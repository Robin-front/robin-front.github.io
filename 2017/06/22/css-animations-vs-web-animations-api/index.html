<!doctype html><html class="theme-next pisces" lang="zh-Hans" manifest="cache.manifest"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="ezF4b6TIq3nrF8BJmQrK_v9BmJnUQfVVPB4xBYo7AD8"><meta name="baidu-site-verification" content="T2V9h2EnoE"><link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="https://cdn.staticfile.org/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="css3,animation,Web Animation,"><link rel="alternate" href="/atom.xml" title="三寸稚笔" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><link rel="apple-touch-icon" href="/touch-icon.png?v=5.1.0"><meta name="apple-mobile-web-app-capable" content="yes"><link rel="apple-touch-startup-image" sizes="750x1294" href="/launch.png?v=5.1.0"><meta name="description" content="有一个JavaScript的动画原生API，称为Web Animation API。我们在这篇文章中称之为WAAPI。MDN有很好的文档，Dan Wilson 有一个伟大的系列文章。在本文中，我们将比较WAAPI和CSS中完成的动画。"><meta name="keywords" content="css3,animation,Web Animation"><meta property="og:type" content="article"><meta property="og:title" content="css 动画和 Web Animation API(WAAPI)对比"><meta property="og:url" content="http://robin-front.github.io/2017/06/22/css-animations-vs-web-animations-api/index.html"><meta property="og:site_name" content="三寸稚笔"><meta property="og:description" content="有一个JavaScript的动画原生API，称为Web Animation API。我们在这篇文章中称之为WAAPI。MDN有很好的文档，Dan Wilson 有一个伟大的系列文章。在本文中，我们将比较WAAPI和CSS中完成的动画。"><meta property="og:image" content="https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_368,f_auto,q_auto/v1496792139/slide-down_ohemtx.gif"><meta property="og:image" content="https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_1000,f_auto,q_auto/v1496519294/animationobject_ujevsk.png"><meta property="og:updated_time" content="2017-06-22T09:48:00.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="css 动画和 Web Animation API(WAAPI)对比"><meta name="twitter:description" content="有一个JavaScript的动画原生API，称为Web Animation API。我们在这篇文章中称之为WAAPI。MDN有很好的文档，Dan Wilson 有一个伟大的系列文章。在本文中，我们将比较WAAPI和CSS中完成的动画。"><meta name="twitter:image" content="https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_368,f_auto,q_auto/v1496792139/slide-down_ohemtx.gif"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",sidebar:{position:"left",display:"always",offset:12,offset_float:0,b2t:!1,scrollpercent:!0},fancybox:!0,motion:!1,duoshuo:{userId:"undefined",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://robin-front.github.io/2017/06/22/css-animations-vs-web-animations-api/"><title>css 动画和 Web Animation API(WAAPI)对比 | 三寸稚笔</title><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-8386186071288063",enable_page_level_ads:!0})</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-74634898-1","auto"),ga("send","pageview")</script><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?51f2c21567935649debac704a10c43f1";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">三寸稚笔</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description"></h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-book"><a href="/RxJS-doc-chinese/" rel="section"><i class="menu-item-icon fa fa-fw fa-book"></i><br>RXJS中文文档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-travel"><a href="/travel" rel="section"><i class="menu-item-icon fa fa-fw fa-plane"></i><br>旅行</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-commonweal"><a href="/404.html" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益404</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://robin-front.github.io/2017/06/22/css-animations-vs-web-animations-api/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="robin"><meta itemprop="description" content=""><meta itemprop="image" content="https://avatars2.githubusercontent.com/u/6723674?v=3&s=460"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="三寸稚笔"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">css 动画和 Web Animation API(WAAPI)对比</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-22T17:48:00+08:00">2017-06-22 </time><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="更新于" itemprop="dateModified" datetime="2017-06-22T17:48:00+08:00">2017-06-22 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/css3/" itemprop="url" rel="index"><span itemprop="name">css3</span> </a></span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/css3/animation/" itemprop="url" rel="index"><span itemprop="name">animation</span> </a></span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/css3/animation/Web-Animation/" itemprop="url" rel="index"><span itemprop="name">Web Animation</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2017/06/22/css-animations-vs-web-animations-api/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/06/22/css-animations-vs-web-animations-api/" itemprop="commentCount"></span></a></span><div class="post-wordcount"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计</span> <span title="字数统计">2,646 </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长</span> <span title="阅读时长">10 min</span></div></div></header><div class="post-body" itemprop="articleBody"><div align="center"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8386186071288063" data-ad-slot="5007169637" data-ad-format="auto"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><p>有一个JavaScript的动画原生API，称为<code>Web Animation API</code>。我们在这篇文章中称之为<code>WAAPI</code>。MDN有很好的<a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API" target="_blank" rel="external">文档</a>，Dan Wilson 有一个伟大的<a href="http://danielcwilson.com/blog/2015/07/animations-part-1/" target="_blank" rel="external">系列文章</a>。</p><p>在本文中，我们将比较WAAPI和CSS中完成的动画。<a id="more"></a></p><h1 id="关于浏览器支持的提示"><a href="#关于浏览器支持的提示" class="headerlink" title="关于浏览器支持的提示"></a>关于浏览器支持的提示</h1><p>尽管现在浏览器的支持很有限，但WAAPI有一个全面而强大的<a href="https://github.com/web-animations/web-animations-js/tree/master" target="_blank" rel="external">polyfill</a>工具，让它可以在当前的生产环境中使用。</p><p>一如既往，您可以检查<a href="http://caniuse.com/#feat=web-animation" target="_blank" rel="external">Can I Use</a> 的浏览器支持数据。然而，这并没有提供非常好的信息来支持WAAPI的所有子功能。这是一个检查器：</p><iframe height="265" scrolling="no" title="WAAPI Browser Support Test" src="//codepen.io/danwilson/embed/xGBKVq/?height=265&theme-id=0&default-tab=js,result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen style="width:100%">See the Pen <a href="https://codepen.io/danwilson/pen/xGBKVq/" target="_blank" rel="external">WAAPI Browser Support Test</a> by Dan Wilson (<a href="https://codepen.io/danwilson" target="_blank" rel="external">@danwilson</a>) on <a href="https://codepen.io" target="_blank" rel="external">CodePen</a>.</iframe><p>想要不使用polyfill而体验所有功能，请使用Firefox Nightly。</p><h1 id="WAAPI的基础知识"><a href="#WAAPI的基础知识" class="headerlink" title="WAAPI的基础知识"></a>WAAPI的基础知识</h1><p>如果您曾经使用<code>jQuery.animate()</code>，WAAPI的基本语法应该看起来很熟悉。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.querySelector(<span class="string">'.animate-me'</span>);</div><div class="line">element.animate(keyframes, <span class="number">1000</span>);</div></pre></td></tr></table></figure><p>该<code>animate</code>方法接受两个参数：关键帧和持续时间。与jQuery不同的是，它不仅具有内置在浏览器中的优点，而且性能也更高。</p><p>第一个参数，关键帧应该是一个对象数组。每个对象都是我们动画中的一个关键帧。这是一个简单的例子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> keyframes = [</div><div class="line">  &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</div><div class="line">  &#123; <span class="attr">opacity</span>: <span class="number">1</span> &#125;</div><div class="line">];</div></pre></td></tr></table></figure><p>第二个参数，持续时间，是我们想要动画持续多久。在上面的例子中是1000毫秒。我们来看一个更令人兴奋的例子。</p><h1 id="用WAAPI重新创建animista-CSS动画"><a href="#用WAAPI重新创建animista-CSS动画" class="headerlink" title="用WAAPI重新创建animista CSS动画"></a>用WAAPI重新创建animista CSS动画</h1><p>这里有一些CSS代码，从非常棒的<a href="http://animista.net/" target="_blank" rel="external">animista</a>中吸取了一些称为“幻灯片模糊的”入场动画的东西。看起来很可爱。</p><p><img src="https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_368,f_auto,q_auto/v1496792139/slide-down_ohemtx.gif" alt="实际[效果](http://animista.net/play/entrances/slide-in-blurred)要比这个 GIF 要棒很多"></p><p>以下是CSS中的关键帧：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">0% &#123;</div><div class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-1000px) <span class="built_in">scaleY</span>(2.5) <span class="built_in">scaleX</span>(.2);</div><div class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">0</span>;</div><div class="line">  <span class="attribute">filter</span>: <span class="built_in">blur</span>(40px);</div><div class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">100% &#123;</div><div class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(0) <span class="built_in">scaleY</span>(1) <span class="built_in">scaleX</span>(1);</div><div class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">50%</span>;</div><div class="line">  <span class="attribute">filter</span>: <span class="built_in">blur</span>(0);</div><div class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>WAAPI中的代码相同：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> keyframes = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">transform</span>: <span class="string">'translateY(-1000px) scaleY(2.5) scaleX(.2)'</span>,</div><div class="line">    <span class="attr">transformOrigin</span>: <span class="string">'50% 0'</span>, <span class="attr">filter</span>: <span class="string">'blur(40px)'</span>, <span class="attr">opacity</span>: <span class="number">0</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">transform</span>: <span class="string">'translateY(0) scaleY(1) scaleX(1)'</span>,</div><div class="line">    <span class="attr">transformOrigin</span>: <span class="string">'50% 50%'</span>,</div><div class="line">    <span class="attr">filter</span>: <span class="string">'blur(0)'</span>,</div><div class="line">    <span class="attr">opacity</span>: <span class="number">1</span></div><div class="line">  &#125;</div><div class="line">];</div></pre></td></tr></table></figure><p>我们已经看到，将关键帧应用到要运动的任何元素是多么容易的事：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">element.animate(keyframes, <span class="number">700</span>);</div></pre></td></tr></table></figure><p>为了简单起见，我只指定了持续时间。但是，我们可以使用这个第二个参数来传递更多的选项。至少我们也应该指定一个缓动函数。以下是可用选项的完整列表，其中包含一些示例值：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> options = &#123;</div><div class="line">  <span class="attr">iterations</span>: <span class="literal">Infinity</span>,</div><div class="line">  <span class="attr">iterationStart</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">delay</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">endDelay</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">direction</span>: <span class="string">'alternate'</span>,</div><div class="line">  <span class="attr">duration</span>: <span class="number">700</span>,</div><div class="line">  <span class="attr">fill</span>: <span class="string">'forwards'</span>,</div><div class="line">  <span class="attr">easing</span>: <span class="string">'ease-out'</span>,</div><div class="line">&#125;</div><div class="line">element.animate(keyframes, options);</div></pre></td></tr></table></figure><p>有了这些选项，我们的动画将从头开始，没有任何延迟，永远循环在向前和向后播放。</p><iframe height="265" scrolling="no" title="motion blur waapi circle" src="//codepen.io/cssgrid/embed/EmBGxG/?height=265&theme-id=0&default-tab=js,result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen style="width:100%">See the Pen <a href="https://codepen.io/cssgrid/pen/EmBGxG/" target="_blank" rel="external">motion blur waapi circle</a> by CSS GRID (<a href="https://codepen.io/cssgrid" target="_blank" rel="external">@cssgrid</a>) on <a href="https://codepen.io" target="_blank" rel="external">CodePen</a>.</iframe><p>令人烦恼的是，对于我们熟悉CSS动画的人来说，一些术语与我们习惯的不同。虽然在积极的一面看，有些事情写起来更快一点！</p><ul><li>这里用<code>easing</code>而不是<code>animation-timing-function</code></li><li>使用<code>iterations</code>而不是<code>animation-iteration-count</code>。如果我们希望动画永远重复，用<code>Infinity</code>而不是<code>infinite</code>。有点混乱，<code>Infinity</code>不是引用。Infinity是一个JavaScript关键字，而其他值是字符串。</li><li>我们使用毫秒而不是秒，对于之前编写过许多JavaScript的人来说，这应该是熟悉的。（您可以在CSS动画中使用毫秒数，但很少有人使用。）</li></ul><p>我们来仔细看看一个选项：<code>iterationStart</code>。</p><p>当我第一次碰到<code>iterationStart</code>, 我被难住了。你为什么要指定迭代的开始，而不仅仅是减少迭代次数？当您使用十进制数时，此选项非常有用。例如，您可以将其设置为 <code>.5</code>，动画将开始一半。要做一整个动画需要两半，所以如果你的迭代次数设置为1，并且你的<code>iterationStart</code>设置为 <code>.5</code>，动画将从一半到动画结束播放，然后从动画开头开始，结束于中间！</p><p>值得注意的是，您也可以将迭代次数设置为小于1。例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> option = &#123;</div><div class="line">  <span class="attr">iterations</span>: <span class="number">.5</span>,</div><div class="line">  <span class="attr">iterationStart</span>: <span class="number">.5</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>这将从中间到最后播放动画。 <code>endDelay：endDelay</code>如果要将多个动画串在一起，但是希望在一个动画的结尾和任何后续动画的开始之间存在差距。这是一个有用的视频，Patrick Brosset 的解释。</p><div style="position:relative;height:0;padding-bottom:56.22%"><iframe src="https://www.youtube.com/embed/hWe-qukNrN8?ecver=2" style="position:absolute;width:100%;height:100%;left:0" width="640" height="360" frameborder="0" allowfullscreen></iframe></div><h1 id="缓动"><a href="#缓动" class="headerlink" title="缓动"></a>缓动</h1><p>缓动是任何动画中最重要的元素之一。WAAPI为我们提供了两种不同的方式设置缓动函数 - 在我们的关键帧阵列或我们的选项对象内。 在CSS中，如果你应用了，<code>animation-timing-function: ease-in-out</code>你可能会假设你的动画的开始会<code>ease in</code>，动画的结束将会<code>ease out</code>。实际上，这些缓动函数应用在关键帧之间，而不是整个动画。这可以对动画的感觉进行细粒度的控制。WAAPI还提供这种能力。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> keyframes = [</div><div class="line">  &#123; <span class="attr">opacity</span>: <span class="number">0</span>, <span class="attr">easing</span>: <span class="string">'ease-in'</span> &#125;,</div><div class="line">  &#123; <span class="attr">opacity</span>: <span class="number">0.5</span>, <span class="attr">easing</span>: <span class="string">'ease-out'</span> &#125;,</div><div class="line">  &#123; <span class="attr">opacity</span>: <span class="number">1</span> &#125;</div><div class="line">]</div></pre></td></tr></table></figure><p>值得注意的是，在CSS和WAAPI中，您不应该传入最后一帧的缓动值，因为这将不起作用。这是很多人犯的错误。 有时候，在整个动画中添加缓动效果更为直观。这在CSS是不可能的，但现在可以实现与WAAPI。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> options = &#123;</div><div class="line">  <span class="attr">duration</span>: <span class="number">1000</span>,</div><div class="line">  <span class="attr">easing</span>: <span class="string">'ease-in-out'</span>,</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>你可以看到这两种缓动在CodePen上的区别：</p><iframe height="265" scrolling="no" title="Same animation, different easing" src="//codepen.io/cssgrid/embed/OmrVeQ/?height=265&theme-id=0&default-tab=js,result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen style="width:100%">See the Pen <a href="https://codepen.io/cssgrid/pen/OmrVeQ/" target="_blank" rel="external">Same animation, different easing</a> by CSS GRID (<a href="https://codepen.io/cssgrid" target="_blank" rel="external">@cssgrid</a>) on <a href="https://codepen.io" target="_blank" rel="external">CodePen</a>.</iframe><h1 id="ease-vs-linear"><a href="#ease-vs-linear" class="headerlink" title="ease vs linear"></a>ease vs linear</h1><p>值得注意的是CSS动画和WAAPI之间的另一个区别：CSS ease的默认值是<code>ease</code>,WAAPI的默认值<code>linear</code>。 <code>Ease</code>实际上是一个版本，<code>ease-in-out</code>是一个非常好的选择，如果你感到懒惰。同时，<code>linear</code> 是沉闷的和无生机的 - 一致的速度看起来机械和不自然。它被选为默认值，可能因为它是最中立的选项。然而，在WAAPI中使用时，使用缓动比在CSS更重要，以免您的动画看起来很乏味和机械地。</p><h1 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h1><p>WAAPI提供与CSS动画相同的性能改进，尽管这并不意味着平滑的动画是不可避免的。</p><p>我希望这个API的性能优化意味着我们可以避免使用<code>will-change</code>和完全hack <code>translateZ</code> - 最终可能。但是，至少在目前的浏览器实现中，这些属性在处理闪烁问题（<code>jank issue</code>）方面仍然是有帮助和必要的。</p><p>但是，至少如果您的动画有延迟，则无需担心使用<code>will-change</code>。网络动画规范的主要作者对“<a href="https://damp-lake-50659.herokuapp.com/" target="_blank" rel="external">Animation for Work Slack community</a>”提出了一些有趣的建议，希望他不介意我在这里重复：</p><blockquote><p>如果您有一个积极的延迟，您不需要<code>will-change</code>因为浏览器将在延迟开始时进行分层，当动画启动时，它将准备就绪。</p></blockquote><h1 id="WAAPI对战CSS动画？"><a href="#WAAPI对战CSS动画？" class="headerlink" title="WAAPI对战CSS动画？"></a>WAAPI对战CSS动画？</h1><p>WAAPI为我们提供了一个在JavaScript中实现css中的语法。然而，他们不应该被视为对手。如果我们决定坚持使用CSS进行<code>animations</code>和<code>transitions</code>，那么我们可以与WAAPI进行动画交互。</p><h1 id="Animation-对象"><a href="#Animation-对象" class="headerlink" title="Animation 对象"></a>Animation 对象</h1><p>该<code>.animate()</code>方法不仅仅是动画我们的元素，它也返回一些东西。</p><p><img src="https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_1000,f_auto,q_auto/v1496519294/animationobject_ujevsk.png" alt="在控制台中查看的动画对象"></p><p>如果我们看看控制台中的返回值，我们将看到它的一个动画对象。这为我们提供了各种各样的功能，其中一些是非常不言自明的<code>myAnimation.pause()</code>。通过更改<code>animation-play-state</code>属性，我们可以通过CSS动画实现类似的结果，但WAAPI语法比稍微简单<code>element.style.animationPlayState = &quot;paused&quot;</code>。我们也有权力轻松地扭转我们的动画<code>myAnimation.reverse()</code>，再次，<code>animation-direction</code>与使用我们的脚本更改CSS属性相比，稍微有点改进。</p><p>然而，到目前为止，<code>@keyframe</code>用JavaScript进行操作并不是世界上最简单的事情。即使像重新启动动画一样简单，就像Chris Coyier 先前<a href="https://css-tricks.com/restart-css-animation/" target="_blank" rel="external">写过的</a>那样，这个技巧也有<a href="https://css-tricks.com/restart-css-animation/" target="_blank" rel="external">一些技巧</a>。使用WAAPI，我们可以简单地使用<code>myAnimation.play()</code>，它从一开始就重播动画，如果它已经完成，或者如果我们暂停播放，则从中间迭代继续播放动画。</p><p>我们甚至可以轻松地改变动画的速度。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">myAnimation.playbackRate = <span class="number">2</span>; <span class="comment">// speed it up</span></div><div class="line">myAnimation.playbackRate = <span class="number">.4</span>; <span class="comment">// use a number less than one to slow it down</span></div></pre></td></tr></table></figure><h1 id="getAnimations（）"><a href="#getAnimations（）" class="headerlink" title="getAnimations（）"></a>getAnimations（）</h1><p>此方法将返回任何动画对象的数组，以便我们使用WAAPI定义的任何动画以及 <em>任何CSS <code>transitions</code>或<code>animations</code></em>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">element.getAnimations() <span class="comment">// returns any animations or transitions applied to our element using CSS or WAAPI</span></div></pre></td></tr></table></figure><p>如果您感觉使用CSS来定义和应用您的动画比较顺手，<code>getAnimations()</code>可以使用API​​与<code>@keyframes</code> 结合使用。您可以继续使用CSS进行大部分动画工作，并在需要API时获得API的优势。让我们看看这是多么简单。</p><p>即使一个DOM元素只有一个动画应用到它，<code>getAnimations()</code>也将始终返回一个数组。我们来抓住那个单一的动画对象来处理。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> h2 = <span class="built_in">document</span>.querySelector(<span class="string">"h2"</span>);</div><div class="line"><span class="keyword">var</span> myCSSAnimation = h2.getAnimations()[<span class="number">0</span>];</div></pre></td></tr></table></figure><p>现在我们可以在我们的CSS动画中使用web animation API :)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">myCSSAnimation.playbackRate = <span class="number">4</span>;</div><div class="line">myCSSAnimation.reverse();</div></pre></td></tr></table></figure><h1 id="Promise和事件"><a href="#Promise和事件" class="headerlink" title="Promise和事件"></a>Promise和事件</h1><p>我们已经有多种通过CSS触发的事件，我们可以在我们的JavaScript代码利用的有：<code>animationstart</code>，<code>animationend</code>，<code>animationiteration</code>和<code>transitionend</code>。我经常需要收听<code>animations</code>或<code>transitions</code>的结束，以便从DOM中删除应用于它的元素。</p><p>在WAAPI 中使用<code>animationend</code>或<code>transitionend</code>为此目的相当于再次使用动画对象：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">myAnimation.onfinish = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  element.remove();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>WAAPI为我们提供了事件和Promise的选择。我们的动画的<code>.finished</code>属性对象将在动画结束时返回一个resolve 的 Promise。以下是上面的例子，就像使用Promise一样：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">myAnimation.finished.then(<span class="function"><span class="params">()</span> =&gt;</span></div><div class="line">  element.remove())</div></pre></td></tr></table></figure><p>我们来看看Mozilla开发人员网络中的一个稍微有点省略的例子。<code>Promise.all</code>接收一个Promise数组，一旦所有这些Promise得到解决，才会运行我们的回调函数。我们已经看到，<code>element.getAnimations()</code>返回一个动画对象数组。我们可以将数组中的所有动画对象映射到每个动画对象<code>.finished</code>上，为我们提供所需的Promise数组。</p><p>在这个例子中，只有在页面上的所有动画完成后，我们的函数才能运行。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.all(<span class="built_in">document</span>.getAnimations().map(<span class="function"><span class="params">animation</span> =&gt;</span></div><div class="line">  animation.finished)).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;           </div><div class="line">    <span class="comment">// do something cool</span></div><div class="line">  &#125;);</div></pre></td></tr></table></figure><h1 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h1><p>本文中提到的功能只是开始。目前的规范和实践看起来是一件伟大的事情的开始。</p><p>「翻譯原文」：<a href="https://css-tricks.com/css-animations-vs-web-animations-api/?utm_source=frontendfocus" target="_blank" rel="external">https://css-tricks.com/css-animations-vs-web-animations-api/?utm_source=frontendfocus</a></p></div><div></div><div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> robin</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://robin-front.github.io/2017/06/22/css-animations-vs-web-animations-api/" title="css 动画和 Web Animation API(WAAPI)对比">http://robin-front.github.io/2017/06/22/css-animations-vs-web-animations-api/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/css3/" rel="tag"># css3</a> <a href="/tags/animation/" rel="tag"># animation</a> <a href="/tags/Web-Animation/" rel="tag"># Web Animation</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/06/21/webpack3官方正式发布-作用域提升，“魔法注释”，以及更多新特性！/" rel="next" title="webpack3官方正式发布,亮点:作用域提升，“魔法注释”，以及更多新特性！"><i class="fa fa-chevron-left"></i> webpack3官方正式发布,亮点:作用域提升，“魔法注释”，以及更多新特性！</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2017/06/25/animations-intro/" rel="prev" title="让我们谈谈 Web Animations API">让我们谈谈 Web Animations API <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8386186071288063" data-ad-slot="9018566839" data-ad-format="auto"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="https://avatars2.githubusercontent.com/u/6723674?v=3&s=460" alt="robin"><p class="site-author-name" itemprop="name">robin</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">65</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">40</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">63</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/robin-front" target="_blank" title="github"><i class="fa fa-fw fa-github"></i> github </a></span><span class="links-of-author-item"><a href="https://twitter.com/lb_robin" target="_blank" title="twitter"><i class="fa fa-fw fa-twitter"></i> twitter </a></span><span class="links-of-author-item"><a href="https://stackoverflow.com/users/6053135/robin" target="_blank" title="stackoverflow"><i class="fa fa-fw fa-stack-overflow"></i> stackoverflow</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#关于浏览器支持的提示"><span class="nav-number">1.</span> <span class="nav-text">关于浏览器支持的提示</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WAAPI的基础知识"><span class="nav-number">2.</span> <span class="nav-text">WAAPI的基础知识</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#用WAAPI重新创建animista-CSS动画"><span class="nav-number">3.</span> <span class="nav-text">用WAAPI重新创建animista CSS动画</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#缓动"><span class="nav-number">4.</span> <span class="nav-text">缓动</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ease-vs-linear"><span class="nav-number">5.</span> <span class="nav-text">ease vs linear</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#性能"><span class="nav-number">6.</span> <span class="nav-text">性能</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WAAPI对战CSS动画？"><span class="nav-number">7.</span> <span class="nav-text">WAAPI对战CSS动画？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Animation-对象"><span class="nav-number">8.</span> <span class="nav-text">Animation 对象</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#getAnimations（）"><span class="nav-number">9.</span> <span class="nav-text">getAnimations（）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Promise和事件"><span class="nav-number">10.</span> <span class="nav-text">Promise和事件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#未来"><span class="nav-number">11.</span> <span class="nav-text">未来</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div align="center"></div><div class="copyright">&copy; 2014 - <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">robin</span></div><div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info">主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script><script type="text/javascript" src="https://cdn.staticfile.org/fastclick/1.0.6/fastclick.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="https://cdn.staticfile.org/velocity/1.2.1/velocity.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.ui.min.js"></script><script type="text/javascript" src="https://cdn.staticfile.org/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript">$(function(){setTimeout(function(){var a=function(a){return'<ins class="adsbygoogle"style="display:block"data-ad-client="ca-pub-8386186071288063"data-ad-slot="'+a+'"data-ad-format="auto"></ins>'},t=$("#posts .post-body").children(),o=$("#more");o.parent().is(".post-body")||(o=o.parent()),o.after(function(a){return'<ins class="adsbygoogle"style="display:block; text-align:center;"data-ad-format="fluid"data-ad-layout="in-article"data-ad-client="ca-pub-8386186071288063"data-ad-slot="'+a+'"></ins>'}(9111344837)),(adsbygoogle=window.adsbygoogle||[]).push({}),t.length>20&&(t.eq(t.length/2>>0).after(a(6018277638)),(adsbygoogle=window.adsbygoogle||[]).push({})),t.length>30&&(t.eq(-5).after(a(7495010830)),(adsbygoogle=window.adsbygoogle||[]).push({}))},0)})</script><script id="dsq-count-scr" src="https://robin-front-github-io.disqus.com/count.js" async></script><script type="text/javascript">var disqus_config=function(){this.page.url="http://robin-front.github.io/2017/06/22/css-animations-vs-web-animations-api/",this.page.identifier="2017/06/22/css-animations-vs-web-animations-api/",this.page.title="css 动画和 Web Animation API(WAAPI)对比"},d=document,s=d.createElement("script");s.src="https://robin-front-github-io.disqus.com/embed.js",s.setAttribute("data-timestamp",""+ +new Date),(d.head||d.body).appendChild(s)</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script></body></html>