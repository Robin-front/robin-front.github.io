<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä¸‰å¯¸ç¨šç¬”</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://robin-front.github.io/"/>
  <updated>2017-11-29T01:49:43.000Z</updated>
  <id>http://robin-front.github.io/</id>
  
  <author>
    <name>robin</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç </title>
    <link href="http://robin-front.github.io/2017/11/29/clean-code-dirty-code/"/>
    <id>http://robin-front.github.io/2017/11/29/clean-code-dirty-code/</id>
    <published>2017-11-29T01:49:43.000Z</published>
    <updated>2017-11-29T01:49:43.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç "><a href="#ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç " class="headerlink" title="ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç "></a>ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç </h1><p>è¿™ç¯‡æ–‡ç« å°†é‡ç‚¹ä»‹ç»é€‚ç”¨äºç°ä»£ react è½¯ä»¶å¼€å‘çš„ç®€æ´ä»£ç ä¹‹é“ã€‚æˆ‘è¿˜ä¼šè°ˆè°ˆ ES6/ES2015 å¸¦æ¥çš„ä¸€äº›â€œè¯­æ³•ç³–â€ã€‚<a id="more"></a></p><h2 id="ä»€ä¹ˆæ˜¯ç®€æ´ä»£ç ä¹‹é“ï¼Œä¸ºä»€ä¹ˆæˆ‘å¦‚æ­¤å…³å¿ƒï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç®€æ´ä»£ç ä¹‹é“ï¼Œä¸ºä»€ä¹ˆæˆ‘å¦‚æ­¤å…³å¿ƒï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç®€æ´ä»£ç ä¹‹é“ï¼Œä¸ºä»€ä¹ˆæˆ‘å¦‚æ­¤å…³å¿ƒï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç®€æ´ä»£ç ä¹‹é“ï¼Œä¸ºä»€ä¹ˆæˆ‘å¦‚æ­¤å…³å¿ƒï¼Ÿ</h2><p>ç®€æ´ä»£ç ä¹‹é“çš„ä¸€è´¯ç¼–ç é£æ ¼æ˜¯è®©ä½ çš„ä»£ç æ›´æ˜“å†™ã€æ˜“è¯»å’Œæ˜“ç»´æŠ¤ã€‚ç»å¸¸ï¼Œç¨‹åºå‘˜åœ¨ä¸€ä¸ªé—®é¢˜ä¸ŠèŠ±äº†è®¸å¤šæ—¶é—´ï¼Œä¸€æ—¦é—®é¢˜è¢«è§£å†³ï¼Œå°±æäº¤ä»£ç ã€‚æˆ‘ä¸€ç›´ä¸»å¼ ï¼Œä½ çš„å·¥ä½œå¹¶æ²¡æœ‰å®Œæˆï¼Œå› ä¸ºä½ åªæ˜¯è®©ä½ çš„ä»£ç â€œæ­£å¸¸å·¥ä½œâ€è€Œå·²ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªæœºä¼šæ¥ç²¾ç®€ä½ çš„ä»£ç ï¼Œé€šè¿‡åˆ é™¤æ­»ä»£ç ï¼ˆåƒµå°¸ä»£ç ï¼‰ã€é‡æ„ã€åˆ é™¤è¢«æ³¨é‡Šçš„ä»£ç ï¼åŠªåŠ›æé«˜å¯ç»´æŠ¤æ€§ã€‚æ‰ªå¿ƒè‡ªé—®ï¼Œâ€œ6ä¸ªæœˆåå…¶ä»–äººè¿˜èƒ½ç†è§£ä½ çš„ä»£ç å—ï¼Ÿâ€</p><p>ç®€å•æ¥è¯´ï¼Œç¼–å†™èƒ½è®©ä½ è‡ªè±ªåˆ°å¸¦å›å®¶å’Œæ¯äº²ç‚«è€€çš„ä»£ç ã€‚</p><p>ä¸ºä»€ä¹ˆä½ è¦è¿™ä¹ˆå…³å¿ƒè¿™ä¸ªé—®é¢˜ï¼Ÿå› ä¸ºå¦‚æœä½ æ˜¯ä¸€ä¸ªå¥½å¼€å‘è€…ï¼Œä½ ä¼šå¾ˆæ‡’ã€‚å¬æˆ‘è¯´å®Œï¼Œæˆ‘æ˜¯èµæ‰¬çš„æ„æ€ã€‚ä¸€ä¸ªå¥½çš„å¼€å‘è€…ï¼Œé¢å¯¹åŒä¸€ä»¶äº‹è¦åšå¾ˆå¤šéçš„çŠ¶å†µï¼Œé€šå¸¸ä¼šå¯»æ‰¾ä¸€ä¸ªè‡ªåŠ¨è§£å†³ï¼ˆæˆ–æ›´å¥½çš„ï¼‰æ–¹æ¡ˆæ¥å®Œæˆçœ¼å‰çš„ä»»åŠ¡ã€‚æ‰€ä»¥ï¼Œå› ä¸ºä½ å¾ˆæ‡’ï¼Œå…³æ³¨ç®€æ´ä»£ç çš„æŠ€æœ¯å°†ä¼šå‡å°‘ä½ æ‹‰å–ä»£ç ä¸€éåˆä¸€éåœ° review åŒä¸€æ®µä»£ç çš„é¢‘ç‡ã€‚</p><h2 id="é€šè¿‡å—…è§‰æµ‹è¯•ç²¾ç®€ä»£ç "><a href="#é€šè¿‡å—…è§‰æµ‹è¯•ç²¾ç®€ä»£ç " class="headerlink" title="é€šè¿‡å—…è§‰æµ‹è¯•ç²¾ç®€ä»£ç "></a>é€šè¿‡å—…è§‰æµ‹è¯•ç²¾ç®€ä»£ç </h2><p>ç²¾ç®€ä»£ç åº”è¯¥é€šè¿‡å—…è§‰æµ‹è¯•ã€‚ä¸æ˜ç™½æˆ‘æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ä»¬éƒ½çœ‹ç€ï¼ˆè‡ªå·±çš„æˆ–åˆ«äººçš„ï¼‰ä»£ç è¯´ï¼šâ€œè¿™é‡Œä¸å¤ªå¯¹åŠ²ã€‚â€ è®°ä½ï¼Œå¦‚æœæ„Ÿè§‰ä¸å¤ªå¯¹åŠ²ï¼Œé‚£å¯èƒ½çœŸçš„ä¸å¯¹åŠ²ã€‚ä¸€èµ·å¯¹ä»£ç æ·±æ€ç†Ÿè™‘æ˜¯å¥½çš„ã€‚ä½†å¦‚æœä½ å‘è§‰ä½ æ­£åœ¨æŠŠä¸€ä¸ªæ–¹å½¢çš„é’‰å­æ’è¿›ä¸€ä¸ªåœ†å½¢çš„æ´é‡Œï¼Œé‚£å°±è¯·åœä¸‹æ¥ï¼Œé€€ä¸€æ­¥ï¼Œå¹¶ä¸”ä¼‘æ¯ä¸€ä¸‹ã€‚æœ€å¤šåæ¬¡ï¼Œä½ ä¼šæ‰¾åˆ°æ›´å¥½çš„è§£å†³åŠæ³•çš„ã€‚</p><h2 id="ç²¾ç®€ä»£ç å°±æ˜¯-DRY-ï¼ˆç¦æ­¢é‡å¤ï¼‰"><a href="#ç²¾ç®€ä»£ç å°±æ˜¯-DRY-ï¼ˆç¦æ­¢é‡å¤ï¼‰" class="headerlink" title="ç²¾ç®€ä»£ç å°±æ˜¯ DRY ï¼ˆç¦æ­¢é‡å¤ï¼‰"></a>ç²¾ç®€ä»£ç å°±æ˜¯ DRY ï¼ˆç¦æ­¢é‡å¤ï¼‰</h2><p>DRY æ˜¯ â€œDonâ€™t repeat yourself!â€ çš„ç¼©å†™ã€‚å¦‚æœä¸€ä»¶äº‹ä½ åšäº†å¾ˆå¤šéï¼Œåˆå¹¶é‡å¤çš„ä»£ç ã€‚å¦‚æœä½ åœ¨ä½ ä»£ç é‡Œå‘ç°äº†è®¾è®¡æ¨¡å¼ï¼Œé‚£æ˜¯ä¸€ä¸ªåˆ é™¤é‡å¤çš„è¿¹è±¡ã€‚æœ‰æ—¶å€™è¿™æ„å‘³ç€ä½ ç«™å¾—ç¦»å±å¹•è¿œè¿œåœ°ï¼Œç›´åˆ°ä½ çœ‹ä¸æ¸…æ–‡å­—ï¼Œä¹Ÿæ— æ³•å¯»æ‰¾æ¨¡å¼ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="keyword">const</span> MyComponent = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;OtherComponent type="a" className="colorful" foo=&#123;123&#125; bar=&#123;456&#125; /&gt;</div><div class="line">    &lt;OtherComponent type="b" className="colorful" foo=&#123;123&#125; bar=&#123;456&#125; /&gt;    </div><div class="line">  &lt;/div&gt;</div><div class="line">);</div></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">const</span> MyOtherComponent = <span class="function">(<span class="params">&#123; type &#125;</span>) =&gt;</span> (</div><div class="line">  &lt;OtherComponent type=&#123;type&#125; className="colorful" foo=&#123;123&#125; bar=&#123;456&#125; /&gt;</div><div class="line">);</div><div class="line">const MyComponent = () =&gt; (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;MyOtherComponent type="a" /&gt;</div><div class="line">    &lt;MyOtherComponent type="b" /&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">);</div></pre></td></tr></table></figure><p>æœ‰æ—¶å€™ï¼Œå°±åƒä¸Šé¢çš„ä¾‹å­é‚£æ · â€”â€” åˆ é™¤é‡å¤ä»£ç å¹¶ä¸ä¼šå‡å°‘ä»£ç é‡ã€‚ä½†æ˜¯ï¼Œåˆ é™¤é‡å¤ä»£ç ä¸€èˆ¬ä¼šæé«˜å¯ç»´æŠ¤æ€§ã€‚</p><p>è¦æ³¨æ„ï¼Œä¸è¦åœ¨åˆ é™¤é‡å¤ä»£ç è¿™ä»¶äº‹ä¸Šåšå¾—å¤ªè¿‡åˆ†äº†ï¼Œæ‰€ä»¥è¦çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥è¯´ä»€ä¹ˆã€‚</p><h2 id="ç®€æ´çš„ä»£ç æ˜¯å¯é¢„æµ‹å’Œå¯æµ‹è¯•çš„"><a href="#ç®€æ´çš„ä»£ç æ˜¯å¯é¢„æµ‹å’Œå¯æµ‹è¯•çš„" class="headerlink" title="ç®€æ´çš„ä»£ç æ˜¯å¯é¢„æµ‹å’Œå¯æµ‹è¯•çš„"></a>ç®€æ´çš„ä»£ç æ˜¯å¯é¢„æµ‹å’Œå¯æµ‹è¯•çš„</h2><p>ç¼–å†™å•å…ƒæµ‹è¯•ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå®ƒå·²ç»å‡ ä¹å˜æˆå¼ºåˆ¶æ€§çš„ã€‚æ¯•ç«Ÿï¼Œä½ æ€æ ·ç¡®ä¿æ–°ç‰¹æ€§æ²¡æœ‰åœ¨æŸäº›åœ°æ–¹å¼•èµ·ä¸€äº› bugsã€‚</p><p>è®¸å¤š react å¼€å‘è€…ä¾é é›¶é…ç½®çš„ <a href="https://facebook.github.io/jest/" target="_blank" rel="noopener">jest</a> æµ‹è¯•åº“ï¼Œå¹¶äº§å‡ºè¦†ç›–æŠ¥å‘Šã€‚å¦‚æœä½ å¯¹å‰åè§†è§‰å¯¹ç…§æµ‹è¯•æ„Ÿå…´è¶£ï¼Œè¯·å°è¯•ä¸€ä¸‹ ç¾å›½è¿é€šå¼€æºçš„ <a href="https://github.com/americanexpress/jest-image-snapshot" target="_blank" rel="noopener">Jest Image Snapshot</a>ã€‚</p><h2 id="ç®€æ´çš„ä»£ç èƒ½è‡ªæˆ‘è¯´æ˜"><a href="#ç®€æ´çš„ä»£ç èƒ½è‡ªæˆ‘è¯´æ˜" class="headerlink" title="ç®€æ´çš„ä»£ç èƒ½è‡ªæˆ‘è¯´æ˜"></a>ç®€æ´çš„ä»£ç èƒ½è‡ªæˆ‘è¯´æ˜</h2><p>ä½ ä¹‹å‰æœ‰é‡åˆ°è¿‡å—ï¼Ÿä½ å†™äº†ä¸€äº›ä»£ç ï¼Œå¹¶ç¡®ä¿å®ƒæ‹¥æœ‰å®Œæ•´çš„æ³¨é‡Šã€‚å°†ä¼šå‘ç”Ÿè¿™æ ·çš„æƒ…å†µï¼Œä½ å‘ç°ä¸€ä¸ª bug, æ‰€ä»¥ä½ å›å»ä¿®æ”¹ä»£ç ã€‚ä½ è¿˜è®°å¾—ä¿®æ”¹æ³¨é‡Šå¹¶å¯¹åº”æ–°çš„é€»è¾‘å—ï¼Ÿä¹Ÿè®¸è®°å¾—ã€‚ä¹Ÿè®¸ä¸è®°å¾—ã€‚ä¸‹ä¸€ä¸ªçœ‹ä½ ä»£ç çš„äººå¯èƒ½å·²ç»æ‰è¿›å…”å­æ´ï¼ˆè¢«ç»•è¿›å»äº†ï¼‰å› ä¸ºä»–è¿˜åœ¨çœ‹ä»¥å‰çš„æ³¨é‡Šã€‚</p><p>åªç»™å¤æ‚çš„æ€è·¯æ·»åŠ æ³¨é‡Šã€‚ä¸è¦ç»™æ˜¾è€Œæ˜“è§çš„ä»£ç æ·»åŠ æ³¨é‡Šã€‚æ›´å°‘é‡çš„æ³¨é‡Šä¹Ÿæœ‰åˆ©äºå‡å°‘è§†è§‰å¹²æ‰°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="keyword">const</span> fetchUser = <span class="function">(<span class="params">id</span>) =&gt;</span> (</div><div class="line">  fetch(buildUri<span class="string">`/users/<span class="subst">$&#123;id&#125;</span>`</span>) <span class="comment">// Get User DTO record from REST API</span></div><div class="line">    .then(convertFormat) <span class="comment">// Convert to snakeCase</span></div><div class="line">    .then(validateUser) <span class="comment">// Make sure the the user is valid</span></div><div class="line">);</div></pre></td></tr></table></figure><p>è€Œç®€æ´ç‰ˆï¼Œæˆ‘ä»¬é‡å‘½åå‡½æ•°ä»¥ä¾¿æ›´å¥½åœ°æè¿°ä»–ä»¬æ˜¯åšä»€ä¹ˆçš„ï¼Œå› æ­¤æ¶ˆé™¤äº†æ³¨é‡Šçš„å¿…è¦å¹¶å‡å°‘è§†è§‰å¹²æ‰°ã€‚è¿™é™åˆ¶äº†ä»£ç ä¸æ³¨é‡Šä¸åŒ¹é…çš„æ½œåœ¨æ··ä¹±ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">const</span> fetchUser = <span class="function">(<span class="params">id</span>) =&gt;</span> (</div><div class="line">  fetch(buildUri<span class="string">`/users/<span class="subst">$&#123;id&#125;</span>`</span>)</div><div class="line">    .then(snakeToCamelCase)</div><div class="line">    .then(validateUser)</div><div class="line">);</div></pre></td></tr></table></figure><h2 id="å‘½åçš„é‡è¦æ€§"><a href="#å‘½åçš„é‡è¦æ€§" class="headerlink" title="å‘½åçš„é‡è¦æ€§"></a>å‘½åçš„é‡è¦æ€§</h2><p>åœ¨æˆ‘å‰é¢çš„æ–‡ç«  <a href="http://americanexpress.io/faccs-are-an-antipattern" target="_blank" rel="noopener">å­ç»„ä»¶çš„å‡½æ•°æ˜¯ä¸€ç§åæ¨¡å¼</a>, æˆ‘å¼ºè°ƒäº†å‘½åçš„é‡è¦æ€§ã€‚æˆ‘ä»¬åº”è¯¥ä¸¥è‚ƒæ€è€ƒå˜é‡åã€å‡½æ•°åã€ç”šè‡³æ–‡ä»¶åã€‚</p><p>ä¸‹é¢æ˜¯ä¸€äº›æŒ‡å—ï¼š</p><ul><li>å¸ƒå°”å€¼å˜é‡ã€æˆ–è¿”å›å¸ƒå°”å€¼çš„å‡½æ•°ï¼Œåº”è¯¥ä»¥ â€œisâ€, â€œhasâ€, â€œshouldâ€ å¼€å¤´ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="keyword">const</span> done = current &gt;= goal;</div><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">const</span> isComplete = current &gt;= goal;</div></pre></td></tr></table></figure><ul><li>å‡½æ•°ååº”è¯¥æè¿°å‡½æ•°çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ€æ ·å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚æ¢å¥è¯è¯´ï¼Œä¸è¦åœ¨å‘½åä¸­æš´éœ²å®ç°ç»†èŠ‚ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºä¸çŸ¥é“å“ªä¸€å¤©ä½ å°±ä¼šæ¢ä¸€ç§å®ç°ï¼Œè€Œä½ ä¸åº”è¯¥ä¸ºé‡æ„å®ç°æ–¹å¼è€Œå»æ›´æ”¹ä¸šåŠ¡ä»£ç ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä»Šå¤©ä½ å¯èƒ½é€šè¿‡ REST API åŠ è½½ä½ çš„é…ç½®ï¼Œä½†å¯èƒ½æ˜å¤©ä½ åˆæ”¹æˆç”¨ javascipt å®ç°ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="keyword">const</span> loadConfigFromServer = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  ...</div><div class="line">&#125;;</div><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">const</span> loadConfig = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  ...</div><div class="line">&#125;;</div></pre></td></tr></table></figure><h2 id="ç®€æ´ä»£ç éµå¾ªæˆç†Ÿçš„è®¾è®¡æ¨¡å¼å’Œæœ€ä½³å®è·µ"><a href="#ç®€æ´ä»£ç éµå¾ªæˆç†Ÿçš„è®¾è®¡æ¨¡å¼å’Œæœ€ä½³å®è·µ" class="headerlink" title="ç®€æ´ä»£ç éµå¾ªæˆç†Ÿçš„è®¾è®¡æ¨¡å¼å’Œæœ€ä½³å®è·µ"></a>ç®€æ´ä»£ç éµå¾ªæˆç†Ÿçš„è®¾è®¡æ¨¡å¼å’Œæœ€ä½³å®è·µ</h2><p>è®¡ç®—æœºæ™®åŠå¾ˆé•¿æ—¶é—´äº†ã€‚å¤šå¹´æ¥ï¼Œç¨‹åºå‘˜åœ¨è§£å†³æŸäº›é—®é¢˜çš„æ—¶å€™å‘ç°æ¨¡å¼ã€‚è¢«ç§°ä¸º è®¾è®¡æ¨¡å¼ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯éšç€æ—¶é—´æ¨ç§»è¢«è¯æ˜çš„æœ‰ç”¨çš„ç®—æ³•ã€‚ä½ å¯ä»¥ç«™åœ¨è¿™äº›å·¨äººçš„è‚©ä¸Šï¼Œä»¥ä¾¿é¿å…å†çŠ¯è¿™äº›é”™è¯¯ã€‚</p><p>ç„¶åæœ‰ä¸€äº›æœ€ä½³å®è·µï¼Œå®ƒä»¬å’Œè®¾è®¡æ¨¡å¼å¾ˆç±»ä¼¼ï¼Œä½†æ›´å¹¿ä¹‰ï¼Œä¸å…·ä½“æŒ‡ç¼–ç ç®—æ³•ã€‚å®ƒä»¬å¯èƒ½æ¶‰åŠåˆ°ç±»ä¼¼â€œä½ åº”è¯¥åœ¨ç¼–ç æ—¶ä½¿ç”¨ lint å·¥å…·â€ æˆ–è€… â€œå½“ä½ å†™ä¸€ä¸ªç±»åº“æ—¶ï¼Œè¯·åŒ…å« react ä½œä¸º <code>peerDependency</code>â€ã€‚</p><ul><li>å°†å‡½æ•°åŠŸèƒ½ç¼©å°ï¼Œæ¯ä¸€ä¸ªéƒ½èŒè´£å•ä¸€ã€‚è¿™ä¸ªå«åšèŒè´£å•ä¸€åŸåˆ™ã€‚ç¡®ä¿æ¯ä¸ªå‡½æ•°åšå¥½å¹¶åªåšä¸€ä»¶äº‹ã€‚æ„æ€æ˜¯ä½ å¯ä»¥å°†ä¸€ä¸ªå¤æ‚çš„ç»„ä»¶æ‹†åˆ†æˆè®¸å¤šå°çš„éƒ¨åˆ†ã€‚è¿™ä¹Ÿä¼šè®©ä»£ç æ›´æ˜“æµ‹è¯•ã€‚</li><li>æ³¨æ„æŠ½è±¡æ¥å£ã€‚æ¢å¥è¯è¯´ï¼Œä¸è¦å¼ºåˆ¶è®©ä½ çš„ä¸šåŠ¡ä»£ç ä½¿ç”¨ç§æœ‰å˜é‡æˆ–ç§æœ‰æ–¹æ³•ã€‚</li><li>éµå¾ªä¸¥æ ¼çš„ linting è§„åˆ™ï¼Œå®ƒä¼šå¸®åŠ©ä½ ç¼–å†™ç®€æ´ã€é£æ ¼ç»Ÿä¸€çš„ä»£ç ã€‚</li></ul><h2 id="ç®€æ´çš„ä»£ç ä¸ä¸€å®šè¦èŠ±è´¹æ›´é•¿æ—¶é—´"><a href="#ç®€æ´çš„ä»£ç ä¸ä¸€å®šè¦èŠ±è´¹æ›´é•¿æ—¶é—´" class="headerlink" title="ç®€æ´çš„ä»£ç ä¸ä¸€å®šè¦èŠ±è´¹æ›´é•¿æ—¶é—´"></a>ç®€æ´çš„ä»£ç ä¸ä¸€å®šè¦èŠ±è´¹æ›´é•¿æ—¶é—´</h2><p>æˆ‘å¬åˆ°ç¼–å†™ç®€æ´çš„ä»£ç ä¼šé™ä½å·¥ä½œæ•ˆç‡ã€‚çœŸæ˜¯ä¸€æ´¾èƒ¡è¨€ã€‚æ˜¯çš„ï¼Œä¸ºäº†å†²åˆºï¼Œä¸€å¼€å§‹ä½ éœ€è¦æ”¾æ…¢è„šæ­¥ï¼Œä½†æ˜¯å†™äº†å‡ è¡Œä»£ç åï¼Œä½ çš„æ­¥ä¼ä¼šè¶Šæ¥è¶Šå¿«ã€‚</p><p>å¹¶ä¸”ä¸è¦è€ƒè™‘å°†æ¥å†â€œé‡æ„â€å®ƒï¼Œå¹¶èŠ±æ—¶é—´ä¿®å¤æ¥è‡ª code review çš„è¯„è®ºã€‚å¦‚æœä½ å°†ä»£ç æ‹†åˆ†æˆå°æ¨¡å—ï¼Œæ¯ä¸ªéƒ½èŒè´£å•ä¸€ï¼Œå¾ˆå¯èƒ½å°†æ¥å¤§éƒ¨åˆ†æ¨¡å—éƒ½ä¸ä¼šç¢°ã€‚è¿™å°±æ˜¯é€šè¿‡â€œå†™ä¸‹å®ƒï¼Œå¿˜äº†å®ƒâ€æ¥äº†çœæ—¶é—´ã€‚</p><h2 id="å†—ä½™ä»£ç -VS-ç®€æ´ä»£ç çš„å®è·µä¾‹å­"><a href="#å†—ä½™ä»£ç -VS-ç®€æ´ä»£ç çš„å®è·µä¾‹å­" class="headerlink" title="å†—ä½™ä»£ç  VS. ç®€æ´ä»£ç çš„å®è·µä¾‹å­"></a>å†—ä½™ä»£ç  VS. ç®€æ´ä»£ç çš„å®è·µä¾‹å­</h2><p>çœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚ç»§ç»­çœ‹ï¼Œå¹¶è¿”å›åˆ°å‰é¢æˆ‘æ‰€è®²çš„å†…å®¹ã€‚ä½ æœ‰çœ‹åˆ°ä»€ä¹ˆæ¨¡å¼å—ï¼Ÿæ³¨æ„åˆ° <code>Thingie</code> ç»„ä»¶å’Œ <code>ThingieWithTitle</code> ç»„ä»¶é™¤äº† <code>Title</code> ç»„ä»¶ä¹‹å¤–éƒ½å®Œå…¨ç›¸åŒã€‚è¿™æ»¡è¶³äº† DRY çš„æ¡ä»¶ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="keyword">import</span> Title <span class="keyword">from</span> <span class="string">'./Title'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> Thingie = <span class="function">(<span class="params">&#123; description &#125;</span>) =&gt;</span> (</div><div class="line">  &lt;div class="thingie"&gt;</div><div class="line">    &lt;div class="description-wrapper"&gt;</div><div class="line">      &lt;Description value=&#123;description&#125; /&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">);</div><div class="line">export const ThingieWithTitle = (&#123; title, description &#125;) =&gt; (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;Title value=&#123;title&#125; /&gt;</div><div class="line">    &lt;div class="description-wrapper"&gt;</div><div class="line">      &lt;Description value=&#123;description&#125; /&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">);</div></pre></td></tr></table></figure><p>è¿™é‡Œå…è®¸æˆ‘ä»¬ä¼ é€’ <code>children</code> åˆ° <code>Thingie</code>, ç„¶ååˆ›å»ºä¸€ä¸ª <code>ThingieWithTitle</code> åŒ…è£¹ <code>Thingie</code>ï¼Œä¼ é€’ <code>Title</code> ä½œä¸ºå®ƒçš„å­èŠ‚ç‚¹ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">import</span> Title <span class="keyword">from</span> <span class="string">'./Title'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> Thingie = <span class="function">(<span class="params">&#123; description, children &#125;</span>) =&gt;</span> (</div><div class="line">  &lt;div class="thingie"&gt;</div><div class="line">    &#123;children&#125;</div><div class="line">    &lt;div class="description-wrapper"&gt;</div><div class="line">      &lt;Description value=&#123;description&#125; /&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">);</div><div class="line">export const ThingieWithTitle = (&#123; title, ...others &#125;) =&gt; (</div><div class="line">  &lt;Thingie &#123;...others&#125;&gt;</div><div class="line">    &lt;Title value=&#123;title&#125; /&gt;</div><div class="line">  &lt;/Thingie&gt;</div><div class="line">);</div></pre></td></tr></table></figure><h2 id="é»˜è®¤å€¼"><a href="#é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h2><p>çœ‹ä¸‹é¢çš„ä»£ç æ®µã€‚å®ƒé»˜è®¤ä½¿ç”¨ <code>icon-large</code> ä½œä¸º <code>className</code> çš„å£°æ˜å€¼ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="keyword">const</span> Icon = <span class="function">(<span class="params">&#123; className, onClick &#125;</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> additionalClasses = className || <span class="string">'icon-large'</span>;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">span</span></span></span></div><div class="line">      <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">icon-hover</span> $&#123;<span class="attr">additionalClasses</span>&#125;`&#125;</div><div class="line">      <span class="attr">onClick</span>=<span class="string">&#123;onClick&#125;</span>&gt;</div><div class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  );</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ ES6 é»˜è®¤è¯­æ³•ï¼Œç”¨å­—ç¬¦ä¸²æ¥æ›¿æ¢æœªå®šä¹‰çš„å€¼ã€‚è¿™ä¹Ÿå…è®¸æˆ‘ä»¬ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå¹¶æ¶ˆé™¤ return çš„ä½¿ç”¨ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">const</span> Icon = <span class="function">(<span class="params">&#123; className = <span class="string">'icon-large'</span>, onClick &#125;</span>) =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">icon-hover</span> $&#123;<span class="attr">className</span>&#125;`&#125; <span class="attr">onClick</span>=<span class="string">&#123;onClick&#125;</span> /&gt;</span></span></div><div class="line">);</div></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æ›´ç®€æ´çš„ç‰ˆæœ¬ï¼Œé»˜è®¤å€¼é€šè¿‡ react è®¾ç½®ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Cleaner</span></div><div class="line"><span class="keyword">const</span> Icon = <span class="function">(<span class="params">&#123; className, onClick &#125;</span>) =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">icon-hover</span> $&#123;<span class="attr">className</span>&#125;`&#125; <span class="attr">onClick</span>=<span class="string">&#123;onClick&#125;</span> /&gt;</span></span></div><div class="line">);</div><div class="line">Icon.defaultProps = &#123;</div><div class="line">  className: 'icon-large',</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™æ ·æ›´ç®€æ´ï¼Ÿä¸ºä»€ä¹ˆè¿™æ ·æ›´å¥½ï¼Ÿä¸‰ä¸ªç‰ˆæœ¬åšçš„ä¸æ˜¯åŒæ ·ä¸€ä»¶äº‹å—ï¼Ÿå¯¹äºå¤§éƒ¨åˆ†æƒ…å†µæ¥è¯´ï¼Œç¡®å®æ˜¯çš„ã€‚ä½†æ˜¯ï¼Œè®© react è®¾ç½®é»˜è®¤å€¼çš„å¥½å¤„æ˜¯ä¼šäº§ç”Ÿæ›´é«˜æ•ˆçš„ä»£ç ã€‚é»˜è®¤ props åŸºäºç±»çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ,åŒæ—¶å…è®¸ä½ ä½¿ç”¨ <code>propTypes</code> æ£€æŸ¥é»˜è®¤å€¼ã€‚ä½†è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼šç®€åŒ–ç»„ä»¶è‡ªèº«çš„é»˜è®¤é€»è¾‘ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼Œåœ¨ä¸€ä¸ªå˜é‡é‡Œå­˜å‚¨æ‰€æœ‰é»˜è®¤çš„ propsã€‚æˆ‘ä¸å»ºè®®ä½ è¿™æ ·åšï¼Œæˆ‘åªæ˜¯è¯´ä½ å¯ä»¥æœ‰è¿™ç§åšæ³•ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> defaultProps <span class="keyword">from</span> <span class="string">'./defaultProps'</span>;</div><div class="line">...</div><div class="line">Icon.defaultProps = defaultProps.Icon;</div></pre></td></tr></table></figure><h2 id="ä»-render-å‡½æ•°ä¸­åˆ†ç¦»çŠ¶æ€"><a href="#ä»-render-å‡½æ•°ä¸­åˆ†ç¦»çŠ¶æ€" class="headerlink" title="ä» render å‡½æ•°ä¸­åˆ†ç¦»çŠ¶æ€"></a>ä» render å‡½æ•°ä¸­åˆ†ç¦»çŠ¶æ€</h2><p>åœ¨ render å‡½æ•°ä¸­æ··åˆä½ çš„çŠ¶æ€æ•°æ®åŠ è½½é€»è¾‘ä¼šè®©ç»„ä»¶å˜å¾—æ›´å¤æ‚ã€‚ç›¸åï¼Œå†™ä¸€ä¸ªèŒè´£å•ä¸€çš„çŠ¶æ€å®¹å™¨ç»„ä»¶å»åŠ è½½æ•°æ®ã€‚ç„¶åç”¨å¦ä¸€ä¸ªèŒè´£å•ä¸€çš„ç»„ä»¶å»æ˜¾ç¤ºæ•°æ®ã€‚è¿™å«åš <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" target="_blank" rel="noopener">å®¹å™¨æ¨¡å¼</a>ã€‚</p><p>ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œç”¨æˆ·æ•°æ®åœ¨åŒä¸€ä¸ªç»„ä»¶ä¸­åŠ è½½å’Œæ˜¾ç¤ºã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  state = &#123; <span class="attr">loading</span>: <span class="literal">true</span> &#125;;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">const</span> &#123; loading, user &#125; = <span class="keyword">this</span>.state;</div><div class="line">    <span class="keyword">return</span> loading</div><div class="line">      ? <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">      : <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">            First name: &#123;user.firstName&#125;</div><div class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">            First name: &#123;user.lastName&#125;</div><div class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">          ...</div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentDidMount() &#123;</div><div class="line">    fetchUser(<span class="keyword">this</span>.props.id)</div><div class="line">      .then(<span class="function">(<span class="params">user</span>) =&gt;</span> &#123; <span class="keyword">this</span>.setState(&#123; <span class="attr">loading</span>: <span class="literal">false</span>, user &#125;)&#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åœ¨ç®€æ´ç‰ˆæœ¬ï¼Œå…³æ³¨ç‚¹ â€”â€” æ•°æ®åŠ è½½ï¼Œæ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼Œå’Œæ˜¾ç¤ºæ•°æ®è¢«åˆ†ç¦»äº†ã€‚ä¸ä»…è®©ä»£ç æ›´å®¹æ˜“ç†è§£ã€‚è€Œä¸”å¾ˆå®¹æ˜“ç‹¬ç«‹åœ°æµ‹è¯•æ¯ä¸ªå…³æ³¨ç‚¹ã€‚åŒæ—¶ <code>RenderUser</code> æ˜¯ä¸€ä¸ªæ— çŠ¶æ€ç»„ä»¶ã€‚ç»“æœæ˜¯å¯é¢„æµ‹çš„ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">import</span> RenderUser <span class="keyword">from</span> <span class="string">'./RenderUser'</span>;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  state = &#123; <span class="attr">loading</span>: <span class="literal">true</span> &#125;;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">const</span> &#123; loading, user &#125; = <span class="keyword">this</span>.state;</div><div class="line">    <span class="keyword">return</span> loading ? &lt;Loading /&gt; : &lt;RenderUser user=&#123;user&#125; /&gt;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentDidMount() &#123;</div><div class="line">    fetchUser(this.props.id)</div><div class="line">      .then(user =&gt; &#123; this.setState(&#123; loading: false, user &#125;)&#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ— çŠ¶æ€ç»„ä»¶-SFC"><a href="#ä½¿ç”¨æ— çŠ¶æ€ç»„ä»¶-SFC" class="headerlink" title="ä½¿ç”¨æ— çŠ¶æ€ç»„ä»¶ SFC"></a>ä½¿ç”¨æ— çŠ¶æ€ç»„ä»¶ SFC</h2><p>æ— çŠ¶æ€ç»„ä»¶ï¼ˆSFCï¼‰åœ¨ React v0.14.0 çš„æ—¶å€™è¢«æ¨å‡ºã€‚å®ƒä»¬è¢«ç”¨æ¥å¤§å¤§ç®€åŒ–ä¸€ä¸ªä»…ç”¨äºæ¸²æŸ“çš„ç»„ä»¶ã€‚ä½†å¾ˆå¤šå¼€å‘è€…è¿˜æ²¡æœ‰æ”¾ä¸‹è¿‡å»ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢è¿™ä¸ªç»„ä»¶å…·å¤‡è½¬æ¢æˆ SFC çš„æ¡ä»¶ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableRowWrapper</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></div><div class="line">        &#123;this.props.children&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç®€æ´ç‰ˆæ¸…ç†äº†å¾ˆå¤šå†—ä½™ç‰ˆæœ¬çš„å¹²æ‰°çš„ä¸œè¥¿ã€‚é€šè¿‡ react çš„æ ¸å¿ƒä¼˜åŒ–ï¼Œæœ‰å¯èƒ½ä½¿ç”¨æ›´å°‘çš„å†…å­˜ï¼Œæ²¡æœ‰å®ä¾‹è¢«åˆ›å»ºã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">const</span> TableRowWrapper = <span class="function">(<span class="params">&#123; children &#125;</span>) =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></div><div class="line">    &#123;children&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">);</div></pre></td></tr></table></figure><h2 id="Rest-spread-â€¦æ“ä½œç¬¦"><a href="#Rest-spread-â€¦æ“ä½œç¬¦" class="headerlink" title="Rest/spread (â€¦æ“ä½œç¬¦)"></a>Rest/spread (â€¦æ“ä½œç¬¦)</h2><p>å¤§çº¦ä¸€å¹´å‰ï¼Œåœ¨æˆ‘å¿ƒä¸­ <code>Object.assign</code> å°†ä¼šå˜æˆæ¯ä¸ªäººæœ€å¥½çš„æ–°æœ‹å‹ã€‚ä½†æ˜¯ï¼Œæ—¶ä»£å˜äº†ï¼ŒES2016/ES7 çš„ <a href="https://github.com/tc39/proposal-object-rest-spread" target="_blank" rel="noopener">rest/spread spec</a> æ¥äº†ã€‚</p><p>çœ‹ä¸€ä¸ªç»™ç»„ä»¶ä¼ é€’ props çš„æ¡ˆä¾‹ã€‚ä½ æƒ³åœ¨ç»„ä»¶å†…ä½¿ç”¨ <code>className</code>ï¼Œä½†æŠŠå‰©ä½™çš„ props ä¼ é€’ç»™å­ç»„ä»¶ã€‚ä½ å¯èƒ½ä¼šè¿™æ ·åšã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="keyword">const</span> MyComponent = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> others = <span class="built_in">Object</span>.assign(&#123;&#125;, props);</div><div class="line">  <span class="keyword">delete</span> others.className;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;props.className&#125;</span>&gt;</span></span></div><div class="line">      &#123;React.createElement(MyOtherComponent, others)&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  );</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p>ä¸å¤Ÿä¼˜é›…ï¼Œä¸æ˜¯ä¹ˆï¼Ÿä½†ä½¿ç”¨ rest/spread, å°±åƒçœ‹åˆ°ä¸€å—è›‹ç³•ä¸€æ ·ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">const</span> MyComponent = <span class="function">(<span class="params">&#123; className, ...others &#125;</span>) =&gt;</span> (</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">MyOtherComponent</span> &#123;<span class="attr">...others</span>&#125; /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">);</div></pre></td></tr></table></figure><h2 id="é€‚æ—¶ä½¿ç”¨è§£æ„"><a href="#é€‚æ—¶ä½¿ç”¨è§£æ„" class="headerlink" title="é€‚æ—¶ä½¿ç”¨è§£æ„"></a>é€‚æ—¶ä½¿ç”¨è§£æ„</h2><p>ES6 æœ‰ä¸€ä¸ªæ¦‚å¿µå« <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank" rel="noopener">destructure</a>è§£æ„èµ‹å€¼ã€‚å®ƒå…è®¸ä½ å–å‡º object æˆ– array é‡Œçš„æŸä¸ªå€¼ã€‚</p><h3 id="object-destructuring-å¯¹è±¡è§£æ„"><a href="#object-destructuring-å¯¹è±¡è§£æ„" class="headerlink" title="object destructuring å¯¹è±¡è§£æ„"></a>object destructuring å¯¹è±¡è§£æ„</h3><p>æ¯”å¦‚ï¼Œç»™ <code>componentWillReceiveProps</code> ä¼ é€’äº† <code>newProps</code>ï¼Œæˆ‘ä»¬ç»™ <code>state.active</code> è®¾ç½®ä¸€ä¸ªæ–°çš„ <code>active</code> å€¼ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line">componentWillReceiveProps(newProps) &#123;</div><div class="line">  <span class="keyword">this</span>.setState(&#123;</div><div class="line">    <span class="attr">active</span>: newProps.active</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åœ¨ç®€æ´ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å°†è§£æ„ <code>newProps</code> é‡Œçš„ <code>active</code>ï¼Œ ä¸ä»…ä¸å†éœ€è¦å¼•ç”¨ <code>newProps.active</code>, è€Œä¸”å¯ä»¥åªä½¿ç”¨å¯¹è±¡ä¸­çš„å±æ€§å <code>setState</code>:</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Clean</span></div><div class="line">componentWillReceiveProps(&#123; active &#125;) &#123;</div><div class="line">  <span class="keyword">this</span>.setState(&#123; active &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="array-destructuring-æ•°ç»„è§£æ„"><a href="#array-destructuring-æ•°ç»„è§£æ„" class="headerlink" title="array destructuring æ•°ç»„è§£æ„"></a>array destructuring æ•°ç»„è§£æ„</h3><p>ç»å¸¸å¿½è§† ES6 çš„æ•°ç»„è§£æ„ç‰¹æ€§ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œå®ƒä» <code>local</code> å–å‡ºä¸€ä¸ªå€¼,æ¯”å¦‚ â€œes-USâ€, æ‹†åˆ†å¹¶èµ‹å€¼ç»™ <code>language</code>(en) å’Œ <code>country</code>(US)</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Dirty</span></div><div class="line"><span class="keyword">const</span> splitLocale = locale.split(<span class="string">'-'</span>);</div><div class="line"><span class="keyword">const</span> language = splitLocale[<span class="number">0</span>];</div><div class="line"><span class="keyword">const</span> country = splitLocale[<span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="comment">// Clean</span></div><div class="line"><span class="keyword">const</span> [language, country] = locale.split(<span class="string">'-'</span>);</div></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘å¸Œæœ›æˆ‘è®©ä½ çœ‹åˆ°ç¼–å†™ç®€æ´ä»£ç çš„å¥½å¤„ï¼Œå¹¶å¯ä»¥åº”ç”¨è¿™é‡Œå‘ˆç°çš„å®é™…ä¾‹å­ã€‚ä¸€æ—¦ä½ æ‹¥æŠ±ç®€æ´ä»£ç ï¼Œå®ƒå°†æˆä¸ºä½ çš„ç¬¬äºŒå¤©æ€§ã€‚ä½ å’Œæœªæ¥çš„ä½ å°†ä¼šæ„Ÿæ¿€â€œå†™ä¸‹å®ƒï¼Œå¿˜äº†å®ƒâ€çš„ç”Ÿæ´»æ–¹å¼ã€‚</p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç &quot;&gt;&lt;a href=&quot;#ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç &quot; class=&quot;headerlink&quot; title=&quot;ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç &quot;&gt;&lt;/a&gt;ç®€æ´ä»£ç ä¸å†—ä½™ä»£ç &lt;/h1&gt;&lt;p&gt;è¿™ç¯‡æ–‡ç« å°†é‡ç‚¹ä»‹ç»é€‚ç”¨äºç°ä»£ react è½¯ä»¶å¼€å‘çš„ç®€æ´ä»£ç ä¹‹é“ã€‚æˆ‘è¿˜ä¼šè°ˆè°ˆ ES6/ES2015 å¸¦æ¥çš„ä¸€äº›â€œè¯­æ³•ç³–â€ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="react" scheme="http://robin-front.github.io/tags/react/"/>
    
      <category term="best practices" scheme="http://robin-front.github.io/tags/best-practices/"/>
    
  </entry>
  
  <entry>
    <title>Dynamic import() ä¸ é™æ€ import ç›¸æ¯”è¾ƒï¼Œæœ‰å“ªäº›ä¸åŒ</title>
    <link href="http://robin-front.github.io/2017/11/27/dynamic-import/"/>
    <id>http://robin-front.github.io/2017/11/27/dynamic-import/</id>
    <published>2017-11-27T02:56:29.000Z</published>
    <updated>2017-11-27T02:56:29.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Dynamic-import-æœ‰å“ªäº›ç‰¹ç‚¹"><a href="#Dynamic-import-æœ‰å“ªäº›ç‰¹ç‚¹" class="headerlink" title="Dynamic import() æœ‰å“ªäº›ç‰¹ç‚¹"></a>Dynamic import() æœ‰å“ªäº›ç‰¹ç‚¹</h1><blockquote><p>Dynamic <strong>import()</strong> å·²è¢« Chrome 63 å’Œ Safari Technology Preview 24 æ”¯æŒã€‚</p></blockquote><p><a href="https://github.com/tc39/proposal-dynamic-import" target="_blank" rel="noopener">Dynamic <strong><code>import()</code></strong></a> é‡‡ç”¨ ç±»å‡½æ•° çš„æ–¹æ³•æ¥å¡‘é€  <code>import</code>ï¼Œç›¸æ¯” static <code>import</code> è§£é”äº†æ–°åŠŸèƒ½ã€‚è¿™ç¯‡æ–‡ç« å¯¹æ¯”äº†ä¸¤è€…å¹¶æ¦‚è§ˆæ–°åŠŸèƒ½ã€‚<a id="more"></a></p><h2 id="Static-importï¼ˆæ¦‚æ‹¬ï¼‰"><a href="#Static-importï¼ˆæ¦‚æ‹¬ï¼‰" class="headerlink" title="Static importï¼ˆæ¦‚æ‹¬ï¼‰"></a>Static importï¼ˆæ¦‚æ‹¬ï¼‰</h2><p>ä¹æœˆä»½ï¼ŒChrome 61 å‘å¸ƒå¹¶æ”¯æŒåœ¨ <a href="https://jakearchibald.com/2017/es-modules-in-browsers/" target="_blank" rel="noopener">modules</a> ä¸­ä½¿ç”¨ ES2015 <code>import</code> å£°æ˜ã€‚</p><p>ä»”ç»†çœ‹ä¸‹é¢è¿™ä¸ªæ¨¡å—ï¼Œä½äº <code>./utils.mjs</code>:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Default export</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Hi from the default export!'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// Named export `doStuff`</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> doStuff = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Doing stuffâ€¦'</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä½¿ç”¨ é™æ€ <code>import</code> å¼•å…¥ <code>./utils.mjs</code> æ¨¡å—ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span>&gt;</span><span class="javascript"></span></div><div class="line">  <span class="keyword">import</span> * <span class="keyword">as</span> <span class="built_in">module</span> <span class="keyword">from</span> <span class="string">'./utils.mjs'</span>;</div><div class="line">  <span class="built_in">module</span>.default();</div><div class="line">  <span class="comment">// â†’ logs 'Hi from the default export!'</span></div><div class="line">  <span class="built_in">module</span>.doStuff();</div><div class="line">  <span class="comment">// â†’ logs 'Doing stuffâ€¦'</span></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„ï¼š</strong> ä¸Šé¢è¿™ä¸ªä¾‹å­ä½¿ç”¨ <strong>.mjs</strong> æ¥æ ‡è¯†è¿™æ˜¯ä¸€ä¸ªæ¨¡å—æ–‡ä»¶è€Œä¸æ˜¯æ™®é€šè„šæœ¬ã€‚åœ¨ç½‘é¡µç«¯ï¼Œæ–‡ä»¶æ‰©å±•åå¹¶ä¸æ˜¯é—®é¢˜ï¼Œåªè¦æœåŠ¡ç«¯è®¾ç½®äº†æ­£ç¡®çš„ MIME ç±»å‹ï¼ˆæ¯”å¦‚ç»™ javascript æ–‡ä»¶è®¾ç½® Content-Type:text/javascriptï¼‰åœ¨ HTTP headerã€‚<strong>.mjs</strong> åœ¨å…¶ä»–ä¸€äº›å¹³å°ä¸Šç‰¹åˆ«æœ‰ç”¨ï¼Œå¦‚ Node.js è¿™ç±»æ²¡æœ‰ MIME ç±»å‹æˆ–å…¶ä»– Hooks å¦‚ <strong>type=â€moduleâ€</strong> æ¥ç¡®å®šæ¨¡å—æˆ–æ™®é€šè„šæœ¬ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ç›¸åŒçš„æ‰©å±•åæ¥ä¿æŒè·¨å¹³å°çš„ä¸€è‡´æ€§ï¼Œå¹¶æ¸…æ¥šåœ°åŒºåˆ†æ¨¡å—å’Œæ™®é€šè„šæœ¬ã€‚</p></blockquote><p>è¿™ä¸ªå¯¼å…¥æ¨¡å—çš„è¯­æ³•å½¢å¼æ˜¯ <strong>é™æ€</strong> å£°æ˜ï¼šå®ƒåªæ¥å—å­—ç¬¦ä¸²ä½œä¸ºæ¨¡å—æ ‡è¯†ç¬¦ï¼Œå¹¶é€šè¿‡è¿è¡Œå‰çš„ â€œlinkingâ€ è¿‡ç¨‹å°†æ¨¡å—ç»‘å®šåˆ°æœ¬åœ°ä½œç”¨åŸŸã€‚é™æ€ <code>import</code> è¯­æ³•åªèƒ½ç”¨äºæ–‡ä»¶é¡¶éƒ¨ã€‚é™æ€<code>import</code> æ”¯æŒä¸€äº›é‡è¦çš„ç”¨ä¾‹ï¼Œå¦‚ï¼š<code>static analysis</code>, <code>bundling tools</code>, å’Œ <code>tree-shaking</code>ã€‚</p><p>åœ¨ä¸€äº›æ¡ˆä¾‹ä¸­ï¼Œä¸‹é¢è¿™äº›ç‰¹æ€§ä¼šéå¸¸æœ‰ç”¨ï¼š</p><ul><li>è¯·æ±‚æ—¶å¯¼å…¥æ¨¡å—ï¼ˆæˆ–æœ‰æ¡ä»¶åœ°ï¼‰</li><li>è¿è¡Œæ—¶è®¡ç®—æ¨¡å—æ ‡è¯†ç¬¦</li><li>åœ¨æ™®é€šè„šæœ¬ä¸­å¯¼å…¥æ¨¡å—ï¼ˆè€Œä¸æ˜¯åœ¨æ¨¡å—ä¸­å¯¼å…¥ï¼‰</li></ul><p>ä½†æ˜¯è¿™äº›ç”¨ é™æ€ <code>import</code> éƒ½æ— æ³•åšåˆ°ã€‚</p><h2 id="Dynamic-import-ğŸ”¥"><a href="#Dynamic-import-ğŸ”¥" class="headerlink" title="Dynamic import() ğŸ”¥"></a>Dynamic import() ğŸ”¥</h2><p><a href="https://github.com/tc39/proposal-dynamic-import" target="_blank" rel="noopener">Dynamic <strong><code>import()</code></strong></a> é‡‡ç”¨ ç±»å‡½æ•° çš„æ–¹æ³•æ¥å¡‘é€ æ»¡è¶³è¿™äº›ç”¨ä¾‹çš„ <code>import</code>ã€‚<code>import(moduleSpecifier)</code> ä¸ºè¯·æ±‚æ¨¡å—çš„æ¨¡å—åç§°ç©ºé—´è¿”å›ä¸€ä¸ª promiseã€‚å®ƒæ˜¯åœ¨è·å–ï¼Œå®ä¾‹åŒ–å’Œè¯„ä¼°æ¨¡å—çš„æ‰€æœ‰ä¾èµ–å…³ç³»ä¹‹ååˆ›å»ºçš„ï¼Œæ¨¡å—æœ¬èº«ä¹Ÿæ˜¯ã€‚</p><p>ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ åŠ¨æ€ importï¼Œå¹¶ä½¿ç”¨ <code>./utils.mjs</code> æ¨¡å—ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span>&gt;</span><span class="javascript"></span></div><div class="line">  <span class="keyword">const</span> moduleSpecifier = <span class="string">'./utils.mjs'</span>;</div><div class="line">  <span class="keyword">import</span>(moduleSpecifier)</div><div class="line">    .then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">      <span class="built_in">module</span>.default();</div><div class="line">      <span class="comment">// â†’ logs 'Hi from the default export!'</span></div><div class="line">      <span class="built_in">module</span>.doStuff();</div><div class="line">      <span class="comment">// â†’ logs 'Doing stuffâ€¦'</span></div><div class="line">    &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„ï¼š</strong> å°½ç®¡ <strong>import()</strong> çœ‹èµ·æ¥åƒä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œä½†å®ƒåªæ˜¯æ°å¥½è¢«è§„å®šä¸ºä½¿ç”¨æ‹¬å·çš„ä¸€ç§ <em>è¯­æ³•</em> ï¼ˆç±»ä¼¼äº <strong>super()</strong>ï¼‰ã€‚è¿™æ„å‘³ç€ <strong>import</strong> ä¸ä¼šç»§æ‰¿ <strong>Function.prototype</strong> ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ <strong>call</strong> å’Œ <strong>apply</strong>ã€‚åƒ <strong>const importAlias = import</strong> è¿™æ ·çš„ä»£ç ä¹Ÿä¸èƒ½è¿è¡Œ â€”â€” <strong>import</strong> ç”šè‡³ä¸æ˜¯ä¸€ä¸ª object å¯¹è±¡ï¼ä½†æ˜¯è¿™åœ¨å®è·µä¸­å¹¶ä¸é‡è¦ã€‚</p></blockquote><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ä¸€ä¸ªå°å‹å•é¡µåº”ç”¨çš„å¯¼èˆªä¸Šä½¿ç”¨ åŠ¨æ€ <code>import()</code> å¯ç”¨æ‡’åŠ è½½æ¨¡å—ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>My library<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">nav</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"books.html"</span> <span class="attr">data-entry-module</span>=<span class="string">"books"</span>&gt;</span>Books<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"movies.html"</span> <span class="attr">data-entry-module</span>=<span class="string">"movies"</span>&gt;</span>Movies<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"video-games.html"</span> <span class="attr">data-entry-module</span>=<span class="string">"video-games"</span>&gt;</span>Video Games<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">main</span>&gt;</span>This is a placeholder for the content that will be loaded on-demand.<span class="tag">&lt;/<span class="name">main</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">  <span class="keyword">const</span> main = <span class="built_in">document</span>.querySelector(<span class="string">'main'</span>);</div><div class="line">  <span class="keyword">const</span> links = <span class="built_in">document</span>.querySelectorAll(<span class="string">'nav &gt; a'</span>);</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> link <span class="keyword">of</span> links) &#123;</div><div class="line">    link.addEventListener(<span class="string">'click'</span>, <span class="keyword">async</span> (event) =&gt; &#123;</div><div class="line">      event.preventDefault();</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">const</span> <span class="built_in">module</span> = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">`/<span class="subst">$&#123;link.dataset.entryModule&#125;</span>.mjs`</span>);</div><div class="line">        <span class="comment">// The module exports a function named `loadPageInto`.</span></div><div class="line">        <span class="built_in">module</span>.loadPageInto(main);</div><div class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</div><div class="line">        main.textContent = error.message;</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure><p>å½“æ­£ç¡®ä½¿ç”¨ åŠ¨æ€ <code>import()</code> å¼€å¯æ‡’åŠ è½½åŠŸèƒ½æ—¶å°†ä¼šéå¸¸å¼ºå¤§ã€‚ä¸ºäº†æ¼”ç¤ºç›®çš„ï¼Œ<a href="https://twitter.com/addyosmani" target="_blank" rel="noopener">Addy</a> ä¿®æ”¹äº†ä¸€ä¸ª <a href="https://hnpwa-vanilla.firebaseapp.com/" target="_blank" rel="noopener">Hacker News PWA</a> ç¤ºä¾‹ï¼Œåœ¨é¦–æ¬¡åŠ è½½æ—¶é™æ€åœ°å¯¼å…¥æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…æ‹¬è¯„è®ºã€‚<a href="https://dynamic-import.firebaseapp.com/" target="_blank" rel="noopener">å‡çº§ç‰ˆ</a> ä½¿ç”¨ åŠ¨æ€ <code>import()</code>å»¶è¿ŸåŠ è½½è¯„è®ºï¼Œé¿å…åŠ è½½ï¼Œè§£æå’Œç¼–è¯‘æˆæœ¬ï¼Œç›´åˆ°ç”¨æˆ·ç¡®å®éœ€è¦å®ƒä»¬ã€‚</p><h2 id="å»ºè®®"><a href="#å»ºè®®" class="headerlink" title="å»ºè®®"></a>å»ºè®®</h2><p>é™æ€ <code>import</code> å’ŒåŠ¨æ€ <code>import()</code> éƒ½å¾ˆæœ‰ç”¨ã€‚å®ƒä»¬éƒ½æœ‰å„è‡ªçš„ç‰¹ç‚¹å’Œä½¿ç”¨åœºæ™¯ã€‚ä½¿ç”¨é™æ€ <code>import</code> æ¥åˆå§‹ç»˜åˆ¶ä¾èµ–å…³ç³»ï¼Œå°¤å…¶æ˜¯é¦–å±å†…å®¹ã€‚å¦ä¸€ç§æƒ…å†µï¼Œè€ƒè™‘åˆ°æŒ‰éœ€åŠ è½½åˆ™ä½¿ç”¨åŠ¨æ€ <code>import()</code>ã€‚</p><blockquote><p>è¯‘è€…æ³¨ï¼š static import æ˜¯æ²¡æœ‰æ‹¬å·çš„ï¼Œdynamic import() æ˜¯å¸¦æ‹¬å·çš„ã€‚ä¸æ³¨æ„çš„å¯èƒ½ä¼šæ··æ·†ã€‚ç”¨æ³•çš„åŒºåˆ«ï¼š</p><ul><li>static import: <code>import $ from &#39;jquery&#39;</code> æœ‰å£°æ˜æå‡ï¼Œä¸€èˆ¬åªæ”¾åœ¨å¤´éƒ¨ä½ç½®</li><li>dynamic import(): <code>const $ = import(&#39;jquery&#39;)</code> å¯ä»¥æ”¾åœ¨ä»»ä½•ä½ç½®</li></ul></blockquote><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Dynamic-import-æœ‰å“ªäº›ç‰¹ç‚¹&quot;&gt;&lt;a href=&quot;#Dynamic-import-æœ‰å“ªäº›ç‰¹ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;Dynamic import() æœ‰å“ªäº›ç‰¹ç‚¹&quot;&gt;&lt;/a&gt;Dynamic import() æœ‰å“ªäº›ç‰¹ç‚¹&lt;/h1&gt;&lt;blockquote&gt;&lt;p&gt;Dynamic &lt;strong&gt;import()&lt;/strong&gt; å·²è¢« Chrome 63 å’Œ Safari Technology Preview 24 æ”¯æŒã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/tc39/proposal-dynamic-import&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Dynamic &lt;strong&gt;&lt;code&gt;import()&lt;/code&gt;&lt;/strong&gt;&lt;/a&gt; é‡‡ç”¨ ç±»å‡½æ•° çš„æ–¹æ³•æ¥å¡‘é€  &lt;code&gt;import&lt;/code&gt;ï¼Œç›¸æ¯” static &lt;code&gt;import&lt;/code&gt; è§£é”äº†æ–°åŠŸèƒ½ã€‚è¿™ç¯‡æ–‡ç« å¯¹æ¯”äº†ä¸¤è€…å¹¶æ¦‚è§ˆæ–°åŠŸèƒ½ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="dynamic import" scheme="http://robin-front.github.io/tags/dynamic-import/"/>
    
      <category term="es6" scheme="http://robin-front.github.io/tags/es6/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ react 16 portal åšä¸€äº›å¾ˆé…·çš„äº‹æƒ…</title>
    <link href="http://robin-front.github.io/2017/11/16/using-a-react-16-portal-to-do-something-cool/"/>
    <id>http://robin-front.github.io/2017/11/16/using-a-react-16-portal-to-do-something-cool/</id>
    <published>2017-11-15T23:31:59.000Z</published>
    <updated>2017-11-15T23:31:59.000Z</updated>
    
    <content type="html"><![CDATA[<p>React 16 å·²ç»å‘å¸ƒäº†ï¼Œå…¶ä¸­ä¸€ä¸ªå¾ˆæœ‰è¶£çš„æ˜¯æ·»åŠ äº† â€œPortalsâ€ã€‚</p><p>Portals å¯ä»¥è®©ä½ åœ¨çˆ¶ç»„ä»¶å¤–æ¸²æŸ“ react å—æ§ DOM èŠ‚ç‚¹ã€‚<a href="https://reactjs.org/docs/portals.html" target="_blank" rel="noopener">react doc</a> ä¹Ÿä½¿ç”¨äº†ä¸€ä¸ªæ¨¡æ€æ¡†çš„ä¾‹å­å¾ˆå¥½åœ°è§£é‡Šäº†å®ƒã€‚ç”¨ä¹Ÿåš tooltips ä¹Ÿå¾ˆåˆé€‚ï¼ˆè¿™æ˜¯æˆ‘<a href="https://codepen.io/davidgilbertson/pen/ooXVyw" target="_blank" rel="noopener">æ—©å‰åšçš„ä¸€ä¸ªä¾‹å­</a>ï¼‰ã€‚</p><p>ä½†è¿™äº›éƒ½å¹¶ä¸æ˜¯å¾ˆæœ‰è¶£ï¼Œè®©æˆ‘ä»¬åšä¸€äº›æ›´ä¸å¯æ€è®®çš„äº‹æƒ…â€¦<a id="more"></a></p><p>å› ä¸ºæ‰€æœ‰ portal åšçš„ï¼Œéƒ½æ˜¯å°†ä¸€ä¸ªå…ƒç´ æ”¾åˆ°å…¶ä»–å…ƒç´ ä¸Šï¼Œä½ å¹¶æ²¡æœ‰è¢«é™åˆ¶æ”¾åœ¨ <em>å½“å‰</em> document çš„ä»»ä½•åœ°æ–¹ã€‚ä½ å¯ä»¥æ·»åŠ åˆ°å¦ä¸€ä¸ª document çš„ body ä¸­ï¼Œå¯èƒ½æ˜¯å®Œå…¨ä¸åŒæµè§ˆå™¨çª—å£çš„ä¸€ä¸ª documentã€‚</p><p>ä¸‹é¢æˆ‘æœ‰ä¸€ä¸ªåŸºæœ¬çš„é¡µé¢ï¼ˆå·¦è¾¹ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ªè®¡æ•°å™¨åŠæ·±çº¢è‰²æŒ‰é’®ã€‚å¦ä¸€ä¸ªçª—å£ï¼ˆå³è¾¹ï¼‰åŒæ ·æ˜¯ react app çš„ä¸€éƒ¨åˆ†ã€‚</p><p>å³è¾¹çš„çª—å£æ˜¯å±äº <em>åŒä¸€ä¸ª React app</em> è¿™ä¸ªäº‹å®åº”è¯¥è®©ä½ æ„Ÿåˆ°æƒŠè®¶ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/2000/1*ogsV-9IGNtaVjne2fb_oEA.png" data-original="https://cdn-images-1.medium.com/max/2000/1*ogsV-9IGNtaVjne2fb_oEA.png"></p><p>ä¸Šé¢å›¾ç‰‡ä¸­èƒ½çœ‹åˆ°çš„æ‰€æœ‰ä¸œè¥¿ï¼ˆé™¤äº†æ ‘ï¼‰éƒ½æ˜¯åœ¨ä¸‹é¢ä»£ç å±•ç¤ºçš„åŒä¸€ä¸ªç»„ä»¶ä¸­ï¼š</p><script src="https://gist.github.com/davidgilbertson/69a8c158ca9b5e202d083408dbabdf49.js"></script><p>ä½ å·²ç»æˆåŠŸäº†ï¼Œ<code>&lt;MyWindowPortal&gt;</code> æœ‰ä¸€ç‚¹ç‰¹æ®Šï¼Œé‡Œé¢çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè¢«æ¸²æŸ“åˆ°å¦ä¸€ä¸ª window ä¸‹ã€‚</p><p>å°¤å…¶æ˜¯ï¼Œ<code>&lt;MyWindowPortal&gt;</code> åšäº†ä¸¤ä»¶äº‹ã€‚</p><ul><li>1ã€ å½“ç»„ä»¶æ¸²æŸ“æ—¶æ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨çª—å£ã€‚</li><li>2ã€ åˆ›å»ºä¸€ä¸ª <code>portal</code> å¹¶å°† <code>props.children</code> æ·»åŠ åˆ°æ–°çª—å£çš„ bodyã€‚</li></ul><p>è¿™ä¸æ˜¯æœ€é…·çš„äº‹æƒ…å—ï¼Ÿ</p><p>æˆ‘æ˜¯å¤šä¹ˆå…´å¥‹ï¼Œå¿…é¡»å¾—å†·é™ä¸€ä¸‹ã€‚</p><p>â€¦</p><p>I saw a duck!</p><p>â€¦</p><p>ä¸Šé¢æåˆ°çš„ bodyä¸­çš„ç»„ä»¶å°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚ React 16 æ–°å¢çš„éƒ¨åˆ† <code>ReactDOM.createPortal</code> åœ¨ 11 è¡Œ â€”â€” é‚£å°±æ˜¯é»‘é­”æ³•ã€‚</p><script src="https://gist.github.com/davidgilbertson/de5e5b84373ee60d91525ab37278913e.js"></script><p>é‚£æœ‰æ„ä¹‰å—ï¼Ÿç»„ä»¶å¹¶æ²¡æœ‰è¿”å›ä»€ä¹ˆï¼Œåªæ˜¯åšäº†ä¸€äº›å…¶ä»–äº‹æƒ…ã€‚</p><p>æ¢ä¸€ä¸ªè§’åº¦æ¥æƒ³å¯èƒ½æ˜¯è¿™æ ·çš„ï¼šæŒ‰ç†æ¥è¯´ï¼Œä¸€ä¸ªçˆ¶ç»„ä»¶å¯¹å­ç»„ä»¶è¯´ï¼šâ€œå˜¿ï¼Œæ¸²æŸ“ DOMï¼Œ ç„¶åæŠŠç»“æœæ·»åŠ åˆ°æˆ‘è¿™é‡Œã€‚â€ï¼Œç„¶åå­ç»„ä»¶ç…§åšäº†ã€‚ä½†æ˜¯è¿™æ¬¡ï¼Œä»»æ€§çš„å­ç»„ä»¶è¯´ï¼Œâ€œä¸ï¼æˆ‘è¦å°†ä¸œä¸œæ¸²æŸ“åˆ°å¦ä¸€ä¸ªçª—å£ï¼Œç„¶åå†™ä¸€ç¯‡å…³äºå®ƒçš„åšå®¢ã€‚â€</p><p>ç°åœ¨ï¼Œæˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆã€‚</p><p>ä½ æœ‰ç‚¹æ¸´ï¼Œå¹¶ä¸”æƒ³çŸ¥é“ä½ æ˜¯å¦è¯¥å–ç‚¹æ°´äº†ã€‚æ˜¯çš„ï¼Œå»å§ã€‚</p><p>å¦ä¸€ä»¶ä½ å¯èƒ½åœ¨æƒ³çš„äº‹æƒ…æ˜¯ï¼šå°†ä¸€äº› DOM æ³¨å…¥åˆ°æ— æ ·å¼çš„ç©ºç™½çª—å£æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå¯èƒ½ Craigslist æˆ– Wikipedia ä¹Ÿä¸çŸ¥é“ã€‚ä½†ä½ çš„ç½‘ç«™å¾ˆç¾ï¼Œä»»ä½•æ—¶å€™éƒ½ä¸èƒ½å¼¹å‡ºå°çª—å£ã€‚</p><p>å¥½å§ï¼Œå¥½æ¶ˆæ¯æ¥äº†ï¼Œå¤§å®¶æ³¨æ„äº†ï¼</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1000/1*eU-7ArIucnG5OreaPIJlEg.png" data-original="https://cdn-images-1.medium.com/max/1000/1*eU-7ArIucnG5OreaPIJlEg.png"></p><p>èµ·åˆï¼Œæˆ‘è¿˜åœ¨æƒ³æ˜¯å¦æœ‰ä¸€ä¸ªç®€å•çš„æ–¹å¼å°†æ ·å¼å¤åˆ¶åˆ°æ–°çª—å£ã€‚ç„¶åæˆ‘æƒ³èµ·æˆ‘çš„ç”Ÿæ´»åªæ˜¯è¢«ä¸€äº›æ¯«æ— æ„ä¹‰çš„äº‹ä»¶å¡«å……ï¼Œå®ƒä»¬å”¯ä¸€çš„ç›®çš„åªæ˜¯è®©æˆ‘åˆ†å¿ƒï¼Œé˜»æ­¢æˆ‘å†…å¿ƒçš„ç©ºè™šå¯‚å¯å†·ã€‚</p><p>æ‰€ä»¥äº²è‡ªå†™è¿™ä¸ªå‡½æ•°å°±æ˜¯ä¹è¶£ï¼</p><p>çœ‹ä¸‹é¢ï¼š</p><script src="https://gist.github.com/davidgilbertson/ed3c8bb8569bc64b094b87aa88bed5fa.js"></script><p>äº‹å®ä¸Šï¼Œæˆ‘å¹¶ä¸æ˜¯å¾ˆäº†è§£ <code>styleSheet</code>ã€‚æˆ‘æœŸå¾…ä»è¯„è®ºä¸­å¾—çŸ¥æœ‰ä»€ä¹ˆå¥‡æŠ€æ·«å·§ã€‚</p><p>ç°åœ¨æˆ‘å¯ä»¥åœ¨æ‰“å¼€æ–°çª—å£çš„æ—¶å€™å¾ˆç®€å•åœ°å¤åˆ¶æ ·å¼ï¼Œåƒè¿™æ ·ï¼š</p><script src="https://gist.github.com/davidgilbertson/4937ac726094735ab44e295f3113df53.js"></script><iframe height="265" scrolling="no" title="React Portal Chat Window" src="//codepen.io/davidgilbertson/embed/xPVMqp/?height=265&theme-id=0&default-tab=js,result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen style="width:100%">See the Pen <a href="https://codepen.io/davidgilbertson/pen/xPVMqp/" target="_blank" rel="noopener">React Portal Chat Window</a> by David Gilbertson (<a href="https://codepen.io/davidgilbertson" target="_blank" rel="noopener">@davidgilbertson</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><p>æˆ‘ä¸è®¤ä¸ºè¿™èƒ½åœ¨ Medium app çš„ iOS/Android å¹³å°ä¸Šè¿è¡Œï¼Œæ‰€ä»¥è¯·åœ¨æµè§ˆå™¨æ‰“å¼€ã€‚</p><p>å¥½äº†ï¼Œæˆ‘è®¤ä¸ºè¿™ç¯‡æ–‡ç« è¯¥ç»“æŸäº†ã€‚</p><p>Bye!</p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;React 16 å·²ç»å‘å¸ƒäº†ï¼Œå…¶ä¸­ä¸€ä¸ªå¾ˆæœ‰è¶£çš„æ˜¯æ·»åŠ äº† â€œPortalsâ€ã€‚&lt;/p&gt;&lt;p&gt;Portals å¯ä»¥è®©ä½ åœ¨çˆ¶ç»„ä»¶å¤–æ¸²æŸ“ react å—æ§ DOM èŠ‚ç‚¹ã€‚&lt;a href=&quot;https://reactjs.org/docs/portals.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;react doc&lt;/a&gt; ä¹Ÿä½¿ç”¨äº†ä¸€ä¸ªæ¨¡æ€æ¡†çš„ä¾‹å­å¾ˆå¥½åœ°è§£é‡Šäº†å®ƒã€‚ç”¨ä¹Ÿåš tooltips ä¹Ÿå¾ˆåˆé€‚ï¼ˆè¿™æ˜¯æˆ‘&lt;a href=&quot;https://codepen.io/davidgilbertson/pen/ooXVyw&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ—©å‰åšçš„ä¸€ä¸ªä¾‹å­&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;ä½†è¿™äº›éƒ½å¹¶ä¸æ˜¯å¾ˆæœ‰è¶£ï¼Œè®©æˆ‘ä»¬åšä¸€äº›æ›´ä¸å¯æ€è®®çš„äº‹æƒ…â€¦
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="react" scheme="http://robin-front.github.io/tags/react/"/>
    
      <category term="portal" scheme="http://robin-front.github.io/tags/portal/"/>
    
  </entry>
  
  <entry>
    <title>react ç»„ä»¶è®¾è®¡æ¨¡å¼</title>
    <link href="http://robin-front.github.io/2017/11/09/react-component-patterns/"/>
    <id>http://robin-front.github.io/2017/11/09/react-component-patterns/</id>
    <published>2017-11-09T15:10:26.000Z</published>
    <updated>2017-11-09T15:10:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="react-component-æ¨¡å¼"><a href="#react-component-æ¨¡å¼" class="headerlink" title="react component æ¨¡å¼"></a>react component æ¨¡å¼</h1><blockquote><p>æœ‰çŠ¶æ€ç»„ä»¶ï¼ˆStatefulï¼‰å’Œæ— çŠ¶æ€ç»„ä»¶ï¼ˆStatelessï¼‰ã€å®¹å™¨ç»„ä»¶ï¼ˆContainerï¼‰ä¸å±•ç¤ºç»„ä»¶ï¼ˆPresentationalï¼‰ã€é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ã€æ¸²æŸ“å›è°ƒï¼ˆRender Callbacksï¼‰ç­‰</p></blockquote><p>æˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨ React æœ‰ä¸€æ®µæ—¶é—´äº†â€”â€”ä¸€ä¸ª facebook ä½¿ç”¨ js æ¸²æŸ“ç”¨æˆ·ç•Œé¢çš„æ¡†æ¶â€”â€”åˆšå¼€å§‹çš„æ—¶å€™æˆ‘æƒ³çŸ¥é“ä¸€äº›æ¦‚å¿µã€‚è¿™äº›æ–‡å­—æ˜¯å°è¯•æ€»ç»“æˆ‘å®è·µè¿™ä¹ˆä¹…ä»¥æ¥å­¦åˆ°çš„ä¸€äº›æ¨¡å¼â€”â€”å¯èƒ½å¯¹äºåˆšå¼€å§‹è¿›å…¥ç»„ä»¶ä¸–ç•Œçš„å¼€å‘è€…æœ‰ç”¨ã€‚<a id="more"></a></p><h2 id="æœ‰çŠ¶æ€-Stateful-ä¸-æ— çŠ¶æ€-Stateless-ç»„ä»¶"><a href="#æœ‰çŠ¶æ€-Stateful-ä¸-æ— çŠ¶æ€-Stateless-ç»„ä»¶" class="headerlink" title="æœ‰çŠ¶æ€(Stateful) ä¸ æ— çŠ¶æ€(Stateless) ç»„ä»¶"></a>æœ‰çŠ¶æ€(Stateful) ä¸ æ— çŠ¶æ€(Stateless) ç»„ä»¶</h2><p>å°±åƒæœ‰çŠ¶æ€å’Œæ— çŠ¶æ€çš„ web æœåŠ¡ä¸€æ ·ï¼Œ React ç»„ä»¶ä¹Ÿèƒ½åœ¨ç”¨æˆ·ä½¿ç”¨æ—¶ä¿å­˜å’Œæ“ä½œçŠ¶æ€ï¼ˆæœ‰çŠ¶æ€ï¼‰ã€‚æˆ–åªæ˜¯ä¸€ä¸ªç®€å•çš„ç»„ä»¶ï¼ŒæŒ‰å— props å¹¶è¿”å›éœ€è¦æ˜¾ç¤ºçš„å†…å®¹ï¼ˆæ— çŠ¶æ€ï¼‰ã€‚</p><p>ä¸€ä¸ªç®€å•çš„ <em>æ— çŠ¶æ€</em> æŒ‰é’®ç»„ä»¶åªæ¥å— props:</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*fgZOSwpdU7MMNxltRcXAcQ.png" data-original="https://cdn-images-1.medium.com/max/1600/1*fgZOSwpdU7MMNxltRcXAcQ.png"></p><p>è€Œä¸‹é¢æ˜¯ä¸€ä¸ª <strong>æœ‰çŠ¶æ€</strong> çš„è®¡æ•°ç»„ä»¶ï¼ˆä½¿ç”¨äº† <code>Button</code> ç»„ä»¶ï¼‰ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*TYPgsZUZMoo7lW7xv4gxYw.png" data-original="https://cdn-images-1.medium.com/max/1600/1*TYPgsZUZMoo7lW7xv4gxYw.png"></p><p>å°±åƒä½ æ‰€çœ‹åˆ°çš„ï¼Œæœ€åä¸€ä¸ªç»„ä»¶çš„ constructor ä¿æŒäº†ä¸€ä¸ªç»„ä»¶çš„ state, è€Œç¬¬ä¸€ä¸ªç»„ä»¶åˆ™æ˜¯ä¸€ä¸ªç®€å•ç»„ä»¶ï¼Œåªé€šè¿‡ props æ¸²æŸ“äº†æ–‡å­—ã€‚è¿™ä¸ªå…³æ³¨åˆ†ç¦»å¯èƒ½éå¸¸ç®€å•ï¼Œä½†æ˜¯è®© <code>Button</code> ç»„ä»¶é«˜åº¦å¤ç”¨ã€‚</p><h2 id="å®¹å™¨-Container-ä¸-å±•ç¤º-Presentational-ç»„ä»¶"><a href="#å®¹å™¨-Container-ä¸-å±•ç¤º-Presentational-ç»„ä»¶" class="headerlink" title="å®¹å™¨(Container) ä¸ å±•ç¤º(Presentational) ç»„ä»¶"></a>å®¹å™¨(Container) ä¸ å±•ç¤º(Presentational) ç»„ä»¶</h2><p>å½“ä½¿ç”¨å¤–éƒ¨æ•°æ®è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªç»„ä»¶åˆ†æˆè¿™ä¸¤ä¸ªæ–°ç±»åˆ«ã€‚<strong>å®¹å™¨ç»„ä»¶</strong> è´Ÿè´£è·å–æ•°æ®ï¼Œå­˜åœ¨åœ¨ react ä½œç”¨åŸŸå¤–éƒ¨ï¼Œå°±åƒè¿æ¥ <em>Redux</em> æˆ– <em>Relay</em> â€”â€”â€”â€” è€Œ <strong>å±•ç¤ºç»„ä»¶</strong> åˆ™ä¸ä¾èµ– react åº”ç”¨çš„å…¶ä»–éƒ¨åˆ†ï¼Œä»…ä»…å–å†³äºå®ƒè‡ªèº«çš„ state å’Œæ¥æ”¶çš„ propsã€‚è®©æˆ‘ä»¬æ‹¿ç”¨æˆ·åˆ—è¡¨ä½œä¸ºå±•ç¤ºç»„ä»¶çš„ä¾‹å­ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*wbih6jbxJiIgNOXgRpcROA.png" data-original="https://cdn-images-1.medium.com/max/1600/1*wbih6jbxJiIgNOXgRpcROA.png"></p><p>è¿™ä¸ªåˆ—è¡¨å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ <strong>å®¹å™¨ç»„ä»¶</strong> æ›´æ–°ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*TJxCVhawM2e99dZsxu11oA.png" data-original="https://cdn-images-1.medium.com/max/1600/1*TJxCVhawM2e99dZsxu11oA.png"></p><p>è¿™ç§æ–¹æ³•å°†æ•°æ®è·å–ä¸æ¸²æŸ“åˆ†ç¦»ï¼ŒåŒæ—¶è®© <code>UserList</code> é«˜åº¦å¤ç”¨ã€‚å¦‚æœä½ æƒ³è¿›ä¸€æ­¥å­¦ä¹ è¿™ç§æ¨¡å¼ï¼Œè¿™é‡Œæœ‰<a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" target="_blank" rel="noopener">ä¸€ç¯‡æ–‡ç« </a>è§£é‡Šåœ°å¾ˆå¥½ã€‚</p><h2 id="é«˜é˜¶ç»„ä»¶"><a href="#é«˜é˜¶ç»„ä»¶" class="headerlink" title="é«˜é˜¶ç»„ä»¶"></a>é«˜é˜¶ç»„ä»¶</h2><p>é«˜é˜¶ç»„ä»¶â€”â€”â€”â€”æˆ–å« HOCã€‚å½“ä½ æƒ³è¦é‡ç”¨é€»è¾‘çš„æ—¶å€™éå¸¸æ„Ÿå…´è¶£ã€‚ä»–ä»¬æ˜¯ javascript å‡½æ•°ï¼Œå°†ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›æ–°ç»„ä»¶ã€‚</p><p>å‡è®¾ä½ éœ€è¦åšä¸€ä¸ªå¯ä¼¸ç¼©çš„çš„èœå•ç»„ä»¶ï¼Œå½“ç”¨æˆ·ç‚¹çš„æ—¶å€™ï¼Œå±•ç¤ºå®ƒé‡Œé¢çš„å†…å®¹ã€‚æ‰€ä»¥ï¼Œä¸ºäº†æ›¿ä»£åœ¨çˆ¶çº§ç»„ä»¶ä¸Šæ§åˆ¶ stateï¼Œä½ å¯ä»¥ç®€å•åœ°åˆ›å»ºä¸€ä¸ªé€šç”¨çš„ <strong>é«˜é˜¶ç»„ä»¶</strong> æ¥å¤„ç†å®ƒï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*qchJXtrHlR46phKFDDJeeQ.png" data-original="https://cdn-images-1.medium.com/max/1600/1*qchJXtrHlR46phKFDDJeeQ.png"></p><p>è¿™ç§æ–¹å¼å…è®¸æˆ‘ä»¬å°†é€»è¾‘åº”ç”¨é€šè¿‡è£…é¥°æ¨¡å¼ï¼ˆdecoratorï¼‰åº”ç”¨åœ¨ <code>ToggleableMenu</code> ç»„ä»¶ä¸Šã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*RQuGzKKbT7R9OIDBzhO8gg.png" data-original="https://cdn-images-1.medium.com/max/1600/1*RQuGzKKbT7R9OIDBzhO8gg.png"></p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»»æ„ä¼ é€’å­çº§åˆ° <code>ToggleableMenu</code> ç»„ä»¶äº†ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*rWCZQqL0Rbizbrw_yjgxgA.png" data-original="https://cdn-images-1.medium.com/max/1600/1*rWCZQqL0Rbizbrw_yjgxgA.png"></p><p>å¦‚æœä½ ç†Ÿæ‚‰ä½¿ç”¨ <code>redux</code> çš„ <code>connect</code> æˆ– react router çš„ <code>withRouter</code> å‡½æ•°ï¼Œé‚£ä½ å·²ç»åœ¨ç”¨ <strong>HOCs</strong> äº†ã€‚</p><h2 id="æ¸²æŸ“å›è°ƒï¼ˆRender-Callbacksï¼‰"><a href="#æ¸²æŸ“å›è°ƒï¼ˆRender-Callbacksï¼‰" class="headerlink" title="æ¸²æŸ“å›è°ƒï¼ˆRender Callbacksï¼‰"></a>æ¸²æŸ“å›è°ƒï¼ˆRender Callbacksï¼‰</h2><p>å¦ä¸€ç§è®©ç»„ä»¶é€»è¾‘å¤ç”¨çš„å¾ˆæ£’çš„æ–¹æ³•æ˜¯ å°†ç»„ä»¶å­çº§è½¬æ¢æˆå‡½æ•°ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ <strong>æ¸²æŸ“å›è°ƒï¼ˆRender Callbacksï¼‰</strong> ä¹Ÿå«ä½œ <strong>Function as Child Components</strong>ã€‚æˆ‘ä»¬å¯ä»¥æ‹¿å¯ä¼¸å±•çš„èœå•é«˜é˜¶ç»„ä»¶ä½œä¸ºä¾‹å­ï¼Œå¹¶ä½¿ç”¨ <strong>æ¸²æŸ“å›è°ƒ</strong> é‡å†™å®ƒã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*Ul-ubPnaOFtY4mTeM5PW3A.png" data-original="https://cdn-images-1.medium.com/max/1600/1*Ul-ubPnaOFtY4mTeM5PW3A.png"></p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°ä½œä¸º <code>Toggleable</code> çš„å­ç»„ä»¶ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*cwoZiIT3Gcau5lDwyCQzQw.png" data-original="https://cdn-images-1.medium.com/max/1600/1*cwoZiIT3Gcau5lDwyCQzQw.png"></p><p>ä¸Šé¢çš„ä»£ç å·²ç»ä½¿ç”¨å‡½æ•°ä½œä¸ºå­çº§ï¼Œä½†ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åƒé«˜é˜¶ç»„ä»¶çš„ä¾‹å­é‚£æ ·å¤ç”¨å®ƒï¼ˆå¤šä¸ªèœå•ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ <code>Toggleable</code> é€»è¾‘åˆ›å»ºä¸€ä¸ªæ–°ç»„ä»¶ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*DVfPDwHw_eH9dUeX9w5GEg.png" data-original="https://cdn-images-1.medium.com/max/1600/1*DVfPDwHw_eH9dUeX9w5GEg.png"></p><p>æˆ‘ä»¬çš„æ–°äº§å“ <code>ToggleableMenu</code> ç»„ä»¶å·²ç»å‡†å¤‡å¥½äº†ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*hzpuJMAMTRQZK_vKCK_jhQ.png" data-original="https://cdn-images-1.medium.com/max/1600/1*hzpuJMAMTRQZK_vKCK_jhQ.png"></p><p>è¿™ç§æ–¹å¼çœŸçš„éå¸¸æœ‰ç”¨ï¼Œå½“æˆ‘ä»¬éœ€è¦æ›´æ”¹æ¸²æŸ“å†…å®¹è€Œä¸ç”¨ç®¡ state æ“ä½œæ—¶ï¼šå°±åƒä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¸²æŸ“é€»è¾‘ç§»åŠ¨åˆ° <code>ToggleableMenu</code> çš„å­çº§å‡½æ•°ä¸­ï¼Œä½†å´ä¿æŒæˆ‘ä»¬ <code>Toggleable</code> ç»„ä»¶çš„ state é€»è¾‘ï¼</p><h2 id="è¿›ä¸€æ­¥é˜…è¯»"><a href="#è¿›ä¸€æ­¥é˜…è¯»" class="headerlink" title="è¿›ä¸€æ­¥é˜…è¯»"></a>è¿›ä¸€æ­¥é˜…è¯»</h2><p>ä¸Šé¢çš„ä¾‹å­åªæ˜¯ä¸€äº›å¯ä»¥ç”¨åœ¨ react ç¼–ç¨‹ä¸­çš„åŸºç¡€æ¨¡å¼ï¼Œå¦‚æœä½ çœŸçš„æƒ³æ·±å…¥è¿™ä¸ªä¸»é¢˜ï¼Œæˆ‘å»ºè®®ä½ çœ‹çœ‹è¿™äº›äº†ä¸èµ·çš„æ–‡ç« ï¼š</p><ul><li><a href="https://www.youtube.com/watch?v=YaZg8wg39QQ" target="_blank" rel="noopener">React Component Patterns by Michael Chan</a></li><li><a href="https://github.com/chantastic/reactpatterns.com" target="_blank" rel="noopener">React Patterns</a></li><li><a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" target="_blank" rel="noopener">Presentational and Container Components</a></li><li><a href="https://medium.com/@franleplant/react-higher-order-components-in-depth-cf9032ee6c3e" target="_blank" rel="noopener">React Higher Order Components in depth</a></li><li><a href="https://medium.com/merrickchristensen/function-as-child-components-5f3920a9ace9" target="_blank" rel="noopener">Function as Child Components</a></li><li><a href="https://github.com/acdlite/recompose" target="_blank" rel="noopener">Recompose</a></li><li><a href="https://github.com/paypal/downshift" target="_blank" rel="noopener">Downshift</a></li></ul><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;react-component-æ¨¡å¼&quot;&gt;&lt;a href=&quot;#react-component-æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;react component æ¨¡å¼&quot;&gt;&lt;/a&gt;react component æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;&lt;p&gt;æœ‰çŠ¶æ€ç»„ä»¶ï¼ˆStatefulï¼‰å’Œæ— çŠ¶æ€ç»„ä»¶ï¼ˆStatelessï¼‰ã€å®¹å™¨ç»„ä»¶ï¼ˆContainerï¼‰ä¸å±•ç¤ºç»„ä»¶ï¼ˆPresentationalï¼‰ã€é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ã€æ¸²æŸ“å›è°ƒï¼ˆRender Callbacksï¼‰ç­‰&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;æˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨ React æœ‰ä¸€æ®µæ—¶é—´äº†â€”â€”ä¸€ä¸ª facebook ä½¿ç”¨ js æ¸²æŸ“ç”¨æˆ·ç•Œé¢çš„æ¡†æ¶â€”â€”åˆšå¼€å§‹çš„æ—¶å€™æˆ‘æƒ³çŸ¥é“ä¸€äº›æ¦‚å¿µã€‚è¿™äº›æ–‡å­—æ˜¯å°è¯•æ€»ç»“æˆ‘å®è·µè¿™ä¹ˆä¹…ä»¥æ¥å­¦åˆ°çš„ä¸€äº›æ¨¡å¼â€”â€”å¯èƒ½å¯¹äºåˆšå¼€å§‹è¿›å…¥ç»„ä»¶ä¸–ç•Œçš„å¼€å‘è€…æœ‰ç”¨ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="React" scheme="http://robin-front.github.io/tags/React/"/>
    
      <category term="Components" scheme="http://robin-front.github.io/tags/Components/"/>
    
      <category term="Higher Order ComponentsRender" scheme="http://robin-front.github.io/tags/Higher-Order-ComponentsRender/"/>
    
      <category term="Callback" scheme="http://robin-front.github.io/tags/Callback/"/>
    
      <category term="patterns" scheme="http://robin-front.github.io/tags/patterns/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://robin-front.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>javascript äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼</title>
    <link href="http://robin-front.github.io/2017/11/06/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-async-and-await/"/>
    <id>http://robin-front.github.io/2017/11/06/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-async-and-await/</id>
    <published>2017-11-06T02:40:21.000Z</published>
    <updated>2017-11-06T02:40:21.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="javascript-äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼"><a href="#javascript-äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼" class="headerlink" title="javascript äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼"></a>javascript äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼</h1><p>è¿™æ¬¡æˆ‘ä»¬å°†é€šè¿‡å›é¡¾åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­ç¼–ç¨‹çš„ç¼ºç‚¹æ¥æ‰©å±•å…ˆå‰çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä»¥åŠå¦‚ä½•å…‹æœå®ƒæ¥å»ºç«‹ä¸€ä¸ªä»¤äººæƒŠå¹çš„ javascript UIsã€‚åƒä»¥å¾€ä¸€æ ·ï¼Œåœ¨æ–‡ç« çš„æœ€åï¼Œæˆ‘ä¼šåˆ†äº«ä½¿ç”¨ async/await å†™ç®€æ´ä»£ç çš„ 5 ä¸ªå°è´´å£«ã€‚<a id="more"></a></p><h2 id="ä¸ºä»€ä¹ˆå•çº¿ç¨‹æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå•çº¿ç¨‹æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå•çº¿ç¨‹æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå•çº¿ç¨‹æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Ÿ</h2><p>åœ¨æˆ‘ä»¬æ¨å‡ºçš„<a href="https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf" target="_blank" rel="noopener">ç¬¬ä¸€ç¯‡æ–‡ç« </a>, æˆ‘ä»¬ä»”ç»†æ€è€ƒäº†è¿™ä¸ªé—®é¢˜ï¼Œ<em>å½“æˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ªéå¸¸è€—æ—¶çš„å‡½æ•°æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ</em>ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä¾‹å¦‚æµè§ˆå™¨ä¸­è¿è¡Œç€ä¸€ä¸ªå¤æ‚çš„å›¾åƒå˜æ¢ç®—æ³•ã€‚</p><p>å½“è°ƒç”¨æ ˆæ‰§è¡Œå‡½æ•°æ—¶ï¼Œæµè§ˆå™¨ä¸èƒ½åšä»»ä½•å…¶ä»–äº‹â€”â€”å®ƒè¢«é˜»å¡äº†ã€‚è¿™æ„å‘³ç€æµè§ˆå™¨ä¸èƒ½æ¸²æŸ“ï¼Œä¸èƒ½æ‰§è¡Œå…¶ä»–ä»£ç ï¼Œæš‚æ—¶å¡ä½äº†ã€‚é‚£é—®é¢˜ä¹Ÿæ¥äº†â€”â€”â€”â€”ä½ çš„UIç•Œé¢ä¹Ÿä¸å†é¡ºç•…å’Œé«˜æ•ˆã€‚</p><p>ä½ çš„åº”ç”¨è¢«å¡ä½äº†ã€‚</p><p>å®ƒå¾ˆä¸‘é™‹ï¼Œå®Œå…¨æ¯äº†ä½ çš„ç”¨æˆ·ä½“éªŒï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*MCt4ZC0dMVhJsgo1u6lpYw.jpeg" data-original="https://cdn-images-1.medium.com/max/800/1*MCt4ZC0dMVhJsgo1u6lpYw.jpeg"></p><h2 id="javascript-ç¨‹åºçš„ç»„æˆéƒ¨åˆ†"><a href="#javascript-ç¨‹åºçš„ç»„æˆéƒ¨åˆ†" class="headerlink" title="javascript ç¨‹åºçš„ç»„æˆéƒ¨åˆ†"></a>javascript ç¨‹åºçš„ç»„æˆéƒ¨åˆ†</h2><p>ä½ å¯èƒ½ä¼šæŠŠä½ çš„ javascript åº”ç”¨å†™åœ¨å•ä¸ª <code>.js</code> æ–‡ä»¶é‡Œï¼Œä½†ä½ çš„ç¨‹åºè‚¯å®šåŒ…å«ç€å¥½å‡ å—ï¼Œåªæœ‰å…¶åªä¸€å—æ­£åœ¨æ‰§è¡Œï¼Œå…¶ä»–çš„ä¼šç¨åæ‰§è¡Œã€‚æœ€å¸¸è§çš„å—å°±æ˜¯å‡½æ•°ã€‚</p><p>é—®é¢˜æ˜¯ï¼Œå¤§å¤šæ•°æ–°å¼€å‘è€…ä¼¼ä¹éƒ½è§‰å¾—ï¼Œè¿™ä¸ª <em>ç¨åæ‰§è¡Œ</em> å¹¶ä¸æ˜¯ä¸¥æ ¼åœ°åœ¨ <em>å½“å‰æ‰§è¡Œ</em> ä¹‹åç«‹å³æ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œä»»åŠ¡å½“å‰ä¸èƒ½ç«‹å³å®Œæˆï¼Œé€šè¿‡å®šä¹‰ï¼Œå°†ä¼šå¼‚æ­¥å®Œæˆã€‚æ„å‘³ç€ä¸ä¼šå‡ºç°ä¸Šé¢æ‰€è¯´çš„é˜»å¡è¡Œä¸ºï¼Œå°±åƒä½ æ‰€æœŸæœ›æˆ–å¸Œæœ›å‘ç”Ÿçš„é‚£æ ·ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><script src="https://gist.github.com/zlatkov/7a8b43e4fb8059bc810aa6aa4941148e.js"></script><p>ä½ å¯èƒ½å·²ç»æ„è¯†åˆ°ï¼Œæ ‡å‡†çš„ <code>Ajax</code> äº‹ä»¶ä¸ä¼šåŒæ­¥å®Œæˆã€‚æ„å‘³ç€å½“æ‰§è¡Œä»£ç  <code>ajax(...)</code> çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šç«‹å³è¿”å›å€¼å¹¶èµ‹å€¼ç»™å˜é‡ <code>response</code>ã€‚</p><p>ä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå« å›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰çš„å‡½æ•°å»ç­‰å¾…å¼‚æ­¥å‡½æ•°è¿”å›çš„ç»“æœã€‚</p><script src="https://gist.github.com/zlatkov/cbd87df9ff2922512609a36d4155274a.js"></script><p>æé†’ä¸€ä¸‹ï¼šä½ å®é™…å¯ä»¥å‘èµ·ä¸€ä¸ª <strong>åŒæ­¥</strong> çš„ <code>Ajax</code> è¯·æ±‚ã€‚ä½†æ°¸è¿œä¸è¦è¿™æ ·åšã€‚å¦‚æœä½ å‘é€ä¸€ä¸ªåŒæ­¥ Ajax è¯·æ±‚, ä½  javascript åº”ç”¨çš„ UI å°±ä¼šè¢«é˜»å¡â€”â€”â€”â€”ç”¨æˆ·å°†ä¸èƒ½ç‚¹å‡»ï¼Œè¾“å…¥æ•°æ®ï¼Œå¯¼èˆªæˆ–æ»šåŠ¨ã€‚è¿™ä¼šé˜»ç¢ç”¨æˆ·äº¤äº’ï¼Œéå¸¸ç³Ÿç³•çš„ä½“éªŒã€‚</p><p>å°±åƒä¸‹é¢è¿™æ ·ï¼Œä½†è¯·æ°¸è¿œä¸è¦è¿™æ ·åšï¼Œä¸è¦æ¯äº†ç½‘é¡µï¼š</p><script src="https://gist.github.com/zlatkov/1b834ae5eb037f46347d71d4c497d43c.js"></script><p>æˆ‘ä»¬åªæ˜¯ç”¨ Ajax è¯·æ±‚åšä¸€ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥å¼‚æ­¥æ‰§è¡Œä»»æ„ä¸€æ®µä»£ç ã€‚</p><p>å¯ä»¥é€šè¿‡ <code>setTimeout(callback, milliseconds)</code> å‡½æ•°æ¥åšåˆ°ã€‚<code>setTimeout</code> å‡½æ•°å»ºç«‹ä¸€ä¸ªå»¶åå‘ç”Ÿçš„äº‹ä»¶ã€‚å°±åƒè¿™æ ·ï¼š</p><script src="https://gist.github.com/zlatkov/688a0b41ae10e45bd202d02bb12df264.js"></script><p>å°†ä¼šè¾“å‡º</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">first</span></div><div class="line"><span class="keyword">third</span></div><div class="line"><span class="keyword">second</span></div></pre></td></tr></table></figure><h2 id="å‰–æäº‹ä»¶å¾ªç¯"><a href="#å‰–æäº‹ä»¶å¾ªç¯" class="headerlink" title="å‰–æäº‹ä»¶å¾ªç¯"></a>å‰–æäº‹ä»¶å¾ªç¯</h2><p>æˆ‘ä»¬ä¼šä»ä¸€ä¸ªå¥‡æ€ªçš„è¦æ±‚å¼€å§‹â€”â€”â€”â€”å°½ç®¡å…è®¸å¼‚æ­¥ç¼–ç ï¼ˆå°±åƒåˆšåˆšè®¨è®ºçš„<code>setTimeout</code>ï¼‰ï¼Œç›´åˆ° ES6ï¼Œ javascriptä»æœªæœ‰è¿‡çœŸæ­£ç›´æ¥çš„å¼‚æ­¥çš„æ¦‚å¿µã€‚javascript å¼•æ“åœ¨æ‰§è¡Œå•ä¸€ä»£ç å—çš„æ—¶åˆ»ä¸ä¼šå†åšä»»ä½•äº‹æƒ…ã€‚</p><p>å…³äºjavascript å¼•æ“ï¼ˆgoogleä¸“ç”¨çš„V8å¼•æ“ï¼‰çš„æ›´å¤šç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬<a href="https://blog.sessionstack.com/how-javascript-works-inside-the-v8-engine-5-tips-on-how-to-write-optimized-code-ac089e62b12e" target="_blank" rel="noopener">ä¹‹å‰çš„æ–‡ç« </a>.</p><p>é‚£ä¹ˆï¼Œè°è®© javascript å¼•æ“æ‰§è¡Œç¨‹åºå—å‘¢ï¼Ÿç°å®ä¸­ï¼Œjavascript å¼•æ“å¹¶ä¸æ˜¯å­¤ç«‹è¿è¡Œçš„â€”â€”â€”â€”å®ƒè¿è¡Œåœ¨ä¸€ä¸ª <em>å®¿ä¸»</em> ç¯å¢ƒä¸­ï¼Œå¯¹äºå¤§å¤šæ•°å¼€å‘è€…æ¥è¯´ï¼Œå…¸å‹çš„æ˜¯ç½‘é¡µæµè§ˆå™¨æˆ–è€… Node.jsã€‚äº‹å®ä¸Šï¼Œjavascript è¢«åµŒå…¥åˆ°å„ç§è®¾å¤‡ä¸­ï¼Œä»æœºå™¨äººåˆ°å°ç¯æ³¡ã€‚æ¯ä¸ªè®¾å¤‡ä»£è¡¨ javascript å¼•æ“çš„ä¸åŒçš„å®¿ä¸»ç¯å¢ƒç±»å‹ã€‚</p><p>åœ¨æ‰€æœ‰ç¯å¢ƒä¸­ï¼Œä¸å˜çš„æ˜¯æ‹¥æœ‰å…±åŒçš„ç§°ä¸º <strong>äº‹ä»¶å¾ªç¯</strong> çš„å†…ç½®æœºåˆ¶ï¼Œæ§åˆ¶å¤„ç†å¤šä¸ªç¨‹åºå—çš„æ‰§è¡Œæ—¶æœºã€‚</p><p>è¿™æ„å‘³ç€ JS å¼•æ“åªæ˜¯åœ¨æ‰§è¡Œç¯å¢ƒä¸­æŒ‰éœ€è°ƒç”¨ä»»æ„ä»£ç ã€‚å®ƒï¼ˆæ‰§è¡ŒJSä»£ç çš„ï¼‰æ˜¯ä¸€ä¸ªäº‹ä»¶è°ƒåº¦çš„ç¯å¢ƒã€‚</p><p>é‚£ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ çš„ JS ç¨‹åºå‘èµ·ä¸€ä¸ª Ajax è¯·æ±‚å»ä»æœåŠ¡å™¨ä¸­è·å–ä¸€äº›æ•°æ®ï¼Œä½ åœ¨ä¸€ä¸ªå‡½æ•°é‡Œè®¾ç½®äº†â€œå“åº”â€çš„ä»£ç ï¼ˆç§°ä¸ºâ€œå›è°ƒå‡½æ•°â€ï¼‰ï¼ŒJS å¼•æ“å‘Šè¯‰å®¿ä¸»ç¯å¢ƒï¼šâ€œå˜¿ï¼Œæˆ‘ç°åœ¨ä¼šæš‚åœæ‰§è¡Œï¼Œä½†å½“ç½‘ç»œè¯·æ±‚å®Œæˆæ—¶ï¼Œå¹¶è¿”å›ä¸€äº›æ•°æ®ï¼Œè¯·å›æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚â€</p><p>æµè§ˆå™¨ä¼šç›‘å¬ç½‘ç»œå“åº”ï¼Œå¹¶åœ¨æ‹¿åˆ°æ•°æ®æ—¶è¿”å›ç»™ä½ ï¼Œå®ƒä¼šé€šè¿‡æ’å…¥åˆ° <em>äº‹ä»¶å¾ªç¯</em> ä¸­æ¥è°ƒåº¦å›è°ƒå‡½æ•°ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„å›¾è¡¨ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*FA9NGxNB6-v1oI2qGEtlRQ.png" data-original="https://cdn-images-1.medium.com/max/800/1*FA9NGxNB6-v1oI2qGEtlRQ.png"></p><p>ä½ å¯ä»¥åœ¨<a href="https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf" target="_blank" rel="noopener">ä»¥å‰çš„æ–‡ç« </a>é˜…è¯»åˆ°æ›´å¤šå…³äºå †å†…å­˜å’Œè°ƒç”¨æ ˆçš„è®¨è®ºã€‚</p><p>è¿™äº› web APIs æ˜¯ä»€ä¹ˆï¼Ÿæœ¬è´¨ä¸Šæ¥è®²ï¼Œå®ƒä»¬æ˜¯æ— æ³•è®¿é—®çš„çº¿ç¨‹ï¼Œä½ åªèƒ½åˆ©ç”¨å®ƒã€‚å®ƒä»¬åªæ˜¯æµè§ˆå™¨çš„å¹¶å‘è®¿é—®çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ æ˜¯ Node.js å¼€å‘è€…ï¼Œå®ƒä»¬æ˜¯ C++ APIsã€‚</p><p>é‚£ä¹ˆï¼Œ<em>äº‹ä»¶å¾ªç¯</em> åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*KGBiAxjeD9JT2j6KDo0zUg.png" data-original="https://cdn-images-1.medium.com/max/800/1*KGBiAxjeD9JT2j6KDo0zUg.png"></p><p>äº‹ä»¶å¾ªç¯æœ‰ä¸€ä¸ªç®€å•çš„å·¥ä½œâ€”â€”â€”â€”ç›‘è§†è°ƒç”¨æ ˆå’Œå›è°ƒé˜Ÿåˆ—ã€‚å¦‚æœè°ƒç”¨æ ˆæ¸…ç©ºäº†ï¼Œå®ƒä¼šè·å–é˜Ÿåˆ—é‡Œçš„ç¬¬ä¸€ä¸ªäº‹ä»¶æ”¾å…¥è°ƒç”¨æ ˆï¼Œé«˜æ•ˆåœ°è¿è¡Œã€‚</p><p>åœ¨äº‹ä»¶å¾ªç¯ä¸­ï¼Œåƒè¿™æ ·çš„ä¸€ä¸ªè¿­ä»£è¢«ç§°ä¸º <strong>tick</strong>ã€‚æ¯ä¸ªäº‹ä»¶éƒ½åªæ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</p><script src="https://gist.github.com/zlatkov/6d2e3006addd24cd73e5b576312a1c98.js"></script><p>è®©æˆ‘ä»¬ä¸€èµ·â€œæ‰§è¡Œâ€è¿™æ®µä»£ç ï¼Œç„¶åçœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š</p><p>1ã€çŠ¶æ€æ˜¯æ¸…ç©ºçš„ã€‚æµè§ˆå™¨æ§åˆ¶å°æ˜¯æ¸…ç©ºçš„ï¼Œè°ƒç”¨æ ˆä¹Ÿæ˜¯ç©ºçš„ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*9fbOuFXJHwhqa6ToCc_v2A.png" data-original="https://cdn-images-1.medium.com/max/800/1*9fbOuFXJHwhqa6ToCc_v2A.png"></p><p>2ã€<code>console.log(&#39;Hi&#39;)</code>è¢«æ·»åŠ è¿›è°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*dvrghQCVQIZOfNC27Jrtlw.png" data-original="https://cdn-images-1.medium.com/max/800/1*dvrghQCVQIZOfNC27Jrtlw.png"></p><p>3ã€<code>console.log(&#39;Hi&#39;)</code>è¢«æ‰§è¡Œã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*yn9Y4PXNP8XTz6mtCAzDZQ.png" data-original="https://cdn-images-1.medium.com/max/800/1*yn9Y4PXNP8XTz6mtCAzDZQ.png"></p><p>4ã€ <code>console.log(&#39;Hi&#39;)</code> è¢«ç§»å‡ºè°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*iBedryNbqtixYTKviPC1tA.png" data-original="https://cdn-images-1.medium.com/max/800/1*iBedryNbqtixYTKviPC1tA.png"></p><p>5ã€<code>setTimeout(function cb1() { ... })</code>è¢«æ·»åŠ è¿›è°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*HIn-BxIP38X6mF_65snMKg.png" data-original="https://cdn-images-1.medium.com/max/800/1*HIn-BxIP38X6mF_65snMKg.png"></p><p>6ã€ <code>setTimeout(function cb1() { ... })</code>è¢«æ‰§è¡Œã€‚æµè§ˆå™¨é€šè¿‡ web api åˆ›å»ºäº†ä¸€ä¸ªå®šæ—¶å™¨ã€‚å®ƒå°†ä¸ºä½ å¤„ç†å€’è®¡æ—¶ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*vd3X2O_qRfqaEpW4AfZM4w.png" data-original="https://cdn-images-1.medium.com/max/800/1*vd3X2O_qRfqaEpW4AfZM4w.png"></p><p>7ã€<code>setTimeout(function cb1() { ... })</code>è¢«æ‰§è¡Œå®Œæ¯•å¹¶ç§»å‡ºè°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*_nYLhoZPKD_HPhpJtQeErA.png" data-original="https://cdn-images-1.medium.com/max/800/1*_nYLhoZPKD_HPhpJtQeErA.png"></p><p>8ã€<code>console.log(&#39;Bye&#39;)</code>è¢«æ·»åŠ è¿›è°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*1NAeDnEv6DWFewX_C-L8mg.png" data-original="https://cdn-images-1.medium.com/max/800/1*1NAeDnEv6DWFewX_C-L8mg.png"></p><p>9ã€<code>console.log(&#39;Bye&#39;)</code>è¢«æ‰§è¡Œã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*UwtM7DmK1BmlBOUUYEopGQ.png" data-original="https://cdn-images-1.medium.com/max/800/1*UwtM7DmK1BmlBOUUYEopGQ.png"></p><p>10ã€<code>console.log(&#39;Bye&#39;)</code>è¢«ç§»å‡ºè°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*-vHNuJsJVXvqq5dLHPt7cQ.png" data-original="https://cdn-images-1.medium.com/max/800/1*-vHNuJsJVXvqq5dLHPt7cQ.png"></p><p>11ã€åœ¨ <em>è‡³å°‘</em> 5000æ¯«ç§’ä¹‹åï¼Œå®šæ—¶å™¨å®Œæˆï¼Œå¹¶å°† <code>cb1</code> å›è°ƒæ¨å…¥å›è°ƒé˜Ÿåˆ—ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*eOj6NVwGI2N78onh6CuCbA.png" data-original="https://cdn-images-1.medium.com/max/800/1*eOj6NVwGI2N78onh6CuCbA.png"></p><p>12ã€äº‹ä»¶å¾ªç¯ä»å›è°ƒé˜Ÿåˆ—é‡Œå–å‡º <code>cb1</code> å¹¶æ¨å…¥è°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*jQMQ9BEKPycs2wFC233aNg.png" data-original="https://cdn-images-1.medium.com/max/800/1*jQMQ9BEKPycs2wFC233aNg.png"></p><p>13ã€<code>cb1</code> è¢«æ‰§è¡Œï¼Œå¹¶æ·»åŠ  <code>console.log(&#39;cb1&#39;)</code> åˆ°è°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*hpyVeL1zsaeHaqS7mU4Qfw.png" data-original="https://cdn-images-1.medium.com/max/800/1*hpyVeL1zsaeHaqS7mU4Qfw.png"></p><p>14ã€<code>console.log(&#39;cb1&#39;)</code> è¢«æ‰§è¡Œã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*lvOtCg75ObmUTOxIS6anEQ.png" data-original="https://cdn-images-1.medium.com/max/800/1*lvOtCg75ObmUTOxIS6anEQ.png"></p><p>15ã€<code>console.log(&#39;cb1&#39;)</code> è¢«ç§»å‡ºè°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*Jyyot22aRkKMF3LN1bgE-w.png" data-original="https://cdn-images-1.medium.com/max/800/1*Jyyot22aRkKMF3LN1bgE-w.png"></p><p>16ã€<code>cb1</code> è¢«ç§»å‡ºè°ƒç”¨æ ˆã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*t2Btfb_tBbBxTvyVgKX0Qg.png" data-original="https://cdn-images-1.medium.com/max/800/1*t2Btfb_tBbBxTvyVgKX0Qg.png"></p><p>å¿«é€Ÿå›é¡¾ä¸€ä¸‹ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*TozSrkk92l8ho6d8JxqF_w.gif" data-original="https://cdn-images-1.medium.com/max/800/1*TozSrkk92l8ho6d8JxqF_w.gif"></p><p>æœ‰è¶£çš„æ˜¯ ES6 æŒ‡å®šäº† äº‹ä»¶å¾ªç¯å¦‚ä½•å·¥ä½œï¼Œæ„å‘³ç€æŠ€æœ¯ä¸Šæ¥è®²ï¼Œäº‹ä»¶å¾ªç¯æ˜¯åœ¨ JS å¼•æ“çš„èŒè´£èŒƒå›´å†…çš„ï¼Œå®ƒå°†ä¸å†æ‰®æ¼”å®¿ä¸»ç¯å¢ƒçš„è§’è‰²ã€‚è¿™ä¸€å˜åŒ–çš„ä¸€ä¸ªä¸»è¦åŸå› æ˜¯ ES6 Promise çš„ä»‹ç»è¯´ï¼šå› ä¸ºåè€…éœ€è¦ç›´æ¥è®¿é—®å’Œç»†ç²’åº¦åœ°æ§åˆ¶äº‹ä»¶é˜Ÿåˆ—å¾ªç¯çš„è°ƒåº¦æ“ä½œã€‚ï¼ˆç¨åæˆ‘ä»¬ä¼šæ›´è¯¦ç»†åœ°è®¨è®ºå®ƒä»¬ï¼‰</p><h2 id="setTimeout-â€¦-å¦‚ä½•å·¥ä½œ"><a href="#setTimeout-â€¦-å¦‚ä½•å·¥ä½œ" class="headerlink" title="setTimeout(â€¦) å¦‚ä½•å·¥ä½œ"></a>setTimeout(â€¦) å¦‚ä½•å·¥ä½œ</h2><p>å€¼å¾—æ³¨æ„åœ°çš„ï¼Œ <code>setTimeout(â€¦)</code> å¹¶ä¸ä¼šè‡ªåŠ¨å°†å›è°ƒå‡½æ•°æ·»åŠ è¿›äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ã€‚å®ƒåªæ˜¯è®¾å®šä¸€ä¸ªå®šæ—¶å™¨ã€‚å½“å®šæ—¶å™¨åˆ°æœŸæ—¶ï¼Œè¿è¡Œç¯å¢ƒå°†å›è°ƒäº‹ä»¶æ¨å…¥äº‹ä»¶å¾ªç¯ã€‚æ‰€ä»¥æœªæ¥ <code>tick</code> ä¼šå–å‡ºå›è°ƒå¹¶æ‰§è¡Œå®ƒã€‚çœ‹ä¸€çœ¼è¿™ä¸ªä»£ç ï¼š</p><script src="https://gist.github.com/zlatkov/9345a7c43b2407ddd1c52a6173a97dd9.js"></script><p>å®ƒå¹¶ä¸æ„å‘³ç€ <code>myCallback</code> å°†ä¼šåœ¨1000æ¯«ç§’çš„æ—¶å€™ç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨1000æ¯«ç§’åï¼Œ<code>myCallback</code> è¢«æ·»åŠ è¿›äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ã€‚ä½†æ˜¯ï¼Œé˜Ÿåˆ—é‡Œå¯èƒ½å·²ç»æœ‰å…¶ä»–äº‹ä»¶è¢«æ›´æ—©åœ°æ·»åŠ è¿›æ¥â€”â€”â€”â€”ä½ çš„å›è°ƒå¿…é¡»ç­‰å¾…ã€‚</p><p>æœ‰ç›¸å½“å¤šçš„æ–‡ç« å’Œæ•™ç¨‹åœ¨å¼€å§‹ä½¿ç”¨å¼‚æ­¥jsæ—¶å»ºè®®ä½¿ç”¨ <code>setTimeout(callback, 0)</code>ã€‚ç°åœ¨ä½ çŸ¥é“äº‹ä»¶å¾ªç¯æ˜¯æ€ä¹ˆå›äº‹ä»¥åŠ setTimeout å¦‚ä½•å·¥ä½œï¼šè°ƒç”¨ç¬¬äºŒä¸ªå‚æ•°ä¸º 0 çš„ setTimeout åªæ˜¯æ¨è¿Ÿæ‰§è¡Œå›è°ƒå‡½æ•°ç›´è‡³è°ƒç”¨æ ˆæ¸…ç©ºã€‚</p><p>çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä»£ç ï¼š</p><script src="https://gist.github.com/zlatkov/b12986d07676bc17fe51398847ebc917.js"></script><p>å°½ç®¡å®šæ—¶å™¨è®¾ç½®ä¸º 0ms, ä½†æµè§ˆå™¨æ§åˆ¶å°çš„ç»“æœæ˜¯ï¼š</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">Hi</span></div><div class="line"><span class="keyword">Bye</span></div><div class="line"><span class="symbol">callback</span></div></pre></td></tr></table></figure><h2 id="ES6-é‡Œçš„-Jobs-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ES6-é‡Œçš„-Jobs-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ES6 é‡Œçš„ Jobs æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ES6 é‡Œçš„ Jobs æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>åœ¨ ES6 ä»‹ç»ä¸­ï¼Œå‡ºç°äº†ä¸€ä¸ªæ–°æ¦‚å¿µ â€œJobs Queueâ€ã€‚å®ƒæ˜¯äº‹ä»¶å¾ªç¯ä¹‹ä¸Šçš„ä¸€å±‚ã€‚å½“ä½ å¤„ç† Promise å¼‚æ­¥æ“ä½œçš„æ—¶å€™ï¼Œä½ å‡ ä¹ç»å¸¸ç¢°åˆ°å®ƒï¼ˆæˆ‘ä»¬ä¹Ÿä¼šè°ˆè°ˆå®ƒï¼‰ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥è°ˆè°ˆè¿™ä¸ªæ¦‚å¿µï¼Œä»¥ä¾¿ç¨åè®¨è®ºå¼‚æ­¥ Promise è¡¨ç°çš„æ—¶å€™ï¼Œä½ èƒ½ç†è§£é‚£äº›è¡Œä¸ºæ˜¯å¦‚ä½•è¢«è°ƒåº¦å’Œå¤„ç†çš„ã€‚</p><p>æƒ³åƒä¸€ä¸‹ï¼ŒJob Queue æ˜¯ä¸€ä¸ªé™„å±äºäº‹ä»¶é˜Ÿåˆ—ä¸­æ¯ä¸€ä¸ª tick ç»“å°¾çš„é˜Ÿåˆ—ã€‚æŸäº›å¼‚æ­¥è¡Œä¸ºå¯èƒ½ä¼šå‘ç”Ÿåœ¨äº‹ä»¶å¾ªç¯çš„æŸä¸€åˆ»ï¼Œå´ä¸ä¼šå¼•èµ·ä¸€ä¸ªå…¨æ–°çš„äº‹ä»¶æ·»åŠ åˆ°äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ä¸­ã€‚ä½†ä¼šæ·»åŠ ä¸€ä¸ªé¡¹ç›®ï¼ˆä¹Ÿå«Jobï¼‰åˆ°å½“å‰ tick çš„ Job Queueã€‚</p><p>è¿™æ„å‘³ç€ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œè®©å®ƒç¨åæ‰§è¡Œã€‚å¹¶ä¸”ä½ å¯ä»¥æ”¾å¿ƒï¼Œå®ƒåˆšå¥½ä¼šåœ¨å…¶ä»–äº‹ä»¶ä¹‹å‰ï¼Œåœ¨é‚£ä¹‹åæ‰§è¡Œã€‚</p><p>ä¸€ä¸ª Job ä¹Ÿèƒ½å¼•èµ·å…¶ä»–çš„ Job æ·»åŠ åˆ°ç›¸åŒçš„é˜Ÿåˆ—åé¢ã€‚ç†è®ºä¸Šï¼ŒJob â€œå¾ªç¯â€ä¹Ÿæ˜¯æœ‰å¯èƒ½äº§ç”Ÿçš„ï¼ˆä¸€ä¸ªä¸æ–­æ·»åŠ å…¶ä»– Jobsçš„Jobä¹‹ç±»ï¼‰ã€‚è¿™æ ·éœ€è¦èµ„æºçš„ç¨‹åºå°±å¿…é¡»ç§»åŠ¨åˆ°äº‹ä»¶å¾ªç¯çš„ä¸‹ä¸€ä¸ª tickã€‚æ¦‚å¿µä¸Šçœ‹ï¼Œè¿™å°±ç±»ä¼¼äºéœ€è¦é•¿æ—¶å€™è¿è¡Œæˆ–æ­»å¾ªç¯ï¼ˆå°±åƒ <code>while (true) ..</code>ï¼‰ã€‚</p><p>Job å°±åƒ <code>setTimeout(callback, 0)</code> çš„ <code>hack</code>ï¼Œä½†é€šè¿‡å¼•å…¥ä¸€ä¸ªæ›´åŠ æ˜ç¡®çš„æ¦‚å¿µæ¥å®ç°ï¼šç¨åæ‰§è¡Œï¼Œä½†å°½å¯èƒ½å¿«ã€‚</p><h2 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h2><p>æ­£å¦‚ä½ æ‰€çŸ¥é“çš„ï¼Œå›è°ƒå‡½æ•°æ˜¯è¿„ä»Šä¸ºæ­¢ javascript ç¨‹åºä¸­æœ€å¸¸è§çš„è¡¨è¾¾å’Œç®¡ç†å¼‚æ­¥çš„æ–¹å¼ã€‚çš„ç¡®ï¼Œå›è°ƒæ˜¯ javascript è¯­è¨€ä¸­æœ€åŸºæœ¬çš„å¼‚æ­¥æ¨¡å¼ã€‚æ— æ•°çš„JSç¨‹åºï¼Œç”šè‡³æ˜¯å³ä½¿æ˜¯éå¸¸å¤æ‚çš„ä¸€ä¸ªï¼Œä¹Ÿä¸ä¼šå°‘äº†æœ€åŸºç¡€çš„å›è°ƒå¼‚æ­¥æ¨¡å¼ã€‚</p><p>é™¤äº†å›è°ƒï¼Œå…¶ä»–çš„ä¸ä¼šæ²¡æœ‰ç¼ºç‚¹ã€‚è®¸å¤šå¼€å‘è€…å°è¯•å¯»æ‰¾æ›´å¥½çš„å¼‚æ­¥æ¨¡å¼ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸èƒ½å¾ˆå¥½åœ°ç†è§£å¼•æ“ä¸‹çš„å·¥ä½œåŸç†ï¼Œå°±ä¸å¯èƒ½æœ‰æ•ˆåœ°ä½¿ç”¨ä»»ä½•æŠ½è±¡æ¦‚å¿µã€‚</p><p>åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ï¼Œæˆ‘ä»¬å°†æ¢ç´¢è¿™äº›æŠ½è±¡æ¦‚å¿µï¼Œæ·±å…¥åœ°å±•ç¤ºä¸ºä»€ä¹ˆæ›´å¤æ‚çš„å¼‚æ­¥æ¨¡å¼ï¼ˆè¿™å°†åœ¨éšåçš„å¸–å­ä¸­è®¨è®ºï¼‰æ˜¯å¿…é¡»çš„ï¼Œç”šè‡³æ˜¯æ¨èçš„ã€‚</p><h2 id="åµŒå¥—å›è°ƒ"><a href="#åµŒå¥—å›è°ƒ" class="headerlink" title="åµŒå¥—å›è°ƒ"></a>åµŒå¥—å›è°ƒ</h2><p>çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><script src="https://gist.github.com/zlatkov/cf5d201413729777fa6b8d5af1f8eaa4.js"></script><p>æˆ‘ä»¬æœ‰ä¸‰ä¸ªå‡½æ•°åµŒå¥—åœ¨ä¸€èµ·ï¼Œæ¯ä¸€ä¸ªå°±ä»£è¡¨å¼‚æ­¥ç³»åˆ—çš„ä¸€æ­¥ã€‚</p><p>è¿™ç§ä»£ç ç»å¸¸è¢«ç§°ä¸ºâ€œå›è°ƒåœ°ç‹±ï¼ˆcallback hellï¼‰â€ã€‚ä½†â€œå›è°ƒåœ°ç‹±â€å®é™…ä¸Šä¸åµŒå¥—ã€ç¼©è¿›æ²¡ä»€ä¹ˆå…³ç³»ã€‚è¿™æ˜¯ä¸€ä¸ªæ›´æ·±å…¥çš„é—®é¢˜ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç­‰å¾…â€œç‚¹å‡»â€äº‹ä»¶ï¼Œç„¶åç­‰å¾…å®šæ—¶å™¨è¢«è§¦å‘ï¼Œç„¶åç­‰å¾… Ajax è¯·æ±‚å“åº”æ•°æ®ï¼Œåœ¨è¿™ä¸€ç‚¹ï¼Œå®ƒå¯èƒ½ä¼šå†æ¬¡é‡å¤ã€‚</p><p>ç²—ç•¥åœ°çœ‹ï¼Œè¿™æ®µä»£ç ä¼¼ä¹è‡ªç„¶è€Œç„¶åœ°å°†å¼‚æ­¥æ˜ å°„ä¸ºè¿ç»­çš„æ­¥éª¤ï¼š</p><script src="https://gist.github.com/zlatkov/c279bb1865ad3a8ff8c890d842b105c1.js"></script><p>ç„¶åæˆ‘ä»¬æœ‰ï¼š</p><script src="https://gist.github.com/zlatkov/8c9c5601ba6b35adf652b7a6797d1a14.js"></script><p>å†ç„¶åæœ‰ï¼š</p><script src="https://gist.github.com/zlatkov/250ccf280b4f191f87bca3a0b8337a41.js"></script><p>æœ€åæˆ‘ä»¬æœ‰ï¼š</p><script src="https://gist.github.com/zlatkov/6dc48448f85e010542ac9ba86482f38d.js"></script><p>è¿™æ ·ç”¨è¿ç»­çš„æ–¹å¼è¡¨è¾¾å¼‚æ­¥çœ‹èµ·æ¥æ›´è‡ªç„¶ï¼Œä¸æ˜¯å—ï¼Ÿè¿™ç§æ–¹å¼ä¸€å®šè¡Œå¾—é€šï¼Œå¯¹å§ï¼Ÿ</p><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><p>çœ‹ä¸€ä¸‹è¿™ä¸ªä»£ç ï¼š</p><script src="https://gist.github.com/zlatkov/bf8888880822b83e4a9c1bfc4b21c6a9.js"></script><p>è¿™éå¸¸ç®€å•ï¼šå°† <code>x</code> å’Œ <code>y</code> çš„å€¼ç›¸åŠ ç„¶åè¾“å‡ºåœ¨æ§åˆ¶å°ã€‚ä½†æ˜¯ï¼Œå¦‚æœ <code>x</code> å’Œ <code>y</code> çš„å€¼åœ¨ç”¨äºè¡¨è¾¾å¼ä¹‹å‰ä¸¢å¤±äº†ï¼Œæˆ–è¿˜ä¸ç¡®å®šæ€ä¹ˆåŠå‘¢ï¼Ÿè®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‡½æ•° <code>loadx</code> å’Œ <code>loady</code> åˆ†åˆ«ä»æœåŠ¡ç«¯åŠ è½½ <code>x</code> å’Œ <code>y</code> çš„å€¼ã€‚ç„¶åï¼Œæœ‰ä¸€ä¸ªå‡½æ•° <code>sum</code> ä¼šåœ¨ <code>x</code> å’Œ <code>y</code> éƒ½è·å–åˆ°å€¼çš„æ—¶å€™ç›¸åŠ ã€‚</p><p>ä»£ç çœ‹èµ·æ¥å¯èƒ½æ˜¯è¿™æ ·çš„ï¼ˆéå¸¸ä¸‘é™‹ï¼Œä¸æ˜¯å—ï¼‰ï¼š</p><script src="https://gist.github.com/zlatkov/1ffa6e00a2750217f1a168fe36deda08.js"></script><p>è¿™é‡Œæœ‰ä¸€äº›éå¸¸å€¼å¾—æ³¨æ„çš„äº‹æƒ…â€”â€”åœ¨ä¸Šé¢çš„ä»£ç æ®µä¸­ï¼Œæˆ‘ä»¬å‡è®¾ <code>x</code> å’Œ <code>y</code> éƒ½æ˜¯æœªæ¥å€¼ï¼Œå¹¶ä¸”æˆ‘ä»¬è¡¨è¾¾äº†ä¸€ä¸ªæ“ä½œå‡½æ•° <code>sum</code> å¹¶ä¸å…³å¿ƒ <code>x</code>æˆ–<code>y</code>æˆ–ä¸¤è€…æ˜¯å¦éƒ½å¯ç”¨ã€‚</p><p>å½“ç„¶ï¼Œè¿™ç§åŸºäºå›è°ƒçš„æ–¹å¼ä¸å°½äººæ„ã€‚è¿™åªæ˜¯é¦–å…ˆçš„ä¸€å°æ­¥ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£ä¸ºä»€ä¹ˆä¸éœ€è¦å…³å¿ƒ <em>æœªæ¥å€¼</em> ä½•æ—¶å¯ç”¨è¿™æ–¹é¢ã€‚</p><h2 id="Promise-Value"><a href="#Promise-Value" class="headerlink" title="Promise Value"></a>Promise Value</h2><p>è®©æˆ‘ä»¬ç²—ç•¥åœ°çœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•ä½¿ç”¨ Promise æ¥è¡¨è¾¾ <code>x + y</code>:</p><script src="https://gist.github.com/zlatkov/e7098be769383bac5336c54d952beb53.js"></script><p>è¿™ä¸ªä»£ç æ®µä¸­æœ‰ä¸¤å±‚ Promise.</p><p><code>fetchX()</code> å’Œ <code>fetchY()</code> è¢«ç›´æ¥è°ƒç”¨ï¼Œå¹¶ä¸”ä»–ä»¬çš„è¿”å›å€¼è¢«ä¼ é€’åˆ° <code>sum(...)</code> ã€‚æ½œåœ¨çš„å€¼å¯èƒ½åœ¨ç°åœ¨æˆ–ç¨åå‡†å¤‡å¥½ï¼Œä½†æ¯ä¸ª Promise è§„å®šäº†å®ƒä»¬çš„è¡¨ç°æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬ä»¥ç‹¬ç«‹çš„æ–¹å¼åˆ†æ <code>x</code> å’Œ <code>y</code>çš„å€¼ã€‚å®ƒä»¬æ˜¯æœªæ¥çš„å€¼ï¼Œæœ‰ä¸€æ®µæœŸé™ã€‚</p><p>ç¬¬äºŒå±‚æ˜¯<code>sum(...)</code> åˆ›å»ºçš„ Promise(æ¥æºäº <code>Promise.all([ ... ])</code>)ã€‚æˆ‘ä»¬ç­‰å¾…ç€è°ƒç”¨ <code>then(...)</code> .å½“ <code>sum(...)</code> æ“ä½œç¬¦å®Œæˆæ—¶ï¼Œæˆ‘ä»¬ç›¸åŠ çš„æœªæ¥çš„å€¼å·²ç»å‡†å¤‡å¥½ï¼Œå¹¶ä¸”å¯ä»¥è¾“å‡ºã€‚æˆ‘ä»¬ä¸ºäº†ç­‰å¾… <code>x</code> å’Œ<code>y</code> å€¼ï¼Œåœ¨ <code>sum(...)</code>ä¸­éšè—äº†é€»è¾‘ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> åœ¨<code>sum(â€¦)</code>ä¹‹ä¸­ï¼Œè°ƒç”¨ <code>Promise.all([ â€¦ ])</code> åˆ›å»ºä¸€ä¸ª Promise ï¼ˆç­‰å¾… <code>promiseX</code> å’Œ <code>promiseY</code> å®Œæˆï¼‰ã€‚è°ƒç”¨é“¾ <code>.then(...)</code> åˆ›å»ºå¦ä¸€ä¸ª Promiseï¼Œç«‹å³è¿”å› <code>values[0] + values[1]</code> ï¼ˆç›¸åŠ çš„ç»“æœï¼‰ã€‚<code>sum(...)</code> åé¢è°ƒç”¨çš„ <code>then(...)</code> å®é™…ä¸Šæ˜¯ç¬¬äºŒä¸ªPromise è¿”å›çš„ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€ä¸ª <code>Promise.all([ ... ])</code> è¿”å›çš„ã€‚åŒæ ·ï¼Œæˆ‘ä»¬æ²¡æœ‰é“¾æ¥ç¬¬äºŒä¸ª <code>then(...)</code>, å®ƒä¹ŸåŒæ ·å·²ç»åˆ›å»ºäº†å¦ä¸€ä¸ª Promiseã€‚è¿™ä¸€ Promise é“¾çš„å†…å®¹å°†åœ¨æœ¬ç« ç»“å°¾è¯¦ç»†è§£é‡Šã€‚</p><p>ä½¿ç”¨ Promise, <code>then(...)</code> å®é™…ä¸Šå¯ä»¥ä¼ å…¥ä¸¤ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå¯¹åº”å®ŒæˆçŠ¶æ€ï¼Œç¬¬äºŒä¸ªæ˜¯å¯¹åº”å¤±è´¥çŠ¶æ€ã€‚</p><script src="https://gist.github.com/zlatkov/33582dc127209706688796092e268772.js"></script><p>å¦‚æœåœ¨è·å– <code>x</code> æˆ– <code>y</code> çš„æ—¶å€™å‘ç”Ÿé”™è¯¯ï¼Œæˆ–è€…åœ¨ç›¸åŠ çš„æ—¶å€™å‡ºé”™ï¼Œ<code>sum(...)</code> ä¼šè¿”å›å¤±è´¥ï¼Œå¹¶ä¸”ä¼ å…¥ <code>then(...)</code> çš„ç¬¬äºŒä¸ªé”™è¯¯å¤„ç†å‡½æ•°ä¼šæ”¶åˆ° Promise è¿”å›çš„å€¼ã€‚</p><p>å› ä¸º Promise å°è£…äº†ä¾èµ–æ—¶é—´çš„çŠ¶æ€â€”â€”ç­‰å¾…åº•å±‚å€¼çš„å®Œæˆæˆ–å¤±è´¥â€”â€”ä»å¤–éƒ¨çœ‹ï¼ŒPromise æœ¬èº«æ˜¯ä¾èµ–æ—¶é—´çš„ï¼Œå› æ­¤ Promise å¯ä»¥ä»¥å¯é¢„æµ‹çš„æ–¹å¼ç»„åˆèµ·æ¥ï¼Œè€Œä¸ç”¨è€ƒè™‘æ—¶é—´å’Œç»“æœã€‚</p><p>æ­¤å¤–ï¼Œä¸€æ—¦ Promise è§£å†³äº†ï¼Œå®ƒå°†æ°¸å…¥åœç•™åœ¨é‚£ä¸ªçŠ¶æ€â€”â€”å®ƒè¿™æ—¶å˜æˆä¸€ä¸ª <em>ä¸å¯å˜çš„</em> å€¼â€”â€”å¹¶ä¸”æ ¹æ®éœ€è¦å¯ä»¥è§‚å¯Ÿå¤šæ¬¡ã€‚</p><p>é“¾å¼è°ƒç”¨ Promise çœŸçš„éå¸¸æœ‰ç”¨ï¼š</p><script src="https://gist.github.com/zlatkov/f94c8e16cbbb8b8940744b348c70de14.js"></script><p>è°ƒç”¨ <code>delay(2000)</code> åˆ›å»ºä¸€ä¸ª Promise å°†ä¼šåœ¨ 2000ms åè¾¾åˆ°æ¡ä»¶ï¼Œç„¶åä»ç¬¬ä¸€ä¸ª <code>then(...)</code> æˆåŠŸå›è°ƒè¿”å›ï¼Œè¿™ä¼šé€ æˆç¬¬äºŒä¸ª <code>then(...)</code> ä¼šç­‰å¾… 2000ms çš„ Promise.</p><p><strong>æ³¨æ„ï¼š</strong> å› ä¸º Promise ä»å¤–éƒ¨çœ‹æ¥å¦‚æœè¢«è§£å†³äº†æ˜¯æ— æ³•å†æ”¹å˜çš„ï¼Œç°åœ¨æŠŠå€¼ä¼ åˆ°ä»»ä½•ä¸€éƒ¨åˆ†éƒ½æ˜¯å®‰å…¨çš„ï¼Œå®ƒä¸èƒ½è¢«æ¶æ„æˆ–æ„å¤–åœ°ä¿®æ”¹ã€‚å°¤å…¶æ˜¯å…³ç³»åˆ°å¤šä¸ª Promise éµå®ˆåè®®ã€‚ä¸€æ–¹ä¸å¯èƒ½å½±å“å¦ä¸€æ–¹éµå®ˆåè®®çš„èƒ½åŠ›ã€‚ä¸å˜æ€§å¬èµ·æ¥å…³ç³»åˆ°å­¦æœ¯æ€§çš„è¯é¢˜ã€‚ä½†å®ƒå®é™…ä¸Šæ˜¯ Promise è®¾è®¡çš„æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œä¸åº”è¯¥éšä¾¿é”™è¿‡ã€‚</p><h2 id="ç”¨è¿˜æ˜¯ä¸ç”¨-Promise"><a href="#ç”¨è¿˜æ˜¯ä¸ç”¨-Promise" class="headerlink" title="ç”¨è¿˜æ˜¯ä¸ç”¨ Promise"></a>ç”¨è¿˜æ˜¯ä¸ç”¨ Promise</h2><p>å…³äº Promise æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ç»†èŠ‚å°±æ˜¯è¦çŸ¥é“æŸä¸ªå€¼æ˜¯å¦æ˜¯ Promiseã€‚æ¢å¥è¯è¯´ï¼ŒæŸä¸ªå€¼è¡¨ç°å¾—åƒ Promise å—ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒPromise é€šè¿‡ <code>new Promise(â€¦)</code> è¯­æ³•æ„é€ ï¼Œç„¶åä½ è®¤ä¸º <code>p instanceof Promise</code> è¶³ä»¥æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ª Promiseã€‚ä½†ï¼Œå¹¶ä¸å®Œå…¨æ˜¯ã€‚</p><p>ä¸»è¦æ˜¯å› ä¸ºä½ å¯ä»¥æœ‰é€šè¿‡å…¶ä»–çš„æµè§ˆçª—å£æ¥æ”¶ä¸€ä¸ª Promise å€¼ï¼ˆæ¯”å¦‚ï¼šiframeï¼‰ï¼Œå®ƒæœ‰å®ƒæ‰€å±çš„ Promiseï¼Œ ä¸åŒäºå½“å‰çª—å£çš„ï¼Œå¹¶ä¸”æ£€æµ‹æ˜¯å¦æ˜¯ Promise å®ä¾‹ä¼šè¿”å›å¤±è´¥ã€‚</p><p>æ­¤å¤–ï¼Œä¸€ä¸ªç±»åº“æˆ–æ¡†æ¶å¯èƒ½ä¼šé€‰æ‹©è‡ªå·±ä½¿ç”¨çš„ Promise å®ç°ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ ES6 åŸç”Ÿå®ç°çš„ Promiseã€‚é€šè¿‡ç±»åº“ä½¿ç”¨ Promise å¯èƒ½åœ¨ä¸æ”¯æŒ Promise çš„æµè§ˆå™¨ä¸Šå·¥ä½œå¾—å¾ˆå¥½ã€‚</p><h2 id="è¢«åæ‰çš„å¼‚å¸¸"><a href="#è¢«åæ‰çš„å¼‚å¸¸" class="headerlink" title="è¢«åæ‰çš„å¼‚å¸¸"></a>è¢«åæ‰çš„å¼‚å¸¸</h2><p>å¦‚æœä»»ä½•æ—¶å€™åˆ›å»ºä¸€ä¸ª Promise ï¼Œæˆ–æ­£åœ¨ç›‘å¬å®ƒå†³ç­–çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†æ„å¤–é”™è¯¯ï¼Œæ¯”å¦‚ <code>TypeError</code> æˆ–è€… <code>ReferenceError</code>, å¼‚å¸¸å°†ä¼šè¢«æ•è·ï¼Œå¹¶ä¸”è¿™ä¸ª Promise å°†ä¼šè¢«å¼ºåˆ¶å˜æˆå¤±è´¥çŠ¶æ€ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><script src="https://gist.github.com/zlatkov/ba13f1f0a37b0156417bc389785d37ea.js"></script><p>ä½†å¦‚æœä¸€ä¸ª Promise è¿˜æ²¡æœ‰å˜æˆæˆåŠŸçŠ¶æ€ï¼Œå´åœ¨è§‚å¯ŸæœŸé—´å‘ç”Ÿäº†å¼‚å¸¸ä¼šæ€æ ·å‘¢ï¼ˆåœ¨ <code>then(...)</code> æ³¨å†Œäº†å›è°ƒï¼‰ï¼Ÿå°½ç®¡è¿™ä¸ªå¼‚å¸¸å¯ä»¥æ•è·ï¼Œä½†å®ƒçš„å¤„ç†æ–¹å¼å¯èƒ½è®©ä½ æœ‰ç‚¹åƒæƒŠã€‚è®©æˆ‘ä»¬æŒ–å¾—æ›´æ·±ä¸€ç‚¹ã€‚</p><script src="https://gist.github.com/zlatkov/2ab398f4d3eeccb80556de844de2cd92.js"></script><p>è¿™çœ‹èµ·æ¥å‘ç”Ÿåœ¨ <code>foo.bar()</code> çš„å¼‚å¸¸ç¡®å®è¢«åæ‰äº†ã€‚è™½ç„¶äº‹å®å¹¶æ²¡æœ‰ã€‚æœ‰ä¸€äº›æ›´æ·±çš„ä¸œè¥¿å‘ç”Ÿäº†é”™è¯¯ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›‘å¬åˆ°ã€‚<code>p.then(â€¦)</code> è¿”å›å¦ä¸€ä¸ª Promiseï¼Œè€Œä¸”è¿™ä¸ª Promise ä¼šå› ä¸º <code>TypeError</code> å˜æˆå¤±è´¥çŠ¶æ€ã€‚</p><h2 id="å¤„ç†æœªæ•è·çš„å¼‚å¸¸"><a href="#å¤„ç†æœªæ•è·çš„å¼‚å¸¸" class="headerlink" title="å¤„ç†æœªæ•è·çš„å¼‚å¸¸"></a>å¤„ç†æœªæ•è·çš„å¼‚å¸¸</h2><p>è¿˜æœ‰å…¶ä»–ä¸€äº›è®¸å¤šäººè®¤ä¸º <em>æ›´å¥½</em> çš„è§£å†³åŠæ³•ã€‚</p><p>ä¸€ä¸ªæ™®éçš„å»ºè®®å°±æ˜¯ Promise åº”è¯¥æ·»åŠ ä¸€ä¸ª <code>done(â€¦)</code>ï¼Œæ„å‘³ç€ Promise é“¾å¼è°ƒç”¨å·²â€œå®Œæˆâ€ã€‚<code>done(â€¦)</code> ä¸ä¼šå†åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ª Promiseï¼Œæ‰€ä»¥ä¼ é€’å›è°ƒå‡½æ•°åˆ° <code>done(..)</code> æ˜¾ç„¶ä¸èƒ½ä¸ä¸å­˜åœ¨çš„ Promise è¿æ¥ä¸ŠæŠ¥å¼‚å¸¸ã€‚</p><p>ä½ å¯èƒ½æœŸæœ›å‘ç°ä»»ä½•æœªæ•è·çš„é”™è¯¯çš„æƒ…å†µï¼šä»»ä½• <code>done(..)</code> ä¸­çš„å¼‚å¸¸éƒ½ä¼šæŠ›å‡ºå…¨å±€çš„æœªæ•è·çš„é”™è¯¯ï¼ˆåŸºæœ¬éƒ½ä¼šå‡ºç°åœ¨æ§åˆ¶å°ï¼‰ï¼š</p><script src="https://gist.github.com/zlatkov/ae156463adf288ca0ac9da9e8964fa18.js"></script><h2 id="ES8-æœ‰ä»€ä¹ˆå˜åŒ–ï¼ŸAsync-await"><a href="#ES8-æœ‰ä»€ä¹ˆå˜åŒ–ï¼ŸAsync-await" class="headerlink" title="ES8 æœ‰ä»€ä¹ˆå˜åŒ–ï¼ŸAsync/await"></a>ES8 æœ‰ä»€ä¹ˆå˜åŒ–ï¼ŸAsync/await</h2><p>javascript ES8 æ¨å‡ºäº† <code>async/await</code> è®© Promise çš„å·¥ä½œæ›´å®¹æ˜“æ›´ç®€å•ã€‚æˆ‘ä»¬ç®€è¦åœ°çœ‹çœ‹ <code>async/await</code> æä¾›äº†ä»€ä¹ˆå¹¶åˆ©ç”¨å®ƒä»¬å†™ä¸€äº›å¼‚æ­¥ä»£ç ã€‚</p><p>é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ <code>async/await</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>ä½ å¯ä»¥ä½¿ç”¨ <code>async</code> å£°æ˜å®šä¹‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ã€‚è¿™æ ·çš„å‡½æ•°è¿”å›ä¸€ä¸ª<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncFunction" target="_blank" rel="noopener">å¼‚æ­¥å‡½æ•°å¯¹è±¡</a>ã€‚<code>AsyncFunction</code> å¯¹è±¡ä»£è¡¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œä»£ç ï¼Œå¹¶åŒ…å«åœ¨é‚£ä¸ªå®¿ä¸»å‡½æ•°ä¸­ã€‚</p><p>å½“å¼‚æ­¥å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒè¿”å›ä¸€ä¸ª <code>Promise</code>ã€‚å½“å¼‚æ­¥å‡½æ•°è¿”å›ä¸€ä¸ªå€¼æ—¶ï¼Œé‚£å°±ä¸æ˜¯ä¸€ä¸ª <code>Promise</code>ã€‚<code>Promise</code> ä¼šè¢«è‡ªåŠ¨åˆ›å»ºï¼Œå¹¶ä¸”ä¼šé€šè¿‡è¿”å›å€¼æ¥å®ŒæˆçŠ¶æ€ã€‚å½“ <code>async</code> æŠ›å‡ºå¼‚å¸¸ï¼Œ<code>Promise</code> å°†æŠ›å‡ºå€¼å¹¶å˜æˆå¤±è´¥çŠ¶æ€ã€‚</p><p>ä¸€ä¸ª <code>async</code> å‡½æ•°å¯ä»¥åŒ…å«ä¸€ä¸ª <code>await</code> è¡¨è¾¾å¼ï¼Œå®ƒä¼šæš‚åœæ‰§è¡Œå‡½æ•°å†…çš„ä»£ç å¹¶ç­‰å¾… Promise è¿”å›ç»“æœï¼Œç„¶åç»§ç»­æ‰§è¡Œå¼‚æ­¥å‡½æ•°å¹¶è¿”å›ç»“æœã€‚</p><p>ä½ å¯ä»¥è®¤ä¸º <code>Promise</code> ä¸ Javaä¸­çš„<code>Future</code>æˆ–è€… <code>C#</code> çš„ä»»åŠ¡ã€‚</p><blockquote><p>ä½¿ç”¨ <code>async/await</code> çš„ç›®çš„æ˜¯ä¸ºäº†ç®€åŒ–ä½¿ç”¨ Promise çš„è¡Œä¸ºã€‚</p></blockquote><p>çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><script src="https://gist.github.com/zlatkov/8f74044b900d1ea4d365ca3992b50ea3.js"></script><p>åŒæ ·çš„ï¼Œå¼‚æ­¥å‡½æ•°å†…æŠ›å‡ºå¼‚å¸¸ç›¸å½“äºæ™®é€šå‡½æ•°æŠ›å‡ºä¸€ä¸ªè¢«æ‹’ç»çš„ Promiseï¼š</p><script src="https://gist.github.com/zlatkov/159929de0c27b2ddfc9c8e100ce51b43.js"></script><p><code>await</code> è¯­å¥åªæœ‰ç”¨åœ¨ <code>async</code> å‡½æ•°å†…ï¼Œå¹¶å…è®¸ä½ åœ¨ Promise è¿›è¡ŒåŒæ­¥ç­‰å¾…ã€‚å¦‚æœæˆ‘ä»¬è¦åœ¨ <code>async</code> å‡½æ•°å¤–ä½¿ç”¨ Promise, æˆ‘ä»¬ä»è¦ä½¿ç”¨ <code>then</code> æ¥æ‰§è¡Œå›è°ƒï¼š</p><script src="https://gist.github.com/zlatkov/448a79cab54330c062a13a84ebb06cf7.js"></script><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨â€œå¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼â€æ¥å®šä¹‰å¼‚æ­¥å‡½æ•°ã€‚ä¸€ä¸ªå¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼å’Œä¸€ä¸ªå¼‚æ­¥å‡½æ•°å£°æ˜å¾ˆç±»ä¼¼ï¼Œå‡ ä¹æœ‰ç›¸åŒçš„è¯­æ³•ã€‚ä»–ä»¬ä¹‹å‰ä¸»è¦çš„ä¸åŒå°±æ˜¯å‡½æ•°åã€‚å¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼å¯ä»¥çœç•¥å‡½æ•°åï¼Œåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚å¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼å¯ä»¥è¢«å½“æˆ IIFEï¼ˆè‡ªæ‰§è¡Œå‡½æ•°ï¼‰æ¥ä½¿ç”¨ï¼Œä¸€ç»å®šä¹‰å°±æ‰§è¡Œã€‚</p><p>çœ‹ä¸‹è¿™ä¸ªï¼š</p><script src="https://gist.github.com/zlatkov/0873db2fd9f5883a2e1bae414e43a5cc.js"></script><p>æ›´é‡è¦çš„åœ°ï¼Œ<code>async/await</code> åœ¨ä¸»æµæµè§ˆå™¨ä¸­çš„æ”¯æŒæƒ…å†µï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="If this compatibility is not what you are after, there are also several JS transpilers like Babel and TypeScript." data-original="https://cdn-images-1.medium.com/max/800/0*z-A-JIe5OWFtgyd2."></p><p>æœ€åï¼Œæœ€é‡è¦çš„æ˜¯ä¸è¦ç›²ç›®åœ°é€‰æ‹©â€œæœ€æ–°â€çš„å†™æ³•å»å®ç°å¼‚æ­¥å‡½æ•°ã€‚æœ¬è´¨æ˜¯è¦ç†è§£å¼‚æ­¥ javascript çš„å†…éƒ¨åŸç†ã€‚äº†è§£å®ƒä¸ºä»€ä¹ˆå¦‚æ­¤å…³é”®ï¼Œå¹¶æ·±å…¥ç†è§£ä½ çš„é€‰æ‹©çš„å†…éƒ¨åŸç†ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰ä¼˜ç¼ºç‚¹ï¼Œå°±åƒç¼–ç¨‹ä¸­çš„å…¶ä»–éƒ¨åˆ†ä¸€æ ·ã€‚</p><h1 id="ç¼–å†™é«˜å¯ç»´æŠ¤æ€§ï¼Œå¥å£®çš„ä»£ç çš„5ä¸ªæç¤º"><a href="#ç¼–å†™é«˜å¯ç»´æŠ¤æ€§ï¼Œå¥å£®çš„ä»£ç çš„5ä¸ªæç¤º" class="headerlink" title="ç¼–å†™é«˜å¯ç»´æŠ¤æ€§ï¼Œå¥å£®çš„ä»£ç çš„5ä¸ªæç¤º"></a>ç¼–å†™é«˜å¯ç»´æŠ¤æ€§ï¼Œå¥å£®çš„ä»£ç çš„5ä¸ªæç¤º</h1><h2 id="1ã€-ç®€æ´çš„ä»£ç "><a href="#1ã€-ç®€æ´çš„ä»£ç " class="headerlink" title="1ã€ ç®€æ´çš„ä»£ç "></a>1ã€ ç®€æ´çš„ä»£ç </h2><p>ä½¿ç”¨ async/await å…è®¸ä½ å†™å¾ˆå°‘çš„ä»£ç ã€‚æ¯æ¬¡ä½ ä½¿ç”¨ async/await è·³è¿‡ä¸€äº›ä¸å¿…é¡»è¦æ­¥éª¤ï¼šå†™ <code>.then</code> æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°å»å¤„ç†å›åº”ï¼Œç»™è¿”å›å€¼å‘½åã€‚ä¾‹å¦‚ï¼š</p><script src="https://gist.github.com/zlatkov/b66f922b26bb6d5fd701c7ba40ac81d7.js"></script><p>ä¸ï¼š</p><script src="https://gist.github.com/zlatkov/f506c8de2c73ba1c4c9ec78c5871816c.js"></script><h2 id="2ã€é”™è¯¯å¤„ç†"><a href="#2ã€é”™è¯¯å¤„ç†" class="headerlink" title="2ã€é”™è¯¯å¤„ç†"></a>2ã€é”™è¯¯å¤„ç†</h2><p>Async/await è®©å¤„ç†åŒæ­¥å’Œå¼‚æ­¥é”™è¯¯ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•â€”â€”å¹¿ä¸ºäººçŸ¥çš„ <code>try/catch</code>ã€‚</p><script src="https://gist.github.com/zlatkov/c5fc0706d2d37ce3bb9db75e8a991807.js"></script><p>ä¸ï¼š</p><script src="https://gist.github.com/zlatkov/1f858a186da7d19fab77893e34e46adc.js"></script><h2 id="3ã€æ¡ä»¶è¯­å¥"><a href="#3ã€æ¡ä»¶è¯­å¥" class="headerlink" title="3ã€æ¡ä»¶è¯­å¥"></a>3ã€æ¡ä»¶è¯­å¥</h2><p>ä½¿ç”¨ <code>async/await</code> å†™æ¡ä»¶å¥æ›´ç®€å•ï¼š</p><script src="https://gist.github.com/zlatkov/30e8c04023639ed289a5d107b6989269.js"></script><p>ä¸ï¼š</p><script src="https://gist.github.com/zlatkov/3dea9285325304af9a73aceb3beb6742.js"></script><h2 id="4ã€å †æ ˆå¸§"><a href="#4ã€å †æ ˆå¸§" class="headerlink" title="4ã€å †æ ˆå¸§"></a>4ã€å †æ ˆå¸§</h2><p>ä¸ <code>async/await</code> ä¸åŒï¼ŒPromise æŠ›å‡ºçš„é”™è¯¯æ ˆå¹¶æ²¡æœ‰åŒ…å«é”™è¯¯å‘ç”Ÿåœ¨å“ªé‡Œã€‚</p><script src="https://gist.github.com/zlatkov/8e728cc4d6ad1e302454e957fcce0580.js"></script><p>ä¸ï¼š</p><script src="https://gist.github.com/zlatkov/7282966e52cab3eee85794d5e8df6928.js"></script><h2 id="5ã€è°ƒè¯•"><a href="#5ã€è°ƒè¯•" class="headerlink" title="5ã€è°ƒè¯•"></a>5ã€è°ƒè¯•</h2><p>å¦‚æœä½ ä½¿ç”¨è¿‡ Promise, ä½ ä¸€å®šçŸ¥é“è°ƒè¯•å®ƒä»¬æ˜¯ä¸€ä¸ªå™©æ¢¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ä¸€ä¸ª <code>.then</code> æ‰“äº†ä¸ªæ–­ç‚¹ï¼Œå¹¶ä¸”ä½¿ç”¨è°ƒè¯•å¿«æ·é”®æ“ä½œï¼Œåƒâ€œstop-overâ€ï¼Œè°ƒè¯•å™¨å¹¶ä¸ä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ª <code>.then</code> ï¼Œå› ä¸ºå®ƒåªæ˜¯åŒæ­¥ä»£ç çš„â€œä¸€æ­¥â€ã€‚ä½¿ç”¨ <code>async/await</code> ä½ å¯ä»¥ç²¾ç¡®åœ°å®šä½åˆ°æ¯ä¸€æ­¥ <code>await</code>ï¼Œå°±å¥½åƒä»–ä»¬æ˜¯æ­£å¸¸çš„åŒæ­¥å‡½æ•°ä¸€æ ·ã€‚</p><p>ä¹¦å†™å¼‚æ­¥å‡½æ•°ä¸ä»…å¯¹åº”ç”¨ç¨‹åºå¾ˆé‡è¦ï¼Œå¯¹ç±»åº“ä¹ŸåŒæ ·å¦‚æ­¤ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š <a href="https://www.sessionstack.com/?utm_source=medium&amp;utm_medium=blog&amp;utm_content=Post-4-eventloop-outro" target="_blank" rel="noopener">Sessionstak</a> ç±»è®°å½•äº†ç½‘é¡µä¸Šå‘ç”Ÿçš„æ‰€æœ‰äº‹æƒ…ã€‚æ‰€æœ‰ DOM æ“ä½œï¼Œç”¨æˆ·äº¤äº’ï¼Œjavascript å¼‚å¸¸ï¼Œå †æ ˆè·Ÿè¸ªï¼Œå¤±è´¥çš„ç½‘ç»œè¯·æ±‚ï¼Œä»¥åŠè°ƒè¯•ä¿¡æ¯ã€‚</p><p>è¿™ä¸€åˆ‡éƒ½å‘ç”Ÿåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å´ä¸å½±å“ç”¨æˆ·ä½“éªŒã€‚æˆ‘ä»¬å¿…é¡»é«˜åº¦ä¼˜åŒ–æˆ‘ä»¬çš„ä»£ç ï¼Œè®©å®ƒä»¬å°½å¯èƒ½åœ°å¼‚æ­¥ï¼Œè¿™æ ·å°±å¯ä»¥å¢åŠ äº‹ä»¶å¾ªç¯å¤„ç†äº‹ä»¶çš„æ•°é‡ã€‚</p><p>ä¹Ÿä¸æ­¢æ˜¯ç±»åº“ï¼Œå½“ä½ åœ¨ SessionStack é‡æ’­ç”¨æˆ·çš„ä¼šè¯æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å‘ç”Ÿé—®é¢˜æ—¶ï¼Œå°†ç”¨æˆ·æµè§ˆå™¨çš„çŠ¶æ€é‡ç°å‡ºæ¥ï¼Œæˆ‘ä»¬å¿…é¡»é‡å»ºæ•´ä¸ªçŠ¶æ€ï¼Œå…è®¸ä½ åœ¨æ—¶é—´è½´ä¸Šå‘åæˆ–å‘å‰è·³è·ƒã€‚ä¸ºäº†è®©è¿™æˆä¸ºå¯èƒ½ï¼Œæˆ‘ä»¬å¤§é‡ä½¿ç”¨äº†å¼‚æ­¥javascriptæä¾›çš„æœºä¼šã€‚</p><p>è¿™é‡Œæœ‰ä¸€ä¸ª<a href="https://www.sessionstack.com/?utm_source=medium&amp;utm_medium=blog&amp;utm_content=Post-4-eventloop-GetStarted" target="_blank" rel="noopener">å…è´¹çš„è®¡åˆ’</a>è®©ä½ æ¥ä½“éªŒä¸€ä¸‹ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/0*xSEaWHGqqlcF8g5H." data-original="https://cdn-images-1.medium.com/max/800/0*xSEaWHGqqlcF8g5H."></p><p>å‚è€ƒï¼š</p><ul><li><a href="https://github.com/getify/You-Dont-Know-JS/blob/master/async%20%26%20performance/ch2.md" target="_blank" rel="noopener">https://github.com/getify/You-Dont-Know-JS/blob/master/async%20%26%20performance/ch2.md</a></li><li><a href="https://github.com/getify/You-Dont-Know-JS/blob/master/async%20%26%20performance/ch3.md" target="_blank" rel="noopener">https://github.com/getify/You-Dont-Know-JS/blob/master/async%20%26%20performance/ch3.md</a></li><li><a href="http://nikgrozev.com/2017/10/01/async-await/" target="_blank" rel="noopener">http://nikgrozev.com/2017/10/01/async-await/</a></li></ul><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;javascript-äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼&quot;&gt;&lt;a href=&quot;#javascript-äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼&quot; class=&quot;headerlink&quot; title=&quot;javascript äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼&quot;&gt;&lt;/a&gt;javascript äº‹ä»¶å¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼&lt;/h1&gt;&lt;p&gt;è¿™æ¬¡æˆ‘ä»¬å°†é€šè¿‡å›é¡¾åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­ç¼–ç¨‹çš„ç¼ºç‚¹æ¥æ‰©å±•å…ˆå‰çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä»¥åŠå¦‚ä½•å…‹æœå®ƒæ¥å»ºç«‹ä¸€ä¸ªä»¤äººæƒŠå¹çš„ javascript UIsã€‚åƒä»¥å¾€ä¸€æ ·ï¼Œåœ¨æ–‡ç« çš„æœ€åï¼Œæˆ‘ä¼šåˆ†äº«ä½¿ç”¨ async/await å†™ç®€æ´ä»£ç çš„ 5 ä¸ªå°è´´å£«ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="tutorial" scheme="http://robin-front.github.io/tags/tutorial/"/>
    
      <category term="web development" scheme="http://robin-front.github.io/tags/web-development/"/>
    
      <category term="programming" scheme="http://robin-front.github.io/tags/programming/"/>
    
      <category term="asynchronous" scheme="http://robin-front.github.io/tags/asynchronous/"/>
    
      <category term="events loop" scheme="http://robin-front.github.io/tags/events-loop/"/>
    
      <category term="promise" scheme="http://robin-front.github.io/tags/promise/"/>
    
      <category term="async await" scheme="http://robin-front.github.io/tags/async-await/"/>
    
  </entry>
  
  <entry>
    <title>ä½ å¯èƒ½å¹¶ä¸éœ€è¦ redux</title>
    <link href="http://robin-front.github.io/2017/10/25/you-might-not-need-redux/"/>
    <id>http://robin-front.github.io/2017/10/25/you-might-not-need-redux/</id>
    <published>2017-10-25T09:04:54.000Z</published>
    <updated>2017-10-25T09:04:54.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä½ å¯èƒ½å¹¶ä¸éœ€è¦-redux"><a href="#ä½ å¯èƒ½å¹¶ä¸éœ€è¦-redux" class="headerlink" title="ä½ å¯èƒ½å¹¶ä¸éœ€è¦ redux"></a>ä½ å¯èƒ½å¹¶ä¸éœ€è¦ redux</h1><p><strong>äººä»¬å¸¸å¸¸åœ¨çœŸæ­£éœ€è¦ç”¨åˆ° redux ä¹‹å‰å°±é€‰æ‹©äº†å®ƒã€‚</strong> â€œå¦‚æœæˆ‘ä»¬çš„åº”ç”¨æ²¡æœ‰ä½¿ç”¨ reduxï¼Œå˜å¾—ä¸å¥½æ‰©å±•æ€ä¹ˆåŠï¼Ÿâ€ åæ¥ï¼Œå¼€å‘è€…ä»¬åˆéƒ½çš±ç€çœ‰å¤´æŒ‡å¤´ä»–ä»¬çš„ä»£ç é—´æ¥åœ°è¯„è®º redux.â€œä¸ºä»€ä¹ˆå®ç°ä¸€ä¸ªå°åŠŸèƒ½éœ€è¦æ›´æ”¹ä¸‰ä¸ªæ–‡ä»¶ï¼Ÿâ€ ä¸ºä»€ä¹ˆä¸€å®šè¦ç”¨ redux å‘¢!<a id="more"></a></p><p>å¤§å®¶ç—›è‹¦åœ°æŒ‡è´£ <code>redux</code>, <code>react</code>, å‡½æ•°å¼ç¼–ç¨‹ã€ ä¸å˜æ€§ç­‰è¿™äº›ä¸œè¥¿ï¼Œæˆ‘èƒ½ç†è§£ä»–ä»¬ã€‚æˆ‘ä»¬å¾ˆè‡ªç„¶åœ°ä¼šæ‹¿ redux å’Œä¸éœ€è¦â€˜æŒ‰æ¨¡æ¿â€™æ¥æ›´æ–° state çš„å®ç°æ–¹å¼è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å¾—å‡º redux åªä¼šè®©äº‹æƒ…å˜å¤æ‚çš„ç»“è®ºã€‚æŸç§ç¨‹åº¦ä¸Šçœ‹ï¼Œredux æ˜¯è¢«è®¾è®¡æˆè¿™æ ·çš„ã€‚</p><p>redux åšäº†ä¸€ä¸ªæƒè¡¡ï¼Œå®ƒè¦æ±‚ä½ ï¼š</p><ul><li>å°†åº”ç”¨çš„çŠ¶æ€æŠ½è±¡æˆç®€å•å¯¹è±¡æˆ–æ•°ç»„ã€‚</li><li>å°†ç³»ç»Ÿçš„å˜åŒ–æŠ½è±¡æˆç®€å•å¯¹è±¡ã€‚</li><li>å°†å¤„ç†é€»è¾‘æŠ½è±¡æˆçº¯å‡½æ•°ã€‚</li></ul><p>ä¸ç®¡æ˜¯ä¸æ˜¯åº”ç”¨åœ¨ react åº”ç”¨ç¨‹åºä¸Šï¼Œè¿™äº›é™åˆ¶éƒ½æ˜¯å¿…éœ€çš„ã€‚äº‹å®ä¸Šï¼Œè¿™äº›éƒ½æ˜¯å¾ˆä¸¥æ ¼çš„çº¦æŸã€‚å°±ç®—åªæ˜¯åœ¨ä½ åº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ä¸­ä½¿ç”¨ï¼Œä¹Ÿåº”è¯¥è®¤çœŸè€ƒè™‘å®ƒã€‚</p><p>æœ‰äººä¼šé—®ï¼Œä½ æœ‰å……åˆ†çš„ç†ç”±è§£é‡Šä¸ºä»€ä¹ˆè¦åšè¿™äº›é™åˆ¶å—ï¼Ÿ</p><p>è¿™äº›é™åˆ¶å¯¹æˆ‘å¾ˆæœ‰å¸å¼•åŠ›ï¼Œå› ä¸ºå®ƒä»¬è®©æˆ‘çš„åº”ç”¨æ‹¥æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ul><li><a href="https://egghead.io/lessons/javascript-redux-persisting-the-state-to-the-local-storage?course=building-react-applications-with-idiomatic-redux" target="_blank" rel="noopener">å°† state å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå¹¶ç”¨å®ƒå¯åŠ¨ï¼Œå¼€ç®±å³ç”¨</a></li><li><a href="http://redux.js.org/docs/recipes/ServerRendering.html" target="_blank" rel="noopener">åœ¨æœåŠ¡ç«¯é¢„æ¸²æŸ“ stateï¼Œå¹¶éš html å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œä»å®ƒå¯åŠ¨ï¼Œå¼€ç®±å³ç”¨</a></li><li><a href="https://github.com/dtschust/redux-bug-reporter" target="_blank" rel="noopener">åºåˆ—åŒ–ç”¨æˆ·äº¤äº’å¹¶è§¦å‘å®ƒï¼Œä»¥åŠè¿›è¡ŒçŠ¶æ€å¿«ç…§ï¼Œè‡ªåŠ¨ bugs ä¸ŠæŠ¥ï¼Œä»¥ä¾¿è®©å¼€å‘è€…é‡ç° errors</a></li><li><a href="https://github.com/philholden/redux-swarmlog" target="_blank" rel="noopener">é€šè¿‡ç½‘ç»œä¼ é€’ action å¯¹è±¡ï¼Œè€Œä¸ä¼šå¯¹å†™ä»£ç çš„æ–¹å¼äº§ç”Ÿå¤§çš„å½±å“</a></li><li><a href="http://redux.js.org/docs/recipes/ImplementingUndoHistory.html" target="_blank" rel="noopener">ä¿æŒé‡åšå†å²å’Œå®ç°å¯é¢„æµ‹çš„å˜åŒ–ï¼Œè€Œä¸ä¼šå¯¹å†™æ³•äº§ç”Ÿå‰§å¤§çš„å½±å“</a></li><li><a href="https://github.com/gaearon/redux-devtools" target="_blank" rel="noopener">å¼€å‘ç¯å¢ƒä¸­å¯ä»¥éšæ„ç©¿æ¢­åœ¨å†å²çš„å„ä¸ªçŠ¶æ€ä¸­ï¼Œå¹¶åœ¨ä»£ç æ›´æ”¹æ—¶æ ¹æ®äº¤äº’å†å²é‡æ–°è®¡ç®—å½“å‰çŠ¶æ€ï¼Œä¸€ç§ TDD é©±åŠ¨</a></li><li><a href="https://github.com/romseguy/redux-devtools-chart-monitor" target="_blank" rel="noopener">ä¸ºå¼€å‘å·¥å…·æä¾›å…¨é¢çš„æ£€æµ‹å’Œæ§åˆ¶èƒ½åŠ›ï¼Œä»¥ä¾¿äº§å“å¼€å‘è€…ä¸ºä»–ä»¬çš„ app æ„å»ºè‡ªå®šä¹‰å¼€å‘å·¥å…·</a></li><li><a href="https://youtu.be/gvVpSezT5_M?t=11m51s" target="_blank" rel="noopener">å½“å¤ç”¨å¤§éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘çš„åŒæ—¶ï¼Œä¹Ÿæä¾›å¤‡ç”¨ UI</a></li></ul><p>å¦‚æœä½ æ­£åœ¨å¼€å‘<a href="https://hyperterm.org/" target="_blank" rel="noopener">å¯æ‰©å±•çš„ terminal</a>, <a href="https://hacks.mozilla.org/2016/09/introducing-debugger-html/" target="_blank" rel="noopener">javascript è°ƒè¯•å™¨</a>, æˆ–<a href="https://twitter.com/necolas/status/727538799966715904" target="_blank" rel="noopener">æŸäº›ç±»å‹çš„ webapp</a>, redux å¯èƒ½å¾ˆå€¼å¾—ä¸€è¯•ï¼Œæˆ–è€…è‡³å°‘å€Ÿé‰´å®ƒçš„ä¸€äº›æ€æƒ³ï¼ˆé¡ºä¾¿æä¸€ä¸‹ï¼Œè¿™äº›å¹¶<a href="https://github.com/evancz/elm-architecture-tutorial" target="_blank" rel="noopener">ä¸æ˜¯</a> <a href="https://github.com/omcljs/om" target="_blank" rel="noopener">æ–°äº‹ç‰©</a>ï¼‰ã€‚</p><p><strong>ä½†æ˜¯ï¼Œå¦‚æœä½ åªæ˜¯åœ¨å­¦ä¹  react, é‚£ä¹ˆä¸è¦æŠŠ redux å½“æˆä½ çš„é¦–é€‰ã€‚</strong></p><p>ç›¸åï¼Œå­¦ä¼š <a href="https://facebook.github.io/react/docs/thinking-in-react.html" target="_blank" rel="noopener">æ€è€ƒ react</a>, å¦‚æœä½ å‘ç°ä½ çœŸçš„éœ€è¦å®ƒï¼Œæˆ–è€…ä½ æƒ³å°è¯•ä¸€äº›æ–°ä¸œè¥¿ï¼Œé‚£å°±é‡æ–°è€ƒè™‘ redux å§ã€‚ä½†æ˜¯ä¸€å®šè¦è°¨æ…å¯¹å¾…å®ƒï¼Œå°±åƒå¯¹å¾…å›ºæ‰§å·²è§çš„å·¥å…·ä¸€æ ·ã€‚</p><p><strong>å¦‚æœä½ å¯¹ redux çš„æ–¹å¼æ„Ÿåˆ°å‹åŠ›ã€‚è¿™æ˜¯ä¸€ä¸ªä¿¡å·ï¼Œå¯èƒ½ä½ çš„é˜Ÿå‹å¤ªè®¤çœŸäº†ã€‚</strong> å®ƒåªæ˜¯ä½ å·¥å…·ç®±é‡Œçš„ä¸€ä¸ªå·¥å…·ï¼Œä¸€ä¸ª<a href="https://www.youtube.com/watch?v=uvAXVMwHJXU" target="_blank" rel="noopener">ç–¯ç‹‚</a> çš„<a href="https://www.youtube.com/watch?v=xsSnOQynTHs" target="_blank" rel="noopener">å®éªŒ</a>ã€‚</p><p><strong>æœ€åï¼Œä¸è¦å¿˜è®°ï¼Œä½ å¯ä»¥ä¸ç”¨ redux,è€Œå®ç° redux çš„æ€æƒ³ã€‚</strong></p><p>ä¸¾ä¸ªä¾‹å­ï¼Œè€ƒè™‘ä¸€ä¸ªå¸¦æœ‰ local state çš„ react ç»„ä»¶:</p><script src="https://gist.github.com/gaearon/a9bbb73d57b6e4cc17d7b50807b62f9a.js"></script><p>çœ‹ä¸Šå»å¾ˆå¥½ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œå®ƒæ²¡æœ‰è¾¾åˆ°é«˜åº¦å¤ç”¨ã€‚</p><p><strong>ä½†æ˜¯ï¼Œè¿™æ ·ä½¿ç”¨ Local state å°±å¾ˆå¥½ã€‚</strong></p><p>æƒè¡¡ä¹‹ä¸‹ï¼Œredux æä¾›è§£è€¦ï¼Œå°†â€œå‘ç”Ÿäº†ä»€ä¹ˆäº¤äº’â€ä¸â€œæ•°æ®å¦‚ä½•æ”¹å˜â€è§£è€¦ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå¯ä»¥ä»æˆ‘ä»¬çš„ç»„ä»¶ä¸­æå–å‡ºä¸€ä¸ª reducer:</p><script src="https://gist.github.com/gaearon/64e2c4adce2b4918c96c3db2b44d8f68.js"></script><p>æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰è¿è¡Œ npm install å´åº”ç”¨äº† redux ! å“‡å“¦ï¼</p><p>ä½ çš„çŠ¶æ€ç»„ä»¶æ˜¯å¦ä¹Ÿéœ€è¦è¿™æ ·å†™å‘¢ï¼Ÿå¯èƒ½ä¸éœ€è¦ã€‚é™¤éä½ æœ‰è®¡åˆ’åœ°ä»è¿™ç§è§£è€¦æ–¹å¼ä¸­è·ç›Šã€‚æœ‰è®¡åˆ’æ˜¯æˆ‘ä»¬çš„ä¸€ç§è¯´æ³•ï¼Œè¿™æ˜¯å…³é”®ã€‚</p><p><a href="http://redux.js.org/" target="_blank" rel="noopener">redux åº“</a>æœ¬èº«åªæ˜¯â€œå®‰è£…â€ reducer å’Œå•ä¸ªå…¨å±€ store å¯¹è±¡çš„å·¥å…·é›†ã€‚ä½ å¯ä»¥åªä½¿ç”¨éƒ¨åˆ†æˆ–è€…å…¨éƒ¨åŠŸèƒ½ï¼Œè¿™å–å†³äºä½ ã€‚</p><p><strong>ä½†ï¼Œå¦‚æœä½ ä»˜å‡ºäº†ä»€ä¹ˆï¼Œä¸€å®šè¦ç¡®ä¿ä½ æœ‰æ‰€æ”¶è·ã€‚</strong></p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä½ å¯èƒ½å¹¶ä¸éœ€è¦-redux&quot;&gt;&lt;a href=&quot;#ä½ å¯èƒ½å¹¶ä¸éœ€è¦-redux&quot; class=&quot;headerlink&quot; title=&quot;ä½ å¯èƒ½å¹¶ä¸éœ€è¦ redux&quot;&gt;&lt;/a&gt;ä½ å¯èƒ½å¹¶ä¸éœ€è¦ redux&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;äººä»¬å¸¸å¸¸åœ¨çœŸæ­£éœ€è¦ç”¨åˆ° redux ä¹‹å‰å°±é€‰æ‹©äº†å®ƒã€‚&lt;/strong&gt; â€œå¦‚æœæˆ‘ä»¬çš„åº”ç”¨æ²¡æœ‰ä½¿ç”¨ reduxï¼Œå˜å¾—ä¸å¥½æ‰©å±•æ€ä¹ˆåŠï¼Ÿâ€ åæ¥ï¼Œå¼€å‘è€…ä»¬åˆéƒ½çš±ç€çœ‰å¤´æŒ‡å¤´ä»–ä»¬çš„ä»£ç é—´æ¥åœ°è¯„è®º redux.â€œä¸ºä»€ä¹ˆå®ç°ä¸€ä¸ªå°åŠŸèƒ½éœ€è¦æ›´æ”¹ä¸‰ä¸ªæ–‡ä»¶ï¼Ÿâ€ ä¸ºä»€ä¹ˆä¸€å®šè¦ç”¨ redux å‘¢!
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="react" scheme="http://robin-front.github.io/tags/react/"/>
    
      <category term="redux" scheme="http://robin-front.github.io/tags/redux/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥ç†è§£ ios11 webview çš„ viewport</title>
    <link href="http://robin-front.github.io/2017/09/21/Understanding-the-WebView-Viewport-in-iOS-11/"/>
    <id>http://robin-front.github.io/2017/09/21/Understanding-the-WebView-Viewport-in-iOS-11/</id>
    <published>2017-09-21T03:34:30.000Z</published>
    <updated>2017-09-21T03:34:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ·±å…¥ç†è§£-ios11-webview-çš„-viewport"><a href="#æ·±å…¥ç†è§£-ios11-webview-çš„-viewport" class="headerlink" title="æ·±å…¥ç†è§£ ios11 webview çš„ viewport"></a>æ·±å…¥ç†è§£ ios11 webview çš„ viewport</h1><p>ios11 å¸¦æ¥äº†ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œå‡­ç›´è§‰ï¼Œå›´ç»•çŠ¶æ€æ åŒºåŸŸçš„å±•ç°å¯¹äºç¨‹åºå‘˜ä½¿ç”¨çš„åƒ Apache Cordova æˆ– Ionic è¿™æ ·çš„å·¥å…·æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚å°¤å…¶æ˜¯ï¼Œè¿™ä¸ªæ”¹åŠ¨å½±å“åˆ°æ‰€æœ‰ä¸º ios11 æ„å»ºçš„ã€åŸºäº web çš„ã€ä½¿ç”¨äº†å›ºå®šæ ‡é¢˜æ çš„ app ä¹‹ä¸­ã€‚è¿™ç¯‡æ–‡ç« å¸®åŠ©ä½ ç†è§£ ios11 webview çš„ viewportã€‚</p><p><strong>æ³¨ï¼š ç°æœ‰çš„ app å¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œï¼Œå› ä¸ºåŸæœ‰çš„ viewport è¡¨ç°å¹¶æ²¡æœ‰è¢«æ”¹å˜ã€‚è¿™ä¸ªæ”¹å˜åªå½±å“é‚£äº›ä½¿ç”¨ xcode9 æ¥ä¸º ios11 æ„å»ºçš„åº”ç”¨ã€‚</strong></p><p>ä¸ºäº†ç†è§£è¿™ä¸ªæ”¹åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹èƒŒæ™¯çŸ¥è¯†ã€‚<a id="more"></a></p><h2 id="çŠ¶æ€æ å’Œå®‰å…¨åŒºåŸŸ"><a href="#çŠ¶æ€æ å’Œå®‰å…¨åŒºåŸŸ" class="headerlink" title="çŠ¶æ€æ å’Œå®‰å…¨åŒºåŸŸ"></a>çŠ¶æ€æ å’Œå®‰å…¨åŒºåŸŸ</h2><p>åœ¨ ios çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼ŒçŠ¶æ€æ æ˜¯å±å¹•é¡¶éƒ¨çš„ä¸å¯è§¦æ‘¸çš„é»‘è‰²é•¿æ¡ã€‚å®ƒæ˜¯ç³»ç»Ÿ UI çš„ä¸€éƒ¨åˆ†ï¼Œè€Œ app è¿è¡Œåœ¨å®ƒçš„ä¸‹é¢ã€‚</p><p>éšç€ ios7 çš„å‘å¸ƒï¼Œä¸€åˆ‡å‘ç”Ÿäº†æ”¹å˜ã€‚å®ƒå˜æˆäº†ä¸€ä¸ªé€æ˜çš„çŠ¶æ€æ ï¼Œä»è€Œæ˜¾ç¤ºäº† app å¯¼èˆªæ çš„é¢œè‰²ã€‚å¯¹äºåƒ Cordova è¿™æ ·æ˜¾ç¤ºåœ¨ webview çš„ app, æ„å‘³ç€é€šå¸¸éœ€è¦æ£€æµ‹æ˜¯å¦ ios å¹¶æ·»åŠ  <code>padding-top: 20px</code> åˆ°å›ºå®šçš„å¤´éƒ¨å¯¼èˆª, ä»¥ä¾¿æ­£ç¡®å¡«å……é‚£éƒ¨åˆ†ç©ºé—´ã€‚</p><p>åæ¥å‘å¸ƒçš„è¾ƒæ–°ç‰ˆæœ¬çš„ ios æ·»åŠ äº†ä¸€äº›å°ä¿®è®¢ã€‚åŒ…å«äº†ä¸€äº›æ–°åŠŸèƒ½ï¼Œæ¯”å¦‚å½“æœ‰ç”µè¯å‘¼å…¥æˆ–åœ¨åå°ä½¿ç”¨å®šä½åŠŸèƒ½æ—¶é¡¶éƒ¨ä¼šå±•ç¤ºé¢å¤–çš„çŠ¶æ€æ ã€‚</p><p>åœ¨åŸç”Ÿåº”ç”¨æ–¹é¢ï¼Œå­˜åœ¨å¤§é‡çš„å¯¼èˆªæ å’Œè‡ªåŠ¨å¸ƒå±€æŒ‡å—ã€‚ä¼šæœ‰ä¸€äº›å¸ƒå±€æŒ‡ç¤ºåœ¨å±å¹•çš„é¡¶éƒ¨æˆ–åº•éƒ¨ä»¥ä¾¿è‡ªåŠ¨è°ƒæ•´é«˜åº¦ï¼Œè®©çŠ¶æ€æ ä¸ä¼šé®ä½åº”ç”¨ã€‚å¦‚æœåœ¨é¡¶éƒ¨è®¾ç½®äº† UINavigationBarï¼Œ ios ä¼šè‡ªåŠ¨åœ¨çŠ¶æ€æ æ‹“å±•å®ƒçš„é¢œè‰²ã€‚å¯¹äº webï¼Œå¾ˆä¸å¹¸ï¼Œæ²¡æœ‰ç­‰ä»·çš„åŠæ³•ã€‚</p><h2 id="iOS11-çš„æ”¹å˜"><a href="#iOS11-çš„æ”¹å˜" class="headerlink" title="iOS11 çš„æ”¹å˜"></a>iOS11 çš„æ”¹å˜</h2><p><img src="/js/lazyload-plugin/loading.svg" alt="The default viewport behaviour in iOS 11 on an iPhone 8." data-original="https://ayogo.com/wp-content/uploads/2017/09/iphone8-viewport-auto-crop-zop.png"></p><p>ios11 å’Œå…ˆå‰ç‰ˆæœ¬çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œ webview å†…å®¹ç°åœ¨é‡è§†å®‰å…¨åŒºåŸŸäº†ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœè®¾ç½®å¤´éƒ¨æ  <code>top: 0</code>, å®ƒä¼šæ¸²æŸ“åœ¨å±å¹•é¡¶éƒ¨çš„<code>20px</code>ä¹‹ä¸‹ï¼Œä¹Ÿå°±æ˜¯çŠ¶æ€æ ä¸‹é¢ã€‚å½“å‘ä¸‹æµè§ˆæ—¶ï¼Œä¼šç§»åˆ°çŠ¶æ€æ åé¢ã€‚å½“å‘ä¸Šæµè§ˆæ—¶ï¼Œåˆä¼šç§»åŠ¨çŠ¶æ€æ ä¸‹é¢ä¸çŠ¶æ€æ éƒ¨å¯¹é½ã€‚ï¼ˆç•™ä¸‹å°´å°¬çš„20åƒç´ ç©ºç™½ï¼‰</p><p>å¯ä»¥çœ‹çœ‹ä¸‹é¢å‰ªè¾‘çš„è§†é¢‘ä¸­äº†è§£åˆ°æœ‰å¤šä¹ˆç³Ÿç³•ï¼š</p><video src="https://cdn.css-tricks.com/wp-content/uploads/2017/09/ios11-viewport.mp4" width="300" height="330" controls name="fitvid0"></video><h2 id="ä¸ºä»€ä¹ˆè‹¹æœå…¬å¸ä¼šæ”¹æˆè¿™ä¸ªæ ·å­"><a href="#ä¸ºä»€ä¹ˆè‹¹æœå…¬å¸ä¼šæ”¹æˆè¿™ä¸ªæ ·å­" class="headerlink" title="ä¸ºä»€ä¹ˆè‹¹æœå…¬å¸ä¼šæ”¹æˆè¿™ä¸ªæ ·å­"></a>ä¸ºä»€ä¹ˆè‹¹æœå…¬å¸ä¼šæ”¹æˆè¿™ä¸ªæ ·å­</h2><p>å¦‚æœä½ çœ‹è¿‡ iPhone X çš„è®¾è®¡ï¼Œå°±çŸ¥é“å®ƒè¿™æ ·æ”¹åŠ¨æ˜¯æœ‰é“ç†çš„ï¼š iPhone X çš„å±å¹•é¡¶éƒ¨æœ‰ä¸ªä¸ºæ‘„åƒå¤´å’Œè¯ç­’ç•™å‡ºçš„ä¸è§„åˆ™åŒºåŸŸã€‚å¦‚æœçœŸçš„æ¸²æŸ“åˆ°å±å¹•é¡¶éƒ¨ï¼Œå°±ä¼šè¢«éº¦å…‹é£æŒ¡ä½ã€‚</p><p>é€šè¿‡å¯¹é½çŠ¶æ€æ åº•éƒ¨ï¼Œå¯ä»¥ç¡®ä¿å¤´éƒ¨æ å¯ä»¥ä¸€ç›´è¢«è®¿é—®ã€‚</p><p>é…·ï¼â€¦é™¤äº†ç°åœ¨ app ä¸Šé¢æ»‘åŠ¨å†…å®¹æ—¶åœ¨çŠ¶æ€æ åº•ä¸‹ç•™ä¸‹çš„å°´å°¬çš„ç©ºç™½ã€‚</p><h2 id="iOS11-è§£å†³æ–¹æ¡ˆ"><a href="#iOS11-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="iOS11 è§£å†³æ–¹æ¡ˆ"></a>iOS11 è§£å†³æ–¹æ¡ˆ</h2><p>å€¼å¾—åº†å¹¸çš„æ˜¯ï¼ŒApple ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªé€šè¿‡è®¾ç½® viewport meta æ ‡ç­¾çš„è§£å†³æ–¹æ¡ˆã€‚æ›´å¹¸è¿çš„æ˜¯ï¼Œå®ƒè¿˜å‘ä¸‹å…¼å®¹æ—§çš„ï¼Œè¿‡æœŸçš„ UIWebViewã€‚</p><p>æˆ‘ä»¬æ­£åœ¨æ‰¾çš„ viewport é€‰é¡¹å°±æ˜¯ <code>viewport-fit</code>,å®ƒæœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼š</p><ul><li>containï¼š è¿™æ„å‘³ç€ iOS11 ä¸‹ï¼Œå›ºå®šæ ä¼šè¢«åŒ…å«åœ¨å®‰å…¨åŒºåŸŸå†…ã€‚</li><li>coverï¼š è¿™æ„å‘³ç€å›ºå®šæ æ˜¯ç›¸å¯¹ viewport å›ºå®šçš„ï¼Œå°±ç®—ä¼šè¢«ç«‹å¤§çŠ¶æ€æ é®è”½ã€‚è¿™å°±å›åˆ°äº† iOS10 çš„è¡¨ç°ã€‚</li><li>autoï¼š è¿™å’Œ contain é€‰é¡¹çš„è¡¨ç°æ˜¯ä¸€æ ·çš„ã€‚</li></ul><p>æ‰€ä»¥ä¸ºäº†æ¢å¤åˆ°å›ºå®šåœ¨å±å¹•çš„æœ€é¡¶ç«¯ï¼Œå°±åƒ iOS10 ä¸€æ ·åœ¨çŠ¶æ€æ ä¸‹é¢ã€‚å¯ä»¥æ·»åŠ  <code>viewport-fit=cover</code> åˆ° viewport meta æ ‡ç­¾ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="" data-original="https://ayogo.com/wp-content/uploads/2017/09/iphone8-viewport-cover-crop-zop.png"></p><h2 id="iPhone-X"><a href="#iPhone-X" class="headerlink" title="iPhone X"></a>iPhone X</h2><p>ä½† iPhone X çš„å°åˆ˜æµ·æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªçŠ¶æ€æ ä¸å†æ˜¯ <code>20px</code> é«˜ï¼Œå¹¶ä¸”å› ä¸ºé‡Œé¢æœ‰æ‘„åƒå¤´å’Œæ‰¬å£°å™¨ï¼Œå¤´éƒ¨æ ä¼šå®Œå…¨æ— æ³•è®¿é—®ã€‚åŒæ ·è¦æ³¨æ„å›ºå®šåœ¨å±å¹•åº•éƒ¨çš„é¡µè„šï¼Œå®ƒä¼šè¢«éº¦å…‹é£é®ä½ã€‚</p><p><strong>æ³¨ï¼šå¦‚æœæœ‰å¯åŠ¨è„šæœ¬ï¼Œåº”ç”¨å°†åªä¼šè¿è¡Œåœ¨ iPhone X çš„å…¨å±å¹•ä¸Šã€‚ç°æœ‰çš„ app ä¼šåœ¨é¡¶éƒ¨å’Œåº•éƒ¨æœ‰é»‘è‰²åŒºåŸŸã€‚</strong></p><p><img src="/js/lazyload-plugin/loading.svg" alt="" data-original="https://ayogo.com/wp-content/uploads/2017/09/iphonex-viewport-cover-crop-zop-300x264.png"></p><p>å¹¸è¿çš„æ˜¯ï¼ŒApple ç»™å‡ºäº†ä¸€ä¸ªå…³äºå®‰å…¨åŒºåŸŸçš„ css æŒ‡å—ã€‚ä»–ä»¬æ·»åŠ ä¸€ä¸ªç±»ä¼¼ css å˜é‡ï¼Œå«åš css å¸¸æ•°ã€‚å¯ä»¥æŠŠå®ƒçœ‹åšæ˜¯ç³»ç»Ÿçš„ css å˜é‡å¹¶ä¸”ä¸å¯è¦†ç›–ã€‚å¯ä»¥åœ¨ css ä¸­é€šè¿‡<code>constant()</code> å‡½æ•°æ¥è°ƒç”¨å®ƒä»¬ï¼Œå¹¶ä¸”å·²å‘ css æ ‡å‡†åŒ–å·¥ä½œå°ç»„ææ¡ˆã€‚</p><p>è¿™å››ä¸ªå¸ƒå±€å¸¸é‡æ˜¯ï¼š</p><ul><li>constant(safe-area-inset-top): viewport é¡¶éƒ¨æ’å…¥çš„å®‰å…¨åŒºåŸŸï¼ˆä½¿ç”¨ css åƒç´ ï¼‰</li><li>constant(safe-area-inset-bottom): viewport åº•éƒ¨æ’å…¥çš„å®‰å…¨åŒºåŸŸï¼ˆä½¿ç”¨ css åƒç´ ï¼‰</li><li>constant(safe-area-inset-left): viewport å·¦è¾¹æ’å…¥çš„å®‰å…¨åŒºåŸŸï¼ˆä½¿ç”¨ css åƒç´ ï¼‰</li><li>constant(safe-area-inset-right): viewport å³è¾¹æ’å…¥çš„å®‰å…¨åŒºåŸŸï¼ˆä½¿ç”¨ css åƒç´ ï¼‰</li></ul><p>è¿™æ˜¯ Apple ç»™æˆ‘ä»¬çš„æœ€åä¸€ä¸ªç¤¼ç‰©ï¼Œä¹Ÿæ˜¯å‘ä¸‹å…¼å®¹çš„ã€‚</p><h2 id="css-constants-çš„ä¾‹å­"><a href="#css-constants-çš„ä¾‹å­" class="headerlink" title="css constants çš„ä¾‹å­"></a>css constants çš„ä¾‹å­</h2><p>å‡è®¾æœ‰ä¸€ä¸ªå¤´éƒ¨å›ºå®šæ ï¼Œç°åœ¨ iOS10 ä¸‹çš„ css å¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">header</span> &#123;</div><div class="line">    <span class="attribute">position</span>: fixed;</div><div class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">44px</span>;</div><div class="line"></div><div class="line">    <span class="attribute">padding-top</span>: <span class="number">20px</span>; <span class="comment">/* Status bar height */</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸ºäº†è°ƒæ•´è‡ªé€‚åº” iPhone X å’Œ iOS11 è®¾å¤‡ï¼Œä¼šæ·»åŠ  <code>viewport-fit=cover</code> é€‰é¡¹åˆ° viewport meta æ ‡ç­¾ä¸Šï¼Œå¹¶ä¸”æ›´æ”¹ cssï¼Œ å¼•ç”¨ css constantã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">header</span> &#123;</div><div class="line">    <span class="comment">/* ... */</span></div><div class="line"></div><div class="line">    <span class="comment">/* Status bar height on iOS 10 */</span></div><div class="line">    <span class="attribute">padding-top</span>: <span class="number">20px</span>;</div><div class="line"></div><div class="line">    <span class="comment">/* Status bar height on iOS 11+ */</span></div><div class="line">    <span class="attribute">padding-top</span>: <span class="built_in">constant</span>(safe-area-inset-top);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>é‡è¦çš„æ˜¯ï¼Œè¦ä¿ç•™å›é€€å€¼ï¼Œå› ä¸ºæ—§è®¾å¤‡ä¸èƒ½è§£é‡Š css <code>constant()</code> è¯­æ³•ã€‚åˆ«å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨ css <code>calc()</code> è¡¨è¾¾å¼ä¸­ä½¿ç”¨ constants.</p><p><img src="/js/lazyload-plugin/loading.svg" alt="" data-original="https://ayogo.com/wp-content/uploads/2017/09/iphonex-viewport-constants-crop-zop-300x264.png"></p><p>è®°ä½ï¼Œä½ ä¹Ÿä¼šæƒ³è¦åœ¨å±å¹•åº•éƒ¨åšè¿™ä»¶äº‹çš„ã€‚</p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;æ·±å…¥ç†è§£-ios11-webview-çš„-viewport&quot;&gt;&lt;a href=&quot;#æ·±å…¥ç†è§£-ios11-webview-çš„-viewport&quot; class=&quot;headerlink&quot; title=&quot;æ·±å…¥ç†è§£ ios11 webview çš„ viewport&quot;&gt;&lt;/a&gt;æ·±å…¥ç†è§£ ios11 webview çš„ viewport&lt;/h1&gt;&lt;p&gt;ios11 å¸¦æ¥äº†ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œå‡­ç›´è§‰ï¼Œå›´ç»•çŠ¶æ€æ åŒºåŸŸçš„å±•ç°å¯¹äºç¨‹åºå‘˜ä½¿ç”¨çš„åƒ Apache Cordova æˆ– Ionic è¿™æ ·çš„å·¥å…·æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚å°¤å…¶æ˜¯ï¼Œè¿™ä¸ªæ”¹åŠ¨å½±å“åˆ°æ‰€æœ‰ä¸º ios11 æ„å»ºçš„ã€åŸºäº web çš„ã€ä½¿ç”¨äº†å›ºå®šæ ‡é¢˜æ çš„ app ä¹‹ä¸­ã€‚è¿™ç¯‡æ–‡ç« å¸®åŠ©ä½ ç†è§£ ios11 webview çš„ viewportã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;æ³¨ï¼š ç°æœ‰çš„ app å¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œï¼Œå› ä¸ºåŸæœ‰çš„ viewport è¡¨ç°å¹¶æ²¡æœ‰è¢«æ”¹å˜ã€‚è¿™ä¸ªæ”¹å˜åªå½±å“é‚£äº›ä½¿ç”¨ xcode9 æ¥ä¸º ios11 æ„å»ºçš„åº”ç”¨ã€‚&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;ä¸ºäº†ç†è§£è¿™ä¸ªæ”¹åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹èƒŒæ™¯çŸ¥è¯†ã€‚
    
    </summary>
    
      <category term="css" scheme="http://robin-front.github.io/categories/css/"/>
    
    
      <category term="ios11" scheme="http://robin-front.github.io/tags/ios11/"/>
    
      <category term="viewport" scheme="http://robin-front.github.io/tags/viewport/"/>
    
      <category term="css-constant" scheme="http://robin-front.github.io/tags/css-constant/"/>
    
      <category term="viewport-fit" scheme="http://robin-front.github.io/tags/viewport-fit/"/>
    
  </entry>
  
  <entry>
    <title>IphoneX çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ</title>
    <link href="http://robin-front.github.io/2017/09/21/the-notch-and-css/"/>
    <id>http://robin-front.github.io/2017/09/21/the-notch-and-css/</id>
    <published>2017-09-21T02:23:04.000Z</published>
    <updated>2017-09-21T02:23:04.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IphoneX-çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ"><a href="#IphoneX-çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ" class="headerlink" title="IphoneX çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ"></a>IphoneX çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ</h1><p>è‹¹æœå…¬å¸çš„ IphoneX æ‹¥æœ‰äº†å…¨é¢å±ï¼Œåªä¿ç•™äº†â€˜å°åˆ˜æµ·â€™ç»™æ‘„åƒå¤´å’Œä¸€äº›ä¼ æ„Ÿè®¾å¤‡ã€‚ç»“æœå°±æ˜¯è®©å±å¹•è®¾è®¡é™·å…¥å°´å°¬çš„å¢ƒåœ°ï¼Œå°±åƒé™åˆ¶ç½‘é¡µæœ‰ä¸€ä¸ªâ€œå®‰å…¨åŒºåŸŸâ€å’Œç™½è‰²è¾¹ç¼˜æ¡ã€‚è™½ç„¶æ²¡æœ‰å¤ªå¤šçš„é»‘é­”æ³•å»æ¶ˆé™¤å®ƒï¼Œä½†ç»™ <code>body</code> è®¾ç½®ä¸€ä¸ª <code>background-color</code> å±æ€§ä¹Ÿå¯ä»¥åšåˆ°ã€‚æˆ–è€…æ‰©å±•ç½‘é¡µä»¥è¦†ç›–æ•´ä¸ªå±å¹•ï¼ˆè¯¥æ­»çš„ç¼ºå£ï¼‰ï¼Œå¯ä»¥ç»™ viewport çš„ meta æ ‡ç­¾æ·»åŠ  <code>viewport-fit=cover</code>ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_1000,f_auto,q_auto/v1505590717/iphonex-safari_njxeiw.png" data-original="https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_1000,f_auto,q_auto/v1505590717/iphonex-safari_njxeiw.png"><a id="more"></a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, viewport-fit=cover"</span>&gt;</span></div></pre></td></tr></table></figure><p>ç„¶åï¼Œç”±ä½ è‡ªå·±å†³å®šå¦‚ä½•å¤„ç†å®‰å…¨åŒºåŸŸçš„é‡å ã€‚è¿™é‡Œæœ‰ä¸€äº›æ–°çš„ css å¯ä»¥å¸®åŠ©é€‚é…å®ƒã€‚<a href="http://stephenradford.me/removing-the-white-bars-in-safari-on-iphone-x/" target="_blank" rel="noopener">Stephen Radford documents</a></p><blockquote><p>ä¸ºäº†é€‚é…ç¼ºå£ï¼Œå¯ä»¥å¼•å…¥ ios 11 ç‰ˆæœ¬åŒ…å«çš„ä¸€äº›å¸¸é‡ï¼Œè¿™äº›å¸¸é‡éœ€è¦ä½¿ç”¨äº† <code>viewport-fit=cover</code> æ‰ä¼šç”Ÿæ•ˆã€‚</p><ul><li>safe-area-inset-top</li><li>safe-area-inset-right</li><li>safe-area-inset-left</li><li>safe-area-inset-bottom</li></ul><p>è¿™äº›å¸¸é‡å¯ä»¥è¢«ç”¨åœ¨ <code>margin</code>, <code>padding</code>, æˆ–è€…ç»å¯¹å®šä½çš„ <code>top</code>, <code>left</code> ç­‰å±æ€§ä¸Šã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">padding</span>: <span class="selector-tag">constant</span>(<span class="selector-tag">safe-area-inset-top</span>) <span class="selector-tag">constant</span>(<span class="selector-tag">safe-area-inset-right</span>) <span class="selector-tag">constant</span>(<span class="selector-tag">safe-area-inset-bottom</span>) <span class="selector-tag">constant</span>(<span class="selector-tag">safe-area-inset-left</span>);</div></pre></td></tr></table></figure></blockquote><p>è¿˜æœ‰å¦å¤–ä¸€ä¸ªå°´å°¬çš„å±€é¢å…³äºç¼ºå£ï¼Œå®‰å…¨åŒºåŸŸå’Œ fixed å®šä½ã€‚<a href="https://ayogo.com/blog/ios11-viewport/" target="_blank" rel="noopener">Darryl Pogue reports:</a></p><blockquote><p>ios 11ä¸æ—©æœŸçš„ç‰ˆæœ¬ä¸å¤ªä¸€æ ·ï¼Œå®ƒç°åœ¨éµå®ˆå®‰å…¨åŒºåŸŸè¿™ä¸€è§„åˆ™ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ª header barï¼Œ å¹¶ä¸”è®¾ç½® <code>position: fixed;top: 0;</code>ï¼Œå®ƒåˆå§‹åŒ–æ—¶ä¼šæ¸²æŸ“åœ¨é¡¶éƒ¨çš„ <code>20px</code> ä¸‹é¢ï¼šå¯¹é½é¡¶éƒ¨çŠ¶æ€æ çš„åº•éƒ¨ã€‚å½“ä½ å‘ä¸‹æµè§ˆç½‘é¡µï¼Œå®ƒä¼šéšè—çŠ¶æ€æ ã€‚å¦‚æœå‘ä¸Šæ»šåŠ¨ï¼ŒçŠ¶æ€æ åˆæ¥è·‘å‡ºæ¥ï¼ˆç•™ä¸‹å°´å°¬çš„20pxé—´éš™ï¼‰ã€‚</p><video src="https://cdn.css-tricks.com/wp-content/uploads/2017/09/ios11-viewport.mp4" controls name="fitvid0"></video></blockquote><p>å¹¸è¿çš„æ˜¯è¿™ä¹Ÿå¾ˆå®¹æ˜“è§£å†³ã€‚åªéœ€è¦æ·»åŠ  <code>viewport-fit=cover</code> åˆ° <code>meta viewport</code> æ ‡ç­¾ä¸Šã€‚</p><p>å¦‚æœè¦†ç›–äº†å…¨å±å¹•ï¼Œé‚£å¯èƒ½éœ€è¦è€ç‚¹å°èªæ˜å»é¿å…æŒ¡ä½å†…å®¹ã€‚</p><p></p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">I think Iâ€™ve fixed the notch issue in landscape ğŸ¾ <a href="https://twitter.com/hashtag/iphoneX?src=hash" target="_blank" rel="noopener">#iphoneX</a> <a href="https://t.co/hGytyO3DRV" target="_blank" rel="noopener">pic.twitter.com/hGytyO3DRV</a></p>&mdash; Vojta Stavik (@vojtastavik) <a href="https://twitter.com/vojtastavik/status/907911237983449088" target="_blank" rel="noopener">September 13, 2017</a></blockquote><p></p><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;IphoneX-çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ&quot;&gt;&lt;a href=&quot;#IphoneX-çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ&quot; class=&quot;headerlink&quot; title=&quot;IphoneX çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ&quot;&gt;&lt;/a&gt;IphoneX çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ&lt;/h1&gt;&lt;p&gt;è‹¹æœå…¬å¸çš„ IphoneX æ‹¥æœ‰äº†å…¨é¢å±ï¼Œåªä¿ç•™äº†â€˜å°åˆ˜æµ·â€™ç»™æ‘„åƒå¤´å’Œä¸€äº›ä¼ æ„Ÿè®¾å¤‡ã€‚ç»“æœå°±æ˜¯è®©å±å¹•è®¾è®¡é™·å…¥å°´å°¬çš„å¢ƒåœ°ï¼Œå°±åƒé™åˆ¶ç½‘é¡µæœ‰ä¸€ä¸ªâ€œå®‰å…¨åŒºåŸŸâ€å’Œç™½è‰²è¾¹ç¼˜æ¡ã€‚è™½ç„¶æ²¡æœ‰å¤ªå¤šçš„é»‘é­”æ³•å»æ¶ˆé™¤å®ƒï¼Œä½†ç»™ &lt;code&gt;body&lt;/code&gt; è®¾ç½®ä¸€ä¸ª &lt;code&gt;background-color&lt;/code&gt; å±æ€§ä¹Ÿå¯ä»¥åšåˆ°ã€‚æˆ–è€…æ‰©å±•ç½‘é¡µä»¥è¦†ç›–æ•´ä¸ªå±å¹•ï¼ˆè¯¥æ­»çš„ç¼ºå£ï¼‰ï¼Œå¯ä»¥ç»™ viewport çš„ meta æ ‡ç­¾æ·»åŠ  &lt;code&gt;viewport-fit=cover&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_1000,f_auto,q_auto/v1505590717/iphonex-safari_njxeiw.png&quot; alt=&quot;https://res.cloudinary.com/css-tricks/image/upload/c_scale,w_1000,f_auto,q_auto/v1505590717/iphonex-safari_njxeiw.png&quot;&gt;
    
    </summary>
    
      <category term="css" scheme="http://robin-front.github.io/categories/css/"/>
    
    
      <category term="viewport" scheme="http://robin-front.github.io/tags/viewport/"/>
    
      <category term="css" scheme="http://robin-front.github.io/tags/css/"/>
    
      <category term="iphoneX" scheme="http://robin-front.github.io/tags/iphoneX/"/>
    
      <category term="notch" scheme="http://robin-front.github.io/tags/notch/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²</title>
    <link href="http://robin-front.github.io/2017/09/19/how-to-handle-4-common-memory-leaks/"/>
    <id>http://robin-front.github.io/2017/09/19/how-to-handle-4-common-memory-leaks/</id>
    <published>2017-09-19T01:38:51.000Z</published>
    <updated>2017-09-19T01:38:51.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²"><a href="#å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²" class="headerlink" title="å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²"></a>å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²</h1><h2 id="ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²"><a href="#ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²" class="headerlink" title="ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²"></a>ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²</h2><p>æœ¬è´¨ä¸Šæ¥è¯´ï¼Œå†…å­˜æ³„éœ²å¯ä»¥è¢«å®šä¹‰ä¸º <strong>å½“å†…å­˜ä¸å†è¢«åº”ç”¨ä½¿ç”¨ï¼Œå´å› ä¸ºæŸäº›åŸå› æ²¡æœ‰è¢«æ“ä½œç³»ç»Ÿå›æ”¶æˆ–é‡Šæ”¾åˆ°è‡ªç”±å†…å­˜æ± </strong></p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1600/1*0B-dAUOH7NrcCDP6GhKHQw.jpeg" data-original="https://cdn-images-1.medium.com/max/1600/1*0B-dAUOH7NrcCDP6GhKHQw.jpeg"></p><p>ç¼–ç¨‹è¯­è¨€æ”¯æŒå¤šç§ä¸åŒçš„å†…å­˜ç®¡ç†ã€‚æŸäº›å†…å­˜æ˜¯å¦åœ¨ä½¿ç”¨å®é™…ä¸Šæ˜¯ä¸å¯åˆ¤å®šçš„ã€‚æ¢å¥è¯è¯´ï¼Œåªè¦å¼€å‘è€…æ‰æ¸…æ¥šå“ªäº›å†…å­˜å—æ˜¯å¯ä»¥è¢«æ“ä½œç³»ç»Ÿå›æ”¶ã€‚</p><p>æŸäº›ç¼–ç¨‹è¯­è¨€æä¾›ä¸€äº›ç‰¹æ€§å¸®åŠ©å¼€å‘è€…è¿›è¡Œå†…å­˜å›æ”¶ã€‚å…¶ä»–çš„æœŸæœ›å¼€å‘è€…å®Œå…¨æ˜ç™½å“ªäº›å†…å­˜æ˜¯æ— ç”¨çš„ã€‚ç»´åŸºæœ‰ä¸€ç³»åˆ—å…³äºå†…å­˜ç®¡ç†çš„å¥½æ–‡ç« ã€‚<a id="more"></a></p><h2 id="å››ç§å¸¸è§çš„å†…å­˜æ³„éœ²"><a href="#å››ç§å¸¸è§çš„å†…å­˜æ³„éœ²" class="headerlink" title="å››ç§å¸¸è§çš„å†…å­˜æ³„éœ²"></a>å››ç§å¸¸è§çš„å†…å­˜æ³„éœ²</h2><h3 id="1-å…¨å±€å˜é‡"><a href="#1-å…¨å±€å˜é‡" class="headerlink" title="1. å…¨å±€å˜é‡"></a>1. å…¨å±€å˜é‡</h3><p>javascript é€šè¿‡ä¸€ä¸ªæœ‰è¶£çš„æ–¹å¼å¤„ç†æœªå£°æ˜çš„å˜é‡ï¼šå¼•ç”¨æœªå£°æ˜çš„å˜é‡ä¼šåœ¨å…¨å±€å¯¹è±¡é‡Œåˆ›å»ºä¸€ä¸ªå˜é‡ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œå…¨å±€å¯¹è±¡æ˜¯<code>window</code>, æ¢å¥è¯è¯´ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line">    bar = <span class="string">"some text"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç­‰ä»·äºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line">    <span class="built_in">window</span>.bar = <span class="string">"some text"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>å¦‚æœ <code>bar</code> é¢„æƒ³ä¸­æ˜¯ <code>foo</code> å‡½æ•°ä½œç”¨åŸŸå†…çš„å±€éƒ¨å˜é‡ï¼Œä½†åˆå¿˜è®°ä½¿ç”¨ <code>var</code> å»å£°æ˜ï¼Œé‚£ä¹ˆé¢„æ–™ä¹‹å¤–çš„å…¨å±€å˜é‡å°±è¢«åˆ›å»ºäº†ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²æ³„éœ²ä¸ä¼šæœ‰å¤šå¤§å®³å¤„ï¼Œä½†è¿™ç§å†™æ³•å½“ç„¶ä¼šæœ‰æ›´ç³Ÿæƒ…å†µã€‚</p><p>å¦ä¸€ä¸ªæ„å¤–åˆ›å»ºå…¨å±€å˜é‡çš„æ–¹å¼æ˜¯é€šè¿‡ <code>this</code>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.var1 = <span class="string">"potential accidental global"</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">// Foo called on its own, this points to the global object (window)</span></div><div class="line"><span class="comment">// rather than being undefined.</span></div><div class="line">foo();</div></pre></td></tr></table></figure><blockquote><p>ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œéœ€è¦åœ¨ javascript æ–‡ä»¶çš„å¼€å¤´æ·»åŠ  <code>&#39;use strict&#39;</code>.è¿™ä¼šä½¿ç”¨ä¸¥æ ¼æ¨¡å¼è§£æjavascriptä»¥é˜²æ­¢æ„å¤–çš„å…¨å±€å˜é‡ã€‚<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode" target="_blank" rel="noopener">äº†è§£æ›´å¤šjavascriptä¸¥æ ¼æ¨¡å¼çš„æ‰§è¡Œæƒ…å†µ</a></p></blockquote><p>å°½ç®¡æˆ‘ä»¬åœ¨è°ˆè®ºæ„å¤–çš„å…¨å±€å˜é‡ï¼Œä½†ä»ç„¶ä¼šæœ‰æ— æ•°çš„æ˜ç¡®çš„å…¨å±€å˜é‡ã€‚è¿™äº›è¢«å®šä¹‰ä¸ºä¸å¯å›æ”¶çš„ï¼ˆé™¤éæŒ‡å®šä¸ºnullæˆ–é‡æ–°åˆ†é…ï¼‰ã€‚ç‰¹åˆ«æ˜¯åº”è¯¥å…³æ³¨ç”¨äºä¸´æ—¶å­˜å‚¨å’Œå¤„ç†å¤§é‡æ•°æ®çš„å…¨å±€å˜é‡ã€‚å¦‚æœå¿…é¡»è¦ç”¨å…¨å±€å˜é‡å»å­˜å‚¨å¤§é‡æ•°æ®ï¼Œå½“ä½ å¤„ç†å®Œä¹‹åï¼Œ<strong>è¯·å‹¿å¿…è®°å¾—æŒ‡å®šä¸ºnullæˆ–é‡æ–°å…¨é…</strong></p><h3 id="2-è¢«é—å¿˜çš„å®šæ—¶å™¨å’Œå›è°ƒ"><a href="#2-è¢«é—å¿˜çš„å®šæ—¶å™¨å’Œå›è°ƒ" class="headerlink" title="2. è¢«é—å¿˜çš„å®šæ—¶å™¨å’Œå›è°ƒ"></a>2. è¢«é—å¿˜çš„å®šæ—¶å™¨å’Œå›è°ƒ</h3><p>åœ¨ javascript ä¸­ä½¿ç”¨ <code>setInterval</code> éå¸¸å¸¸è§ã€‚</p><p>å¤§éƒ¨åˆ†ç±»åº“æä¾›è§‚å¯Ÿè€…å’Œå…¶ä»–è°ƒç”¨å›è°ƒçš„å·¥å…·ï¼Œå°å¿ƒåœ°å¼•ç”¨é‚£äº› <strong>æ‹¥æœ‰ä¼šå˜å¾—ä¸å¯è®¿é—®çš„å®ä¾‹</strong> çš„å›è°ƒã€‚<code>setInterval</code> çš„ä¾‹å­ï¼Œå°½ç®¡è¿™å¾ˆå¸¸è§ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> serverData = loadData();</div><div class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> renderer = <span class="built_in">document</span>.getElementById(<span class="string">'renderer'</span>);</div><div class="line">    <span class="keyword">if</span>(renderer) &#123;</div><div class="line">        renderer.innerHTML = <span class="built_in">JSON</span>.stringify(serverData);</div><div class="line">    &#125;</div><div class="line">&#125;, <span class="number">5000</span>); <span class="comment">//This will be executed every ~5 seconds.</span></div></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­è¯´æ˜äº†å®šæ—¶å™¨ä¼šå‘ç”Ÿçš„äº‹ï¼šå®šæ—¶å™¨å¼•ç”¨äº†ä¸å†éœ€è¦çš„nodeèŠ‚ç‚¹å’Œæ•°æ®ã€‚</p><p>è¢« <code>renderer</code> å¼•ç”¨çš„å¯¹è±¡åœ¨å°†æ¥æŸä¸ªæ—¶åˆ»å¯èƒ½ä¼šè¢«åˆ é™¤ï¼Œè®©æ•´ä¸ªå†…éƒ¨å—éƒ½å˜å¾—ä¸å¿…è¦äº†ã€‚ä½†æ˜¯ï¼Œå› ä¸ºå®šæ—¶å™¨è¿˜åœ¨è¿è¡Œï¼Œæ‰€ä»¥å¤„ç†ç¨‹åºä¸èƒ½è¢«å›æ”¶ï¼ˆå®šæ—¶å™¨éœ€è¦è¢«åœæ­¢æ‰èƒ½å›æ”¶ï¼‰ã€‚å¦‚æœå®šæ—¶å¤„ç†ç¨‹åºä¸èƒ½è¢«å›æ”¶ï¼Œé‚£ä¹ˆç›¸å…³çš„ä¸€åˆ‡éƒ½ä¸èƒ½è¢«å›æ”¶ã€‚è¿™æ„å‘³ç€å¯èƒ½å­˜å‚¨ç€å¤§é‡æ•°æ®çš„ <code>serverData</code> ä¹Ÿä¸èƒ½è¢«å›æ”¶ã€‚</p><p>è§‚å¯Ÿè€…çš„ä¾‹å­ä¸­ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯å½“ä¸åœ¨éœ€è¦çš„æ—¶å€™ï¼Œå¿…é¡»æ˜ç¡®ç§»é™¤ä»–ä»¬ï¼ˆæˆ–è€…è®©ç›¸å…³çš„å¯¹è±¡å˜å¾—ä¸å¯è®¿é—®ï¼‰ã€‚</p><p>åœ¨è¿‡å»ï¼Œè¿™å¯¹äºæŸäº›ä¸èƒ½å¾ˆå¥½åœ°ç®¡ç†å†…å­˜çš„æµè§ˆå™¨ï¼ˆåƒIE6ï¼‰æ˜¯éå¸¸é‡è¦çš„ã€‚å¦‚ä»Šï¼Œå¤§éƒ¨åˆ†æµè§ˆå™¨æœ‰èƒ½åŠ›å¹¶ä¸”ä¼šå›æ”¶ä¸å¯è®¿é—®çš„è§‚å¯Ÿè€…å¤„ç†ç¨‹åºï¼Œå°±ç®—æœ‰æ—¶ç›‘å¬å™¨æ²¡æœ‰è¢«æ˜ç¡®åœ°ç§»é™¤ã€‚è¿™ä»ç„¶æ˜¯å¾ˆå¥½çš„åšæ³•ï¼Œä¸ç®¡æ€æ ·ï¼Œåœ¨å¯¹è±¡è¢«å¤„ç†æ‰ä¹‹å‰æ˜ç¡®åœ°ç§»é™¤è§‚å¯Ÿè€…ã€‚ä¸¾ä¸ªå®ä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">'launch-button'</span>);</div><div class="line"><span class="keyword">var</span> counter = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onClick</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">   counter++;</div><div class="line">   element.innerHtml = <span class="string">'text '</span> + counter;</div><div class="line">&#125;</div><div class="line">element.addEventListener(<span class="string">'click'</span>, onClick);</div><div class="line"><span class="comment">// Do stuff</span></div><div class="line">element.removeEventListener(<span class="string">'click'</span>, onClick);</div><div class="line">element.parentNode.removeChild(element);</div><div class="line"><span class="comment">// Now when element goes out of scope,</span></div><div class="line"><span class="comment">// both element and onClick will be collected even in old browsers // that don't handle cycles well.</span></div></pre></td></tr></table></figure><p>æ¡†æ¶æˆ–ç±»åº“ï¼Œæ¯”å¦‚ jQuery åœ¨åˆ é™¤ node èŠ‚ç‚¹çš„æ—¶å€™å°±ç§»é™¤äº†ç›‘å¬äº‹ä»¶ï¼ˆå½“ä½¿ç”¨å®ƒçš„APIçš„æ—¶å€™ï¼‰ï¼Œè¿™æ˜¯ç±»åº“å†…éƒ¨å¤„ç†çš„ï¼Œä¸ºäº†é˜²æ­¢å†…å­˜æ³„éœ²äº§ç”Ÿã€‚å°±ç®—åœ¨æœ‰é—®é¢˜çš„æµè§ˆå™¨ä¸‹è¿è¡Œï¼Œæ¯”å¦‚â€¦å¯¹ï¼ŒIE6 ï¼šï¼‰</p><h3 id="é—­åŒ…ï¼ˆclosureï¼‰"><a href="#é—­åŒ…ï¼ˆclosureï¼‰" class="headerlink" title="é—­åŒ…ï¼ˆclosureï¼‰"></a>é—­åŒ…ï¼ˆclosureï¼‰</h3><p>javascript å¼€å‘ä¸€ä¸ªå…³é”®ç‚¹æ˜¯ <strong>é—­åŒ…</strong>ï¼š ä¸€ä¸ªå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®ï¼ˆå°é—­çš„ï¼‰å¤–éƒ¨å‡½æ•°çš„å˜é‡ã€‚ç”±äº javascript è¿è¡Œç¯å¢ƒçš„å®ç°ï¼Œä»¥ä¸‹æ–¹å¼å¾ˆå¯èƒ½é€ æˆå†…å­˜æ³„éœ²ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> theThing = <span class="literal">null</span>;</div><div class="line"><span class="keyword">var</span> replaceThing = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> originalThing = theThing;</div><div class="line">  <span class="keyword">var</span> unused = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (originalThing) <span class="comment">// a reference to 'originalThing'</span></div><div class="line">      <span class="built_in">console</span>.log(<span class="string">"hi"</span>);</div><div class="line">  &#125;;</div><div class="line">  theThing = &#123;</div><div class="line">    <span class="attr">longStr</span>: <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000000</span>).join(<span class="string">'*'</span>),</div><div class="line">    <span class="attr">someMethod</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">"message"</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line">setInterval(replaceThing, <span class="number">1000</span>);</div></pre></td></tr></table></figure><p>è¿™æ®µä»£ç åšäº†ä¸€ä»¶äº‹ï¼šæ¯æ¬¡è°ƒç”¨ <code>replaceThing</code> æ—¶ï¼Œ<code>theThing</code> æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«å¤§æ•°æ®å’Œé—­åŒ…ï¼ˆsomeMethodï¼‰çš„æ–°å¯¹è±¡ï¼ŒåŒæ—¶ï¼Œ <code>unused</code> ä¹ŸæŒ‡å‘ä¸€ä¸ªå¼•ç”¨äº† <code>originalThing</code>ï¼ˆ<code>theThing</code> æŒ‡å‘å‰ä¸€æ¬¡ <code>replaceThing</code> è°ƒç”¨ï¼‰ çš„é—­åŒ…ï¼Œå·²ç»æœ‰ç‚¹æ··ä¹±äº†ï¼Œå•Šå“ˆï¼Ÿé‡ç‚¹æ˜¯ï¼Œ<strong>ä¸€æ—¦ä¸ºä¸€ä¸ªå…·æœ‰ç›¸åŒçˆ¶çº§ä½œç”¨åŸŸçš„é—­åŒ…åˆ›å»ºä½œç”¨åŸŸï¼Œä½œç”¨åŸŸæ˜¯å…±äº«çš„</strong></p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œ ä¸ºé—­åŒ… <code>someMethod</code> åˆ›å»ºçš„ä½œç”¨åŸŸä¸ <code>unused</code> å…±äº«ã€‚<code>unused</code> æœ‰ä¸€ä¸ªæŒ‡å‘ <code>originalThing</code> çš„å¼•ç”¨ã€‚å°½ç®¡ <code>unused</code> ä»æœªè¢«ä½¿ç”¨ï¼Œä½†æ˜¯ <code>someMethod</code> å¯ä»¥é€šè¿‡ <code>theThing</code> ä¹Ÿå°±æ˜¯ <code>replaceThing</code> å¤–å›´çš„ä½œç”¨åŸŸï¼ˆä¾‹å¦‚ï¼šå…¨å±€èŒƒå›´å†…ï¼‰è°ƒç”¨ã€‚ä¸æ­¤åŒæ—¶ <code>someMethod</code> ä¸ <code>unused</code> å…±äº«é—­åŒ…ä½œç”¨åŸŸï¼Œ<code>unused</code> å¼•ç”¨ <code>originalThing</code> è¿«ä½¿å®ƒä¿æŒåœ¨å†…å­˜ä¸­ï¼ˆåœ¨ä¸¤ä¸ªé—­åŒ…å…±äº«çš„ä½œç”¨åŸŸèŒƒå›´ï¼‰ã€‚è¿™é˜»æ­¢äº†å®ƒè¢«å›æ”¶ã€‚</p><p>å½“è¿™æ®µä»£ç åå¤åœ°è¿è¡Œæ—¶ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°å†…å­˜ä½¿ç”¨ç‡ç¨³å®šåœ°å¢é•¿ã€‚GC è¿è¡Œæ—¶ä¹Ÿå¹¶æœªå‡å°‘ã€‚æœ¬è´¨ä¸Šï¼Œä¸€ä¸ªé—­åŒ…é“¾è¢«åˆ›å»ºäº†ï¼ˆé€šè¿‡æ ¹ä½œç”¨åŸŸçš„ <code>theThing</code> å˜é‡ï¼‰ã€‚è€Œæ¯ä¸€ä¸ªé—­åŒ…ä½œç”¨åŸŸé™„å¸¦ç€å¼•ç”¨äº†å¤§æ•°æ®ï¼Œç»“æœå°±æ˜¯å†…å­˜æ³„éœ²ã€‚</p><p>è¿™ä¸ªé—®é¢˜è¢« Meteor å›¢é˜Ÿå‘ç°å¹¶å‘è¡¨äº†<a href="https://blog.meteor.com/an-interesting-kind-of-javascript-memory-leak-8b47d2e7f156" target="_blank" rel="noopener">è‘—åçš„æ–‡ç« æè¿°è¿™ä¸ªé—®é¢˜</a>ã€‚</p><h3 id="4-é¢å¤–çš„-DOM-å¼•ç”¨"><a href="#4-é¢å¤–çš„-DOM-å¼•ç”¨" class="headerlink" title="4. é¢å¤–çš„ DOM å¼•ç”¨"></a>4. é¢å¤–çš„ DOM å¼•ç”¨</h3><p>æœ‰æ—¶åœ¨æ•°æ®ç»“æ„ä¸­å¼•ç”¨ DOM èŠ‚ç‚¹å¾ˆæœ‰ç”¨ã€‚å‡è®¾ä½ æƒ³è¿…é€Ÿåœ°æ›´æ–°ä¸€ä¸ªè¡¨æ ¼ä¸­çš„å‡ è¡Œå†…å®¹ã€‚å¯èƒ½æ„Ÿè§‰åœ¨å­—å…¸ä¸­æˆ–æ•°æ®ä¸­å¼•ç”¨ DOM row æ˜¯æœ‰æ„ä¹‰çš„ã€‚åœ¨è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œä¸¤ä¸ªå¯¹ç›¸åŒ DOM çš„å¼•ç”¨è¢«ä¿æŒï¼šä¸€ä¸ªåœ¨ DOM æ ‘ï¼Œå¦ä¸€ä¸ªåœ¨å­—å…¸ä¸­ã€‚å¦‚æœå°†æ¥æŸä¸ªæ—¶é—´ç‚¹ï¼Œä½ æƒ³åˆ é™¤è¿™å‡ è¡Œè¡¨æ ¼ï¼Œä½ è¦ç¡®ä¿è¿™ä¸¤ä¸ªè€…å¤±å»å¼•ç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> elements = &#123;</div><div class="line">    <span class="attr">button</span>: <span class="built_in">document</span>.getElementById(<span class="string">'button'</span>),</div><div class="line">    <span class="attr">image</span>: <span class="built_in">document</span>.getElementById(<span class="string">'image'</span>)</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doStuff</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    image.src = <span class="string">'http://example.com/image_name.png'</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeImage</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// The image is a direct child of the body element.</span></div><div class="line">    <span class="built_in">document</span>.body.removeChild(<span class="built_in">document</span>.getElementById(<span class="string">'image'</span>));</div><div class="line">    <span class="comment">// At this point, we still have a reference to #button in the</span></div><div class="line">    <span class="comment">//global elements object. In other words, the button element is</span></div><div class="line">    <span class="comment">//still in memory and cannot be collected by the GC.</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜æœ‰é¢å¤–çš„ç‚¹éœ€è¦æ³¨æ„ï¼Œå½“æ¶‰åŠåˆ° DOM æ ‘æˆ–å­èŠ‚ç‚¹çš„å¼•ç”¨ã€‚æ¯”å¦‚è¯´åœ¨ javascript ä»£ç ä¸­å¼•ç”¨äº†è¡¨æ ¼çš„æŸä¸ªæ ¼å­ï¼ˆä¸€ä¸ª<code>&lt;td&gt;</code>æ ‡ç­¾ï¼‰ã€‚æŸå¤©ä½ å†³å®šåˆ é™¤è¡¨æ ¼ä½†è¿˜ä¿æŒç€å•å…ƒæ ¼çš„å¼•ç”¨ã€‚ç›´è§‚çš„å‡è®¾å°±æ˜¯ GC ä¼šå›æ”¶è¡¨æ ¼ï¼Œä½†ä¿ç•™å•å…ƒæ ¼ã€‚äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼šå•å…ƒæ ¼æ˜¯è¡¨æ ¼çš„å­èŠ‚ç‚¹ï¼Œå®ƒä¿æŒç€å¯¹çˆ¶çº§è¡¨æ ¼çš„å¼•ç”¨ã€‚javascript ä»£ç ä¿æŒå•å…ƒæ ¼çš„å¼•ç”¨å¯¼è‡´ <strong>æ•´ä¸ªè¡¨æ ¼è¢«ä¿ç•™åœ¨å†…å­˜ä¸­</strong>ã€‚æ‰€ä»¥è¯·è°¨æ…è€ƒè™‘å¼•ç”¨ DOM å…ƒç´ ã€‚</p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²&quot;&gt;&lt;a href=&quot;#å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²&quot; class=&quot;headerlink&quot; title=&quot;å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²&quot;&gt;&lt;/a&gt;å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²&lt;/h1&gt;&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²&lt;/h2&gt;&lt;p&gt;æœ¬è´¨ä¸Šæ¥è¯´ï¼Œå†…å­˜æ³„éœ²å¯ä»¥è¢«å®šä¹‰ä¸º &lt;strong&gt;å½“å†…å­˜ä¸å†è¢«åº”ç”¨ä½¿ç”¨ï¼Œå´å› ä¸ºæŸäº›åŸå› æ²¡æœ‰è¢«æ“ä½œç³»ç»Ÿå›æ”¶æˆ–é‡Šæ”¾åˆ°è‡ªç”±å†…å­˜æ± &lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://cdn-images-1.medium.com/max/1600/1*0B-dAUOH7NrcCDP6GhKHQw.jpeg&quot; alt=&quot;https://cdn-images-1.medium.com/max/1600/1*0B-dAUOH7NrcCDP6GhKHQw.jpeg&quot;&gt;&lt;/p&gt;&lt;p&gt;ç¼–ç¨‹è¯­è¨€æ”¯æŒå¤šç§ä¸åŒçš„å†…å­˜ç®¡ç†ã€‚æŸäº›å†…å­˜æ˜¯å¦åœ¨ä½¿ç”¨å®é™…ä¸Šæ˜¯ä¸å¯åˆ¤å®šçš„ã€‚æ¢å¥è¯è¯´ï¼Œåªè¦å¼€å‘è€…æ‰æ¸…æ¥šå“ªäº›å†…å­˜å—æ˜¯å¯ä»¥è¢«æ“ä½œç³»ç»Ÿå›æ”¶ã€‚&lt;/p&gt;&lt;p&gt;æŸäº›ç¼–ç¨‹è¯­è¨€æä¾›ä¸€äº›ç‰¹æ€§å¸®åŠ©å¼€å‘è€…è¿›è¡Œå†…å­˜å›æ”¶ã€‚å…¶ä»–çš„æœŸæœ›å¼€å‘è€…å®Œå…¨æ˜ç™½å“ªäº›å†…å­˜æ˜¯æ— ç”¨çš„ã€‚ç»´åŸºæœ‰ä¸€ç³»åˆ—å…³äºå†…å­˜ç®¡ç†çš„å¥½æ–‡ç« ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="memory leaks" scheme="http://robin-front.github.io/tags/memory-leaks/"/>
    
  </entry>
  
  <entry>
    <title>é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†</title>
    <link href="http://robin-front.github.io/2017/08/30/avoid-large-complex-layouts-and-layout-thrashing/"/>
    <id>http://robin-front.github.io/2017/08/30/avoid-large-complex-layouts-and-layout-thrashing/</id>
    <published>2017-08-30T02:11:00.000Z</published>
    <updated>2017-08-30T02:11:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†"><a href="#é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†" class="headerlink" title="é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†"></a>é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†</h1><p>å¸ƒå±€æ˜¯æµè§ˆå™¨æŸ¥æ‰¾å…ƒç´ çš„å‡ ä½•ä¿¡æ¯ï¼šå…¶å¤§å°å’Œé¡µé¢ä¸­çš„ä½ç½®ã€‚æ¯ä¸ªå…ƒç´ å°†åŸºäºæ‰€ä½¿ç”¨çš„CSSï¼Œå…ƒç´ çš„å†…å®¹æˆ–çˆ¶å…ƒç´ æ˜¾ç¤ºæˆ–éšå¼çš„å¤§å°è°ƒæ•´ä¿¡æ¯ã€‚è¯¥è¿‡ç¨‹åœ¨ Chromeï¼ŒOperaï¼ŒSafari å’Œ Internet Explorerä¸­ç§°ä¸ºâ€œå¸ƒå±€â€ã€‚åœ¨ Firefox ä¸­ï¼Œå®ƒè¢«ç§°ä¸º Reflow ï¼ˆå›æµï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„ä½œç”¨æ˜¯ç›¸åŒçš„ã€‚</p><p>ç±»ä¼¼äº style è®¡ç®—ï¼Œå¸ƒå±€æˆæœ¬çš„ç›´æ¥ç›¸å…³æ˜¯ï¼š</p><ul><li>éœ€è¦å¸ƒå±€çš„å…ƒç´ æ•°é‡ã€‚</li><li>è¿™äº›å¸ƒå±€çš„å¤æ‚æ€§ã€‚<a id="more"></a></li></ul><p>TL; DR</p><ul><li>å¸ƒå±€é€šå¸¸ä½œç”¨äºæ•´ä¸ªæ–‡æ¡£ã€‚</li><li>DOM å…ƒç´ çš„æ•°é‡å°†å½±å“æ€§èƒ½; æ‚¨åº”å°½å¯èƒ½é¿å…è§¦å‘å¸ƒå±€ã€‚</li><li>è¯„ä¼°å¸ƒå±€æ¨¡å‹æ€§èƒ½; æ–°çš„Flexboxé€šå¸¸æ¯”æ—§ç‰ˆFlexboxæˆ–åŸºäºæµ®åŠ¨çš„å¸ƒå±€æ¨¡å‹æ›´å¿«ã€‚</li><li>é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†; å…ˆè¯»å–æ ·å¼å€¼ï¼Œç„¶åå†è¿›è¡Œæ ·å¼æ›´æ”¹ã€‚</li></ul><h2 id="å°½å¯èƒ½é¿å…å¸ƒå±€"><a href="#å°½å¯èƒ½é¿å…å¸ƒå±€" class="headerlink" title="å°½å¯èƒ½é¿å…å¸ƒå±€"></a>å°½å¯èƒ½é¿å…å¸ƒå±€</h2><p>å½“æ‚¨æ›´æ”¹æ ·å¼æ—¶ï¼Œæµè§ˆå™¨å°†æ£€æŸ¥ä»¥æŸ¥çœ‹æ˜¯å¦æœ‰ä»»ä½•æ›´æ”¹éœ€è¦è®¡ç®—å¸ƒå±€ï¼Œå¹¶ä¸ºè¯¥æ¸²æŸ“æ ‘è¿›è¡Œæ›´æ–°ã€‚å¯¹â€œå‡ ä½•å±æ€§â€çš„æ›´æ”¹ï¼Œå¦‚å®½åº¦ï¼Œé«˜åº¦ï¼Œå·¦ä¾§æˆ–é¡¶éƒ¨éƒ½éœ€è¦å¸ƒå±€ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.box</span> &#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">20px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">20px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * æ”¹å˜å®½é«˜</div><div class="line"> * è§¦å‘ layout.</div><div class="line"> */</div><div class="line"><span class="selector-class">.box--expanded</span> &#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">350px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>å¸ƒå±€å‡ ä¹æ€»æ˜¯ä½œç”¨äºæ•´ä¸ªæ–‡æ¡£</strong>ã€‚å¦‚æœä½ æœ‰å¾ˆå¤šå…ƒç´ ï¼Œé‚£ä¹ˆéœ€è¦å¾ˆé•¿æ—¶é—´æ¥ç¡®å®šå®ƒä»¬çš„ä½ç½®å’Œå°ºå¯¸ã€‚</p><p>å¦‚æœä¸å¯èƒ½é¿å…å¸ƒå±€ï¼Œé‚£ä¹ˆå…³é”®æ˜¯å†æ¬¡ä½¿ç”¨ Chrome DevTools æ¥æŸ¥çœ‹èŠ±è´¹å¤šé•¿æ—¶é—´ï¼Œå¹¶ç¡®å®šå¸ƒå±€æ˜¯å¦æ˜¯ç“¶é¢ˆçš„åŸå› ã€‚é¦–å…ˆï¼Œæ‰“å¼€ DevToolsï¼Œè½¬åˆ°â€œæ—¶é—´è½´â€é€‰é¡¹å¡ï¼Œç‚¹å‡»è®°å½•å¹¶ä¸æ‚¨çš„ç½‘ç«™è¿›è¡Œäº¤äº’ã€‚å½“æ‚¨åœæ­¢å½•åˆ¶æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°æ‚¨çš„ç½‘ç«™æ‰§è¡Œçš„ç»†ç›®ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="" data-original="https://developers.google.com/web/fundamentals/performance/rendering/images/avoid-large-complex-layouts-and-layout-thrashing/big-layout.jpg"></p><p>å½“åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æŒ–æ˜æ¯ä¸€å¸§æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨å¸ƒå±€ä¸­èŠ±è´¹äº†è¶…è¿‡20æ¯«ç§’ï¼Œå½“æˆ‘ä»¬çš„å±å¹•åœ¨åŠ¨ç”»ä¸­æœ‰16msæ—¶ï¼Œè¿™å¤ªé«˜äº†ã€‚æ‚¨è¿˜å¯ä»¥çœ‹åˆ°ï¼ŒDevTools ä¼šå‘Šè¯‰æ‚¨ DOM æ ‘çš„å¤§å°ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º1,618ä¸ªå…ƒç´ ï¼‰ï¼Œä»¥åŠéœ€è¦å¤šå°‘ä¸ªèŠ‚ç‚¹è¿›è¡Œå¸ƒå±€ã€‚</p><blockquote><p>æ³¨æ„ï¼šæƒ³è¦æ˜ç¡®åˆ—å‡ºå“ªäº› CSS å±æ€§è§¦å‘å¸ƒå±€(layout)ï¼Œç»˜ç”»(paint)æˆ–å¤åˆ(composite)ï¼ŸæŸ¥çœ‹<a href="https://csstriggers.com/" target="_blank" rel="noopener">CSSè§¦å‘å™¨</a>ã€‚</p></blockquote><h2 id="åœ¨æ—§çš„å¸ƒå±€æ¨¡å‹ä¸Šä½¿ç”¨-flexbox"><a href="#åœ¨æ—§çš„å¸ƒå±€æ¨¡å‹ä¸Šä½¿ç”¨-flexbox" class="headerlink" title="åœ¨æ—§çš„å¸ƒå±€æ¨¡å‹ä¸Šä½¿ç”¨ flexbox"></a>åœ¨æ—§çš„å¸ƒå±€æ¨¡å‹ä¸Šä½¿ç”¨ flexbox</h2><p>ç½‘ç»œä¸Šæœ‰ä¸€ç³»åˆ—çš„å¸ƒå±€æ¨¡å¼ï¼Œå…¶ä¸­ä¸€äº›æ¯”å…¶ä»–æ¨¡å‹æ›´å—å¹¿æ³›æ”¯æŒã€‚æœ€æ—§çš„ CSS å¸ƒå±€æ¨¡å‹å…è®¸æˆ‘ä»¬åœ¨å±å¹•ä¸Šè¿›è¡Œç›¸å¯¹ï¼Œç»å¯¹åœ°å®šä½å…ƒç´ å’Œæµ®åŠ¨å…ƒç´ ã€‚</p><p>ä¸‹é¢çš„æˆªå›¾æ˜¾ç¤ºäº†åœ¨1,300ä¸ªç›’å­ä¸Šä½¿ç”¨æµ®ç‚¹æ•°æ—¶çš„å¸ƒå±€æˆæœ¬ã€‚è¯šç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªä¾‹è¯ï¼Œå› ä¸ºå¤§å¤šæ•°åº”ç”¨ç¨‹åºå°†ä½¿ç”¨å„ç§æ–¹æ³•æ¥å®šä½å…ƒç´ ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="" data-original="https://developers.google.com/web/fundamentals/performance/rendering/images/avoid-large-complex-layouts-and-layout-thrashing/layout-float.jpg"></p><p>å¦‚æœæˆ‘ä»¬æ›´æ–°æ ·æœ¬ä»¥ä½¿ç”¨ Flexboxï¼Œè¿™æ˜¯Webå¹³å°ä¸Šæœ€è¿‘çš„ä¸€ä¸ªè¡¥å……ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªä¸åŒçš„å›¾ç‰‡ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="" data-original="https://developers.google.com/web/fundamentals/performance/rendering/images/avoid-large-complex-layouts-and-layout-thrashing/layout-flex.jpg"></p><p>ç°åœ¨ï¼Œåœ¨ç›¸åŒæ•°é‡çš„å…ƒç´ å’Œç›¸åŒçš„è§†è§‰å¤–è§‚çš„å¸ƒå±€ä¸­ï¼Œæˆ‘ä»¬èŠ±è´¹æ›´å°‘çš„æ—¶é—´ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ3.5mså¯¹14msï¼‰ã€‚é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œå¯¹äºæŸäº›æµè§ˆå™¨ç¯å¢ƒï¼Œæ‚¨å¯èƒ½æ— æ³•é€‰æ‹© Flexboxï¼Œå› ä¸ºå®ƒæ¯”<a href="http://caniuse.com/#search=flexbox" target="_blank" rel="noopener">æµ®åŠ¨å¸ƒå±€æ›´ä¸å—æ”¯æŒ</a>ï¼Œä½†æ‚¨åº”è¯¥è‡³å°‘åº”è¯¥è°ƒæŸ¥å¸ƒå±€æ¨¡å‹å¯¹æ‚¨çš„æ€§èƒ½çš„å½±å“ï¼Œå¹¶å°†å…¶æœ€å°åŒ–æ‰§è¡Œæˆæœ¬</p><p>æ— è®ºæ‚¨æ˜¯å¦é€‰æ‹©Flexboxï¼Œæ‚¨ä»ç„¶åº”è¯¥ <strong>å°è¯•é¿å…</strong> åœ¨åº”ç”¨ç¨‹åºçš„é«˜å‹ç‚¹ <strong>å®Œå…¨è§¦å‘å¸ƒå±€</strong>ï¼</p><h2 id="é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€"><a href="#é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€" class="headerlink" title="é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€"></a>é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€</h2><p>è¿é€ä¸€ä¸ªæ¡†æ¶åˆ°å±å¹•æœ‰è¿™æ ·çš„é¡ºåºï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="" data-original="https://developers.google.com/web/fundamentals/performance/rendering/images/avoid-large-complex-layouts-and-layout-thrashing/frame.jpg"></p><p>é¦–å…ˆ JavaScript è¿è¡Œï¼Œç„¶åè¿›è¡Œé£æ ¼è®¡ç®—ï¼Œç„¶åè¿›è¡Œå¸ƒå±€ã€‚ç„¶è€Œï¼Œå¯ä»¥å¼ºåˆ¶æµè§ˆå™¨ä½¿ç”¨ JavaScript æ›´æ—©åœ°æ‰§è¡Œå¸ƒå±€ã€‚å®ƒè¢«ç§°ä¸º <strong>å¼ºåˆ¶åŒæ­¥å¸ƒå±€</strong>ã€‚</p><p>è¦è®°ä½çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼Œç”±äº JavaScript è¿è¡Œï¼Œæ‰€æœ‰æ—§çš„å¸ƒå±€å€¼éƒ½æ˜¯å·²çŸ¥çš„ï¼Œå¯ä¾›æ‚¨æŸ¥è¯¢ã€‚æ‰€ä»¥å¦‚æœä½ æƒ³åœ¨ä¸‹ä¸€å¸§ä¹‹å‰å†™å‡ºä¸€ä¸ªå…ƒç´ çš„é«˜åº¦ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œboxâ€ï¼‰ï¼Œä½ å¯ä»¥ç¼–å†™ä¸€äº›è¿™æ ·çš„ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Schedule our function to run at the start of the frame.</span></div><div class="line">requestAnimationFrame(logBoxHeight);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logBoxHeight</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Gets the height of the box in pixels and logs it out.</span></div><div class="line">  <span class="built_in">console</span>.log(box.offsetHeight);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¦‚æœæ‚¨åœ¨è¦æ±‚å…¶é«˜åº¦ä¹‹å‰æ›´æ”¹äº† box çš„æ ·å¼ï¼Œé‚£ä¹ˆäº‹æƒ…ä¼šå˜å¾—æœ‰é—®é¢˜ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logBoxHeight</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  box.classList.add(<span class="string">'super-big'</span>);</div><div class="line"></div><div class="line">  <span class="comment">// Gets the height of the box in pixels</span></div><div class="line">  <span class="comment">// and logs it out.</span></div><div class="line">  <span class="built_in">console</span>.log(box.offsetHeight);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œä¸ºäº†å›ç­”é«˜åº¦é—®é¢˜ï¼Œæµè§ˆå™¨å¿…é¡»é¦–å…ˆåº”ç”¨æ ·å¼æ›´æ”¹ï¼ˆå› ä¸ºæ·»åŠ äº† <code>super-big</code> ç±»ï¼‰ï¼Œç„¶åè¿è¡Œå¸ƒå±€ã€‚åªæœ‰è¿™æ ·æ‰èƒ½æ¢å¤æ­£ç¡®çš„é«˜åº¦ã€‚è¿™æ˜¯ä¸å¿…è¦çš„å’Œæ½œåœ¨çš„æ˜‚è´µçš„å·¥ä½œã€‚</p><p>å› æ­¤ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆæ‰¹è¯„è¿™ç±»çš„æ ·å¼è¯»å–ï¼Œå¹¶é¦–å…ˆæ‰§è¡Œï¼ˆæµè§ˆå™¨å¯ä»¥ä½¿ç”¨ä¸Šä¸€å¸§çš„å¸ƒå±€å€¼ï¼‰ï¼Œç„¶åæ‰§è¡Œä»»ä½•å†™æ“ä½œï¼š</p><p>å®Œæˆä¸Šè¿°åŠŸèƒ½å°†æ˜¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logBoxHeight</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Gets the height of the box in pixels</span></div><div class="line">  <span class="comment">// and logs it out.</span></div><div class="line">  <span class="built_in">console</span>.log(box.offsetHeight);</div><div class="line"></div><div class="line">  box.classList.add(<span class="string">'super-big'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ä¸åº”è¯¥éœ€è¦åº”ç”¨æ ·å¼ï¼Œç„¶åæŸ¥è¯¢å€¼; ä½¿ç”¨æœ€åä¸€å¸§çš„å€¼åº”è¯¥æ˜¯è¶³å¤Ÿçš„ã€‚è¿‡æ—©åœ°è¿è¡Œ style è®¡ç®—å’Œå¸ƒå±€æ˜¯æµè§ˆå™¨åŒæ­¥å’Œå¸ƒå±€æ½œåœ¨çš„ç“¶é¢ˆï¼Œè¿™ä¸æ˜¯æ‚¨é€šå¸¸æƒ³è¦åšçš„äº‹æƒ…ã€‚</p><h2 id="é¿å…å¸ƒå±€é¢ è¦†"><a href="#é¿å…å¸ƒå±€é¢ è¦†" class="headerlink" title="é¿å…å¸ƒå±€é¢ è¦†"></a>é¿å…å¸ƒå±€é¢ è¦†</h2><p>æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥ä½¿å¼ºåˆ¶åŒæ­¥å¸ƒå±€æ›´åŠ ç³Ÿç³•ï¼š<em>å¿«é€Ÿè¿ç»­åœ°åšå¾ˆå¤šäº‹æƒ…</em>ã€‚çœ‹çœ‹è¿™æ®µä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">resizeAllParagraphsToMatchBlockWidth</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// Puts the browser into a read-write-read-write cycle.</span></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; paragraphs.length; i++) &#123;</div><div class="line">    paragraphs[i].style.width = box.offsetWidth + <span class="string">'px'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ­¤ä»£ç å¾ªç¯éå†ä¸€ç»„æ®µè½ï¼Œå¹¶è®¾ç½®æ¯ä¸ªæ®µè½çš„å®½åº¦ä»¥åŒ¹é…åä¸ºâ€œboxâ€çš„å…ƒç´ çš„å®½åº¦ã€‚å®ƒçœ‹èµ·æ¥å¾ˆæ— å®³ï¼Œä½†é—®é¢˜æ˜¯å¾ªç¯çš„æ¯æ¬¡è¿­ä»£è¯»å–ä¸€ä¸ªæ ·å¼å€¼ï¼ˆ<code>box.offsetWidth</code>ï¼‰ï¼Œç„¶åç«‹å³ä½¿ç”¨å®ƒæ¥æ›´æ–°ä¸€ä¸ªparagraphï¼ˆ<code>paragraphs[i].style.width</code>ï¼‰çš„å®½åº¦ã€‚åœ¨å¾ªç¯çš„ä¸‹ä¸€ä¸ªè¿­ä»£ä¸­ï¼Œæµè§ˆå™¨å¿…é¡»è€ƒè™‘åˆ° <code>offsetWidth</code> ä¸Šä¸€æ¬¡è¯·æ±‚ï¼ˆåœ¨ä¸Šä¸€æ¬¡è¿­ä»£ä¸­ï¼‰æ ·å¼å·²ç»æ”¹å˜çš„äº‹å®ï¼Œå› æ­¤å®ƒå¿…é¡»åº”ç”¨æ ·å¼æ›´æ”¹å¹¶è¿è¡Œå¸ƒå±€ã€‚è¿™å°†åœ¨æ¯ä¸€æ¬¡è¿­ä»£ä¸­å‘ç”Ÿï¼</p><p>æ­¤ç¤ºä¾‹çš„è§£å†³æ–¹æ³•æ˜¯ç¼“å­˜è¯»å–å€¼ï¼Œç„¶åå†™å€¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Read.</span></div><div class="line"><span class="keyword">var</span> width = box.offsetWidth;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">resizeAllParagraphsToMatchBlockWidth</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; paragraphs.length; i++) &#123;</div><div class="line">    <span class="comment">// Now write.</span></div><div class="line">    paragraphs[i].style.width = width + <span class="string">'px'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¦‚æœæ‚¨æƒ³ä¿è¯å®‰å…¨æ€§ï¼Œæ‚¨åº”è¯¥æ£€æŸ¥<a href="https://github.com/wilsonpage/fastdom" target="_blank" rel="noopener">FastDOM</a>ï¼Œè¿™å°†è‡ªåŠ¨ä¸ºæ‚¨åˆ†é…è¯»å–å’Œå†™å…¥æ•°æ®ï¼Œå¹¶ä¸”åº”é˜²æ­¢æ‚¨æ„å¤–è§¦å‘å¼ºåˆ¶åŒæ­¥å¸ƒå±€æˆ–å¸ƒå±€é¢ è¦†ã€‚</p><p>ã€ç¿»è¯‘åŸæ–‡ã€‘:<a href="https://developers.google.com/web/fundamentals/performance/rendering/avoid-large-complex-layouts-and-layout-thrashing?hl=en" target="_blank" rel="noopener">Avoid Large, Complex Layouts and Layout Thrashing</a></p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†&quot;&gt;&lt;a href=&quot;#é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†&quot; class=&quot;headerlink&quot; title=&quot;é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†&quot;&gt;&lt;/a&gt;é¿å…å¤§å‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†&lt;/h1&gt;&lt;p&gt;å¸ƒå±€æ˜¯æµè§ˆå™¨æŸ¥æ‰¾å…ƒç´ çš„å‡ ä½•ä¿¡æ¯ï¼šå…¶å¤§å°å’Œé¡µé¢ä¸­çš„ä½ç½®ã€‚æ¯ä¸ªå…ƒç´ å°†åŸºäºæ‰€ä½¿ç”¨çš„CSSï¼Œå…ƒç´ çš„å†…å®¹æˆ–çˆ¶å…ƒç´ æ˜¾ç¤ºæˆ–éšå¼çš„å¤§å°è°ƒæ•´ä¿¡æ¯ã€‚è¯¥è¿‡ç¨‹åœ¨ Chromeï¼ŒOperaï¼ŒSafari å’Œ Internet Explorerä¸­ç§°ä¸ºâ€œå¸ƒå±€â€ã€‚åœ¨ Firefox ä¸­ï¼Œå®ƒè¢«ç§°ä¸º Reflow ï¼ˆå›æµï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„ä½œç”¨æ˜¯ç›¸åŒçš„ã€‚&lt;/p&gt;&lt;p&gt;ç±»ä¼¼äº style è®¡ç®—ï¼Œå¸ƒå±€æˆæœ¬çš„ç›´æ¥ç›¸å…³æ˜¯ï¼š&lt;/p&gt;&lt;ul&gt;&lt;li&gt;éœ€è¦å¸ƒå±€çš„å…ƒç´ æ•°é‡ã€‚&lt;/li&gt;&lt;li&gt;è¿™äº›å¸ƒå±€çš„å¤æ‚æ€§ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="layout" scheme="http://robin-front.github.io/tags/layout/"/>
    
      <category term="css" scheme="http://robin-front.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ requestIdleCallback</title>
    <link href="http://robin-front.github.io/2017/08/25/using-requestIdleCallback/"/>
    <id>http://robin-front.github.io/2017/08/25/using-requestIdleCallback/</id>
    <published>2017-08-25T07:40:26.000Z</published>
    <updated>2017-08-25T07:40:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä½¿ç”¨-requestIdleCallback"><a href="#ä½¿ç”¨-requestIdleCallback" class="headerlink" title="ä½¿ç”¨ requestIdleCallback"></a>ä½¿ç”¨ requestIdleCallback</h1><p>è®¸å¤šç½‘ç«™å’Œåº”ç”¨ç¨‹åºéƒ½æœ‰å¾ˆå¤šè„šæœ¬æ¥æ‰§è¡Œã€‚æ‚¨çš„ JavaScript é€šå¸¸éœ€è¦å°½å¿«è¿è¡Œï¼Œä½†åŒæ—¶æ‚¨ä¸å¸Œæœ›å®ƒé˜»ç¢ç”¨æˆ·é‚£æ¡è·¯ã€‚å¦‚æœæ‚¨åœ¨ç”¨æˆ·æ»šåŠ¨é¡µé¢æ—¶å‘é€åˆ†ææ•°æ®ï¼Œæˆ–è€…åœ¨è½»è§¦æŒ‰é’®æ—¶å°†å…ƒç´ é™„åŠ åˆ° DOMï¼Œåˆ™æ‚¨çš„ Web åº”ç”¨ç¨‹åºå°†æ— æ³•å“åº”ï¼Œä»è€Œå¯¼è‡´ç”¨æˆ·ä½“éªŒä¸ä½³ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://developers.google.com/web/updates/images/2015-08-27-using-requestidlecallback/main.png" data-original="https://developers.google.com/web/updates/images/2015-08-27-using-requestidlecallback/main.png"></p><p>å¥½æ¶ˆæ¯æ˜¯ï¼Œç°åœ¨æœ‰ä¸€ä¸ª API å¯ä»¥å¸®åŠ©ï¼š<code>requestIdleCallback</code>ã€‚ä»¥åŒæ ·çš„æ–¹å¼ï¼Œ<code>requestAnimationFrame</code> æˆ‘ä»¬å¯ä»¥æ­£ç¡®åœ°å®‰æ’åŠ¨ç”»ï¼Œå¹¶æœ€å¤§é™åº¦åœ°æé«˜ 60fps çš„æœºä¼šï¼Œ<code>requestIdleCallback</code> å½“ä¸€ä¸ªæ¡†æ¶ç»“æŸæ—¶ï¼Œæˆ–å½“ç”¨æˆ·å¤„äºéæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œå¯ä»¥å®‰æ’å·¥ä½œã€‚è¿™æ„å‘³ç€æœ‰æœºä¼šåœ¨ç”¨æˆ·ä¸ä½¿ç”¨çš„æƒ…å†µä¸‹è¿›è¡Œå·¥ä½œã€‚å®ƒå¯ç”¨äº Chrome 47ï¼è¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§çš„åŠŸèƒ½ï¼Œè§„æ ¼è¿˜åœ¨ä¸æ–­å˜åŒ–ï¼Œæ‰€ä»¥å°†æ¥ä¼šå‘ç”Ÿå˜åŒ–ã€‚<a id="more"></a></p><h2 id="æ£€æŸ¥-requestIdleCallback-æ”¯æŒ"><a href="#æ£€æŸ¥-requestIdleCallback-æ”¯æŒ" class="headerlink" title="æ£€æŸ¥ requestIdleCallback æ”¯æŒ"></a>æ£€æŸ¥ requestIdleCallback æ”¯æŒ</h2><p>è¿™æ˜¯æ—©æœŸçš„ <code>requestIdleCallback</code>ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨å®ƒä¹‹å‰ï¼Œæ‚¨åº”è¯¥æ£€æŸ¥å®ƒæ˜¯å¦å¯ç”¨ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="string">'requestIdleCallback'</span> <span class="keyword">in</span> <span class="built_in">window</span>) &#123;</div><div class="line">  <span class="comment">// Use requestIdleCallback to schedule work.</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  <span class="comment">// Do what youâ€™d do today.</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä½ ä¹Ÿå¯ä»¥ polyfill å®ƒçš„è¡Œä¸ºï¼Œè¿™éœ€è¦å›åˆ° <code>setTimeout</code>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.requestIdleCallback = <span class="built_in">window</span>.requestIdleCallback ||</div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">cb</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> start = <span class="built_in">Date</span>.now();</div><div class="line">    <span class="keyword">return</span> setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      cb(&#123;</div><div class="line">        <span class="attr">didTimeout</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">timeRemaining</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="built_in">Math</span>.max(<span class="number">0</span>, <span class="number">50</span> - (<span class="built_in">Date</span>.now() - start));</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125;, <span class="number">1</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line"><span class="built_in">window</span>.cancelIdleCallback = <span class="built_in">window</span>.cancelIdleCallback ||</div><div class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123;</div><div class="line">    clearTimeout(id);</div><div class="line">  &#125;</div></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>setTimeout</code> ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºå®ƒä¸çŸ¥é“ <code>requestIdleCallback</code> çš„ç©ºé—²æ—¶é—´æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†æ˜¯å¦‚æœ <code>requestIdleCallback</code> ä¸å¯ç”¨çš„è¯ï¼Œä½ å¯ä»¥ç›´æ¥è°ƒç”¨ä½ çš„å›è°ƒï¼Œä½ æ²¡æœ‰æ¯”è¿™æ›´å·®çš„æ–¹å¼ã€‚æœ‰äº†å«ç‰‡ï¼Œ<code>requestIdleCallback</code> å°±å¯ä»¥ä½¿ç”¨ï¼Œä½ å°†è¢«é»˜è®¤é‡å®šå‘åˆ°ç›´æ¥è°ƒç”¨ï¼Œè¿™æ˜¯å¾ˆæ£’çš„ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å‡è®¾å®ƒå­˜åœ¨ã€‚</p><h2 id="ä½¿ç”¨requestIdleCallback"><a href="#ä½¿ç”¨requestIdleCallback" class="headerlink" title="ä½¿ç”¨requestIdleCallback"></a>ä½¿ç”¨requestIdleCallback</h2><p>è°ƒç”¨ <code>requestIdleCallback</code> éå¸¸ç±»ä¼¼äº <code>requestAnimationFrame</code>, å®ƒéœ€è¦å›è°ƒå‡½æ•°ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">requestIdleCallback(myNonEssentialWork);</div></pre></td></tr></table></figure><p>å½“ <code>myNonEssentialWork</code> è¢«è°ƒç”¨æ—¶ï¼Œå®ƒå°†è¢«èµ‹äºˆä¸€ä¸ª <code>deadline</code>, å®ƒæ˜¯ä¸€ä¸ªåŒ…å«å‡½æ•°çš„å¯¹è±¡ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæ•°å­—ï¼ŒæŒ‡ç¤ºæ‚¨çš„å·¥ä½œå‰©ä½™å¤šå°‘æ—¶é—´ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myNonEssentialWork</span> (<span class="params">deadline</span>) </span>&#123;</div><div class="line">  <span class="keyword">while</span> (deadline.timeRemaining() &gt; <span class="number">0</span>)</div><div class="line">    doWorkIfNeeded();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><code>timeRemaining</code> å¯ä»¥è°ƒç”¨è¯¥å‡½æ•°æ¥è·å–æœ€æ–°å€¼ã€‚å½“ <code>timeRemaining()</code> è¿”å›é›¶æ—¶ï¼Œæ‚¨å¯ä»¥å®‰æ’å¦ä¸€ä¸ª <code>requestIdleCallback</code>, å¦‚æœæ‚¨è¿˜æœ‰æ›´å¤šçš„å·¥ä½œè¦åšï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myNonEssentialWork</span> (<span class="params">deadline</span>) </span>&#123;</div><div class="line">  <span class="keyword">while</span> (deadline.timeRemaining() &gt; <span class="number">0</span> &amp;&amp; tasks.length &gt; <span class="number">0</span>)</div><div class="line">    doWorkIfNeeded();</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (tasks.length &gt; <span class="number">0</span>)</div><div class="line">    requestIdleCallback(myNonEssentialWork);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="è°ƒç”¨ä½ çš„ä»»åŠ¡"><a href="#è°ƒç”¨ä½ çš„ä»»åŠ¡" class="headerlink" title="è°ƒç”¨ä½ çš„ä»»åŠ¡"></a>è°ƒç”¨ä½ çš„ä»»åŠ¡</h2><p>å¦‚æœæµè§ˆå™¨çœŸçš„å¾ˆå¿™ï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿæ‚¨å¯èƒ½ä¼šæ‹…å¿ƒæ‚¨çš„å›è°ƒå¯èƒ½æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ã€‚å—¯ï¼Œè™½ç„¶ <code>requestIdleCallback</code> ç±»ä¼¼ <code>requestAnimationFrame</code>ï¼Œä½†å®ƒä¹Ÿæœ‰æ‰€ä¸åŒï¼Œå®ƒéœ€è¦ä¸€ä¸ªå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ï¼šå…·æœ‰ <code>timeout</code> å±æ€§çš„ <code>options</code> å¯¹è±¡ã€‚æ­¤è¶…æ—¶ï¼ˆå¦‚æœè®¾ç½®ï¼‰ä¸ºæµè§ˆå™¨æä¾›äº†å¿…é¡»æ‰§è¡Œå›è°ƒçš„æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Wait at most two seconds before processing events.</span></div><div class="line">requestIdleCallback(processPendingAnalyticsEvents, &#123; <span class="attr">timeout</span>: <span class="number">2000</span> &#125;);</div></pre></td></tr></table></figure><p>å¦‚æœæ‚¨çš„å›è°ƒç”±äºè¶…æ—¶è§¦å‘è€Œæ‰§è¡Œï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ä¸¤ä»¶äº‹æƒ…ï¼š</p><ul><li><code>timeRemaining()</code> å°†è¿”å›é›¶ã€‚</li><li>å¯¹è±¡çš„ <code>didTimeout</code> å±æ€§ <code>deadline</code> å°†ä¸º <code>true</code>ã€‚</li></ul><p>å¦‚æœä½ çœ‹åˆ°è¿™ <code>didTimeout</code> æ˜¯çœŸçš„ï¼Œä½ å¾ˆå¯èƒ½åªæƒ³è¿è¡Œè¿™ä¸ªå·¥ä½œå¹¶å®Œæˆå®ƒï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myNonEssentialWork</span> (<span class="params">deadline</span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// Use any remaining time, or, if timed out, just run through the tasks.</span></div><div class="line">  <span class="keyword">while</span> ((deadline.timeRemaining() &gt; <span class="number">0</span> || deadline.didTimeout) &amp;&amp;</div><div class="line">         tasks.length &gt; <span class="number">0</span>)</div><div class="line">    doWorkIfNeeded();</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (tasks.length &gt; <span class="number">0</span>)</div><div class="line">    requestIdleCallback(myNonEssentialWork);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç”±äºæ½œåœ¨çš„ä¸­æ–­ï¼Œè¿™ç§è¶…æ—¶å¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„ç”¨æˆ·ï¼ˆå·¥ä½œå¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„åº”ç”¨ç¨‹åºå˜å¾—æ— å“åº”æˆ–jankyï¼‰è®¾ç½®æ­¤å‚æ•°æ—¶è¦è°¨æ…ã€‚åœ¨å“ªé‡Œå¯ä»¥è®©æµè§ˆå™¨å†³å®šä½•æ—¶è°ƒç”¨å›è°ƒã€‚</p><h2 id="ä½¿ç”¨-requestIdleCallback-å‘é€åˆ†ææ•°æ®"><a href="#ä½¿ç”¨-requestIdleCallback-å‘é€åˆ†ææ•°æ®" class="headerlink" title="ä½¿ç”¨ requestIdleCallback å‘é€åˆ†ææ•°æ®"></a>ä½¿ç”¨ requestIdleCallback å‘é€åˆ†ææ•°æ®</h2><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹ <code>requestIdleCallback</code> å‘é€åˆ†ææ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæƒ³è·Ÿè¸ªä¸€ä¸ªäº‹ä»¶ï¼Œæ¯”å¦‚è¯´ - ç‚¹å‡»å¯¼èˆªèœå•ã€‚ä¸è¿‡ï¼Œç”±äºé€šå¸¸åœ¨è¤å¹•ä¸Šè®¾å®šåŠ¨ç”»ï¼Œæˆ‘ä»¬å¸Œæœ›é¿å…ç«‹å³å°†æ­¤äº‹ä»¶å‘é€åˆ° Google Analyticsï¼ˆåˆ†æï¼‰ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ç³»åˆ—äº‹ä»¶æ¥å‘é€å’Œè¯·æ±‚åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´å‘é€å®ƒä»¬ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> eventsToSend = [];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onNavOpenClick</span> (<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// Animate the menu.</span></div><div class="line">  menu.classList.add(<span class="string">'open'</span>);</div><div class="line"></div><div class="line">  <span class="comment">// Store the event for later.</span></div><div class="line">  eventsToSend.push(</div><div class="line">    &#123;</div><div class="line">      <span class="attr">category</span>: <span class="string">'button'</span>,</div><div class="line">      <span class="attr">action</span>: <span class="string">'click'</span>,</div><div class="line">      <span class="attr">label</span>: <span class="string">'nav'</span>,</div><div class="line">      <span class="attr">value</span>: <span class="string">'open'</span></div><div class="line">    &#125;);</div><div class="line"></div><div class="line">  schedulePendingEvents();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>requestIdleCallback</code> æ¥å¤„ç†ä»»ä½•å¾…å¤„ç†çš„äº‹ä»¶ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">schedulePendingEvents</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// Only schedule the rIC if one has not already been set.</span></div><div class="line">  <span class="keyword">if</span> (isRequestIdleCallbackScheduled)</div><div class="line">    <span class="keyword">return</span>;</div><div class="line"></div><div class="line">  isRequestIdleCallbackScheduled = <span class="literal">true</span>;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (<span class="string">'requestIdleCallback'</span> <span class="keyword">in</span> <span class="built_in">window</span>) &#123;</div><div class="line">    <span class="comment">// Wait at most two seconds before processing events.</span></div><div class="line">    requestIdleCallback(processPendingAnalyticsEvents, &#123; <span class="attr">timeout</span>: <span class="number">2000</span> &#125;);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    processPendingAnalyticsEvents();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æˆ‘è®¾ç½®äº†2ç§’çš„è¶…æ—¶æ—¶é—´ï¼Œä½†è¿™ä¸ªå€¼å–å†³äºä½ çš„åº”ç”¨ç¨‹åºã€‚å¯¹äºåˆ†ææ•°æ®ï¼Œæœ‰æ„ä¹‰çš„æ˜¯ï¼Œå°†ä½¿ç”¨è¶…æ—¶æ—¶é—´æ¥ç¡®ä¿æ•°æ®åœ¨åˆç†çš„æ—¶é—´å†…æŠ¥å‘Šï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹ã€‚</p><p>æœ€åæˆ‘ä»¬éœ€è¦ç¼–å†™ <code>requestIdleCallback</code> å°†æ‰§è¡Œçš„å‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processPendingAnalyticsEvents</span> (<span class="params">deadline</span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// Reset the boolean so future rICs can be set.</span></div><div class="line">  isRequestIdleCallbackScheduled = <span class="literal">false</span>;</div><div class="line"></div><div class="line">  <span class="comment">// If there is no deadline, just run as long as necessary.</span></div><div class="line">  <span class="comment">// This will be the case if requestIdleCallback doesnâ€™t exist.</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> deadline === <span class="string">'undefined'</span>)</div><div class="line">    deadline = &#123; <span class="attr">timeRemaining</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Number</span>.MAX_VALUE &#125; &#125;;</div><div class="line"></div><div class="line">  <span class="comment">// Go for as long as there is time remaining and work to do.</span></div><div class="line">  <span class="keyword">while</span> (deadline.timeRemaining() &gt; <span class="number">0</span> &amp;&amp; eventsToSend.length &gt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">var</span> evt = eventsToSend.pop();</div><div class="line"></div><div class="line">    ga(<span class="string">'send'</span>, <span class="string">'event'</span>,</div><div class="line">        evt.category,</div><div class="line">        evt.action,</div><div class="line">        evt.label,</div><div class="line">        evt.value);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// Check if there are more events still to send.</span></div><div class="line">  <span class="keyword">if</span> (eventsToSend.length &gt; <span class="number">0</span>)</div><div class="line">    schedulePendingEvents();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘å‡è®¾å¦‚æœ <code>requestIdleCallback</code> ä¸å­˜åœ¨åˆ†ææ•°æ®åº”è¯¥ç«‹å³å‘é€ã€‚ç„¶è€Œï¼Œåœ¨ç”Ÿäº§åº”ç”¨ç¨‹åºä¸­ï¼Œå»¶è¿Ÿå‘é€è¶…æ—¶å¯èƒ½ä¼šæ›´å¥½ï¼Œä»¥ç¡®ä¿å®ƒä¸ä¼šä¸ä»»ä½•äº¤äº’å†²çªï¼Œå¹¶å¯¼è‡´ jankã€‚</p><h2 id="ä½¿ç”¨-requestIdleCallback-è¿›è¡Œ-DOM-æ›´æ”¹"><a href="#ä½¿ç”¨-requestIdleCallback-è¿›è¡Œ-DOM-æ›´æ”¹" class="headerlink" title="ä½¿ç”¨ requestIdleCallback è¿›è¡Œ DOM æ›´æ”¹"></a>ä½¿ç”¨ <code>requestIdleCallback</code> è¿›è¡Œ DOM æ›´æ”¹</h2><p>å¦ä¸€ç§ <code>requestIdleCallback</code> çœŸæ­£æœ‰åŠ©äºè¡¨ç°çš„æƒ…å†µæ˜¯å½“æ‚¨è¿›è¡Œéå¿…è¦çš„ DOM æ›´æ”¹æ—¶ï¼Œä¾‹å¦‚å°†é¡¹ç›®æ·»åŠ åˆ°ä¸æ–­å¢é•¿çš„æƒ°æ€§åˆ—è¡¨çš„æœ«å°¾ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•å°† requestIdleCallback å®é™…åº”ç”¨åœ¨ä¸€ä¸ªå…¸å‹çš„æ¡†æ¶ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://developers.google.com/web/updates/images/2015-08-27-using-requestidlecallback/frame.jpg" data-original="https://developers.google.com/web/updates/images/2015-08-27-using-requestidlecallback/frame.jpg"></p><p>æµè§ˆå™¨å¯èƒ½å¤ªå¿™ï¼Œæ— æ³•åœ¨ç»™å®šçš„æ¡†æ¶ä¸­è¿è¡Œä»»ä½•å›è°ƒï¼Œæ‰€ä»¥æ‚¨ä¸åº”è¯¥æœŸæœ›åœ¨æ¡†æ¶ç»“å°¾å¤„æœ‰ä»»ä½•ç©ºé—²æ—¶é—´æ¥æ‰§è¡Œä»»ä½•æ›´å¤šçš„å·¥ä½œã€‚è¿™ä½¿å¾—å®ƒä¸åŒäº <code>setImmediate</code> è¿™ç±»æ¯å¸§éƒ½è¿è¡Œçš„ä¸œè¥¿ã€‚</p><p>å¦‚æœå›è°ƒåœ¨æ¡†æ¶ç»“æŸæ—¶è¢«è§¦å‘ï¼Œå®ƒå°†è¢«è°ƒåº¦åˆ°å½“å‰å¸§å·²ç»æäº¤ä¹‹åï¼Œè¿™æ„å‘³ç€å°†åº”ç”¨æ ·å¼æ›´æ”¹ï¼Œå¹¶ä¸”é‡è¦çš„æ˜¯å¸ƒå±€è®¡ç®—ã€‚å¦‚æœæˆ‘ä»¬åœ¨ç©ºé—²å›è°ƒå†…éƒ¨è¿›è¡Œ DOM æ›´æ”¹ï¼Œè¿™äº›å¸ƒå±€è®¡ç®—å°†æ— æ•ˆã€‚å¦‚æœæœ‰ä»»ä½•è¯»å–ä¸‹ä¸€å¸§å¸ƒå±€çš„äº‹ä»¶ï¼Œä¾‹å¦‚ <code>getBoundingClientRect</code>ï¼Œ<code>clientWidth</code>ç­‰ç­‰ï¼Œæµè§ˆå™¨å°†ä¸å¾—ä¸è¿›è¡Œ<a href="https://developers.google.com/web/fundamentals/performance/rendering/avoid-large-complex-layouts-and-layout-thrashing#avoid-forced-synchronous-layouts" target="_blank" rel="noopener">å¼ºåˆ¶åŒæ­¥å¸ƒå±€</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ€§èƒ½ç“¶é¢ˆã€‚</p><p>ä¸è¦åœ¨ç©ºé—²å›è°ƒä¸­ DOM æ›´æ”¹çš„å¦ä¸€ä¸ªåŸå› æ˜¯æ›´æ”¹ DOM çš„æ—¶é—´å½±å“æ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è¶…è¿‡æµè§ˆå™¨æä¾›çš„æœŸé™ã€‚</p><p>æœ€å¥½çš„åšæ³•æ˜¯åªèƒ½åœ¨ <code>requestAnimationFrame</code> å›è°ƒå†…éƒ¨è¿›è¡Œ DOM æ›´æ”¹ï¼Œå› ä¸ºå®ƒæ˜¯ç”±æµè§ˆå™¨å®‰æ’çš„é‚£ç§ç±»å‹çš„å·¥ä½œã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„ä»£ç å°†éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–‡æ¡£ç‰‡æ®µï¼Œç„¶åå¯ä»¥å°†å…¶é™„åŠ åœ¨ä¸‹ä¸€ä¸ª <code>requestAnimationFrame</code> å›è°ƒä¸­ã€‚å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ VDOM åº“ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>requestIdleCallback</code> è¿›è¡Œæ›´æ”¹ï¼Œä½†æ˜¯æ‚¨å¯ä»¥åœ¨ä¸‹ä¸€ä¸ªå›è°ƒä¸­åº”ç”¨ DOM ä¿®è¡¥ç¨‹åº <code>requestAnimationFrame</code>ï¼Œè€Œä¸æ˜¯ç©ºé—²å›è°ƒã€‚</p><p>æ‰€ä»¥è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processPendingElements</span> (<span class="params">deadline</span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// If there is no deadline, just run as long as necessary.</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> deadline === <span class="string">'undefined'</span>)</div><div class="line">    deadline = &#123; <span class="attr">timeRemaining</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Number</span>.MAX_VALUE &#125; &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (!documentFragment)</div><div class="line">    documentFragment = <span class="built_in">document</span>.createDocumentFragment();</div><div class="line"></div><div class="line">  <span class="comment">// Go for as long as there is time remaining and work to do.</span></div><div class="line">  <span class="keyword">while</span> (deadline.timeRemaining() &gt; <span class="number">0</span> &amp;&amp; elementsToAdd.length &gt; <span class="number">0</span>) &#123;</div><div class="line"></div><div class="line">    <span class="comment">// Create the element.</span></div><div class="line">    <span class="keyword">var</span> elToAdd = elementsToAdd.pop();</div><div class="line">    <span class="keyword">var</span> el = <span class="built_in">document</span>.createElement(elToAdd.tag);</div><div class="line">    el.textContent = elToAdd.content;</div><div class="line"></div><div class="line">    <span class="comment">// Add it to the fragment.</span></div><div class="line">    documentFragment.appendChild(el);</div><div class="line"></div><div class="line">    <span class="comment">// Don't append to the document immediately, wait for the next</span></div><div class="line">    <span class="comment">// requestAnimationFrame callback.</span></div><div class="line">    scheduleVisualUpdateIfNeeded();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// Check if there are more events still to send.</span></div><div class="line">  <span class="keyword">if</span> (elementsToAdd.length &gt; <span class="number">0</span>)</div><div class="line">    scheduleElementCreation();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œæˆ‘åˆ›å»ºå…ƒç´ å¹¶ä½¿ç”¨è¯¥ <code>textContent</code> å±æ€§æ¥å¡«å……å®ƒï¼Œä½†æ˜¯æ‚¨çš„å…ƒç´ åˆ›å»ºä»£ç å¯èƒ½ä¼šæ›´å¤šçš„æ“ä½œï¼åœ¨åˆ›å»ºå…ƒç´ å <code>scheduleVisualUpdateIfNeeded</code>ï¼Œè°ƒç”¨è¯¥å…ƒç´ å°†ä¼šå»ºç«‹ä¸€ä¸ªå•ç‹¬çš„ <code>requestAnimationFrame</code> å›è°ƒï¼Œç„¶åä¾æ¬¡å°†æ–‡æ¡£ç‰‡æ®µé™„åŠ åˆ°æ­£æ–‡ä¸­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">scheduleVisualUpdateIfNeeded</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (isVisualUpdateScheduled)</div><div class="line">    <span class="keyword">return</span>;</div><div class="line"></div><div class="line">  isVisualUpdateScheduled = <span class="literal">true</span>;</div><div class="line"></div><div class="line">  requestAnimationFrame(appendDocumentFragment);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">appendDocumentFragment</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// Append the fragment and reset.</span></div><div class="line">  <span class="built_in">document</span>.body.appendChild(documentFragment);</div><div class="line">  documentFragment = <span class="literal">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸€åˆ‡é¡ºåˆ©ï¼Œæˆ‘ä»¬ç°åœ¨å°†æŠŠé¡¹ç›®é™„åŠ åˆ° DOM æ—¶çœ‹èµ·æ¥æ›´å°‘ jankã€‚ä¼˜ç§€ï¼</p><h2 id="å¸¸é—®é—®é¢˜"><a href="#å¸¸é—®é—®é¢˜" class="headerlink" title="å¸¸é—®é—®é¢˜"></a>å¸¸é—®é—®é¢˜</h2><ul><li>æ˜¯å¦æœ‰ polyfillï¼Ÿ å¯æ‚²çš„æ˜¯ï¼Œæ²¡æœ‰ã€‚å¦‚æœä½ æƒ³è¦é€æ˜çš„é‡å®šå‘åˆ° <code>setTimeout</code>ï¼Œé‚£å°±æœ‰ä¸€ä¸ª <code>shim</code> ã€‚è¯¥APIå­˜åœ¨çš„åŸå› æ˜¯å› ä¸ºå®ƒåœ¨Webå¹³å°ä¸­æ’å…¥äº†éå¸¸çœŸå®çš„å·®è·ã€‚ä½†æ˜¯æ²¡æœ‰JavaScript APIæ¥ç¡®å®šæ¡†æ¶ç»“æŸæ—¶çš„ç©ºé—²æ—¶é—´ï¼Œæ‰€ä»¥æœ€å¤šåªèƒ½åšå‡ºçŒœæµ‹ã€‚åƒ <code>setTimeout</code>ï¼Œ<code>setInterval</code> æˆ–è€… <code>setImmediate</code> è¿™æ ·çš„ API å¯ä»¥ç”¨äºè°ƒåº¦å·¥ä½œï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æŒ‰ç…§ <code>requestIdleCallback</code> è¿™æ ·çš„æ–¹å¼é¿å¼€ç”¨æˆ·äº¤äº’ã€‚</li><li>å¦‚æœæˆ‘è®¾ç½® <code>timeout</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å¦‚æœ <code>timeRemaining()</code> è¿”å›é›¶ï¼Œä½†æ˜¯æ‚¨é€‰æ‹©è¿è¡Œæ›´é•¿æ—¶é—´ï¼Œæ‚¨å¯ä»¥è¿™æ ·åšï¼Œè€Œä¸ç”¨æ‹…å¿ƒæµè§ˆå™¨åœæ­¢å·¥ä½œã€‚ä½†æ˜¯ï¼Œæµè§ˆå™¨ä¸ºæ‚¨æä¾›äº†æœ€ç»ˆæœŸé™ï¼Œä»¥ç¡®ä¿æ‚¨çš„ç”¨æˆ·é¡ºåˆ©ä½“éªŒï¼Œå› æ­¤é™¤éæœ‰éå¸¸å¥½çš„ç†ç”±ï¼Œå¦åˆ™æ‚¨åº”å§‹ç»ˆéµå®ˆæœ€ç»ˆæœŸé™ã€‚</li><li><code>timeRemaining()</code> ä¼šè¿”å›æœ‰æœ€å¤§å€¼å—ï¼Ÿ æ˜¯çš„ï¼Œç°åœ¨æ˜¯ <code>50ms</code> ã€‚åœ¨å°è¯•ç»´æŠ¤å“åº”å¼åº”ç”¨ç¨‹åºæ—¶ï¼Œæ‰€æœ‰å¯¹ç”¨æˆ·äº¤äº’çš„å“åº”åº”ä¿æŒåœ¨ 100ms ä»¥ä¸‹ã€‚å¦‚æœç”¨æˆ·åœ¨ 50ms çª—å£ä¸­è¿›è¡Œäº¤äº’ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åº”å…è®¸ç©ºé—²å›è°ƒå®Œæˆï¼Œå¹¶ä¸”æµè§ˆå™¨å¯ä»¥å“åº”ç”¨æˆ·çš„äº¤äº’ã€‚æ‚¨å¯èƒ½ä¼šå¾—åˆ°å¤šä¸ªç©ºé—²çš„å›è°ƒï¼ˆå¦‚æœæµè§ˆå™¨ç¡®å®šæœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥è¿è¡Œå®ƒä»¬ï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬å°†è¢«ä¸€ä¸ªä¸ªå®‰æ’ã€‚</li><li>æœ‰æ²¡æœ‰ä»€ä¹ˆå·¥ä½œæˆ‘ä¸åº”è¯¥åœ¨ <code>requestIdleCallback</code> é‡Œæ‰§è¡Œï¼Ÿ ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨æ‰€åšçš„å·¥ä½œåº”è¯¥æ˜¯å…·æœ‰ç›¸å¯¹å¯é¢„æµ‹ç‰¹å¾çš„å°å—ï¼ˆå¾®ä»»åŠ¡ï¼‰ã€‚ä¾‹å¦‚ï¼Œç‰¹åˆ«æ˜¯æ›´æ”¹ DOM å°†å…·æœ‰ä¸å¯é¢„æµ‹çš„æ‰§è¡Œæ—¶é—´ï¼Œå› ä¸ºå®ƒå°†è§¦å‘æ ·å¼è®¡ç®—ï¼Œå¸ƒå±€ï¼Œç»˜ç”»å’Œåˆæˆã€‚å› æ­¤ï¼Œæ‚¨åº”è¯¥ä»…åœ¨ä¸Šè¿° requestAnimationFrame å›è°ƒä¸­è¿›è¡Œ DOM æ›´æ”¹ã€‚è¦æ³¨æ„çš„å¦ä¸€ä»¶äº‹æ˜¯è§£å†³ï¼ˆæˆ–æ‹’ç»ï¼‰Promisesï¼Œå› ä¸ºåœ¨ç©ºé—²å›è°ƒå®Œæˆåå›è°ƒå°†ç«‹å³æ‰§è¡Œï¼Œå³ä½¿æ²¡æœ‰æ›´å¤šçš„æ—¶é—´å‰©ä½™ã€‚</li><li>æˆ‘ä¼šæ€»æ˜¯åœ¨ä¸€å¸§ç»“æŸæ—¶è¢«æ‰§è¡Œ <code>requestIdleCallback</code> ï¼Ÿä¸ï¼Œä¸æ€»æ˜¯ã€‚æµè§ˆå™¨å°†åœ¨å¸§ç»“æŸæ—¶çš„ç©ºé—²æ—¶é—´æˆ–ç”¨æˆ·å¤„äºéæ´»åŠ¨çŠ¶æ€çš„æ—¶æ®µå†…è°ƒåº¦å›è°ƒã€‚æ‚¨ä¸åº”è¯¥æœŸæœ›æ¯å¸§è°ƒç”¨å›è°ƒï¼Œå¹¶ä¸”å¦‚æœè¦æ±‚å®ƒåœ¨ç»™å®šçš„æ—¶é—´èŒƒå›´å†…è¿è¡Œï¼Œåˆ™åº”è¯¥ä½¿ç”¨è¶…æ—¶ã€‚</li><li>æˆ‘å¯ä»¥æœ‰å¤šä¸ª <code>requestIdleCallback</code> å›è°ƒå—ï¼Ÿ æ˜¯çš„ï¼Œä½ å¯ä»¥æ‹¥æœ‰éå¸¸å¤šä¸ª <code>requestAnimationFrame</code> å›è°ƒã€‚å€¼å¾—è®°ä½çš„æ˜¯ï¼Œå¦‚æœä½ çš„ç¬¬ä¸€ä¸ªå›è°ƒä½¿ç”¨äº†å®ƒåœ¨å›è°ƒæœŸé—´çš„å‰©ä½™æ—¶é—´ï¼Œé‚£ä¹ˆä»»ä½•å…¶ä»–å›è°ƒéƒ½ä¸ä¼šæœ‰æ›´å¤šçš„æ—¶é—´ã€‚ç„¶åï¼Œå…¶ä»–å›è°ƒå°†ä¸å¾—ä¸ç­‰å¾…æµè§ˆå™¨ä¸‹ä¸€ä¸ªç©ºé—²ï¼Œæ‰èƒ½è¿è¡Œã€‚æ ¹æ®æ‚¨è¦å®Œæˆçš„å·¥ä½œï¼Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªç©ºé—²çš„å›è°ƒï¼Œå¹¶å°†å·¥ä½œåˆ†é…åˆ°é‚£é‡Œã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¶…æ—¶æ—¶é—´æ¥ç¡®ä¿å›è°ƒéƒ½æœ‰æœºä¼šæ‰§è¡Œã€‚</li><li>å¦‚æœæˆ‘åœ¨å¦ä¸€ä¸ªå†…éƒ¨è®¾ç½®ä¸€ä¸ªæ–°çš„ç©ºé—²å›è°ƒï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ æ–°çš„ç©ºé—²å›è°ƒå°†è¢«å®‰æ’å°½å¿«è¿è¡Œï¼Œä»ä¸‹ä¸€ä¸ªå¸§å¼€å§‹ï¼ˆè€Œä¸æ˜¯å½“å‰çš„ï¼‰ã€‚</li></ul><h2 id="åˆ©ç”¨ç©ºé—²"><a href="#åˆ©ç”¨ç©ºé—²" class="headerlink" title="åˆ©ç”¨ç©ºé—²"></a>åˆ©ç”¨ç©ºé—²</h2><p><code>requestIdleCallback</code> æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„æ–¹æ³•ï¼Œä»¥ç¡®ä¿æ‚¨å¯ä»¥è¿è¡Œæ‚¨çš„ä»£ç ï¼Œä½†æ²¡æœ‰é˜»ç¢ç”¨æˆ·çš„äº¤äº’ã€‚ä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œéå¸¸çµæ´»ã€‚ä½†ä»ç„¶å±äºæ—©æœŸï¼Œè€Œä¸”è§„èŒƒè¿˜æ²¡æœ‰å®Œå…¨è§£å†³ï¼Œæ‰€ä»¥ä½ æ‰€æä¾›çš„ä»»ä½•åé¦ˆéƒ½æ˜¯å€¼å¾—æ¬¢è¿çš„ã€‚</p><p>ã€ç¿»è¯‘åŸæ–‡ã€‘:<a href="https://developers.google.com/web/updates/2015/08/using-requestidlecallback" target="_blank" rel="noopener">useing requestIdleCallback</a></p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä½¿ç”¨-requestIdleCallback&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨-requestIdleCallback&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨ requestIdleCallback&quot;&gt;&lt;/a&gt;ä½¿ç”¨ requestIdleCallback&lt;/h1&gt;&lt;p&gt;è®¸å¤šç½‘ç«™å’Œåº”ç”¨ç¨‹åºéƒ½æœ‰å¾ˆå¤šè„šæœ¬æ¥æ‰§è¡Œã€‚æ‚¨çš„ JavaScript é€šå¸¸éœ€è¦å°½å¿«è¿è¡Œï¼Œä½†åŒæ—¶æ‚¨ä¸å¸Œæœ›å®ƒé˜»ç¢ç”¨æˆ·é‚£æ¡è·¯ã€‚å¦‚æœæ‚¨åœ¨ç”¨æˆ·æ»šåŠ¨é¡µé¢æ—¶å‘é€åˆ†ææ•°æ®ï¼Œæˆ–è€…åœ¨è½»è§¦æŒ‰é’®æ—¶å°†å…ƒç´ é™„åŠ åˆ° DOMï¼Œåˆ™æ‚¨çš„ Web åº”ç”¨ç¨‹åºå°†æ— æ³•å“åº”ï¼Œä»è€Œå¯¼è‡´ç”¨æˆ·ä½“éªŒä¸ä½³ã€‚&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://developers.google.com/web/updates/images/2015-08-27-using-requestidlecallback/main.png&quot; alt=&quot;https://developers.google.com/web/updates/images/2015-08-27-using-requestidlecallback/main.png&quot;&gt;&lt;/p&gt;&lt;p&gt;å¥½æ¶ˆæ¯æ˜¯ï¼Œç°åœ¨æœ‰ä¸€ä¸ª API å¯ä»¥å¸®åŠ©ï¼š&lt;code&gt;requestIdleCallback&lt;/code&gt;ã€‚ä»¥åŒæ ·çš„æ–¹å¼ï¼Œ&lt;code&gt;requestAnimationFrame&lt;/code&gt; æˆ‘ä»¬å¯ä»¥æ­£ç¡®åœ°å®‰æ’åŠ¨ç”»ï¼Œå¹¶æœ€å¤§é™åº¦åœ°æé«˜ 60fps çš„æœºä¼šï¼Œ&lt;code&gt;requestIdleCallback&lt;/code&gt; å½“ä¸€ä¸ªæ¡†æ¶ç»“æŸæ—¶ï¼Œæˆ–å½“ç”¨æˆ·å¤„äºéæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œå¯ä»¥å®‰æ’å·¥ä½œã€‚è¿™æ„å‘³ç€æœ‰æœºä¼šåœ¨ç”¨æˆ·ä¸ä½¿ç”¨çš„æƒ…å†µä¸‹è¿›è¡Œå·¥ä½œã€‚å®ƒå¯ç”¨äº Chrome 47ï¼è¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§çš„åŠŸèƒ½ï¼Œè§„æ ¼è¿˜åœ¨ä¸æ–­å˜åŒ–ï¼Œæ‰€ä»¥å°†æ¥ä¼šå‘ç”Ÿå˜åŒ–ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="performance" scheme="http://robin-front.github.io/tags/performance/"/>
    
      <category term="optimization" scheme="http://robin-front.github.io/tags/optimization/"/>
    
      <category term="requestIdleCallback" scheme="http://robin-front.github.io/tags/requestIdleCallback/"/>
    
  </entry>
  
  <entry>
    <title>IntersectionObserver API</title>
    <link href="http://robin-front.github.io/2017/08/24/intersectionobserver/"/>
    <id>http://robin-front.github.io/2017/08/24/intersectionobserver/</id>
    <published>2017-08-24T01:59:34.000Z</published>
    <updated>2017-08-24T01:59:34.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IntersectionObserver"><a href="#IntersectionObserver" class="headerlink" title="IntersectionObserver"></a>IntersectionObserver</h1><p>å‡è®¾ä½ æƒ³è¿½è¸ª DOM é‡Œçš„ä¸€ä¸ªå…ƒç´ æ˜¯å¦è¿›å…¥ <a href="https://en.wikipedia.org/wiki/Viewport" target="_blank" rel="noopener">viewport</a> çš„å¯è§†åŒºã€‚ä½ åšè¿™ä»¶äº‹å¯èƒ½æ˜¯å› ä¸ºä½ æƒ³åœ¨è¿™ä¸ªæ—¶æœº lazyload å›¾ç‰‡æˆ–è€…ä½ éœ€è¦çŸ¥é“ç”¨æˆ·æ˜¯å¦çœŸçš„åœ¨çœ‹ä¸€ä¸ªæŸä¸ªå¹¿å‘Šæ¨ªå¹…ã€‚ä½ å¯ä»¥é€šè¿‡æ·»åŠ  <code>scroll</code> äº‹ä»¶é’©å­æˆ–ä½¿ç”¨å®šæ—¶å™¨å»è°ƒç”¨å…ƒç´ çš„ <code>getBoundingClientRect()</code> æ–¹æ³•ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•çœŸçš„å¾ˆæ…¢ï¼Œå› ä¸ºæ¯æ¬¡è°ƒç”¨ <code>getBoundingClientRect()</code> <a href="https://gist.github.com/paulirish/5d52fb081b3570c81e3a" target="_blank" rel="noopener">ä¼šé€ æˆæµè§ˆå™¨ re-layout å½“å‰é¡µé¢</a> å¹¶ä¼šåœ¨ä½ çš„é¡µé¢é€ æˆå¾ˆå¤§çš„å¡é¡¿å’Œé—ªçƒã€‚ <code>iframe</code> é‡Œçš„å…ƒç´ æ˜¯å¦å¯è§è¿™æ ·çš„äº‹æƒ…å‡ ä¹å¾ˆéš¾åšåˆ°ã€‚ åŸºäºå•ä¸€æºæ¨¡å‹ï¼Œæµè§ˆå™¨ä¸ä¼šè®©ä½ è®¿é—®åŒ…å« <code>iframe</code> çš„é¡µé¢çš„ä»»ä½•æ•°æ®ã€‚è¿™æ˜¯é¢‘ç¹ä½¿ç”¨ <code>iframe</code> åŠ è½½å¹¿å‘Šçš„å¸¸è§é—®é¢˜ã€‚</p><p>ä¸ºäº†è®©å¯è§åº¦æµ‹è¯•æ›´æœ‰æ•ˆç‡ï¼Œ <a href="https://wicg.github.io/IntersectionObserver/" target="_blank" rel="noopener">IntersectionObserver</a> è¢«è®¾è®¡å‡ºæ¥äº†ã€‚<code>IntersectionObserver</code> è®©ä½ çŸ¥é“è§‚å¯Ÿçš„å…ƒç´ ä½•æ—¶è¿›å…¥æˆ–é€€å‡ºæµè§ˆå™¨ <code>viewport</code>ã€‚<a id="more"></a></p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://developers.google.com/web/updates/images/2016/04/intersectionobserver/iframe.gif" data-original="https://developers.google.com/web/updates/images/2016/04/intersectionobserver/iframe.gif"></p><h2 id="å¦‚ä½•åˆ›å»ºä¸€ä¸ª-IntersectionObserver"><a href="#å¦‚ä½•åˆ›å»ºä¸€ä¸ª-IntersectionObserver" class="headerlink" title="å¦‚ä½•åˆ›å»ºä¸€ä¸ª IntersectionObserver"></a>å¦‚ä½•åˆ›å»ºä¸€ä¸ª IntersectionObserver</h2><p>API ç›¸å½“ç®€å•ï¼Œä¾‹å­ä¸€çœ‹å°±æ‡‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> io = <span class="keyword">new</span> IntersectionObserver(</div><div class="line">    <span class="function"><span class="params">entries</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(entries);</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="comment">/* ä½¿ç”¨é»˜è®¤é€‰é¡¹ï¼Œè¯¦ç»†åœ¨ä¸‹é¢ä¼šä»‹ç» */</span></div><div class="line">    &#125;</div><div class="line">);</div><div class="line"><span class="comment">// å¼€å§‹è§‚å¯Ÿä¸€ä¸ªå…ƒç´ </span></div><div class="line">io.observe(element);</div><div class="line"></div><div class="line"><span class="comment">// åœæ­¢è§‚å¯Ÿä¸€ä¸ªå…ƒç´ </span></div><div class="line"><span class="comment">// io.unobserve(element);</span></div><div class="line"></div><div class="line"><span class="comment">// ç¦ç”¨æ•´ä¸ª IntersectionObserver</span></div><div class="line"><span class="comment">// io.disconnect();</span></div></pre></td></tr></table></figure><p>ä½¿ç”¨é»˜è®¤é€‰é¡¹ï¼Œå›è°ƒä¼šåœ¨å…ƒç´ è¿›å…¥å’Œå®Œå…¨é€€å‡º <code>viewport</code> çš„æ—¶å€™è§¦å‘ã€‚</p><p>å¦‚æœä½ éœ€è¦è§‚å¯Ÿå¤šä¸ªå…ƒç´ ï¼Œå»ºè®®åœ¨åŒä¸€ä¸ª <code>IntersectionObserver</code> å®ä¾‹ä¸Šå¤šæ¬¡è°ƒç”¨ <code>observe()</code> æ¥è§‚å¯Ÿå¤šä¸ªå…ƒç´ ï¼Œè¿™ä¹Ÿæ˜¯å…è®¸çš„è°ƒç”¨æ–¹å¼ã€‚</p><p>å›è°ƒå‡½æ•°å›ä¼ çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„å¯¹è±¡ <a href="https://wicg.github.io/IntersectionObserver/#intersection-observer-entry" target="_blank" rel="noopener"><code>IntersectionObserverEntry</code></a> ã€‚æ¯ä¸ªè¿™æ ·çš„å¯¹è±¡éƒ½åŒ…å«äº†æ¯ä¸ªè§‚å¯Ÿå…ƒç´ çš„æœ€æ–°æ•°æ®ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">ğŸ”½[IntersectionObserverEntry]</div><div class="line">  ğŸ”½ 0: IntersectionObserverEntry</div><div class="line">       time: 3893.92</div><div class="line">    ğŸ”½ rootBounds: ClientRect</div><div class="line">        bottom: 920</div><div class="line">        height: 1024</div><div class="line">        left: 0</div><div class="line">        right: 1024</div><div class="line">        top: 0</div><div class="line">        width: 920</div><div class="line">    ğŸ”½ boundingClientRect: ClientRect</div><div class="line">       // ...</div><div class="line">    ğŸ”½ intersectionRect: ClientRect</div><div class="line">       // ...</div><div class="line">      intersectionRatio: 0.54</div><div class="line">    ğŸ”½ target: div#observee</div><div class="line">       // ...</div></pre></td></tr></table></figure><ul><li><a href="https://wicg.github.io/IntersectionObserver/#dom-intersectionobserverentry-rootbounds" target="_blank" rel="noopener"><code>rootBounds</code></a> æ˜¯å¯¹ root å…ƒç´ è°ƒç”¨ <code>getBoundingClientRect</code> çš„ç»“æœï¼Œé»˜è®¤ root å…ƒç´ æ˜¯ viewport ã€‚</li><li><a href="https://wicg.github.io/IntersectionObserver/#dom-intersectionobserverentry-boundingclientrect" target="_blank" rel="noopener"><code>boundingClientRect</code></a> æ˜¯è¢«è§‚å¯Ÿå…ƒç´ è°ƒç”¨ <code>getBoundingClientRect</code> çš„ç»“æœã€‚</li><li><a href="https://wicg.github.io/IntersectionObserver/#dom-intersectionobserverentry-intersectionrect" target="_blank" rel="noopener"><code>intersectionRect</code></a> æ˜¯ä¸¤ä¸ªçŸ©å½¢çš„äº¤å‰éƒ¨åˆ†ï¼Œå¯èƒ½æœ‰æ•ˆåœ°å‘Šè¯‰ä½ è¢«è§‚å¯Ÿçš„å…ƒç´ çš„å“ªä¸€éƒ¨åˆ†æ˜¯å¯è§çš„ã€‚</li><li><a href="https://wicg.github.io/IntersectionObserver/#dom-intersectionobserverentry-intersectionratio" target="_blank" rel="noopener"><code>intersectionRatio</code></a> æ˜¯æœ€ç›¸å…³çš„ï¼Œå‘Šè¯‰ä½ å…ƒç´ æœ‰ç™¾åˆ†ä¹‹å‡ æ˜¯å¯è§çš„ã€‚</li></ul><p>æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œä½ ç°åœ¨å¯ä»¥å®ç°å…ƒç´ è¿›å…¥ viewport å‰åŠæ—¶åŠ è½½çš„ç‰¹æ€§ã€‚éå¸¸æœ‰ç”¨ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://developers.google.com/web/updates/images/2016/04/intersectionobserver/intersectratio.png" data-original="https://developers.google.com/web/updates/images/2016/04/intersectionobserver/intersectratio.png"></p><p><code>IntersectionObservers</code> æ˜¯å¼‚æ­¥æ¨é€ä»–ä»¬çš„æ•°æ®ï¼Œè€Œå›è°ƒæ˜¯è¿è¡Œåœ¨ä¸»çº¿ç¨‹çš„ã€‚å¦å¤–ï¼Œè§„èŒƒæåˆ° <code>IntersectionObserver</code> åº”è¯¥ä½¿ç”¨ <a href="https://wicg.github.io/IntersectionObserver/#queue-intersection-observer-task" target="_blank" rel="noopener"><code>requestIdleCallback()</code></a>ã€‚ è¿™æ„å‘³ç€è°ƒç”¨å›è°ƒå‡½æ•°çš„ä¼˜å…ˆçº§æ˜¯éå¸¸ä½çš„ï¼Œåªä¼šåœ¨æµè§ˆå™¨æœ‰ç©ºé—²çš„æ—¶å€™è°ƒç”¨ã€‚è¿™æ˜¯æœ‰æ„è®¾è®¡çš„ã€‚</p><h2 id="Scrolling-divs"><a href="#Scrolling-divs" class="headerlink" title="Scrolling divs"></a>Scrolling divs</h2><p>æˆ‘å¹¶ä¸å–œæ¬¢åœ¨ div ä¸­æ»šåŠ¨å…ƒç´ , ä½†æˆ‘ä¸ä¼šç”¨ <code>scroll</code> åˆ¤å®š, è€Œæ˜¯ç”¨ <code>IntersectionObserver</code>ã€‚ <a href="https://wicg.github.io/IntersectionObserver/#dictdef-intersectionobserverinit" target="_blank" rel="noopener"><code>option</code></a> å¯¹è±¡æœ‰ä¸€ä¸ª <a href="https://wicg.github.io/IntersectionObserver/#dom-intersectionobserverinit-root" target="_blank" rel="noopener"><code>root</code></a> é€‰é¡¹è®©ä½ å®šä¹‰ä¸€ä¸ªä»£æ›¿ viewport çš„ root å…ƒç´ ã€‚éœ€è¦è®°ä½çš„æ˜¯ï¼Œè¦ä¿è¯ root å…ƒç´ æ˜¯æ‰€æœ‰è¢«è§‚å¯Ÿå…ƒç´ çš„ç¥–å…ˆã€‚</p><h2 id="é‡å æ‰€æœ‰å…ƒç´ "><a href="#é‡å æ‰€æœ‰å…ƒç´ " class="headerlink" title="é‡å æ‰€æœ‰å…ƒç´ "></a>é‡å æ‰€æœ‰å…ƒç´ </h2><p>ä¸ï¼é‚£æ˜¯ç³Ÿç³•çš„å¼€å‘è€…ï¼è¯·æ³¨æ„ä½¿ç”¨ç”¨æˆ·çš„ CPU å‘¨æœŸã€‚è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æ— é™æ»šåŠ¨çš„ä¾‹å­ï¼š åœ¨è„šæœ¬ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªå“¨å…µæ¥è§‚å¯Ÿå’Œå›æ”¶æ˜¯æ˜æ™ºçš„é€‰æ‹©ã€‚ä½ åº”è¯¥åœ¨æ— é™æ»šåŠ¨çš„æœ€åä¸€ä¸ªå…ƒç´ æ·»åŠ å“¨å…µã€‚å½“å“¨å…µå¿«è¦è¿›å…¥ viewport çš„æ—¶å€™ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­åŠ è½½æ•°æ®ï¼Œåˆ›å»ºæ¥ä¸‹æ¥çš„å…ƒç´ ï¼Œå¹¶æ·»åŠ åˆ°å“¨å…µä¹‹å‰çš„ DOM ç»“æ„ä¸­ã€‚å¦‚æœé‡å¤åˆ©ç”¨å“¨å…µï¼Œä¸éœ€è¦å†è°ƒç”¨ <code>observe()</code>ï¼Œ <code>IntersectionObserver</code> ä»ç„¶ä¼šç»§ç»­å·¥ä½œã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://developers.google.com/web/updates/images/2016/04/intersectionobserver/infinitescroller.png" data-original="https://developers.google.com/web/updates/images/2016/04/intersectionobserver/infinitescroller.png"></p><h3 id="æ›´å¤šåœ°æ›´æ–°ä¸å›è°ƒè°ƒç”¨"><a href="#æ›´å¤šåœ°æ›´æ–°ä¸å›è°ƒè°ƒç”¨" class="headerlink" title="æ›´å¤šåœ°æ›´æ–°ä¸å›è°ƒè°ƒç”¨"></a>æ›´å¤šåœ°æ›´æ–°ä¸å›è°ƒè°ƒç”¨</h3><p>å°±åƒå‰é¢æåˆ°çš„ï¼Œå½“è¢«ç›‘å¬å…ƒç´ è¿›å…¥æˆ–ç¦»å¼€ viewport çš„æ—¶å€™ï¼Œå›è°ƒå‡½æ•°ä¼šåˆ†åˆ«å•æ¬¡è§¦å‘ã€‚ è¿™è®©<code>IntersectionObserver</code> å¯ä»¥ç»™ä½ è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œâ€œå…ƒç´  X æ˜¯å¦åœ¨è§†å›¾ä¸­ï¼Ÿâ€ã€‚ä½†åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œè¿™è¿˜ä¸å¤Ÿã€‚</p><p><a href="https://wicg.github.io/IntersectionObserver/#dom-intersectionobserverinit-threshold" target="_blank" rel="noopener"><code>theshold</code></a> é€‰é¡¹ç™»åœºã€‚å®ƒå…è®¸ä½ å®šä¹‰ä¸€ä¸ª <a href="https://wicg.github.io/IntersectionObserver/#dom-intersectionobserverentry-intersectionratio" target="_blank" rel="noopener"><code>intersectionRatio</code></a> é˜ˆå€¼æ•°ç»„ã€‚å½“è¾¾åˆ°æ¯ä¸€ä¸ª <code>intersectionRatio</code> å€¼æ—¶ï¼Œå›è°ƒå‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ã€‚<code>theshold</code> é»˜è®¤å€¼æ˜¯ <code>[0]</code>ï¼Œå°±æ˜¯æˆ‘ä»¬è§£é‡Šçš„é»˜è®¤è¡¨ç°ã€‚å½“è®¾å®š <code>theshold</code> ä¸º <code>[0, 0.25, 0.5, 0.75, 1]</code>, æˆ‘ä»¬ä¼šåœ¨å…ƒç´ æ¯å››åˆ†ä¹‹ä¸€çš„éƒ¨åˆ†è¿›å…¥ viewport æ—¶å¾—åˆ°é€šçŸ¥ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://developers.google.com/web/updates/images/2016/04/intersectionobserver/threshold.gif" data-original="https://developers.google.com/web/updates/images/2016/04/intersectionobserver/threshold.gif"></p><h3 id="è¿˜æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿ"><a href="#è¿˜æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿ" class="headerlink" title="è¿˜æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿ"></a>è¿˜æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿ</h3><p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œè¿˜æœ‰ä¸€ä¸ªé€‰é¡¹æ²¡æœ‰è¢«æåˆ°ã€‚<a href="https://wicg.github.io/IntersectionObserver/#dom-intersectionobserverinit-rootmargin" target="_blank" rel="noopener"><code>rootMargin</code></a> å…è®¸ä½ æŒ‡å®š <code>root</code> å…ƒç´ çš„ <code>margin</code>ï¼Œæœ‰æ•ˆåœ°å…è®¸ä½ å¢åŠ æˆ–ç¼©å‡å®é™…çš„äº¤å‰åŒºåŸŸã€‚<code>margin</code> ä½¿ç”¨ css-style çš„è§„åˆ™ï¼Œ <code>10px 20px 30px 40px</code> åˆ†åˆ«è¡¨ç¤ºä¸Šã€å³ã€ä¸‹ã€å·¦ã€‚æ€»çš„æ¥è¯´ï¼Œ<code>IntersectionObserver</code> çš„é€‰é¡¹æ€»ç»“å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> IntersectionObserver(<span class="function"><span class="params">entries</span> =&gt;</span> &#123;<span class="comment">/* â€¦ */</span>&#125;, &#123;</div><div class="line">  <span class="comment">// The root to use for intersection.</span></div><div class="line">  <span class="comment">// If not provided, use the top-level documentâ€™s viewport.</span></div><div class="line">  root: <span class="literal">null</span>,</div><div class="line">  <span class="comment">// Same as margin, can be 1, 2, 3 or 4 components, possibly negative lengths.  </span></div><div class="line">  <span class="comment">// If an explicit root element is specified, components may be percentages of the</span></div><div class="line">  <span class="comment">// root element size.  If no explicit root element is specified, using a percentage</span></div><div class="line">  <span class="comment">// is an error.</span></div><div class="line">  rootMargin: <span class="string">"0px"</span>,</div><div class="line">  <span class="comment">// Threshold(s) at which to trigger callback, specified as a ratio, or list of</span></div><div class="line">  <span class="comment">// ratios, of (visible area / total area) of the observed element (hence all</span></div><div class="line">  <span class="comment">// entries must be in the range [0, 1]).  Callback will be invoked when the visible</span></div><div class="line">  <span class="comment">// ratio of the observed element crosses a threshold in the list.</span></div><div class="line">  threshold: [<span class="number">0</span>],</div><div class="line">&#125;);</div></pre></td></tr></table></figure><h3 id="iframe-é­”æ³•"><a href="#iframe-é­”æ³•" class="headerlink" title="iframe é­”æ³•"></a>iframe é­”æ³•</h3><p><code>IntersectionObserver</code> è¢«è®¾è®¡æ—¶æ˜ç¡®è€ƒè™‘å¹¿å‘ŠæœåŠ¡å’Œç½‘ç»œç¤¾äº¤æœåŠ¡ï¼Œå¯èƒ½ç»å¸¸ä¼šç”¨åˆ° <code>iframe</code> å’Œæœ‰ç›ŠäºçŸ¥é“ä»–ä»¬æ˜¯å¦åœ¨çœ‹ã€‚å¦‚æœè§‚å¯Ÿ <code>iframe</code> ä¸­çš„å…ƒç´ ï¼Œé‚£ä¹ˆæ»šåŠ¨ <code>iframe</code> å’Œæ»šåŠ¨çˆ¶é¡µé¢éƒ½å¯ä»¥åœ¨é€‚å½“çš„æ—¶å€™è§¦å‘å›è°ƒå‡½æ•°ã€‚å¯¹äºåè€…ï¼Œ <code>rootBounds</code> å°†è¢«è®¾ç½®ä¸º <code>null</code> ä»¥é¿å…æ•°æ®æºæ³„æ¼ã€‚</p><h2 id="IntersectionObserver-ä¸æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#IntersectionObserver-ä¸æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="IntersectionObserver ä¸æ˜¯ä»€ä¹ˆï¼Ÿ"></a><code>IntersectionObserver</code> ä¸æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œ <code>IntersectionObserver</code> æ˜¯è¢«æ•…æ„è®¾ç½®æˆä¸å®Œç¾å’Œä½å»¶è¿Ÿçš„ã€‚ä½¿ç”¨å®ƒä»¬åŠªåŠ›å®ç°åƒæ»šåŠ¨åŠ¨ç”»ä¹‹ç±»æ˜¯æ³¨å®šä¼šå¤±è´¥çš„ã€‚å› ä¸ºä¸¥æ ¼åœ°è¯´ï¼Œå½“ä½ è·å¾—æ•°æ®æ—¶ï¼Œæ•°æ®å·²ç»è¿‡æ—¶äº†ã€‚è¿™é‡Œæœ‰æ›´å¤šçš„å…³äº <code>IntersectionObserver</code> <a href="https://github.com/WICG/IntersectionObserver/blob/gh-pages/explainer.md" target="_blank" rel="noopener">åŸå§‹ç”¨ä¾‹</a>ã€‚</p><h2 id="å¯ä»¥åœ¨-callback-ä¸­åšå¤šå°‘äº‹æƒ…"><a href="#å¯ä»¥åœ¨-callback-ä¸­åšå¤šå°‘äº‹æƒ…" class="headerlink" title="å¯ä»¥åœ¨ callback ä¸­åšå¤šå°‘äº‹æƒ…"></a>å¯ä»¥åœ¨ <code>callback</code> ä¸­åšå¤šå°‘äº‹æƒ…</h2><p>åœ¨å›è°ƒä¸­èŠ±å¤ªå¤šæ—¶å€™ä¼šè®©ä½ çš„åº”ç”¨æ»åï¼Œå’Œå¸¸è§çš„å®è·µä¸€æ ·ã€‚</p><h2 id="ä½¿ç”¨-IntersectionObserver"><a href="#ä½¿ç”¨-IntersectionObserver" class="headerlink" title="ä½¿ç”¨ IntersectionObserver"></a>ä½¿ç”¨ IntersectionObserver</h2><p>å¯¹äº <code>IntersectionObserver</code>ï¼Œæµè§ˆå™¨çš„æ”¯æŒä»ç„¶å¾ˆå¼±ï¼Œæ‰€ä»¥å®ƒä¸ä¼šé©¬ä¸Šè¢«æ™®éåº”ç”¨ã€‚åŒæ—¶ï¼Œ<a href="https://github.com/WICG/IntersectionObserver" target="_blank" rel="noopener">WICG</a> çš„ polyfill ä¹Ÿè¢«å»ºç«‹èµ·æ¥ã€‚æ˜¾ç„¶ï¼Œä½¿ç”¨ polyfill ä¸å¦‚åŸç”Ÿå®ç°çš„æ•ˆç‡å¥½ã€‚</p><blockquote><p>Except as otherwise noted, the content of this page is licensed under the Creative Commons Attribution 3.0 License, and code samples are licensed under the Apache 2.0 License. For details, see our Site Policies. Java is a registered trademark of Oracle and/or its affiliates. ä¸Šæ¬¡æ›´æ–°æ—¥æœŸï¼šå…­æœˆ 5, 2017</p></blockquote><p>ã€ç¿»è¯‘åŸæ–‡ã€‘ï¼š <a href="https://developers.google.com/web/updates/2016/04/intersectionobserver" target="_blank" rel="noopener">intersectionobserver</a></p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;IntersectionObserver&quot;&gt;&lt;a href=&quot;#IntersectionObserver&quot; class=&quot;headerlink&quot; title=&quot;IntersectionObserver&quot;&gt;&lt;/a&gt;IntersectionObserver&lt;/h1&gt;&lt;p&gt;å‡è®¾ä½ æƒ³è¿½è¸ª DOM é‡Œçš„ä¸€ä¸ªå…ƒç´ æ˜¯å¦è¿›å…¥ &lt;a href=&quot;https://en.wikipedia.org/wiki/Viewport&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;viewport&lt;/a&gt; çš„å¯è§†åŒºã€‚ä½ åšè¿™ä»¶äº‹å¯èƒ½æ˜¯å› ä¸ºä½ æƒ³åœ¨è¿™ä¸ªæ—¶æœº lazyload å›¾ç‰‡æˆ–è€…ä½ éœ€è¦çŸ¥é“ç”¨æˆ·æ˜¯å¦çœŸçš„åœ¨çœ‹ä¸€ä¸ªæŸä¸ªå¹¿å‘Šæ¨ªå¹…ã€‚ä½ å¯ä»¥é€šè¿‡æ·»åŠ  &lt;code&gt;scroll&lt;/code&gt; äº‹ä»¶é’©å­æˆ–ä½¿ç”¨å®šæ—¶å™¨å»è°ƒç”¨å…ƒç´ çš„ &lt;code&gt;getBoundingClientRect()&lt;/code&gt; æ–¹æ³•ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•çœŸçš„å¾ˆæ…¢ï¼Œå› ä¸ºæ¯æ¬¡è°ƒç”¨ &lt;code&gt;getBoundingClientRect()&lt;/code&gt; &lt;a href=&quot;https://gist.github.com/paulirish/5d52fb081b3570c81e3a&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¼šé€ æˆæµè§ˆå™¨ re-layout å½“å‰é¡µé¢&lt;/a&gt; å¹¶ä¼šåœ¨ä½ çš„é¡µé¢é€ æˆå¾ˆå¤§çš„å¡é¡¿å’Œé—ªçƒã€‚ &lt;code&gt;iframe&lt;/code&gt; é‡Œçš„å…ƒç´ æ˜¯å¦å¯è§è¿™æ ·çš„äº‹æƒ…å‡ ä¹å¾ˆéš¾åšåˆ°ã€‚ åŸºäºå•ä¸€æºæ¨¡å‹ï¼Œæµè§ˆå™¨ä¸ä¼šè®©ä½ è®¿é—®åŒ…å« &lt;code&gt;iframe&lt;/code&gt; çš„é¡µé¢çš„ä»»ä½•æ•°æ®ã€‚è¿™æ˜¯é¢‘ç¹ä½¿ç”¨ &lt;code&gt;iframe&lt;/code&gt; åŠ è½½å¹¿å‘Šçš„å¸¸è§é—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;ä¸ºäº†è®©å¯è§åº¦æµ‹è¯•æ›´æœ‰æ•ˆç‡ï¼Œ &lt;a href=&quot;https://wicg.github.io/IntersectionObserver/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;IntersectionObserver&lt;/a&gt; è¢«è®¾è®¡å‡ºæ¥äº†ã€‚&lt;code&gt;IntersectionObserver&lt;/code&gt; è®©ä½ çŸ¥é“è§‚å¯Ÿçš„å…ƒç´ ä½•æ—¶è¿›å…¥æˆ–é€€å‡ºæµè§ˆå™¨ &lt;code&gt;viewport&lt;/code&gt;ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="lazyload" scheme="http://robin-front.github.io/tags/lazyload/"/>
    
      <category term="performance" scheme="http://robin-front.github.io/tags/performance/"/>
    
      <category term="optimization" scheme="http://robin-front.github.io/tags/optimization/"/>
    
      <category term="IntersectionObserver" scheme="http://robin-front.github.io/tags/IntersectionObserver/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ intersection observer å»¶è¿ŸåŠ è½½å›¾ç‰‡</title>
    <link href="http://robin-front.github.io/2017/08/18/lazy-loading-images-using-intersection-observer/"/>
    <id>http://robin-front.github.io/2017/08/18/lazy-loading-images-using-intersection-observer/</id>
    <published>2017-08-18T02:14:15.000Z</published>
    <updated>2017-08-18T02:14:15.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä½¿ç”¨-intersection-observer-å»¶è¿ŸåŠ è½½å›¾ç‰‡"><a href="#ä½¿ç”¨-intersection-observer-å»¶è¿ŸåŠ è½½å›¾ç‰‡" class="headerlink" title="ä½¿ç”¨ intersection observer å»¶è¿ŸåŠ è½½å›¾ç‰‡"></a>ä½¿ç”¨ intersection observer å»¶è¿ŸåŠ è½½å›¾ç‰‡</h1><p>å¦‚æœæ‚¨è¿˜æ²¡æœ‰çœ‹è¿‡ï¼ŒPaul Lewis ç»„ç»‡äº†ä¸€ä¸ªä»¤äººæ•¬ç•çš„è§†é¢‘ç³»åˆ—ï¼Œæ¼”ç¤ºå¦‚ä½•æ„å»ºåª’ä½“æ’­æ”¾å™¨ä»¥åŠæ‹¥æœ‰éå¸¸æ£’çš„ç‰¹æ€§çš„ Progressive Web Appsã€‚ä»–åœ¨YouTubeä¸Šå»ºç«‹äº†<a href="https://www.youtube.com/playlist?list=PLNYkxOF6rcIBykcJ7bvTpqU7vt-oey72J" target="_blank" rel="noopener">ä¸€ç³»åˆ—è§†é¢‘</a>ï¼Œè¿™äº›è§†é¢‘æ˜¯åœ¨ä»–å»ºç«‹ç½‘ç«™çš„æ¯ä¸€éƒ¨åˆ†çš„è¿‡ç¨‹ä¸­å‘ç”Ÿçš„ã€‚è§‚çœ‹å¼€å‘è€…å±•ç¤ºä»–ä»¬å·¥ä½œçš„è§†é¢‘ç»å¯¹æ˜¯æˆ‘æœ€å–œæ¬¢å­¦ä¹ æ–°äº‹ç‰©çš„æ–¹æ³•ä¹‹ä¸€ï¼</p><a id="more"></a><p>å½“ä»–åœ¨æ¼”ç¤ºä»–çš„ä»£ç æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°ä»–åˆ›å»ºäº†ä¸€ä¸ªå‡ºè‰²çš„ helper åº“æ¥å»¶è¿ŸåŠ è½½å›¾åƒã€‚æˆ‘ä¸€ç›´åœ¨å¯»æ‰¾æ”¹å–„æˆ‘ç½‘ç«™æ€§èƒ½çš„æ–¹æ³•ï¼Œè¿™æ— ç–‘å¼•èµ·äº†æˆ‘çš„å…´è¶£ã€‚</p><h2 id="ä¸æ‡’æƒ°åŠ è½½æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ"><a href="#ä¸æ‡’æƒ°åŠ è½½æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ" class="headerlink" title="ä¸æ‡’æƒ°åŠ è½½æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ"></a>ä¸æ‡’æƒ°åŠ è½½æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</h2><p>å»¶è¿ŸåŠ è½½å›¾åƒèƒŒåçš„æƒ³æ³•æ˜¯ï¼Œæ‚¨ç­‰åˆ°ç”¨æˆ·å‘ä¸‹æ»šåŠ¨é¡µé¢ï¼Œå¹¶å›¾åƒè¿›å…¥è§†å›¾ä¹‹å‰ï¼Œå†ä¸ºè¿™ä¸ªå›¾ç‰‡å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚å¦‚æœæ‚¨çš„ç½‘é¡µåŒ…å«å¤šä¸ªå›¾åƒï¼Œä½†æ˜¯åªæœ‰åœ¨å›¾åƒæ»šåŠ¨åˆ°è§†å›¾æ—¶æ‰åŠ è½½æ¯ä¸ªå›¾åƒï¼Œæ‚¨å°†æœ€ç»ˆèŠ‚çœå¸¦å®½ï¼Œå¹¶ç¡®ä¿æ‚¨çš„ç½‘é¡µåŠ è½½æ›´å¿«ã€‚</p><p>ä¸ºäº†ç»™ä½ ä¸€ä¸ªè¿™æ ·çš„æƒ³æ³•ï¼Œæˆ‘ä»¬æ¥æƒ³è±¡ä¸‹é¢æœ‰ä¸‰ä¸ªå›¾åƒçš„é¡µé¢ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://307a6ed092846b809be7-9cfa4cf7c673a59966ad8296f4c88804.ssl.cf3.rackcdn.com/intersection-observer/intersection-observer.png" data-original="https://307a6ed092846b809be7-9cfa4cf7c673a59966ad8296f4c88804.ssl.cf3.rackcdn.com/intersection-observer/intersection-observer.png"></p><p>å¦‚æœç”¨æˆ·ç™»é™†é¡µé¢å¹¶ä¸”ä»…æŸ¥çœ‹ç¬¬ä¸€å¼ å›¾åƒï¼Œæˆ‘ä»¬ä¸æƒ³åŠ è½½é¡µé¢åº•éƒ¨æ¯”è¨çš„å›¾åƒï¼Œç›´åˆ°ç”¨æˆ·å‘ä¸‹æ»šåŠ¨ï¼Œå¹¶ä¸”ç­‰åˆ°å›¾åƒçœŸæ­£åœ¨è§†å›¾ä¸­ã€‚å¦‚æœæˆ‘ä»¬æ‡’æƒ°åŠ è½½å›¾åƒï¼Œè¿™æ„å‘³ç€ç”¨æˆ·åªéœ€è¦ä¸‹è½½ä»–ä»¬éœ€è¦çš„ä¸œè¥¿ï¼Œè¿™ä½¿æ‚¨çš„ç½‘é¡µæ›´ç²¾ç®€ã€‚</p><p>å¯¹äºæ›´æœ‰ç»éªŒçš„å¼€å‘äººå‘˜ï¼Œæ‚¨å¯èƒ½ä¼šç†Ÿæ‚‰å»¶è¿ŸåŠ è½½å›¾åƒï¼Œæ¯•ç«Ÿè¿™ä¸ªæ¦‚å¿µå·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆæ–°æ¦‚å¿µå—ï¼Ÿï¼æœ‰å¾ˆå¤šæ‡’åŠ è½½åº“åšå¾—å¾ˆå¥½ã€‚æˆ‘ç”šè‡³ä»¥å‰åœ¨è¿™ä¸ªåšå®¢ä¸Šå†™äº†ä¸€ç¯‡ï¼ˆ<a href="https://deanhume.com/Home/BlogPost/lazy-loading-images-with-jquery/22" target="_blank" rel="noopener">å¾ˆå¤šå¹´å‰</a>ï¼‰ã€‚é—®é¢˜åœ¨äºï¼Œå‡ ä¹æ‰€æœ‰è¿™äº›åº“éƒ½ä¼šç»‘å®šæ»šåŠ¨äº‹ä»¶ï¼Œæˆ–è€…ä½¿ç”¨å®šæ—¶å™¨æ¥æ£€æŸ¥å…ƒç´ çš„è¾¹ç•Œï¼Œç„¶åå†ç¡®å®šæ˜¯å¦åœ¨è§†å›¾ä¸­ã€‚è¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯å®ƒå¼ºåˆ¶æµè§ˆå™¨é‡æ–°å¸ƒå±€ï¼ˆre-layoutï¼‰æ•´ä¸ªé¡µé¢ï¼Œå¹¶ä¸”åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨çš„ç½‘ç«™ä¼šå¼•èµ·ç›¸å½“å¤§çš„æ€§èƒ½æŸå¤±ã€‚æˆ‘ä»¬å¯ä»¥åšå¾—æ›´å¥½ï¼</p><h2 id="INTERSECTION-OBSERVER-æ¥æŠ¢æ•‘ï¼"><a href="#INTERSECTION-OBSERVER-æ¥æŠ¢æ•‘ï¼" class="headerlink" title="INTERSECTION OBSERVER æ¥æŠ¢æ•‘ï¼"></a>INTERSECTION OBSERVER æ¥æŠ¢æ•‘ï¼</h2><p>è¿™æ˜¯å°±æ˜¯ Intersection Observer çš„ç”¨å¤„ã€‚Intersection Observer å†…ç½®äºå¤§å¤šæ•°ç°ä»£æµè§ˆå™¨ä¸­ï¼Œè®©æ‚¨çŸ¥é“è¢«è§‚å¯Ÿçš„å…ƒç´ ä½•æ—¶è¿›å…¥æˆ–é€€å‡ºæµè§ˆå™¨çš„è§†å£ã€‚è¿™ä½¿å¾—å®ƒéå¸¸ç†æƒ³ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿå¼‚æ­¥ä¼ è¾“æ•°æ®ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“ä¸»çº¿ç¨‹ï¼Œä½¿å…¶æˆä¸ºæä¾›åé¦ˆçš„æœ‰æ•ˆæ‰‹æ®µã€‚</p><p>åœ¨ <a href="https://github.com/googlechrome/sample-media-pwa" target="_blank" rel="noopener">Paul çš„ä¾‹å­</a>ä¸­ï¼Œä»–æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Intersection Observer æ¥å»¶è¿ŸåŠ è½½è¿›å…¥è§†å£å›¾åƒã€‚æˆ‘å·²ç»è·å–äº†ä»–çš„åˆå§‹ä»£ç ï¼Œå¹¶ç¨å¾®è°ƒæ•´äº†ä¸€ç‚¹ï¼Œä½¿æˆ‘æ›´å®¹æ˜“ç†è§£ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é€šè¿‡äº†è§£ Intersection Observer çš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶å‘æ‚¨å±•ç¤ºå¦‚ä½•ä»¥è¶…çº§é«˜æ•ˆçš„æ–¹å¼åšåˆ°å»¶è¿ŸåŠ è½½å›¾åƒã€‚</p><h2 id="å…¥é—¨"><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h2><p>æƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªåŸºæœ¬çš„HTMLé¡µé¢ï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªä¸ä¸Šè¿°ç›¸ä¼¼çš„å›¾åƒã€‚åœ¨ç½‘é¡µä¸Šï¼Œæ‚¨å°†å…·æœ‰ä¸ä»¥ä¸‹ç†Ÿæ‚‰çš„å›¾åƒå…ƒç´ ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"js-lazy-image"</span> <span class="attr">data-src</span>=<span class="string">"burger.png"</span>&gt;</span></div></pre></td></tr></table></figure><p>æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå›¾åƒæ–‡ä»¶æ²¡æœ‰ <code>src</code> å±æ€§ã€‚è¿™æ˜¯å› ä¸ºå®ƒæ­£åœ¨ä½¿ç”¨ä¸€ä¸ªåä¸º <code>data-src</code> çš„æ•°æ®å±æ€§æ¥æŒ‡å‘å›¾åƒæºã€‚å½“è¿›å…¥è§†å£æ—¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥åŠ è½½å›¾åƒã€‚æ‚¨è¿˜å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œå›¾åƒå…ƒç´ è¿˜å…·æœ‰ä¸€ä¸ªåä¸º â€œjs-lazy-imageâ€ çš„ç±» - æˆ‘ä»¬å°†åœ¨ JavaScript ä»£ç ä¸­å°½å¿«ä½¿ç”¨è¿™ä¸ªç±»ï¼Œä»¥ç¡®å®šè¦å»¶è¿ŸåŠ è½½çš„å…ƒç´ ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå°†åœ¨é¡µé¢ä¸ŠåŠ è½½å›¾åƒçš„ä»£ç ã€‚åœ¨æˆ‘ä»¬çš„ JavaScript æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ Intersection Observer ã€‚</p><script src="https://gist.github.com/deanhume/1da60330fa8f6dc3d0f4885168a48f9e.js"></script><p>ä¸Šé¢çš„ä¾‹å­çœ‹èµ·æ¥åƒå¾ˆå¤šä»£ç ï¼Œä½†æ˜¯è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°åˆ†è§£å®ƒã€‚é¦–å…ˆï¼Œæˆ‘æ­£åœ¨é€‰æ‹©é¡µé¢ä¸Šå…·æœ‰ç±»â€œjs-lazy-imageâ€çš„æ‰€æœ‰å›¾åƒã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘æ­£åœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„ <em>IntersectionObserver</em>ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥è§‚å¯Ÿæˆ‘ä»¬é€‰æ‹©çš„å…·æœ‰ç±»â€œjs-lazy-imageâ€çš„æ‰€æœ‰å›¾åƒã€‚ä½¿ç”¨ <em>IntersectionObserver</em> çš„é»˜è®¤é€‰é¡¹ï¼Œå½“å…ƒç´ éƒ¨åˆ†è¿›å…¥è§†å›¾æˆ–å®Œå…¨ç¦»å¼€è§†å£æ—¶ï¼Œæ‚¨çš„å›è°ƒéƒ½å°†è¢«è°ƒç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘å°†å‡ ä¸ªé¢å¤–çš„é…ç½®é€‰é¡¹ä¼ é€’ç»™ <em>IntersectionObserver</em>ã€‚ä½¿ç”¨ <code>rootMargin</code> å…è®¸æ‚¨æŒ‡å®šæ ¹çš„è¾¹è·ï¼Œæœ‰æ•ˆåœ°å…è®¸æ‚¨å¢åŠ æˆ–ç¼©å°ç”¨äºè§‚å¯Ÿäº¤ç‚¹çš„åŒºåŸŸã€‚æˆ‘ä»¬æƒ³ç¡®ä¿å¦‚æœå›¾åƒåœ¨Yè½´ä¸Šçš„50åƒç´ å†…ï¼Œæˆ‘ä»¬å°†å¼€å§‹ä¸‹è½½ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ª Intersection Observerï¼Œå¹¶ä¸”æ­£åœ¨è§‚å¯Ÿé¡µé¢ä¸Šçš„å›¾åƒï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥åˆ°è¯¥å…ƒç´ è¿›å…¥è§†å›¾æ—¶è¢«è§¦å‘çš„ intersection äº‹ä»¶ã€‚</p><script src="https://gist.github.com/deanhume/768666a8b37dce069d5ce7839100a4e4.js"></script><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåªè¦æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„å…ƒç´ è¿›å…¥ç”¨æˆ·è§†å£ï¼Œ<code>onIntersection</code> åŠŸèƒ½å°†è¢«è§¦å‘ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ªç¯æŸ¥çœ‹æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„å›¾åƒï¼Œå¹¶ç¡®å®šå“ªä¸ªå›¾åƒåœ¨è§†å£ä¸­ã€‚å¦‚æœå½“å‰å…ƒç´ å¤„äºäº¤å‰æ¯”ä¾‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“å›¾åƒåœ¨ç”¨æˆ·è§†å£ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åŠ è½½å®ƒã€‚åŠ è½½å›¾åƒåï¼Œæˆ‘ä»¬ä¸éœ€è¦å†è§‚å¯Ÿå›¾åƒï¼Œå¹¶ä¸”ä½¿ç”¨ <em><code>unobserve()</code></em> å°†å…¶ä» Intersection Observer ä¸­çš„æ¡ç›®åˆ—è¡¨ä¸­åˆ é™¤ã€‚</p><p>å°±æ˜¯è¿™æ ·ï¼ä¸€æ—¦ç”¨æˆ·æ»šåŠ¨å¹¶ä¸”å›¾åƒè¿›å…¥è§†å›¾ï¼Œåˆ™å°†åŠ è½½é€‚å½“çš„å›¾åƒã€‚è¿™ä¸ªä»£ç æœ€å¥½çš„åŠæ³•æ˜¯ Intersection Observer æ¯”å·´é‡ŒÂ·æ€€ç‰¹ï¼ˆBarry Whiteï¼‰æ›´å¹³æ»‘ã€‚æˆ‘å°½é‡ä¿æŒå°½å¯èƒ½ç®€æ´çš„ä»£ç ï¼Œä½†å¦‚æœæ‚¨æƒ³çœ‹åˆ°å®Œæ•´ç‰ˆæœ¬ï¼Œæˆ‘å·²ç»åˆ›å»ºäº†ä¸€ä¸ªGithub repoï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ª<a href="https://deanhume.github.io/lazy-observer-load/" target="_blank" rel="noopener">æœ‰æ•ˆçš„ä¾‹å­</a>ã€‚</p><h2 id="æµè§ˆå™¨æ”¯æŒ"><a href="#æµè§ˆå™¨æ”¯æŒ" class="headerlink" title="æµè§ˆå™¨æ”¯æŒ"></a>æµè§ˆå™¨æ”¯æŒ</h2><p>åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæ‚¨å¯èƒ½ä¼šæƒ³çŸ¥é“æµè§ˆå™¨å¯¹æ­¤åŠŸèƒ½çš„æ”¯æŒã€‚<a href="http://caniuse.com/#feat=intersectionobserver" target="_blank" rel="noopener">Edgeï¼ŒFirefoxï¼ŒChromeå’ŒOpera</a>ç›®å‰æ”¯æŒ Intersection Observerï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½æ¶ˆæ¯ã€‚</p><p>ä½†æ˜¯ï¼Œä¸ºäº†ç¡®ä¿ä¸æ”¯æŒæ­¤åŠŸèƒ½çš„æµè§ˆå™¨çš„ä»£ç ä¸ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠŸèƒ½æ£€æµ‹æ¥ç¡®å®šæˆ‘ä»¬å¦‚ä½•åŠ è½½å›¾åƒã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚</p><script src="https://gist.github.com/deanhume/948c59af68c86da9d3b3f2955747a651.js"></script><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨æ£€æŸ¥ <em>IntersectionObserver</em> æ˜¯å¦åœ¨å½“å‰æµè§ˆå™¨ä¸­å¯ç”¨ï¼Œå¦‚æœä¸æ”¯æŒæˆ‘ä»¬åªæ˜¯ç®€å•åœ°ç«‹å³åŠ è½½å›¾åƒï¼Œå¦åˆ™æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„é»˜è®¤è¡Œä¸ºã€‚</p><p>å¦‚æœæ‚¨çœŸçš„å–œæ¬¢ <em>IntersectionObserver</em> API çš„ç®€ä¾¿æ€§ï¼Œå¹¶ä¸”æƒ³è¦ä½¿ç”¨ polyfillï¼Œåˆ™ WICG å·²åˆ›å»ºä¸€ä¸ªå¯åœ¨ <a href="https://github.com/WICG/IntersectionObserver/tree/gh-pages/polyfill" target="_blank" rel="noopener">Github repository</a> ä¸­ä½¿ç”¨çš„åŠŸèƒ½ã€‚å”¯ä¸€çš„ç¼ºç‚¹æ˜¯æ‚¨ä¸ä¼šè·å¾—åŸç”Ÿå®ç°ç»™æ‚¨çš„æ€§èƒ½ä¼˜åŠ¿ã€‚</p><p>æ‚¨ç”šè‡³å¯ä»¥é‡‡å–è¿›ä¸€æ­¥æªæ–½ï¼Œå¹¶ä¸º <a href="https://www.robinosborne.co.uk/2016/05/16/lazy-loading-images-dont-rely-on-javascript/#a-no-JavaScript" target="_blank" rel="noopener">Robin Osborne</a> å»ºè®®çš„æœªå¯ç”¨ JavaScript çš„ç”¨æˆ·æ·»åŠ æ”¯æŒã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ <em>IntersectionObserver</em> æ¥å»¶è¿ŸåŠ è½½å›¾åƒï¼Œä½†æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿›è¡Œæ›´å¤šæ“ä½œã€‚å®ƒå¯ä»¥ç”¨äºç¡®å®šæŸäººæ˜¯å¦æ­£åœ¨æŸ¥çœ‹å¹¿å‘Šï¼Œæˆ–è€…å³ä½¿æ˜¯åœ¨iFrameä¸­çš„å…ƒç´ ã€‚æ˜“äºç†è§£çš„APIä½¿å…¶å¯ä»¥æ‰“å¼€è®¸å¤šé€‰é¡¹ã€‚</p><p>å¦‚æœæ‚¨æƒ³äº†è§£æœ‰å…³äº¤å‰ç‚¹è§‚å¯Ÿè€…çš„æ›´å¤šä¿¡æ¯ï¼Œæˆ‘å»ºè®®æ‚¨åœ¨Google Developersç½‘ç«™ä¸Šé˜…è¯»<a href="https://developers.google.com/web/updates/2016/04/intersectionobserver" target="_blank" rel="noopener">è¿™ç¯‡æœ‰å…³ä¿¡æ¯</a>çš„æ–‡ç« ã€‚æˆ‘è¿˜å¼ºçƒˆå»ºè®®åœ¨ Youtube ä¸Šè§‚çœ‹<a href="https://www.youtube.com/watch?v=ncYQkOrKTaI&amp;list=PLNYkxOF6rcIBykcJ7bvTpqU7vt-oey72J&amp;index=7" target="_blank" rel="noopener">ä¿ç½—Â·åˆ˜æ˜“æ–¯çš„è§†é¢‘ç³»åˆ—</a>ï¼Œå®ƒåŒ…å«äº†å¾ˆæ£’çš„æç¤ºï¼Œä½ ä¸€å®šä¼šå­¦åˆ°ä¸€äº›ä¸œè¥¿ã€‚</p><p>ã€ç¿»è¯‘åŸæ–‡ã€‘: <a href="https://deanhume.com/Home/BlogPost/lazy-loading-images-using-intersection-observer/10163" target="_blank" rel="noopener">LAZY LOADING IMAGES USING INTERSECTION OBSERVER</a></p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä½¿ç”¨-intersection-observer-å»¶è¿ŸåŠ è½½å›¾ç‰‡&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨-intersection-observer-å»¶è¿ŸåŠ è½½å›¾ç‰‡&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨ intersection observer å»¶è¿ŸåŠ è½½å›¾ç‰‡&quot;&gt;&lt;/a&gt;ä½¿ç”¨ intersection observer å»¶è¿ŸåŠ è½½å›¾ç‰‡&lt;/h1&gt;&lt;p&gt;å¦‚æœæ‚¨è¿˜æ²¡æœ‰çœ‹è¿‡ï¼ŒPaul Lewis ç»„ç»‡äº†ä¸€ä¸ªä»¤äººæ•¬ç•çš„è§†é¢‘ç³»åˆ—ï¼Œæ¼”ç¤ºå¦‚ä½•æ„å»ºåª’ä½“æ’­æ”¾å™¨ä»¥åŠæ‹¥æœ‰éå¸¸æ£’çš„ç‰¹æ€§çš„ Progressive Web Appsã€‚ä»–åœ¨YouTubeä¸Šå»ºç«‹äº†&lt;a href=&quot;https://www.youtube.com/playlist?list=PLNYkxOF6rcIBykcJ7bvTpqU7vt-oey72J&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¸€ç³»åˆ—è§†é¢‘&lt;/a&gt;ï¼Œè¿™äº›è§†é¢‘æ˜¯åœ¨ä»–å»ºç«‹ç½‘ç«™çš„æ¯ä¸€éƒ¨åˆ†çš„è¿‡ç¨‹ä¸­å‘ç”Ÿçš„ã€‚è§‚çœ‹å¼€å‘è€…å±•ç¤ºä»–ä»¬å·¥ä½œçš„è§†é¢‘ç»å¯¹æ˜¯æˆ‘æœ€å–œæ¬¢å­¦ä¹ æ–°äº‹ç‰©çš„æ–¹æ³•ä¹‹ä¸€ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="lazyload" scheme="http://robin-front.github.io/tags/lazyload/"/>
    
      <category term="performance" scheme="http://robin-front.github.io/tags/performance/"/>
    
      <category term="optimization" scheme="http://robin-front.github.io/tags/optimization/"/>
    
      <category term="IntersectionObserver" scheme="http://robin-front.github.io/tags/IntersectionObserver/"/>
    
  </entry>
  
  <entry>
    <title>ä½ å¯èƒ½ä¸çŸ¥é“çš„JSONç”¨æ³•åŠè¯¯åŒº</title>
    <link href="http://robin-front.github.io/2017/07/28/you-may-dont-know-JSON/"/>
    <id>http://robin-front.github.io/2017/07/28/you-may-dont-know-JSON/</id>
    <published>2017-07-28T01:17:36.000Z</published>
    <updated>2017-07-28T01:17:36.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å†è°ˆ-JSON-ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº›-JSON-ç”¨æ³•åŠè¯¯åŒº"><a href="#å†è°ˆ-JSON-ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº›-JSON-ç”¨æ³•åŠè¯¯åŒº" class="headerlink" title="å†è°ˆ JSON, ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº› JSON ç”¨æ³•åŠè¯¯åŒº"></a>å†è°ˆ JSON, ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº› JSON ç”¨æ³•åŠè¯¯åŒº</h1><p>æœ€è¿‘ä¹Ÿæ˜¯çœ‹åˆ°å¾ˆå¤šäººåœ¨è®¨è®º <code>JSON</code>, ä½†æœ‰äº›ç‚¹è¯´å¾—ä¸å¤ªå‡†ç¡®ï¼Œç¿»ç¿»çŠ€ç‰›ä¹¦ï¼Œå†æ¬¡å¤ä¹ ä¸€ä¸‹ã€‚</p><h2 id="JSON-stringify-value-replacer-space"><a href="#JSON-stringify-value-replacer-space" class="headerlink" title="JSON.stringify(value [, replacer [, space]])"></a>JSON.stringify(value [, replacer [, space]])</h2><p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸€èˆ¬æ˜¯å¯¹è±¡ï¼ˆObjectï¼‰æˆ–æ•°ç»„ï¼ˆArrayï¼‰ï¼Œæˆ– <code>javascript</code> åŸºæœ¬å€¼ã€‚</p><h3 id="è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥"><a href="#è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥" class="headerlink" title="è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥"></a>è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥</h3><p><strong>é¦–å…ˆ JSON åªèƒ½åºåˆ—åŒ–å¯æšä¸¾çš„å€¼ï¼Œå…¶æ¬¡ <code>undefined</code>ï¼Œ<code>NaN</code>ï¼Œ<code>Infinity</code>ï¼Œ<code>function</code>, <code>Date</code>, <code>RegExp</code>, <code>Error</code> è¿™äº›å€¼æˆ–å¯¹è±¡éƒ½æ˜¯ä¸æ”¯æŒçš„ï¼Œä½†å¹¶ä¸æ˜¯è¿™äº›å€¼éƒ½ä¼šè¢«å¿½ç•¥ã€‚</strong><a id="more"></a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="built_in">Symbol</span>(), <span class="comment">// æ–°å¢çš„ ES6 åŸºæœ¬å€¼</span></div><div class="line">  b: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],</div><div class="line">  <span class="attr">c</span>: <span class="literal">undefined</span>,</div><div class="line">  <span class="attr">d</span>: <span class="literal">NaN</span>,</div><div class="line">  <span class="attr">e</span>: <span class="literal">Infinity</span>,</div><div class="line">  <span class="attr">f</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123; <span class="keyword">return</span> <span class="number">1</span>;&#125;,</div><div class="line">  <span class="attr">g</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(),</div><div class="line">  <span class="attr">h</span>: <span class="regexp">/^\d$/gi</span>,</div><div class="line">  <span class="attr">i</span>: <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'err'</span>),</div><div class="line">  <span class="attr">j</span>: &#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">JSON</span>.stringify(o);</div><div class="line"></div><div class="line"><span class="comment">// output: '&#123;"b":[1,2,3],"d":null,"e":null,"g":"2017-07-28T02:56:37.102Z","h":&#123;&#125;,"i":&#123;&#125;,"j":&#123;&#125;&#125;'</span></div></pre></td></tr></table></figure><p>ç”±ä¸Šå¯ä»¥çœ‹å‡ºï¼š</p><ul><li><code>Symbol</code>, <code>undefined</code>, <code>function</code> ä¼šç›´æ¥è¢«å¿½ç•¥</li><li><code>NaN</code>, <code>Infinity</code> è¢«è½¬æ¢æˆäº† <code>null</code></li><li><code>RegExp</code>, <code>Error</code> åˆ™è¢«è½¬æˆäº†ç©ºå¯¹è±¡ {}</li></ul><h3 id="replacer"><a href="#replacer" class="headerlink" title="replacer"></a>replacer</h3><p>å› ä¸º <code>JSON.stringify()</code> åºåˆ—åŒ–ä¸æ”¯æŒéƒ¨åˆ†å€¼ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•åœ°ä½¿ç”¨ <code>JSON</code> çš„ä¸¤ä¸ªæ–¹æ³•è¿›è¡Œæ·±æ‹·è´ã€‚ä½†å¯ä»¥åˆ©ç”¨ <code>JSON.stringify()</code> çš„ç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œæ­£ç¡®åºåˆ—åŒ–ã€‚</p><p><strong>ä½†è¿™å¹¶ä¸æ¨èï¼Œå› ä¸º JSON.parse() ä»ç„¶æ— æ³•è¿˜åŸä¸è¢«æ”¯æŒçš„å€¼ã€‚åªæœ‰å¯¹è±¡å­—é¢é‡ Object å’Œ æ•°ç»„ Array å¯ä»¥è¢«æ­£ç¡®è¿˜åŸï¼Œå…¶ä»–éƒ½å˜æˆå­—ç¬¦ä¸²</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ²¿ç”¨ä¸Šä¸€ä¾‹å­çš„ä»£ç </span></div><div class="line"><span class="keyword">var</span> replacer = <span class="function"><span class="keyword">function</span>(<span class="params">k ,v</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> type = <span class="keyword">typeof</span> v;</div><div class="line">  <span class="keyword">if</span>(type === <span class="string">'function'</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Function</span>.prototype.toString.call(v)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'undefined'</span>)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'undefined'</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'number'</span>)&#123;</div><div class="line">    <span class="keyword">if</span> (v !== v)&#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">'NaN'</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (v === <span class="literal">Infinity</span>)&#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">'Infinity'</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'symbol'</span>)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Symbol</span>.prototype.toString.call(v)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (v <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">RegExp</span>.prototype.toString.call(v)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (v <span class="keyword">instanceof</span> <span class="built_in">Error</span> &amp;&amp; v.name !== <span class="string">''</span> &amp;&amp; v.message !== <span class="string">''</span>)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'new '</span> + v.name + <span class="string">'('</span>+ v.message +<span class="string">')'</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> v</div><div class="line">&#125;</div><div class="line"><span class="built_in">JSON</span>.stringify(o, replacer);</div><div class="line"></div><div class="line"><span class="comment">//  output: '&#123;"a":"Symbol()","b":[1,2,3],"c":"undefined","d":"NaN","e":"Infinity","f":"function ()&#123; return 1;&#125;","g":"2017-07-28T02:56:37.102Z","h":"/^\\d$/gi","i":"new Error(err)","j":&#123;&#125;&#125;'</span></div></pre></td></tr></table></figure><p>å¦å¤–ä¸€ä¸ªç”¨æ³•å°±æ˜¯ä¼ å…¥æ•°ç»„ï¼ŒæŒ‡å®šéœ€è¦åºåˆ—åŒ–çš„key.è¿™ä¸ªåœ¨æå–éƒ¨åˆ†å±æ€§çš„æ—¶å€™ä¹Ÿæ˜¯å¾ˆæœ‰ç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ²¿ç”¨ä¸Šé¢çš„ä»£ç </span></div><div class="line"><span class="built_in">JSON</span>.stringify(o, [<span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>]);</div><div class="line"></div><div class="line"><span class="comment">// output: '&#123;"b":[1,2,3],"d":null&#125;'</span></div></pre></td></tr></table></figure><h3 id="space"><a href="#space" class="headerlink" title="space"></a>space</h3><p>æ˜¯ä¸€ä¸ªå¯é€‰çš„ç¾åŒ–å±æ€§ï¼Œåºåˆ—åŒ–æ—¶æ˜¯æ²¡æœ‰æ¢è¡Œå’Œç©ºæ ¼çš„ï¼Œæ­¤å‚æ•°å¯æŒ‡å®šä¸€ä¸ªæ•°å€¼ï¼ˆå¤§äº10åˆ™é™åˆ¶ä¸º10ï¼‰æˆ–ä¸€ç»„å­—ç¬¦ï¼ˆé•¿åº¦æœ€é•¿ä¸º10ä¸ªå­—ç¬¦), æ­¤å‚æ•°ä¸ä¸ºç©ºä¼šè‡ªåŠ¨æ’å…¥æ¢è¡Œã€‚</p><p><strong>ä½†æ˜¯è®¾ç½®ä¸ºå­—ç¬¦æ—¶ï¼Œæ— æ³•ä½¿ç”¨ parse å¤åŸ</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">JSON</span>.stringify(o, <span class="literal">null</span>, <span class="string">'-'</span>);</div><div class="line"><span class="comment">// '&#123;</span></div><div class="line"><span class="comment">// -"b": [</span></div><div class="line"><span class="comment">// --1,</span></div><div class="line"><span class="comment">// --2,</span></div><div class="line"><span class="comment">// --3</span></div><div class="line"><span class="comment">// -],</span></div><div class="line"><span class="comment">// -"d": null,</span></div><div class="line"><span class="comment">// -"e": null,</span></div><div class="line"><span class="comment">// -"g": "2017-07-28T02:56:37.102Z",</span></div><div class="line"><span class="comment">// -"h": &#123;&#125;,</span></div><div class="line"><span class="comment">// -"i": &#123;&#125;,</span></div><div class="line"><span class="comment">// -"j": &#123;&#125;</span></div><div class="line"><span class="comment">// &#125;'</span></div></pre></td></tr></table></figure><h2 id="JSON-parse-value-reviver"><a href="#JSON-parse-value-reviver" class="headerlink" title="JSON.parse(value[, reviver])"></a>JSON.parse(value[, reviver])</h2><p><code>JSON.parse</code> ä¸ <code>JSON.stringify</code> æ“ä½œæ­£å¥½ç›¸åï¼Œä½† <code>value</code> å¿…é¡»ä¸¥æ ¼ç¬¦åˆ <code>JSON</code> æ ¼å¼ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p><p>ç¬¬äºŒä¸ªå‚æ•°å¯ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œç”¨ä»¥è½¬æ¢è§£æå‡ºæ¥çš„å€¼ã€‚</p><p>æ¯”å¦‚ <code>Date</code> å¯¹è±¡åœ¨åºåˆ—åŒ–ä¹‹åæ— æ³•é€†è½¬æˆä¸€ä¸ª <code>Date</code> å¯¹è±¡ï¼Œæ­¤æ—¶å¯å†™ä¸€ä¸ªå‡½æ•°å»è½¬æ¢ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reviver = <span class="function"><span class="keyword">function</span> (<span class="params">name, value</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="regexp">/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d.\d\d\dZ$/</span>.test(value));</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">'string'</span> &amp;&amp; <span class="regexp">/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d.\d\d\dZ$/</span>.test(value))&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(value)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> value</div><div class="line">&#125;</div><div class="line"><span class="comment">// æ²¿ç”¨å‰ä¸ªä¾‹å­çš„ä»£ç </span></div><div class="line"><span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(o.g), reviver)</div><div class="line"><span class="comment">// output: Fri Jul 28 2017 10:56:37 GMT+0800 (+08)</span></div></pre></td></tr></table></figure><h2 id="toJSON"><a href="#toJSON" class="headerlink" title="toJSON()"></a>toJSON()</h2><p>æœ‰äº›æ–‡ç« ä¼šè¯´ <code>Object.toJSON()</code> ï¼Œè¿™æ˜¯ä¸å¯¹çš„ï¼Œ<code>Object</code> åŸå‹ä¸Šå¹¶æ²¡æœ‰å®šä¹‰ <code>toJSON</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åªè¢«å®šä¹‰åœ¨ <code>Date</code> å¯¹è±¡ä¸Šã€‚<code>JSON.stringify()</code> åœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¼šé¦–å…ˆæŸ¥æ‰¾è¯¥æ–¹æ³•ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å› <code>toJSON</code> çš„è°ƒç”¨ç»“æœã€‚è¿™ä¸ªä¸€å¼€å§‹æ˜¯è®© <code>Date</code> æ­£ç¡®åºåˆ—åŒ–æˆ <code>JSON</code> æ—¶è®¾è®¡çš„ã€‚ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨ <code>toJSON</code> çš„å±è”½åŠŸèƒ½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.toJSON = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Function</span>.prototype.toString.call(<span class="keyword">this</span>)</div><div class="line">&#125;</div><div class="line"><span class="comment">// æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­</span></div><div class="line"><span class="built_in">JSON</span>.stringify(o);</div><div class="line"><span class="comment">// &#123;"b":[1,2,3],"d":null,"e":null,"f":"function ()&#123; return 1;&#125;","g":"2017-07-28T02:56:37.102Z","h":&#123;&#125;,"i":&#123;&#125;,"j":&#123;&#125;&#125;</span></div></pre></td></tr></table></figure><p>ä¼šå‘ç°ï¼Œ<code>function</code> æ²¡æœ‰è¢«å¿½ç•¥ï¼Œä½†æ­¤æ–¹æ³•è¦æ…ç”¨ï¼Œåœ¨åŸå‹ä¸Šæ·»åŠ æ–¹æ³•å¯èƒ½äº§ç”Ÿå‰¯ä½œç”¨ã€‚</p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å†è°ˆ-JSON-ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº›-JSON-ç”¨æ³•åŠè¯¯åŒº&quot;&gt;&lt;a href=&quot;#å†è°ˆ-JSON-ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº›-JSON-ç”¨æ³•åŠè¯¯åŒº&quot; class=&quot;headerlink&quot; title=&quot;å†è°ˆ JSON, ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº› JSON ç”¨æ³•åŠè¯¯åŒº&quot;&gt;&lt;/a&gt;å†è°ˆ JSON, ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº› JSON ç”¨æ³•åŠè¯¯åŒº&lt;/h1&gt;&lt;p&gt;æœ€è¿‘ä¹Ÿæ˜¯çœ‹åˆ°å¾ˆå¤šäººåœ¨è®¨è®º &lt;code&gt;JSON&lt;/code&gt;, ä½†æœ‰äº›ç‚¹è¯´å¾—ä¸å¤ªå‡†ç¡®ï¼Œç¿»ç¿»çŠ€ç‰›ä¹¦ï¼Œå†æ¬¡å¤ä¹ ä¸€ä¸‹ã€‚&lt;/p&gt;&lt;h2 id=&quot;JSON-stringify-value-replacer-space&quot;&gt;&lt;a href=&quot;#JSON-stringify-value-replacer-space&quot; class=&quot;headerlink&quot; title=&quot;JSON.stringify(value [, replacer [, space]])&quot;&gt;&lt;/a&gt;JSON.stringify(value [, replacer [, space]])&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€ä¸ªå‚æ•°ä¸€èˆ¬æ˜¯å¯¹è±¡ï¼ˆObjectï¼‰æˆ–æ•°ç»„ï¼ˆArrayï¼‰ï¼Œæˆ– &lt;code&gt;javascript&lt;/code&gt; åŸºæœ¬å€¼ã€‚&lt;/p&gt;&lt;h3 id=&quot;è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥&quot;&gt;&lt;a href=&quot;#è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥&quot; class=&quot;headerlink&quot; title=&quot;è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥&quot;&gt;&lt;/a&gt;è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é¦–å…ˆ JSON åªèƒ½åºåˆ—åŒ–å¯æšä¸¾çš„å€¼ï¼Œå…¶æ¬¡ &lt;code&gt;undefined&lt;/code&gt;ï¼Œ&lt;code&gt;NaN&lt;/code&gt;ï¼Œ&lt;code&gt;Infinity&lt;/code&gt;ï¼Œ&lt;code&gt;function&lt;/code&gt;, &lt;code&gt;Date&lt;/code&gt;, &lt;code&gt;RegExp&lt;/code&gt;, &lt;code&gt;Error&lt;/code&gt; è¿™äº›å€¼æˆ–å¯¹è±¡éƒ½æ˜¯ä¸æ”¯æŒçš„ï¼Œä½†å¹¶ä¸æ˜¯è¿™äº›å€¼éƒ½ä¼šè¢«å¿½ç•¥ã€‚&lt;/strong&gt;
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="JSON" scheme="http://robin-front.github.io/tags/JSON/"/>
    
  </entry>
  
  <entry>
    <title>åƒ google ä¸€æ ·é€šè¿‡ç¼©çŸ­ css ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ– css åŒ…çš„å¤§å°</title>
    <link href="http://robin-front.github.io/2017/07/24/reducing-css-bundle-size-by-cutting-the-class-names-and-using-scope-isolation/"/>
    <id>http://robin-front.github.io/2017/07/24/reducing-css-bundle-size-by-cutting-the-class-names-and-using-scope-isolation/</id>
    <published>2017-07-24T09:05:01.000Z</published>
    <updated>2017-07-24T09:05:01.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åƒ-google-ä¸€æ ·é€šè¿‡ç¼©çŸ­-css-ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ–-css-åŒ…çš„å¤§å°"><a href="#åƒ-google-ä¸€æ ·é€šè¿‡ç¼©çŸ­-css-ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ–-css-åŒ…çš„å¤§å°" class="headerlink" title="åƒ google ä¸€æ ·é€šè¿‡ç¼©çŸ­ css ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ– css åŒ…çš„å¤§å°"></a>åƒ google ä¸€æ ·é€šè¿‡ç¼©çŸ­ css ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ– css åŒ…çš„å¤§å°</h1><blockquote><h2 id="å°±åƒ-google-çš„åšæ³•ä¸€æ ·"><a href="#å°±åƒ-google-çš„åšæ³•ä¸€æ ·" class="headerlink" title="å°±åƒ google çš„åšæ³•ä¸€æ ·"></a>å°±åƒ google çš„åšæ³•ä¸€æ ·</h2></blockquote><p>ä»Šå¹´å¹´åˆï¼Œæˆ‘å·²ç»é€€å‡ºå’¨è¯¢å…¬å¸å¹¶å¼€å§‹æ„å»º <a href="https://go2cinema.com/" target="_blank" rel="noopener">GO2CINEMA</a> - ä¸€ä¸ª <em>å¿«é€Ÿï¼Œç®€å•å’Œå®‰å…¨</em> çš„æ–¹å¼æ¥é¢„è®¢è‹±å›½çš„ç”µå½±ç¥¨çš„ç½‘ç«™ã€‚æˆ‘åšäº†ä¸€ä¸ªè¾‰ç…Œçš„å·¥ä½œï¼Œä½¿å…¶å¿«é€Ÿï¼Œç®€å•å’Œå®‰å…¨ã€‚åœ¨å…¶ä¸­æŸä¸ªé˜¶æ®µï¼Œæˆ‘ä¸€ç›´ç—´è¿·äºå…³é”®æ¸²æŸ“è·¯å¾„çš„ä¼˜åŒ–ã€‚âš¡ï¸</p><p>æˆ‘å·²ç»ä½¿ç”¨ <a href="https://github.com/gajus/usus" target="_blank" rel="noopener">Å«sus</a> è§£å†³äº† HTML çš„é¢„æ¸²æŸ“ã€‚Å«sus æ¸²æŸ“å•é¡µåº”ç”¨ç¨‹åºï¼ˆSPAï¼‰çš„ HTMLï¼Œå¹¶<a href="https://medium.com/@gajus/pre-rendering-spa-for-seo-and-improved-perceived-page-loading-speed-47075aa16d24" target="_blank" rel="noopener">å†…åµŒäº†ç”¨äºå‘ˆç°é¡µé¢çš„ CSS</a>ã€‚ä½†æ˜¯ï¼Œæˆ‘å¹¶ä¸å–œæ¬¢åœ¨æ¯ä¸ª HTML æ–‡æ¡£å†…åµŒ 70 KB çš„ cssï¼Œç‰¹åˆ«æ˜¯å…¶ä¸­å¤§éƒ¨åˆ†æ˜¯ CSS ç±»åã€‚</p><a id="more"></a><h2 id="å°±åƒGoogleä¸€æ ·"><a href="#å°±åƒGoogleä¸€æ ·" class="headerlink" title="å°±åƒGoogleä¸€æ ·"></a>å°±åƒGoogleä¸€æ ·</h2><p>ä½ æœ‰æ²¡æœ‰çœ‹è¿‡ <a href="https://www.google.com/" target="_blank" rel="noopener">https://www.google.com/</a> çš„æºä»£ç ï¼Ÿå¦‚æœçœ‹è¿‡ï¼Œæ‚¨æ³¨æ„åˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ä¼šæ˜¯ï¼ŒCSS ç±»åç§°æ²¡æœ‰è¶…è¿‡å‡ ä¸ªå­—ç¬¦ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*mGuDYFM56iyLi1MgZPC8bw.png" data-original="https://cdn-images-1.medium.com/max/800/1*mGuDYFM56iyLi1MgZPC8bw.png"></p><p>ä½†æ˜¯æ€ä¹ˆæ ·åšåˆ°çš„å‘¢ï¼Ÿ</p><h2 id="CSS-minifiers-çš„ç¼ºç‚¹"><a href="#CSS-minifiers-çš„ç¼ºç‚¹" class="headerlink" title="CSS minifiers çš„ç¼ºç‚¹"></a>CSS minifiers çš„ç¼ºç‚¹</h2><p>æœ‰ä¸€ä»¶äº‹ï¼Œ<code>minifier</code> ä¸èƒ½åš - æ”¹å˜é€‰æ‹©å™¨åç§°ã€‚è¿™æ˜¯å› ä¸º <code>CSS minifier</code> ä¸èƒ½æ§åˆ¶ HTML è¾“å‡ºã€‚åŒæ—¶ï¼ŒCSS åç§°å¯ä»¥å¾ˆé•¿ã€‚</p><p>å¦‚æœæ‚¨ä½¿ç”¨ <code>CSS modules</code>ï¼Œæ‚¨çš„ CSS modules å¯èƒ½ä¼šåŒ…å«æ ·å¼è¡¨æ–‡ä»¶åï¼Œæœ¬åœ°æ ‡è¯†åå’Œéšæœºå“ˆå¸Œã€‚ä½¿ç”¨ <a href="https://github.com/webpack-contrib/css-loader" target="_blank" rel="noopener">css-loader</a> <a href="https://github.com/webpack-contrib/css-loader" target="_blank" rel="noopener">localIdentName</a> é…ç½®æè¿°ç±»åæ¨¡æ¿ï¼Œä¾‹å¦‚<code>[name]___[local]___[hash:base64:5]</code>ã€‚å› æ­¤ï¼Œç”Ÿæˆçš„ç±»åç§°å°†å¦‚ä¸‹æ‰€ç¤º <code>.MovieView___movie-title___yvKVV</code> ; å¦‚æœä½ å–œæ¬¢æè¿°æ€§çš„åå­—ï¼Œå®ƒå¯èƒ½æ›´é•¿ï¼Œä¾‹å¦‚ <code>.MovieView___movie-description-with-summary-paragraph___yvKVV</code> ã€‚</p><h2 id="åœ¨ç¼–è¯‘æ—¶é‡å‘½å-CSS-ç±»å"><a href="#åœ¨ç¼–è¯‘æ—¶é‡å‘½å-CSS-ç±»å" class="headerlink" title="åœ¨ç¼–è¯‘æ—¶é‡å‘½å CSS ç±»å"></a>åœ¨ç¼–è¯‘æ—¶é‡å‘½å CSS ç±»å</h2><p>ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ <a href="https://webpack.js.org/" target="_blank" rel="noopener"><code>webpack</code></a> å’Œ <a href="https://github.com/gajus/babel-plugin-react-css-modules" target="_blank" rel="noopener"><code>babel-plugin-react-css-modules</code></a>ï¼Œé‚£ä¹ˆæ‚¨å¾ˆå¹¸è¿ ğŸ€ - æ‚¨å¯ä»¥ä½¿ç”¨ <code>css-loader</code> çš„ <code>getLocalIdent</code> é…ç½®é¡¹æˆ–è€…ç­‰æ•ˆçš„ <code>babel-plugin-react-css-modules</code> ä¸­çš„ <code>generateScopedName</code> é…ç½®é¡¹æ¥è¾¾åˆ°åœ¨ç¼–è¯‘æ—¶é‡å‘½åç±»åçš„ç›®çš„ã€‚</p><script src="https://gist.github.com/gajus/a70df30613ebd848ab1ce27f3e33aac2.js"></script><p><code>generateScopedName</code> ä¸­å¾ˆé…·çš„æ˜¯ï¼ŒåŒæ ·çš„åŠŸèƒ½å®ä¾‹å¯ä»¥ç”¨äº <code>Babel</code> å’Œ <code>webpack</code> çš„æ„å»ºè¿‡ç¨‹ï¼š</p><script src="https://gist.github.com/gajus/acc6684de7ef310e9fdcbfa502307e50.js"></script><h2 id="è®©åå­—å˜çŸ­"><a href="#è®©åå­—å˜çŸ­" class="headerlink" title="è®©åå­—å˜çŸ­"></a>è®©åå­—å˜çŸ­</h2><p>æ„Ÿè°¢ <code>babel-plugin-react-css-modules</code> å’Œ <code>css-loader</code> å…±äº«ç›¸åŒçš„é€»è¾‘æ¥ç”Ÿæˆ CSS ç±»åç§°ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç±»åæ”¹ä¸ºä»»ä½•æˆ‘ä»¬å–œæ¬¢çš„ï¼Œç”šè‡³æ˜¯éšæœºå“ˆå¸Œã€‚ç„¶è€Œï¼Œæˆ‘æƒ³è¦æœ€çŸ­çš„ç±»åï¼Œè€Œä¸æ˜¯éšæœºå“ˆå¸Œã€‚</p><p>ä¸ºäº†ç”Ÿæˆæœ€çŸ­çš„ç±»åï¼Œæˆ‘åˆ›å»ºäº†ç±»åç´¢å¼•ï¼Œå¹¶ä½¿ç”¨è¯¥ <code>incstr</code> æ¨¡å—ä¸ºç´¢å¼•ä¸­çš„æ¯ä¸ªæ¡ç›®ç”Ÿæˆå¢é‡IDã€‚</p><script src="https://gist.github.com/gajus/b61ab58c4243f189722c0c13e59cdd24.js"></script><p>è¿™ä¿è¯äº†ç±»åç®€çŸ­å¹¶ä¸”å”¯ä¸€ã€‚ç°åœ¨ï¼Œ<code>.MovieView___movie-title___yvKVV</code> å’Œ <code>.MovieView___movie-description-with-summary-paragraph___yvKVV</code> çš„ç±»åéƒ½æˆäº† <code>.a_a</code>, <code>.b_a</code>ç­‰ã€‚</p><p>è¿™å°† <code>GO2CINEMA</code> CSS å‹ç¼©åŒ…çš„å¤§å°ä» 140 KB é™ä½åˆ° 53KBã€‚</p><h2 id="ä½¿ç”¨ä½œç”¨åŸŸéš”ç¦»æ¥è¿›ä¸€æ­¥å‡å°‘åŒ…çš„å¤§å°"><a href="#ä½¿ç”¨ä½œç”¨åŸŸéš”ç¦»æ¥è¿›ä¸€æ­¥å‡å°‘åŒ…çš„å¤§å°" class="headerlink" title="ä½¿ç”¨ä½œç”¨åŸŸéš”ç¦»æ¥è¿›ä¸€æ­¥å‡å°‘åŒ…çš„å¤§å°"></a>ä½¿ç”¨ä½œç”¨åŸŸéš”ç¦»æ¥è¿›ä¸€æ­¥å‡å°‘åŒ…çš„å¤§å°</h2><p>åˆ†ç¦»ç»„ä»¶åç§°å’Œæœ¬åœ°æ ‡è¯†ç¬¦åç§°æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç†ç”±è®©æˆ‘æ·»åŠ  <code>_</code> åˆ° CSS ç±»å - å¯¹äºç¼©å°æ–‡ä»¶å¤§å°ç‰¹åˆ«æœ‰ç”¨ã€‚</p><p><a href="https://github.com/css/csso" target="_blank" rel="noopener">csso</a>ï¼ˆCSS minifierï¼‰å…·æœ‰<a href="https://github.com/css/csso#scopes" target="_blank" rel="noopener">ä½œç”¨åŸŸ</a>é…ç½®ã€‚ä½œç”¨åŸŸå®šä¹‰äº†åœ¨æŸäº›æ ‡è®°ä¸Šä¸“é—¨ä½¿ç”¨çš„ç±»ååˆ—è¡¨ï¼Œå³æ¥è‡ªä¸åŒä½œç”¨åŸŸçš„é€‰æ‹©å™¨ä¸ä¼šåŒ¹é…åŒä¸€ä¸ªå…ƒç´ ã€‚è¿™ä¸€æ¡è®©ä¼˜åŒ–è§„åˆ™æ›´è¿›ä¸€æ­¥ã€‚</p><p>è¦åˆ©ç”¨æ­¤åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ <a href="https://github.com/zoobestik/csso-webpack-plugin" target="_blank" rel="noopener"><code>csso-webpack-plugin</code></a> æ¥åå¤„ç† CSS åŒ…ï¼š</p><script src="https://gist.github.com/gajus/720ece26d03ea901b515c9b80b6ac4c8.js"></script><p>è¿™ä½¿ GO2CINEMA CSS æ†ç»‘åŒ…çš„å¤§å°ä» 53 KB é™è‡³ 47 KBã€‚</p><h2 id="è¿™å€¼å¾—ä¹ˆï¼Ÿ"><a href="#è¿™å€¼å¾—ä¹ˆï¼Ÿ" class="headerlink" title="è¿™å€¼å¾—ä¹ˆï¼Ÿ"></a>è¿™å€¼å¾—ä¹ˆï¼Ÿ</h2><p>è¿™ç§å‹ç¼©çš„ç¬¬ä¸€ä¸ªäº‰è®®æ˜¯è§‰å¾—å‹ç¼©ç®—æ³•æœ¬æ¥å°±å¯ä»¥åšåˆ°ã€‚ä½¿ç”¨ <a href="https://en.wikipedia.org/wiki/Brotli" target="_blank" rel="noopener">Brotli</a> ç®—æ³•å‹ç¼©çš„ GO2CINEMA CSS åŒ…ä¸é•¿ç±»åçš„åŸå§‹åŒ…ç›¸æ¯”åªå‹ç¼©äº† 1 KBã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œè®¾ç½®è¿™ä¸ªç¼©å°æ˜¯ä¸€æ¬¡æ€§æŠ•å…¥ï¼Œå®ƒå‡å°‘äº†éœ€è¦è§£æçš„æ–‡æ¡£çš„å¤§å°ã€‚å®ƒè¿˜å…·æœ‰å…¶ä»–å¥½å¤„ï¼Œä¾‹å¦‚é˜»æ­¢ä¾èµ– CSSç±»åç§°çš„æ‰«æä»ªå¯¼èˆªæˆ–æ„å¤–åŒ¹é…å¹¿å‘Šæ‹¦æˆªå™¨<a href="https://gist.github.com/spyesx/42fe84c0ef757d1c38a4" target="_blank" rel="noopener">é»‘åå•</a>çš„ CSSé€‰æ‹©å™¨ã€‚</p><p>åŒæ—¶ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°åœ¨ GO2CINEMA å’Œ venue é¡µé¢ä¸Šä½¿ç”¨çš„è¿™ç§å‹ç¼©çš„æ¼”ç¤ºï¼Œä¾‹å¦‚</p><ul><li><a href="https://go2cinema.com/movies/wonder-woman-2017-1305237" target="_blank" rel="noopener">https://go2cinema.com/movies/wonder-woman-2017-1305237</a></li><li><a href="https://go2cinema.com/venues/odeon-oxford-magdalen-st-1001053" target="_blank" rel="noopener">https://go2cinema.com/venues/odeon-oxford-magdalen-st-1001053</a></li></ul><p>ã€ç¿»è¯‘åŸæ–‡ã€‘ï¼š<a href="https://medium.freecodecamp.org/reducing-css-bundle-size-70-by-cutting-the-class-names-and-using-scope-isolation-625440de600b" target="_blank" rel="noopener">https://medium.freecodecamp.org/reducing-css-bundle-size-70-by-cutting-the-class-names-and-using-scope-isolation-625440de600b</a></p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;åƒ-google-ä¸€æ ·é€šè¿‡ç¼©çŸ­-css-ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ–-css-åŒ…çš„å¤§å°&quot;&gt;&lt;a href=&quot;#åƒ-google-ä¸€æ ·é€šè¿‡ç¼©çŸ­-css-ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ–-css-åŒ…çš„å¤§å°&quot; class=&quot;headerlink&quot; title=&quot;åƒ google ä¸€æ ·é€šè¿‡ç¼©çŸ­ css ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ– css åŒ…çš„å¤§å°&quot;&gt;&lt;/a&gt;åƒ google ä¸€æ ·é€šè¿‡ç¼©çŸ­ css ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥å‹ç¼©ä¼˜åŒ– css åŒ…çš„å¤§å°&lt;/h1&gt;&lt;blockquote&gt;&lt;h2 id=&quot;å°±åƒ-google-çš„åšæ³•ä¸€æ ·&quot;&gt;&lt;a href=&quot;#å°±åƒ-google-çš„åšæ³•ä¸€æ ·&quot; class=&quot;headerlink&quot; title=&quot;å°±åƒ google çš„åšæ³•ä¸€æ ·&quot;&gt;&lt;/a&gt;å°±åƒ google çš„åšæ³•ä¸€æ ·&lt;/h2&gt;&lt;/blockquote&gt;&lt;p&gt;ä»Šå¹´å¹´åˆï¼Œæˆ‘å·²ç»é€€å‡ºå’¨è¯¢å…¬å¸å¹¶å¼€å§‹æ„å»º &lt;a href=&quot;https://go2cinema.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GO2CINEMA&lt;/a&gt; - ä¸€ä¸ª &lt;em&gt;å¿«é€Ÿï¼Œç®€å•å’Œå®‰å…¨&lt;/em&gt; çš„æ–¹å¼æ¥é¢„è®¢è‹±å›½çš„ç”µå½±ç¥¨çš„ç½‘ç«™ã€‚æˆ‘åšäº†ä¸€ä¸ªè¾‰ç…Œçš„å·¥ä½œï¼Œä½¿å…¶å¿«é€Ÿï¼Œç®€å•å’Œå®‰å…¨ã€‚åœ¨å…¶ä¸­æŸä¸ªé˜¶æ®µï¼Œæˆ‘ä¸€ç›´ç—´è¿·äºå…³é”®æ¸²æŸ“è·¯å¾„çš„ä¼˜åŒ–ã€‚âš¡ï¸&lt;/p&gt;&lt;p&gt;æˆ‘å·²ç»ä½¿ç”¨ &lt;a href=&quot;https://github.com/gajus/usus&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Å«sus&lt;/a&gt; è§£å†³äº† HTML çš„é¢„æ¸²æŸ“ã€‚Å«sus æ¸²æŸ“å•é¡µåº”ç”¨ç¨‹åºï¼ˆSPAï¼‰çš„ HTMLï¼Œå¹¶&lt;a href=&quot;https://medium.com/@gajus/pre-rendering-spa-for-seo-and-improved-perceived-page-loading-speed-47075aa16d24&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å†…åµŒäº†ç”¨äºå‘ˆç°é¡µé¢çš„ CSS&lt;/a&gt;ã€‚ä½†æ˜¯ï¼Œæˆ‘å¹¶ä¸å–œæ¬¢åœ¨æ¯ä¸ª HTML æ–‡æ¡£å†…åµŒ 70 KB çš„ cssï¼Œç‰¹åˆ«æ˜¯å…¶ä¸­å¤§éƒ¨åˆ†æ˜¯ CSS ç±»åã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="css" scheme="http://robin-front.github.io/categories/css/"/>
    
    
      <category term="react" scheme="http://robin-front.github.io/tags/react/"/>
    
      <category term="webpack" scheme="http://robin-front.github.io/tags/webpack/"/>
    
      <category term="css" scheme="http://robin-front.github.io/tags/css/"/>
    
      <category term="minifier" scheme="http://robin-front.github.io/tags/minifier/"/>
    
  </entry>
  
  <entry>
    <title>æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿</title>
    <link href="http://robin-front.github.io/2017/07/23/Daxu-village-Huixian-wetland-Putao-Xingping-of-Guilin/"/>
    <id>http://robin-front.github.io/2017/07/23/Daxu-village-Huixian-wetland-Putao-Xingping-of-Guilin/</id>
    <published>2017-07-23T02:42:17.000Z</published>
    <updated>2017-07-23T02:42:17.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æˆ‘å¯ä¸æ˜¯ä¸€ä¸ªé…’åº—äº«å—è€…ï¼Œæˆ‘çš„ç©æ³•æ˜¯ donâ€™t stop, keep your step.</p></blockquote><h1 id="æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿"><a href="#æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿" class="headerlink" title="æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿"></a>æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿</h1><p>å¯¹äºæ¯ä¸ªåœ°æ–¹å¹¶ä¸æ‰“ç®—å»ä¸¤æ¬¡çš„äººæ¥è¯´ï¼ˆé™¤äº†ä¸€äº›ä½“éªŒç‰¹åˆ«å¥½çš„åœ°æ–¹ï¼‰ï¼Œä¸€æ¬¡æ€§æ‰“åŒ…çœ‹å®Œä¸€ä¸ªåœ°æ–¹æ‰€æœ‰æ„Ÿå…´è¶£çš„åœ°ç‚¹æ˜¯æœ€åˆé€‚çš„ã€‚æ‰€ä»¥ï¼Œæ¯æ¬¡å»å®Œï¼Œæ€»æ˜¯æŠŠä¸€ä¸ªå¸‚ï¼Œç”šè‡³ä¸€ä¸ªçœçš„æ”»ç•¥éƒ½åšå®Œäº†ã€‚æˆ–è®¸ä¹Ÿæ˜¯ä¸€ç§å¼ºè¿«ç—‡å§ã€‚</p><p>å…¶å®å›½å†…å¾ˆå¤šæ™¯ç‚¹éƒ½æ˜¯å‘ï¼Œç½‘ä¸Šç…§ç‰‡åŸºæœ¬éƒ½ä¸æ˜¯åŸç‰‡ã€‚å†™æ”»ç•¥æ˜¯ä¸ºäº†æ–¹ä¾¿åˆ«äººï¼Œä¹Ÿæ˜¯ä¸ºå‘äº†åˆ«äººä¸€èµ·ï¼Œå“ˆå“ˆï¼Œé¡ºä¾¿è®°å½•ã€‚<a id="more"></a></p><h2 id="è·¯çº¿è§„åˆ’"><a href="#è·¯çº¿è§„åˆ’" class="headerlink" title="è·¯çº¿è§„åˆ’"></a>è·¯çº¿è§„åˆ’</h2><p>ä¸‹é¢å…ˆç®€è¦çœ‹çœ‹æ€»ä½“è·¯çº¿è§„åˆ’ï¼š</p><p>Day 1: ç«è½¦ â€”â€”&gt; æ¡‚æ—å¸‚ â€”â€”&gt; å¤§åœ©å¤é•‡ï¼ˆ+ç†Šæ‘ï¼‰ Day 2: å¤§åœ©å¤é•‡ â€”â€”&gt; å¥‡å³°é•‡ï¼ˆé‡åˆ°ä¸å¯æŠ—å› ç´ ï¼‰â€”â€”&gt; ä¼šä»™é•‡ Day 3: ä¼šä»™æ¹¿åœ° â€”â€”&gt; ç»ç’ƒç”° â€”â€”&gt; è‘¡è„é•‡ Day 4: è‘¡è„é•‡ è‡³ å…´åªå¤é•‡ ç»å…¸å¾’æ­¥è·¯çº¿ 20 å…¬é‡Œ â€”â€”&gt; ç›¸å…¬å±±ï¼ˆæ—¥è½ï¼‰ Day 5: ç›¸å…¬å±±ï¼ˆæ—¥å‡ºï¼‰â€”â€”&gt; ç›¸å…¬å±±è‡³å…´åªå¤é•‡ â€”â€”&gt; è€å¯¨å±±ï¼ˆæ—¥è½ï¼‰â€”â€”&gt; é˜³æœ”é«˜é“æœ€åä¸€ç­å›ï¼ˆ8pmï¼‰</p><p>è¡¥å……å‡ å¼ çº¿è·¯å›¾ï¼š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/guilin/tubu.jpeg" data-original="/images/guilin/tubu.jpeg"> <img src="/js/lazyload-plugin/loading.svg" alt="/images/guilin/tubu2.jpeg" data-original="/images/guilin/tubu2.jpeg"> è‘¡è„é•‡è‡³å…´åªå¤é•‡ å¾’æ­¥è·¯çº¿å›¾</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/guilin/huixian.jpeg" data-original="/images/guilin/huixian.jpeg"> ä¼šä»™ç»ç’ƒç”°è·¯çº¿å›¾</p><h2 id="å¤§åœ©å¤é•‡ï¼ˆå¤§å¢Ÿï¼‰"><a href="#å¤§åœ©å¤é•‡ï¼ˆå¤§å¢Ÿï¼‰" class="headerlink" title="å¤§åœ©å¤é•‡ï¼ˆå¤§å¢Ÿï¼‰"></a>å¤§åœ©å¤é•‡ï¼ˆå¤§å¢Ÿï¼‰</h2><p>â€œæ˜æ¸…æ—¶æœŸç¹åä¸€æ—¶çš„å¤§åœ©å¤é•‡â€ã€‚</p><p>åœ¨æ¡‚æ—ç«è½¦ç«™æ—è¾¹çš„æ¡‚æ—é•¿é€”æ±½è½¦æ€»ç«™åå¼€å¾€å† å²©çš„ä¸“çº¿è½¦ï¼Œ40åˆ†é’Ÿå·¦å³å³å¯åˆ°è¾¾å¤§åœ©ï¼Œç¥¨ä»·5å…ƒå·¦å³ã€‚</p><p>å¤é•‡ä¸å¤§ï¼Œ1å°æ—¶è¶³ä»¥æ¸¸å®Œï¼Œè·å¤§åœ©é•‡8å…¬é‡Œï¼ˆåœ¨å¤§åœ©è·¯å£èƒ½çœ‹åˆ°æŒ‡è·¯ç‰Œï¼‰çš„ç†Šæ‘ï¼ˆå¤§åœ©å¿åŸæ­å…¬äº¤è¿‡å»3å…ƒï¼‰ã€‚</p><p>æ‘ä¸Šä¿ç•™ç€å®Œæ•´çš„æ—§æ—¶æ‘è½æ ¼å±€ï¼Œæœ‰ä¸Šç™¾æ ‹æ˜æ¸…å»ºç­‘ï¼Œç°å­˜æœ‰æ¹–å—ä¼šé¦†ã€æ±Ÿè¥¿ä¼šé¦†ã€è´¢ç¥æ®¿ç­‰ï¼Œæ‘å­çš„è€å»ºç­‘ä¸Šä¿ç•™äº†è®¸å¤šæ–‡é©æ ‡è¯­ã€‚</p><p>å°åƒï¼šå§œæ±æ¡‚èŠ±å‡‰ç²‰</p><p>â€œå¤§åœ©æ±Ÿä¸ŠèŠ¦ç”°å¯ºï¼Œç™¾å°ºæ·±æ½­ä¸‡ç«¹å›´ã€‚æŸ³åº—ç§¯è–ªæ™¨çˆ¨åï¼Œåƒ®äººè·å¶è£¹ç›å½’â€</p><h2 id="å¥‡å³°é•‡ï¼ˆæå®¶æ‘ï¼‰"><a href="#å¥‡å³°é•‡ï¼ˆæå®¶æ‘ï¼‰" class="headerlink" title="å¥‡å³°é•‡ï¼ˆæå®¶æ‘ï¼‰"></a>å¥‡å³°é•‡ï¼ˆæå®¶æ‘ï¼‰</h2><p>åœ¨æ¡‚æ—ç«è½¦ç«™å¯¹é¢æ­ä¹˜4è·¯è½¦ï¼Œå¼€å¾€å¥‡å³°é•‡æ–¹å‘ï¼Œåœ¨ <strong>ä¸œå±±æ‘</strong> ä¸‹è½¦ã€‚æ¯è¶Ÿè¿è¡Œå•ç¨‹æ—¶é—´å¤§çº¦æ˜¯40åˆ†é’Ÿã€‚ï¼ˆæˆ‘æ˜¯å¤§åœ©ç›´æ¥åæ‘©çš„30å…ƒæŠ„å°è·¯åˆ°å¥‡å³°é•‡ï¼‰</p><p>å¥‡å³°é•‡å¤–çœ‹å¥‡å³°ï¼Œä¸‡ç‚¹å°–å³°é”ç¢§ç©ºã€‚</p><p><strong>äº‹å®ä¸Šï¼Œé‡Œé¢æ˜¯å†›äº‹ç®¡åˆ¶åŒºï¼Œåªæœ‰æœ¬æ‘æ‘æ°‘æ‰èƒ½è¿›ã€‚å…¬äº¤è½¦åˆ°æ‘å£å°±è¢«å¼ºåˆ¶ä¸‹è½¦ã€‚è¯·ä¸è¦æ¥è¿™é‡Œï¼Œæ²¡æœ‰å¼€æ”¾</strong></p><h2 id="ä¼šä»™é•‡"><a href="#ä¼šä»™é•‡" class="headerlink" title="ä¼šä»™é•‡"></a>ä¼šä»™é•‡</h2><p>æ¡‚æ—æ±½è½¦ç«™ï¼Œä¹˜åæ¡‚æ—â€”ä¼šä»™çš„ç­è½¦ï¼Œæ¯éš”15åˆ†é’Ÿä¸€è¶Ÿï¼Œç¥¨ä»·8å…ƒï¼ˆç›´è¾¾ï¼‰ï¼Œä¹Ÿå¯åœ¨é›ä¸­è·¯å£ï¼Œå¸ˆå¤§ä¾§é—¨åè½¦ã€‚</p><blockquote><p>ç§‹å¤©å»çœ‹ä¸€ç‰‡é‡‘é»„ï¼Œæˆ–ç”°åœ°æ”¾æ°´æ—¶ï¼Œä¸€ç‰‡å¤©é•œã€‚</p></blockquote><ul><li><p>ä¼šä»™æ¹¿åœ°ï¼š æ­£åœ¨å¼€å‘ä¸­ï¼Œé…’åº—é£Ÿå®¿å…¨æ²¡æœ‰ï¼Œä¸€å¹´ååº”è¯¥ä¼šæœ‰ã€‚åˆ°ç¦æ´æ‘å§”è·¯å£ï¼Œç„¶åä¹˜åå‰å¾€æ¯›å®¶æ‘çš„ä¸‰è½®è½¦æ¯äºº2å…ƒé’±ï¼ˆå®é™…ä¸Šæœ‰æ—¶ä¼šå‘ä½ 10å…ƒï¼‰ã€‚ä¹Ÿå¯ä»è·¯å£æ­¥è¡Œè‡³æ¯›å®¶æ‘ï¼Œå¤§æ¦‚40åˆ†é’Ÿå·¦å³ï¼Œè·¯è¾¹ä¸€å¤§ç‰‡å†œç”°ï¼Œæ¹¿åœ°å…¬å›­æœ‰ä¸€å¤§ç‰‡è·èŠ±ã€‚ä¸€èˆ¬æ‘„å½±äººä¼šå»é¾™å±±ï¼Œå”®ç¥¨å£çš„äººä¼šå»ºè®®ä½ åèˆ¹è¿‡å»ä¸Šé¾™å±±ã€‚ç¥¨ä»·ä¸è²ã€‚è§‰å¾—å€¼å¯ä»¥åã€‚å¦‚æœæ˜¯ç©·å­¦ç”Ÿï¼Œé‚£å°±ä¹°é—¨ç¥¨ï¼Œèµ°è¿‡å»ï¼Œèˆ¹æ˜¯èµ°è¿‘è·¯ç›´æ¥åˆ°å±±è„šï¼Œèµ°è·¯å°±è¦åå…«å¼¯ï¼Œ40åˆ†é’Ÿå·¦å³ã€‚å†ä¸æµï¼Œå¾€å›èµ°æœ‰æ¡å²”è·¯ï¼Œæ˜¯é€šå‘åˆšåˆšå…¥å£æ–¹å‘ï¼Œäººå°‘æ—¶æ²¡äººå®ˆï¼Œå…ç¥¨è¿›å…¥ï¼Œè¿™æ˜¯æˆ‘å‡ºæ¥çš„æ—¶å€™å‘ç°çš„ã€‚</p></li><li><p>ç»ç’ƒç”°ï¼š æ¹¿åœ°æ˜¯åå¼€å‘çš„ï¼Œæœ€å¼€å§‹å‡ºåçš„æ˜¯ç»ç’ƒç”°è¿™ä¸€å—ã€‚å±±ä¹Ÿä¸éš¾æ‰¾ï¼Œå°±æ˜¯ä¸‹å›¾çš„ D ç‚¹ï¼Œä¸Šå±±ç‚¹åœ¨æ‘å£åŒ»é™¢å‰ã€‚</p></li></ul><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/guilin/huixian.jpeg" data-original="/images/guilin/huixian.jpeg"></p><h2 id="è‘¡è„é•‡"><a href="#è‘¡è„é•‡" class="headerlink" title="è‘¡è„é•‡"></a>è‘¡è„é•‡</h2><p>è¿™æ˜¯ä¸ªä¸­è½¬ä¼‘æ¯ç‚¹ï¼Œæ˜¯ç»å…¸å¾’æ­¥è·¯çº¿çš„èµ·ç‚¹ã€‚ä»ä¼šä»™è¿‡æ¥çš„è¯ï¼Œå…ˆåè½¦åˆ° é›ä¸­è·¯å£ï¼Œå¸ˆå¤§ä¾§é—¨ï¼Œç„¶ååœ¨å—ä¸‹çš„å¤§è·¯ä¸Šæ‹¦å»é˜³æœ”çš„è½¦ï¼Œåœ¨è‘¡è„é•‡ä¸‹è½¦ã€‚</p><p>ã€ŠçŸ³å¤´åŸåˆ°å…´åªå¾’æ­¥ - å±…é«˜ä¸´ä¸‹æ¬£èµå±±æ°´ç”»å·ã€‹ï¼ˆæ€»é•¿åº¦22.5å…¬é‡Œï¼‰: è¿™æ¡å¾’æ­¥çº¿è·¯æ¸…å¹½å¤æœ´ï¼Œæ¸¸äººç½•è‡³ï¼Œé€”ä¸­æ¯ä¸€æ¬¡ç™»é«˜ä¿¯è§†ï¼Œéƒ½å°†ä¸ºæ‚¨å±•å¼€ä¸€å¹…ä¸åŒçš„é˜³æœ”å±±æ°´ç”»å·ã€‚é˜³æœ”çš„ç»å…¸æ‘„å½±ä¸»é¢˜ï¼Œè‘¡è„ç”°å›­é£å…‰(åœ°å¤„é˜³æœ”è‘¡è„é•‡ä¹Œé¾™æ‘ï¼Œæ‹æ‘„è‘¡è„ç”°å›­é£å…‰å¤šä¸ºé€†å…‰æ‹æ‘„ï¼Œåº”é€‰æ‹©æœ‰å¤ªé˜³çš„å¤©æ°”ä¸‹åˆ4-5æ—¶åˆ°è¾¾å±±é¡¶ç­‰å€™æ‹æ‘„)ã€ç›¸å…¬å±±æ—¥å‡ºä»¥åŠè€å¯¨å±±æ—¥è½ï¼Œéƒ½åœ¨è¿™æ¡çº¿è·¯ä¸Šã€‚é€”å¾„å¤æœ´çš„çŸ³å¤´åŸä»¥åŠå…´åªè€è¡—ï¼Œåˆç»™è¿™æ¡çº¿è·¯å¢åŠ äº†äººæ–‡é£æƒ…ã€‚çº¿è·¯æœ€å¥½åˆ†ä¸¤å¤©å®Œæˆï¼Œè¿™æ ·å¯ä»¥å¤œå®¿ç›¸å…¬å±±ä»¥ä¾¿ç¬¬äºŒå¤©è§‚çœ‹æ—¥å‡ºã€‚å…¨ç¨‹éš¾åº¦ä¸å¤§ï¼Œä¸¤ä¸‰äººè½»è£…ä¾¿å¯å‡ºå‘ï¼Œæ²¿é€”æ‘åº„å¯ä»¥è¡¥ç»™ï¼Œä¹Ÿå¯å¸¦å°‘é‡é£Ÿç‰©å’Œæ°´ä»¥é˜²ä¸‡ä¸€</p><p>å½“ç„¶ï¼Œè¿™æ¡è·¯çº¿å¯ä»¥åç€æ¥èµ°ï¼Œä½†æˆ‘æ˜¯ä»ä¼šä»™è¿‡æ¥çš„ï¼Œè¿™æ ·èµ°æ›´é¡ºè·¯ï¼Œæœ€åé˜³æœ”é«˜é“å›ã€‚</p><p>ã€å¾’æ­¥çº¿è·¯Aï¼šå°è€€é—¨æ‘â€“çŸ³å¤´å¯¨â€“å¤§å²©å¤´æ‘â€“å°å†²å´´æ‘â€“å¤§åªæ‘â€“æ°´å²©é—¨æ‘â€“ç›¸å…¬å±±â€“é»„æ³¥ç”°æ‘â€“é•°åˆ€æ¹¾æ‘â€“å¤§æ²³èƒŒæ‘â€“æ¸”æ‘æ‘â€“å…´åªé•‡ã€‚ï¼ˆå…¨ç¨‹çº¦19å…¬é‡Œï¼‰ å¾’æ­¥çº¿è·¯Bï¼šå°è€€é—¨æ‘â€”çŸ³å¤´å¯¨â€”å¤§å²©å¤´æ‘â€”å°å†²å´´æ‘â€”å¤§åªæ‘â€“æ°´å²©é—¨æ‘â€“ç›¸å…¬å±±â€“è·è‹å±±æ‘â€“å†·æ°´æ‘â€“ç”»å±±æ‘â€“å…´åªé•‡ã€‚ï¼ˆå…¨ç¨‹çº¦18å…¬é‡Œï¼‰ã€‘ (PS: å…¶å®åº”è¯¥æœ‰25å…¬é‡Œï¼Œæˆ‘åœ¨çŸ³å¤´åŸè¿·è·¯ï¼Œèµ°å¾—å¤ªç´¯ï¼Œåæ¥è¿˜æ­äº†ä¸€æ®µé¡ºé£è½¦åˆ°ç›¸å…¬å±±)</p><h2 id="å…´åªå¤é•‡"><a href="#å…´åªå¤é•‡" class="headerlink" title="å…´åªå¤é•‡"></a>å…´åªå¤é•‡</h2><p>ç›¸å…¬å±±åˆ°å†·æ°´æ‘è·¯ä¸å¤ªå¥½èµ°ï¼Œæ¯”æƒ³è±¡ä¸­è¿œï¼Œä½†å…¶å®åº”è¯¥æœ‰è¿‘è·¯ï¼Œå› ä¸ºåœ¨è·¯ä¸Šæœ‰å²”è·¯ï¼Œä½†åœ°å›¾ä¸Šæ²¡æœ‰æ ‡ã€‚å»å†·æ°´æ‘éœ€è¦æ¸¡æ²³ï¼Œ10å…ƒã€‚æœ¬åœ°äººå…è´¹ã€‚å†·æ°´æ‘åˆ°å…´åªå¤é•‡ä¸€è·¯æ˜¯é£æ™¯ï¼Œä¹Ÿå¯åä¸‰è½®è½¦è¿‡å»ã€‚ä¸‹è½¦ç‚¹å°±æ˜¯20å…ƒäººæ°‘å¸ä¸Šçš„å›¾ã€‚ä¹‹ååœ¨è€å¯¨å±±çœ‹æ—¥è½ã€‚ä¸‹å±±åœ¨æ±½è½¦ç«™åå°é¢åŒ… 5å…ƒåˆ°é˜³æœ”é«˜é“ç«™å›ã€‚</p><h2 id="è¯¦ç»†å½±æ‘„"><a href="#è¯¦ç»†å½±æ‘„" class="headerlink" title="è¯¦ç»†å½±æ‘„"></a>è¯¦ç»†å½±æ‘„</h2><p>ä¸Šé¢éƒ½æ˜¯äº¤é€šç®€è¦ï¼Œä¸‹é¢æ˜¯å½±æ‘„ï¼š</p><blockquote><p>ï¼ˆå¾…æ›´ã€‚ã€‚ï¼‰</p></blockquote><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;&lt;p&gt;æˆ‘å¯ä¸æ˜¯ä¸€ä¸ªé…’åº—äº«å—è€…ï¼Œæˆ‘çš„ç©æ³•æ˜¯ donâ€™t stop, keep your step.&lt;/p&gt;&lt;/blockquote&gt;&lt;h1 id=&quot;æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿&quot;&gt;&lt;a href=&quot;#æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿&quot; class=&quot;headerlink&quot; title=&quot;æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿&quot;&gt;&lt;/a&gt;æ¡‚æ—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿&lt;/h1&gt;&lt;p&gt;å¯¹äºæ¯ä¸ªåœ°æ–¹å¹¶ä¸æ‰“ç®—å»ä¸¤æ¬¡çš„äººæ¥è¯´ï¼ˆé™¤äº†ä¸€äº›ä½“éªŒç‰¹åˆ«å¥½çš„åœ°æ–¹ï¼‰ï¼Œä¸€æ¬¡æ€§æ‰“åŒ…çœ‹å®Œä¸€ä¸ªåœ°æ–¹æ‰€æœ‰æ„Ÿå…´è¶£çš„åœ°ç‚¹æ˜¯æœ€åˆé€‚çš„ã€‚æ‰€ä»¥ï¼Œæ¯æ¬¡å»å®Œï¼Œæ€»æ˜¯æŠŠä¸€ä¸ªå¸‚ï¼Œç”šè‡³ä¸€ä¸ªçœçš„æ”»ç•¥éƒ½åšå®Œäº†ã€‚æˆ–è®¸ä¹Ÿæ˜¯ä¸€ç§å¼ºè¿«ç—‡å§ã€‚&lt;/p&gt;&lt;p&gt;å…¶å®å›½å†…å¾ˆå¤šæ™¯ç‚¹éƒ½æ˜¯å‘ï¼Œç½‘ä¸Šç…§ç‰‡åŸºæœ¬éƒ½ä¸æ˜¯åŸç‰‡ã€‚å†™æ”»ç•¥æ˜¯ä¸ºäº†æ–¹ä¾¿åˆ«äººï¼Œä¹Ÿæ˜¯ä¸ºå‘äº†åˆ«äººä¸€èµ·ï¼Œå“ˆå“ˆï¼Œé¡ºä¾¿è®°å½•ã€‚
    
    </summary>
    
      <category term="travel" scheme="http://robin-front.github.io/categories/travel/"/>
    
    
      <category term="travel" scheme="http://robin-front.github.io/tags/travel/"/>
    
  </entry>
  
  <entry>
    <title>é©¬è¨è¨æµ·æ»©(masasa beach) æ—…è¡Œé¢„ç®—æŒ‡å—</title>
    <link href="http://robin-front.github.io/2017/07/22/masasa-beach-travel-guide/"/>
    <id>http://robin-front.github.io/2017/07/22/masasa-beach-travel-guide/</id>
    <published>2017-07-22T03:29:35.000Z</published>
    <updated>2017-07-22T03:29:35.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ-â€”â€”-é©¬è¨è¨æµ·æ»©-masasa-beach"><a href="#å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ-â€”â€”-é©¬è¨è¨æµ·æ»©-masasa-beach" class="headerlink" title="å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ â€”â€” é©¬è¨è¨æµ·æ»©(masasa beach)"></a>å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ â€”â€” é©¬è¨è¨æµ·æ»©(masasa beach)</h1><p>é©¬è¨æ²™æ»©å¯ä»¥è¯´æ˜¯ Tingloy æœ€å¥½çš„æµ·æ»©ï¼Œè¿™æ˜¯ Batangas å”¯ä¸€ä¸åœ¨å¤§é™†å•å®‹å²›ä¸Šã€‚å®ƒçš„ä¸»è¦å²›å±¿æ˜¯é±¼å½¢é©¬é‡Œå¡ç­ï¼ˆMaricabanï¼‰ï¼Œä½äº Calumpang åŠå²›çš„ä¸€è§’ï¼Œå°†å·´æ‹‰æ‰¬æ¹¾ï¼ˆBalayan Bayï¼‰ä¸å…«æ‰“é›æ¹¾ï¼ˆBatangas Bayï¼‰åˆ†å¼€ã€‚</p><p>äº‹å®æ˜¯ï¼Œè¿™é‡Œçš„æ²™æ»©ä¸åƒä½ åœ¨é•¿æ»©å²›æˆ–å·´æ‹‰æœ›å²›æ‰€æœŸæœ›çš„é‚£æ ·åƒç™½è‰²çç ï¼Œä½†æ˜¯é©¬è¨æ²™æ»©åœ¨ç¼ºä¹äº®åº¦çš„æ²™æ»©ä¸­å±•ç°å‡ºæ³¢æµªçš„æ°”æ¯ã€‚å®ƒçš„æ°´æ™¶èˆ¬æ¸…æ¾ˆï¼Œæµ…æ°´æ•£å‘å‡ºç¾ä¸½çš„ç»¿æ¾çŸ³é—ªå…‰ï¼Œå³ä½¿è¿œè·ç¦»ä¹Ÿèƒ½å¸å¼•æ‚¨çš„æ³¨æ„ã€‚<a id="more"></a></p><p>æ¥è¿™é‡Œä¸»è¦æ˜¯ç©æ°´ï¼Œå¦‚æœä½ å–œæ¬¢æ¸¸æ³³ï¼Œæ¥è¿™é‡Œå§ã€‚æˆ‘æ˜¯åœ¨è¿™å­¦ä¼šç‹—çˆ¬å¼çš„ã€‚å“ˆå“ˆã€‚ã€‚ å…ˆæ¥çœ‹çœ‹ä¸€äº›ç…§ç‰‡ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="http://www.thepoortraveler.net/wp-content/uploads/2014/02/Mabini-Tingloy-Map.png" data-original="http://www.thepoortraveler.net/wp-content/uploads/2014/02/Mabini-Tingloy-Map.png"> å°å²›æ˜¯ä¸€ä¸ªå°é±¼å½¢çŠ¶ï¼Œå¾ˆå¯çˆ±</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1398.JPG" data-original="/images/masasa/IMG_1398.JPG"> åœ¨ Anilao Port åå…¬å…±èˆ¹åª</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1419.JPG" data-original="/images/masasa/IMG_1419.JPG"> åˆ°è¾¾ å°é±¼å²› ï¼Œå‡†å¤‡æµ®æ½œï¼Œå°å“¥å¾ˆå–åŠ›ï¼</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1429.JPG" data-original="/images/masasa/IMG_1429.JPG"> æ²¡é”™ï¼ŒèƒèŸ¹èˆ¹å¾ˆå¥½çœ‹ï¼Œä»–ä»¬å–œæ¬¢æ¶‚æˆå„ç§é¢œè‰²ï¼Œè‰ºæœ¯ç»†èƒä¸é”™ã€‚ä»¥åŠã€‚ã€‚çœŸæ­£è“è‰²çš„å¤§æµ·ï¼Œè€Œä¸æ˜¯ç°è‰²çš„ã€‚</p><p>æµ®æ½œåªéœ€100p !!è¶…ä¾¿å®œï¼Œä¸€å®šè¦å°è¯•ä¸€ä¸‹ï¼Œè™½ç„¶åªæ˜¯å¸¦ç€ä½ è½¬ä¸€åœˆï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°å„ç§æµ·é¾Ÿï¼ŒçŠç‘šï¼Œé•¿å¸¦é±¼ç­‰ã€‚æ€ªä¸å¾—å¾ˆå¤šæœ¬åœ°å¤§å­¦ç”Ÿæ¥ï¼ç»æµæ¼‚äº®ï¼ä½†æ˜¯æˆ‘æ²¡æœ‰æ‹åˆ°å¥½çš„æµ·åº•ç…§ç‰‡ã€‚ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1439.JPG" data-original="/images/masasa/IMG_1439.JPG"> æ²™å­ç¡®å®ä¸æ€ä¹ˆæ ·ï¼Œä½†æ˜¯æ°´è¿˜æ˜¯ä¸é”™</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1477.JPG" data-original="/images/masasa/IMG_1477.JPG"> æ°´æ¸…è§åº•</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1478.JPG" data-original="/images/masasa/IMG_1478.JPG"> å…¨è²Œ</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1539.JPG" data-original="/images/masasa/IMG_1539.JPG"> å®¶åº­å‡ºè¡Œéå¸¸å¤š</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1588.JPG" data-original="/images/masasa/IMG_1588.JPG"> é¦™è•‰èˆ¹</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1643.JPG" data-original="/images/masasa/IMG_1643.JPG"> é™„è¿‘æ‘åº„çš„å°å–éƒ¨çš„è€äºº</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1692.JPG" data-original="/images/masasa/IMG_1692.JPG"> è¿™æ˜¯ä»€ä¹ˆï¼Œè°èƒ½å‘Šè¯‰æˆ‘</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1702.JPG" data-original="/images/masasa/IMG_1702.JPG"> å…¶å®æ¥åˆ°è¿™é‡Œå†æ‰¾ä½å®¿ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºå¾ˆå¤šï¼Œåˆ°å¤„éƒ½æ˜¯</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1732.JPG" data-original="/images/masasa/IMG_1732.JPG"> è²è² <img src="/js/lazyload-plugin/loading.svg" alt="/images/masasa/IMG_1741.JPG" data-original="/images/masasa/IMG_1741.JPG"></p><h2 id="äº¤é€š"><a href="#äº¤é€š" class="headerlink" title="äº¤é€š"></a>äº¤é€š</h2><ul><li><p>bus,åœ¨å…«æ‰“é›å¸‚åŒº Batangas Grand Terminalä¸‹è½¦ï¼ˆ3-4 å°æ—¶ï¼‰ï¼ˆ<strong>åŒæ ·çš„ï¼ŒåŠå¤œå‡ºå‘ï¼Œæ—©ä¸Šåˆ°è¾¾ï¼Œä¸ç„¶ä¼šå¡è½¦</strong>ï¼‰ åœ¨LRT- Gil Puyat è½¦ç«™æ—è¾¹æœ‰å…¬å…±æ±½è½¦ç«™ï¼ˆDLTB liner æˆ– JAM linerï¼‰ã€‚ï¼ˆæ³¨æ„ï¼Œè¶Šæ—©è¶Šå¥½ã€‚å¦‚æœæ‚¨é€‰æ‹©ä¸€è¾†å¸¦æœ‰ CALABARZON æ ‡å¿—çš„å…¬å…±æ±½è½¦ï¼Œæ—…è¡Œæ—¶é—´å°†ä¼šæ›´çŸ­ï¼‰P120-P180ã€‚</p></li><li><p>è½¬å‰æ™®å°¼ï¼ˆ1å°æ—¶ï¼‰ 40 minutes. Fare: PhP 37. ç»ˆç‚¹ç«™æ˜¯ Mabini Multi-purpose port.ï¼ˆåˆå Anilao Portï¼‰(åœ¨habagat seasonå­£èŠ‚ï¼Œç»ˆç‚¹ç«™æ˜¯ Talaga Port )</p></li><li><p>a. åœ¨ Anilao Port åèˆ¹(<strong>æ¨è</strong>)ï¼ˆ45minï¼‰ å¦‚æœè¦åœ¨å²›ä¸Šä½ä¸€æ™šï¼Œå°±é€‰æ‹©å…¬å…±èˆ¹åªï¼Œæœ€ä¾¿å®œï¼ŒP80ã€‚æ—…è¡Œæ—¶é—´ï¼š45åˆ†é’Ÿ - 1å°æ—¶ã€‚ ç›´æ¥åèˆ¹åˆ° masasa beachã€‚ä½†æ˜¯ç›´è¾¾çš„èˆ¹æ›´å°‘ï¼Œä¸å¯é¢„æµ‹ï¼ŒP100 ï¼ˆæ³¨æ„ï¼Œæœ€åä¸€è‰˜è¿”å› Anilaoçš„èˆ¹æ˜¯ä¸Šåˆä¹ç‚¹ï¼Œæ‰€ä»¥ä¸å¾—ä¸ä½ä¸€æ™š,æœ‰äº›èˆ¹åœ¨è¾ƒå°çš„ç å¤´åœ¨ä¸­åˆ12ç‚¹å¯ä»¥æ¥ä¹˜å®¢å›,å…·ä½“å¯ä»¥å’¨è¯¢å½“åœ°äººä¸Šèˆ¹åœ°ç‚¹ï¼‰</p></li><li><p>b. å¦‚æœæ˜¯ä¸€æ—¥æ¸¸ï¼Œç§Ÿèˆ¹P4500ï¼Œå¯å10äººï¼Œå¯ä»¥è®²ä»·ã€‚å¦‚æœç§Ÿèˆ¹ï¼Œå¯ä»¥è¦æ±‚ä¸­é€”ç™»é™† Sombreroå²›ï¼Œä¸Šå²›è´¹ P200ï¼Œæœ‰äº›è¦P500.ï¼ˆç®—æ˜¯è·³å²›æ¸¸ï¼Œæ¯”è¾ƒè´µï¼‰</p></li></ul><h2 id="ä½å®¿"><a href="#ä½å®¿" class="headerlink" title="ä½å®¿"></a>ä½å®¿</h2><p>æˆ‘å½“æ—¶æ˜¯åœ¨ facebook ä¸Šæœç´¢ masasa ç„¶åè”ç³»çš„ä½å®¿ï¼ŒP300 æ¯äººï¼æ²¡æœ‰é…’åº—ã€‚å…¶å®é‚£é‡Œæ—è¾¹æœ‰æ‘å­ï¼Œæœ‰å¾ˆå¤šè¿‡å¤œçš„åœ°æ–¹ã€‚ä»¥å‰å¯ä»¥åœ¨æ²™æ»©éœ²è¥è¿‡å¤œï¼Œä½†åæ¥ä¸å…è®¸äº†ã€‚</p><h2 id="å…¶ä»–é¡¹ç›®"><a href="#å…¶ä»–é¡¹ç›®" class="headerlink" title="å…¶ä»–é¡¹ç›®"></a>å…¶ä»–é¡¹ç›®</h2><ul><li>ç¯å²›æ¸¸ï¼š æ ‡å‡†è´¹ç‡ï¼šP1500ï¼Œå²›ä¸Šå¯ä»¥è”ç³»å½“åœ°èˆ¹åªã€‚</li><li>æµ®æ½œï¼šP100 !!æˆ‘æ˜¯å½“æ—¶ä½å®¿çš„äººå¸®æˆ‘å®‰æ’è”ç³»çš„ï¼Œ30min,æ—¶é—´ä¸é•¿</li></ul><h2 id="è´¹ç”¨æ¸…å•"><a href="#è´¹ç”¨æ¸…å•" class="headerlink" title="è´¹ç”¨æ¸…å•"></a>è´¹ç”¨æ¸…å•</h2><ul><li>åˆ°å…«æ‰“é›çš„ç¥¨ä»·è½¦ç¥¨ï¼šç¥¨ä»·ï¼šP157 ä»LRT-Buendia å‡ºå‘ï¼ŒP127 ä»é˜¿æ‹‰é‚¦å‡ºå‘ã€‚</li><li>å‰éš†å°¼åˆ°é˜¿å°¼æ´›çš„å‰æ™®å°¼ç¥¨ä»·ï¼šP37</li><li>ä»Anilaoå‡ºå‘çš„å°èˆ¹å‡ºç§Ÿï¼ˆå²›å±¿æ¸¸è§ˆï¼‰ï¼šæ¯èˆ¹P4500ï¼ˆæœ€å¤§10äººï¼‰Masasa</li><li>æµ·æ»©çš„å°èˆ¹å‡ºç§Ÿï¼ˆå²›å±¿æ¸¸è§ˆï¼‰ï¼šæ¯èˆ¹P1500ï¼ˆ3paxæœ€å¤§ï¼‰</li><li>å…¬å…±å°èˆ¹åˆ° Tingloyï¼šP80ï¼ˆæ¨èï¼‰</li><li>ä¸‰è½®è½¦åˆ°é©¬è¨æ²™æ»©ï¼šP120/è¾†</li><li>ç¯å¢ƒè´¹ï¼šP30</li><li>é©¬è¨æ²™æ»©ï¼šå…è´¹</li><li>Sombrero Island ä¸Šå²›è´¹ï¼šP200</li><li>ç§Ÿå¸ç¯· P200</li></ul><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul><li>masasa beachåªæœ‰ä¸€ä¸ªæ´—æ‰‹é—´ï¼Œæ”¶è´¹ï¼ŒP10 æ¯æ¬¡ï¼›</li><li>è¿‡å¤œå¯èƒ½æ²¡æœ‰ç”µï¼Œå¸¦å¥½å……ç”µå®ï¼›</li><li>çœ‹å¥½å¤©æ°”ï¼Œæ™´å¤©æ¯”é˜´å¤©æ›´æ¼‚äº®ï¼Œæ°´æ›´æ¸…ï¼›</li></ul><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ-â€”â€”-é©¬è¨è¨æµ·æ»©-masasa-beach&quot;&gt;&lt;a href=&quot;#å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ-â€”â€”-é©¬è¨è¨æµ·æ»©-masasa-beach&quot; class=&quot;headerlink&quot; title=&quot;å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ â€”â€” é©¬è¨è¨æµ·æ»©(masasa beach)&quot;&gt;&lt;/a&gt;å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ â€”â€” é©¬è¨è¨æµ·æ»©(masasa beach)&lt;/h1&gt;&lt;p&gt;é©¬è¨æ²™æ»©å¯ä»¥è¯´æ˜¯ Tingloy æœ€å¥½çš„æµ·æ»©ï¼Œè¿™æ˜¯ Batangas å”¯ä¸€ä¸åœ¨å¤§é™†å•å®‹å²›ä¸Šã€‚å®ƒçš„ä¸»è¦å²›å±¿æ˜¯é±¼å½¢é©¬é‡Œå¡ç­ï¼ˆMaricabanï¼‰ï¼Œä½äº Calumpang åŠå²›çš„ä¸€è§’ï¼Œå°†å·´æ‹‰æ‰¬æ¹¾ï¼ˆBalayan Bayï¼‰ä¸å…«æ‰“é›æ¹¾ï¼ˆBatangas Bayï¼‰åˆ†å¼€ã€‚&lt;/p&gt;&lt;p&gt;äº‹å®æ˜¯ï¼Œè¿™é‡Œçš„æ²™æ»©ä¸åƒä½ åœ¨é•¿æ»©å²›æˆ–å·´æ‹‰æœ›å²›æ‰€æœŸæœ›çš„é‚£æ ·åƒç™½è‰²çç ï¼Œä½†æ˜¯é©¬è¨æ²™æ»©åœ¨ç¼ºä¹äº®åº¦çš„æ²™æ»©ä¸­å±•ç°å‡ºæ³¢æµªçš„æ°”æ¯ã€‚å®ƒçš„æ°´æ™¶èˆ¬æ¸…æ¾ˆï¼Œæµ…æ°´æ•£å‘å‡ºç¾ä¸½çš„ç»¿æ¾çŸ³é—ªå…‰ï¼Œå³ä½¿è¿œè·ç¦»ä¹Ÿèƒ½å¸å¼•æ‚¨çš„æ³¨æ„ã€‚
    
    </summary>
    
      <category term="travel" scheme="http://robin-front.github.io/categories/travel/"/>
    
    
      <category term="travel" scheme="http://robin-front.github.io/tags/travel/"/>
    
      <category term="philippine" scheme="http://robin-front.github.io/tags/philippine/"/>
    
  </entry>
  
  <entry>
    <title>Borawan islandã€Pagbilao Beach å’Œ Dampalitan islandæ—…è¡Œé¢„ç®—æŒ‡å—â€”â€”ä¸€ä¸ªå‘¨æœ«ä¸‰ä¸ªæ²™æ»©</title>
    <link href="http://robin-front.github.io/2017/07/22/borawan-island-Pagbilao-beach-and-Dampalitan-island/"/>
    <id>http://robin-front.github.io/2017/07/22/borawan-island-Pagbilao-beach-and-Dampalitan-island/</id>
    <published>2017-07-22T00:30:22.000Z</published>
    <updated>2017-07-22T00:30:22.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä¸€ä¸ªå­©å­çš„å†’é™©æ•…äº‹ â€”â€”â€”â€”è®²æ•…äº‹çš„äºº</p></blockquote><h1 id="å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€-â€”â€”â€”â€”-Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›"><a href="#å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€-â€”â€”â€”â€”-Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›" class="headerlink" title="å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€ â€”â€”â€”â€” Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›"></a>å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€ â€”â€”â€”â€” Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›</h1><p>åè½åœ¨å¥æ¾å—éƒ¨çš„è¾¹ç¼˜ï¼Œå¸ƒå°”æˆˆæ–¯ï¼ˆPadre Burgosï¼‰å’Œå¸•æ ¼æ¯”æ´›ï¼ˆPagbilaoï¼‰çš„åŸé•‡é¢å‘æ³°å·´å·´æ–¯æ¹¾ï¼ˆTayabas Bayï¼‰ï¼Œè¿™æ˜¯åˆ†ç¦»å¤§é™†å•å®‹å²›å’Œé©¬æ—æœå…‹å²›ï¼ˆMarinduqueï¼‰çš„é€šé“ã€‚é©¬å°¼æ‹‰å¸‚åŒºçš„è¿™ä¸€è¾¹åªæœ‰å››åˆ°äº”ä¸ªå°æ—¶çš„è·¯ç¨‹ï¼Œç”šè‡³è¿œè¿œè¿‘äº Pangasinanå’Œç¢§ç‘¶ï¼ˆBaguioï¼‰ã€‚<a id="more"></a></p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_4158.JPG" data-original="/images/20170722/IMG_4158.JPG"> è¿™æ˜¯Puting Buhanginï¼ŒPagbilaoï¼ˆä¹Ÿå«Kuwebang Lampasï¼‰æœ€æ¨èï¼Œè¯·åœ¨è¿™é‡Œè§„åˆ’æœ€é•¿çš„æ—¶é—´</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_4157.JPG" data-original="/images/20170722/IMG_4157.JPG"></p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_4139.JPG" data-original="/images/20170722/IMG_4139.JPG"></p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_3918.JPG" data-original="/images/20170722/IMG_3918.JPG"> <img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_3904.JPG" data-original="/images/20170722/IMG_3904.JPG"> Borawanï¼ŒèƒŒé å±±ï¼Œæ˜¯å¦ä¸€ç§é£æ™¯ï¼Œå’Œå²©çŸ³æ‹ç…§ç‰¹åˆ«å¥½çœ‹ã€‚è¿™æ˜¯ Borawan çš„æ—¥è½ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_3979.JPG" data-original="/images/20170722/IMG_3979.JPG"> æ°´é¢å¾ˆå¹³é™ï¼Œæ²¡æœ‰æµªï¼Œå¾ˆé€‚åˆæ¸¸æ³³</p><p><img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_3383.JPG" data-original="/images/20170722/IMG_3383.JPG"> Dampalitanï¼Œ æ°´å¾ˆæ¸…ï¼ <img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_3613.JPG" data-original="/images/20170722/IMG_3613.JPG"> <img src="/js/lazyload-plugin/loading.svg" alt="/images/20170722/IMG_3654.JPG" data-original="/images/20170722/IMG_3654.JPG"> å¤©æ°”å¾ˆå¥½ï¼</p><h2 id="å…¬å…±äº¤é€šå¦‚ä½•åˆ°è¾¾"><a href="#å…¬å…±äº¤é€šå¦‚ä½•åˆ°è¾¾" class="headerlink" title="å…¬å…±äº¤é€šå¦‚ä½•åˆ°è¾¾"></a>å…¬å…±äº¤é€šå¦‚ä½•åˆ°è¾¾</h2><ul><li>å…¬å…±æ±½è½¦ç«™ï¼šJAM liner, DLTB liner, JAC liner. ä½äº Taft Ave.</li><li>ä¹˜å…¬å…±æ±½è½¦åˆ°å¢å¡çº³å¸‚ï¼ˆLucenaï¼‰ã€‚é©¬å°¼æ‹‰å¤§éƒ½ä¼šæœ‰è®¸å¤šç»ˆç‚¹ç«™åˆ°å¢å¡çº³ã€‚ç¥¨ä»·ä»‹äºP250-260ä¹‹é—´ã€‚æ—…è¡Œæ—¶é—´ï¼š3-4å°æ—¶ã€‚</li><li>åœ¨å¢å¡çº³ç«™ä¸‹è½¦ï¼ˆLucena Grand Terminalï¼‰ã€‚</li><li>a. ä»ç»ˆç‚¹ç«™ä¹˜åå¦ä¸€è¾†å·´å£«åˆ° Unisanã€‚å…¬å…±æ±½è½¦æ²¡æœ‰ç©ºè°ƒï¼Œç¥¨ä»·åœ¨P35-40å·¦å³ã€‚æ—…è¡Œæ—¶é—´ï¼š1ä¸ªåŠå°æ—¶ã€‚ b. ä¹Ÿæœ‰å°é¢åŒ…è½¦ ï¼ˆVansï¼‰ï¼Œæœ‰æ‹›å®¢ç‰Œå†™ç€ Unisanï¼Œè¯´å» QCRB Bank ä¸‹è½¦ï¼Œå¤§æ¦‚ 60p æ¯äºº</li><li>åœ¨QCRBé“¶è¡Œï¼ˆPadre Burgosï¼‰ä¸‹è½¦ï¼Œæˆ–è€… <strong>æå‰å‘Šè¯‰å¸æœºè®©ä½ è¿™é‡Œä¸‹è½¦</strong>ã€‚</li><li>ä¹˜åä¸‰è½®è½¦åˆ° Aplayaã€‚å‘Šè¯‰å¸æœºä½ æ‰“ç®—å»Borawanï¼Œ åªéœ€ 20pã€‚</li><li>åœ¨ Aplaya æœ‰å°èˆ¹å‡ºç§Ÿã€‚è¿™äº›èˆ¹åªå¯ä»¥å¸¦æ‚¨å‰å¾€ Puting Buhanginï¼ˆPagbilaoï¼‰ï¼ŒDampalitanå²›å’ŒBorawanå²›çš„ä¸€ä¸ªå²›å±¿æ¸¸è§ˆã€‚P1500 - P2000ï¼Œé€‚åˆ10äººä»¥ä¸‹ã€‚</li></ul><h2 id="è¡Œç¨‹å‚è€ƒæ—¶é—´è¡¨"><a href="#è¡Œç¨‹å‚è€ƒæ—¶é—´è¡¨" class="headerlink" title="è¡Œç¨‹å‚è€ƒæ—¶é—´è¡¨"></a>è¡Œç¨‹å‚è€ƒæ—¶é—´è¡¨</h2><p>åŠå¤œå‡ºå‘æ˜¯æœ€åˆé€‚çš„ï¼Œæ—©ä¸Šå°±åˆ°ã€‚å¦‚æœæ—©ä¸Šå‡ºå‘ï¼Œä½ ä¼šåœ¨è·¯ä¸Šå¡è½¦å¹¶æµªè´¹ä¸€æ•´å¤©ã€‚ä¸è¦æŠŠç™½å¤©ç©çš„æ—¶é—´æµªè´¹åœ¨è½¦ä¸Šã€‚</p><ol><li>2:00 - Buendia Bus Terminal(DLTB liner or JAM liner)åè½¦ (P227-P250, 4h)ã€å‡Œæ™¨ä¸¤ç‚¹å‡ºå‘ï¼Œæ—©ä¸Šå…­ç‚¹åˆ°ã€‘ ç›®çš„åœ°ï¼šLucena Grand Terminal</li><li>6:00 - Lucena Grand Terminalæ¢ä¹˜å» Unisan çš„å…¬äº¤busï¼ˆP35 - P40ï¼‰ã€1.5h, é¢„è®¡ä¸ƒç‚¹åŠåˆ°ã€‘</li><li>7:00 - åœ¨ QCRB BANKä¸‹è½¦ã€‚æ¢tricycleä¸‰è½®è½¦ï¼ˆ10minï¼‰ï¼Œå»Aplaya (å’Œå¸æœºè¯´è¦å» Borawan)</li><li>åœ¨Aplayaç§Ÿèˆ¹ 8:00 å‡ºå‘ã€‚</li></ol><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>è¯¥åœ°åŒºæœ‰æ°´æ¯ï¼ˆjerryfishï¼‰ï¼Œè¯·ä¸€å®šæ³¨æ„ï¼ŒBorawanæ²™æ»©å°¤å…¶å¤šï¼Œæ‰€ä»¥å»ºäº†æ°´ç½‘åŒºåŸŸæ¸¸æ³³ï¼Œä¸è¦åœ¨éå®‰å…¨åŒºåŸŸæ¸¸æ³³ã€‚è¢«æ°´æ¯è›°äº†ä¹Ÿä¸è¦æƒŠæ…Œï¼Œæå‰äº†è§£å¤„ç†æ–¹æ³•ï¼Œä½¿ç”¨ç¢±æ€§æº¶æ¶²ï¼ˆå¦‚è‚¥çš‚æ°´ç­‰ï¼‰æ¸…æ´—ã€‚Pagbilaoå²›ã€Dampalitanå²›æ¯”è¾ƒå®‰å…¨ï¼Œä¸‹æ°´å‰å¯ä»¥è¯¢é—®å²›ä¸Šå·¥ä½œäººå‘˜èƒ½å¦ä¸‹æ°´ï¼Œæˆ–ä¸å…¶ä»–äººä¸€åŒä¸‹æ°´ï¼Œå‹¿å•ç‹¬æ¸¸æ³³ã€‚</p><h2 id="éœ²è¥æˆ–é…’åº—æˆ–ç§Ÿèˆ¹"><a href="#éœ²è¥æˆ–é…’åº—æˆ–ç§Ÿèˆ¹" class="headerlink" title="éœ²è¥æˆ–é…’åº—æˆ–ç§Ÿèˆ¹"></a>éœ²è¥æˆ–é…’åº—æˆ–ç§Ÿèˆ¹</h2><p>Borawan å’Œ Dampalitan Islands æ²¡æœ‰åº¦å‡æ‘æˆ–é…’åº—ï¼Œä½†å…è®¸éœ²è¥è¿‡å¤œã€‚å¦‚æœä½ ä¸æ˜¯é‡è¥çš„ç±»å‹ï¼Œé‚£ä¹ˆå¤§é™†æœ‰å‡ ä¸ªåº¦å‡æ‘ï¼Œä½ å¯ä»¥é€‰æ‹©ç•™ä¸‹æ¥ã€‚ä»¥ä¸‹æ˜¯æˆ‘æ”¶é›†çš„ç®€çŸ­åˆ—è¡¨ï¼š</p><ul><li>Silangang Nayoné¤å…å’Œåº¦å‡æ‘ã€‚ä½äºPagbilaoï¼Œå®ƒæ˜¯Bicolç»‘å®šçš„è·¯é€”è·‹æ¶‰è€…ä¹‹é—´çš„å…±åŒç‚¹ï¼Œä»–ä»¬æ¸´æœ›å“å°åˆ°ä»–ä»¬ç¾å‘³çš„Pinoyæµ·é²œèœè‚´ã€‚ä»–ä»¬åªæœ‰å°‘é‡çš„æˆ¿é—´ï¼Œæ‰€ä»¥å¦‚æœä½ è¦åœ¨æ—ºå­£ï¼Œæå‰é¢„è®¢ã€‚è”ç³»ç”µè¯ï¼šï¼ˆ042ï¼‰7160077ï¼Œ0922 8867677</li></ul><p>ä½†ï¼Œå¦‚æœä½ è®¤ä¸ºä½ æ˜¯ä¸€ä¸ªé‡è¥æ—…è¡Œï¼Œä¸ºä»€ä¹ˆä¸éœ²è¥å‘¢ï¼Ÿéœ²è¥ä¸ä»…é™ä½äº†æˆæœ¬ï¼Œè¿˜ä½¿æ‚¨æ›´å¥½åœ°æ¬£èµå²›å±¿ï¼Œä»è€Œä½¿æ‚¨æ›´æ¥è¿‘è‡ªç„¶ã€‚æ‰€æœ‰ä½ éœ€è¦çš„æ˜¯ä¸€ä¸ªå¸ç¯·å’Œä¸€äº›æ˜“äºå‡†å¤‡çš„é£Ÿå“ã€‚å¦‚æœæœ‰å†²æ³¡é£Ÿå“ï¼Œæ²™æ»©å°å–éƒ¨æœ‰çƒ­æ°´å‡ºå”®ï¼Œ20pã€‚</p><p>ç§Ÿèˆ¹ï¼ˆå®Œå…¨å¯ä»¥å»åˆ°å†ç§Ÿï¼Œå¦‚æœä¸æ”¾å¿ƒï¼Œå¯ä»¥æå‰è¯¢é—®ï¼‰ï¼š 09501928546ï¼Œ09094819703</p><p>å¤§éƒ¨åˆ†äººä¼šåœ¨ Borawan æ²™æ»© å’Œ Pagbilao æ²™æ»©è¿‡å¤œï¼Œè¿™ä¸¤ä¸ªåœ°æ–¹æœ‰å†²å‡‰æˆ¿å’Œå…¬å•ï¼Œå…è´¹ä½¿ç”¨ã€‚æˆ‘å»ºè®®åœ¨ Puthang Buhangin, Pagbilao è¿‡å¤œï¼Œé‚£é‡Œæ°´æœ€æ¸…ã€‚</p><h2 id="å¤‡ç”¨ç‰©å“æç¤º"><a href="#å¤‡ç”¨ç‰©å“æç¤º" class="headerlink" title="å¤‡ç”¨ç‰©å“æç¤º"></a>å¤‡ç”¨ç‰©å“æç¤º</h2><ul><li>åŒ–å¦†å“å’Œé˜²æ™’éœœ - é€šå¸¸ã€‚åœ¨å²›ä¸Šæœ‰å•†åº—ï¼Œä½†é¢„è®¡ä»·æ ¼æœ‰ç‚¹è¿‡é«˜ï¼Œæ‰€ä»¥æ›´å¥½åœ°å¸¦ä¸Šæ´—å‘æ°´ï¼Œè‚¥çš‚ï¼Œç‰™è†ï¼Œå«ç”Ÿçº¸å’Œæ¹¿å·¾ã€‚Dampalitan å²›ä¸Šæœ‰å…¬å•ï¼Œä½†æ°´æœ‰ç‚¹ç¨€å°‘ã€‚</li><li>é˜²èšŠæ´—å‰‚ - å¾ˆå¤šäººä¼šå¿˜è®°å¸¦æ¥ã€‚å²›ä¸Šæœ‰èšŠå­ã€‚</li><li>æ‰‹ç”µç­’ - é‚£é‡Œå¶å°”ä¼šåœç”µ</li><li>æ‰“ç«æœºå’Œå¾ˆå¤šæ•…äº‹ - ä½ ä¼šè¢«è¯±æƒ‘å¼€å§‹ç¯ç«ï¼Œä½ å°†éœ€è¦æ‰“ç«æœºç‚¹ç«å’Œå¯¹è¯ï¼Œä»¥ä¿æŒç‡ƒçƒ§ã€‚</li><li>æ€¥æ•‘åŒ… - ä½ æ°¸è¿œä¸ä¼šçŸ¥é“æ„å¤–ä»€ä¹ˆæ—¶å€™å‘ç”Ÿã€‚</li><li>æµ®æ½œè£…ç½® - æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°æ´»çŠç‘šï¼Œä½†æœ‰å¾ˆå¤šé±¼ã€‚ç‰¹åˆ«æ˜¯åœ¨ Dampalitanå’ŒPagbilaoï¼Œè¿™ä¸¤ä¸ªæ²™æ»©æ°´æ›´æ¸…ã€‚</li><li>é˜²æ°´ç›¸æœº - Kuwebang Lampasï¼ˆåœ¨Puthang Buhangin, Pagbilaoï¼‰æ˜¯éå¸¸æ£’çš„ï¼Œä½†å»é‚£é‡Œçš„æ°´å¾ˆæ·±ã€‚å¦‚æœæ‚¨æƒ³è¦åœ¨æ´ç©´å†…çš„å›¾ç‰‡ï¼Œé˜²æ°´ç›¸æœºéå¸¸æœ‰ç”¨ã€‚</li></ul><h2 id="é¢„ç®—è¯¦ç»†æ¡ç›®"><a href="#é¢„ç®—è¯¦ç»†æ¡ç›®" class="headerlink" title="é¢„ç®—è¯¦ç»†æ¡ç›®"></a>é¢„ç®—è¯¦ç»†æ¡ç›®</h2><p>ä»¥ä¸‹æ˜¯æ‚¨æœŸæœ›çš„è´¹ç”¨å’Œå…¶ä»–è´¹ç”¨æ¸…å•ã€‚</p><p>ä¹˜èˆ¹æ¸¸è§ˆè´¹ï¼ˆ8äººä¹˜è½¦ï¼‰ï¼š P800 - Borawanæµ·æ»©ï¼ˆå¾€è¿”ï¼‰ P1800 - Borawan + Dampalitan + Puting Buhanginï¼ˆä¸‰å²›ä¸¤å¤©ä¸€å¤œï¼Œè¿™æ˜¯æ€»èˆ¹è´¹ï¼Œä¸æ˜¯æ¯æ¬¡ï¼‰</p><p>Borawanæµ·æ»© ä¸Šå²›è´¹ï¼šP80 å¸ç¯·ç§Ÿé‡‘ï¼šP500(ä¹°ä¸€ä¸ªå¸ç¯·å»æœ€å¥½ï¼Œä¾¿å®œçš„æ‰1000på·¦å³ï¼Œè¿˜èƒ½å¸¦å›å») å°å±‹å‡ºç§Ÿï¼šP700-P850 è¿‡å¤œè´¹ï¼š P220æ¯äºº å¸ç¯·å åœ°è´¹ç”¨ï¼šP200-P250(åˆ†å åœ°å¤§å°)</p><p>Puting Buhanginï¼ŒPagbilao ä¸Šå²›è´¹ï¼šP80 å¸ç¯·å‡ºç§Ÿï¼šP300-400</p><p>Dampalitan å²› ä¸Šå²›è´¹ï¼šP80 å¸ç¯·å åœ°è´¹ï¼šP100 å°å±‹å‡ºç§Ÿï¼šP850-P1000 æ°´ï¼šP40/5Lï¼ŒP400/å¤§æ¡¶</p><p>ä»¥ä¸Šè´¹ç”¨å¯èƒ½ä¼šæ¶¨ä»·ï¼Œä½†ä¸ä¼šåç¦»å¤ªå¤šã€‚æœ€é‡è¦æ˜¯å¸¦å¥½é£Ÿç‰©å’Œé¥®ç”¨æ°´ã€‚è¿‡å¤œè¯·æ‹¿å¥½ç¥¨æ®ï¼Œä»¥å…å…¶ä»–å‘˜å·¥å†æ¬¡æ¥æ”¶é’±ã€‚</p><h2 id="ä¸€èˆ¬é¡ºåºï¼š"><a href="#ä¸€èˆ¬é¡ºåºï¼š" class="headerlink" title="ä¸€èˆ¬é¡ºåºï¼š"></a>ä¸€èˆ¬é¡ºåºï¼š</h2><ul><li><strong>æ¨èï¼šBorawanï¼ˆ9ï¼š00-åˆé¤ï¼‰ ==&gt; Puting buhanginï¼ˆ14ï¼š00-è¿‡å¤œï¼‰ ===&gt; Dampalitan (10ï¼š00 - 14:00å›ç¨‹)</strong></li><li>Puting buhanginï¼ˆ9ï¼š00ï¼‰ ==&gt; Dampalitanï¼ˆ11ï¼š30-åˆé¤ï¼‰ ===&gt; Borawan (14ï¼š00 - è¿‡å¤œ)</li><li>Puting buhanginï¼ˆ9ï¼š00-åˆé¤ï¼‰===&gt; Borawanï¼ˆ14ï¼š00-è¿‡å¤œï¼‰===&gt; Dampalitan(10:00- 14:00å›ç¨‹)</li></ul><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;&lt;p&gt;ä¸€ä¸ªå­©å­çš„å†’é™©æ•…äº‹ â€”â€”â€”â€”è®²æ•…äº‹çš„äºº&lt;/p&gt;&lt;/blockquote&gt;&lt;h1 id=&quot;å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€-â€”â€”â€”â€”-Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›&quot;&gt;&lt;a href=&quot;#å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€-â€”â€”â€”â€”-Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›&quot; class=&quot;headerlink&quot; title=&quot;å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€ â€”â€”â€”â€” Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›&quot;&gt;&lt;/a&gt;å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€ â€”â€”â€”â€” Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›&lt;/h1&gt;&lt;p&gt;åè½åœ¨å¥æ¾å—éƒ¨çš„è¾¹ç¼˜ï¼Œå¸ƒå°”æˆˆæ–¯ï¼ˆPadre Burgosï¼‰å’Œå¸•æ ¼æ¯”æ´›ï¼ˆPagbilaoï¼‰çš„åŸé•‡é¢å‘æ³°å·´å·´æ–¯æ¹¾ï¼ˆTayabas Bayï¼‰ï¼Œè¿™æ˜¯åˆ†ç¦»å¤§é™†å•å®‹å²›å’Œé©¬æ—æœå…‹å²›ï¼ˆMarinduqueï¼‰çš„é€šé“ã€‚é©¬å°¼æ‹‰å¸‚åŒºçš„è¿™ä¸€è¾¹åªæœ‰å››åˆ°äº”ä¸ªå°æ—¶çš„è·¯ç¨‹ï¼Œç”šè‡³è¿œè¿œè¿‘äº Pangasinanå’Œç¢§ç‘¶ï¼ˆBaguioï¼‰ã€‚
    
    </summary>
    
      <category term="travel" scheme="http://robin-front.github.io/categories/travel/"/>
    
    
      <category term="travel" scheme="http://robin-front.github.io/tags/travel/"/>
    
      <category term="philippine" scheme="http://robin-front.github.io/tags/philippine/"/>
    
  </entry>
  
  <entry>
    <title>é«˜æ€§èƒ½ reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·</title>
    <link href="http://robin-front.github.io/2017/07/18/make-react-fast-again-tools-and-techniques-for-speeding-up-your-react-app/"/>
    <id>http://robin-front.github.io/2017/07/18/make-react-fast-again-tools-and-techniques-for-speeding-up-your-react-app/</id>
    <published>2017-07-18T07:25:02.000Z</published>
    <updated>2017-07-18T07:25:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é«˜æ€§èƒ½-reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·"><a href="#é«˜æ€§èƒ½-reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·" class="headerlink" title="é«˜æ€§èƒ½ reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·"></a>é«˜æ€§èƒ½ reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·</h1><p>react é€šå¸¸å¾ˆå¿«ï¼Œä½†å¾ˆå®¹æ˜“é€ æˆå¯¼è‡´æ€§èƒ½é—®é¢˜çš„å°é”™è¯¯ã€‚ç¼“æ…¢çš„ç»„ä»¶å®‰è£…ï¼Œæ·±å±‚ç»„ä»¶æ ‘å’Œä¸å¿…è¦çš„æ¸²æŸ“å¾ªç¯å¯ä»¥å¿«é€Ÿæ·»åŠ åˆ°ä¸€ä¸ªæ„Ÿè§‰ç¼“æ…¢çš„åº”ç”¨ç¨‹åºã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼Œæœ‰å¾ˆå¤šå·¥å…·ï¼Œæœ‰äº›ç”šè‡³å†…ç½®äº Reactï¼Œè¿™æœ‰åŠ©äºè¯Šæ–­æ€§èƒ½é—®é¢˜ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å¼ºè°ƒä½¿ React åº”ç”¨ç¨‹åºæ›´å¿«é€Ÿçš„å·¥å…·å’ŒæŠ€æœ¯ã€‚æ¯ä¸ªéƒ¨åˆ†è¿˜æœ‰ä¸€ä¸ªäº’åŠ¨ï¼Œï¼ˆå¸Œæœ›ï¼‰æœ‰è¶£çš„æ¼”ç¤ºï¼<a id="more"></a></p><h2 id="å·¥å…·ï¼ƒ1ï¼šæ€§èƒ½æ—¶é—´è¡¨"><a href="#å·¥å…·ï¼ƒ1ï¼šæ€§èƒ½æ—¶é—´è¡¨" class="headerlink" title="å·¥å…·ï¼ƒ1ï¼šæ€§èƒ½æ—¶é—´è¡¨"></a>å·¥å…·ï¼ƒ1ï¼šæ€§èƒ½æ—¶é—´è¡¨</h2><p>React 15.4.0å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ€§èƒ½æ—¶é—´è½´åŠŸèƒ½ï¼Œå¯è®©æ‚¨å‡†ç¡®äº†è§£ç»„ä»¶çš„æŒ‚è½½ï¼Œæ›´æ–°å’Œå¸è½½ã€‚å®ƒè¿˜å¯ä»¥è®©æ‚¨å¯è§†åŒ–ç›¸å…³çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€‚</p><p>æ³¨æ„ï¼šç°åœ¨ï¼Œæ­¤åŠŸèƒ½ä»…é€‚ç”¨äºChromeï¼ŒEdgeå’ŒIEï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†å°šæœªåœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­å®ç°çš„ç”¨æˆ·æ—¶é—´è½´APIï¼ˆUser Timing APIï¼‰ã€‚</p><h3 id="æ€ä¹ˆè¿è¡Œçš„"><a href="#æ€ä¹ˆè¿è¡Œçš„" class="headerlink" title="æ€ä¹ˆè¿è¡Œçš„"></a>æ€ä¹ˆè¿è¡Œçš„</h3><ul><li>æ‰“å¼€ä½ çš„åº”ç”¨ç¨‹åºå¹¶é™„åŠ æŸ¥è¯¢å‚æ•°ï¼š<code>react_perf</code>ã€‚ä¾‹å¦‚ï¼Œ<code>http://localhost:3000?react_perf</code></li><li>æ‰“å¼€Chrome DevTools æ€§èƒ½é€‰é¡¹å¡ï¼Œç„¶åæŒ‰ <strong>è®°å½•ï¼ˆRecordï¼‰</strong>ã€‚</li><li>æ‰§è¡Œæ‚¨è¦åˆ†æçš„æ“ä½œã€‚</li><li>åœæ­¢è®°å½•</li><li>åœ¨ <code>User Timing</code> ä¸‹æ£€æŸ¥å¯è§†åŒ–ã€‚</li></ul><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1000/1*cOO5vUnbkdDUcqMW8ebJqA.png" data-original="https://cdn-images-1.medium.com/max/1000/1*cOO5vUnbkdDUcqMW8ebJqA.png"></p><h3 id="äº†è§£è¾“å‡º"><a href="#äº†è§£è¾“å‡º" class="headerlink" title="äº†è§£è¾“å‡º"></a>äº†è§£è¾“å‡º</h3><p>æ¯ä¸ªå½©è‰²æ¡æ˜¾ç¤ºç»„ä»¶æ­£åœ¨åšâ€œå·¥ä½œâ€çš„æ—¶é—´ã€‚ç”±äºJavaScriptæ˜¯å•çº¿ç¨‹çš„ï¼Œæ¯å½“ç»„ä»¶æ­£åœ¨åŠ è½½æˆ–å‘ˆç°æ—¶ï¼Œå®ƒä¼šé˜»æ­¢ä¸»çº¿ç¨‹ï¼Œå¹¶é˜»æ­¢å…¶ä»–ä»£ç è¿è¡Œã€‚</p><p>æ–¹æ‹¬å·ä¸­çš„æ–‡å­—<code>[update]</code>æè¿°äº†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„å“ªä¸ªéƒ¨åˆ†æ­£åœ¨å‘ç”Ÿã€‚æ—¶é—´è½´ä¼šåˆ†è§£æ¯ä¸ªæ­¥éª¤ï¼Œå› æ­¤æ‚¨å¯ä»¥åœ¨<code>[componentDidMount]</code> <code>[componentWillReceiveProps]</code> <code>[ctor]</code>ï¼ˆæ„é€ å‡½æ•°ï¼‰å’Œ <code>[render]</code> æ–¹æ³•ä¸Šçœ‹åˆ°ç»†ç²’åº¦çš„æ—¶åº.</p><p>å †å çš„æ¡è¡¨ç¤ºç»„ä»¶æ ‘ã€‚è™½ç„¶åœ¨Reactä¸­å…·æœ‰ç›¸å½“æ·±çš„ç»„ä»¶æ ‘æ˜¯å…¸å‹çš„ï¼Œä½†å¦‚æœè¦ä¼˜åŒ–ç»å¸¸å®‰è£…çš„ç»„ä»¶ï¼Œåˆ™å¯ä»¥å¸®åŠ©å‡å°‘å°è£…ç»„ä»¶çš„æ•°é‡ï¼Œå› ä¸ºæ¯ä¸ªç»„ä»¶éƒ½ä¼šå¢åŠ å°çš„æ€§èƒ½å’Œå†…å­˜æŸå¤±ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ç‚¹å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ—¶é—´è¡¨ä¸­çš„æ—¶é—´åºåˆ—æ˜¯ç”¨äºå¼€å‘æ„å»ºReactçš„ï¼Œå®ƒæ¯”ç”Ÿäº§ç¯å¢ƒæ›´æ…¢ã€‚äº‹å®ä¸Šï¼Œç”šè‡³æ€§èƒ½æ—¶é—´è¡¨æœ¬èº«ä¼šå‡æ…¢æ‚¨çš„åº”ç”¨ç¨‹åºã€‚è™½ç„¶è¿™äº›æ•°å­—ä¸åº”è¯¥è¢«è®¤ä¸ºæ˜¯çœŸå®è¡¨ç°çš„æ€§èƒ½ï¼Œä½†æ˜¯ä¸åŒç»„ä»¶ä¹‹é—´çš„ç›¸å¯¹å®šæ—¶æ˜¯å‡†ç¡®çš„ã€‚æ­¤å¤–ï¼Œç»„ä»¶æ˜¯å¦æ›´æ–°å®Œå…¨ä¸ä¾èµ–äºç”Ÿäº§ç¯å¢ƒä¸Šçš„æ„å»ºã€‚</p><h3 id="æ¼”ç¤ºï¼ƒ1"><a href="#æ¼”ç¤ºï¼ƒ1" class="headerlink" title="æ¼”ç¤ºï¼ƒ1"></a>æ¼”ç¤ºï¼ƒ1</h3><p>ä¸ºäº†ä¹è¶£ï¼Œæˆ‘æ“çºµäº†TodoMVCåº”ç”¨ç¨‹åºï¼Œå‡ºç°ä¸€äº›ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚ä½ å¯ä»¥åœ¨<a href="https://perf-demo.firebaseapp.com/?react_perf" target="_blank" rel="noopener">è¿™é‡Œè¯•è¯•çœ‹</a>ã€‚</p><p>è¦æŸ¥çœ‹æ—¶é—´è½´ï¼Œè¯·æ‰“å¼€Chromeå¼€å‘å·¥å…·ï¼Œè½¬åˆ°â€œæ€§èƒ½â€é€‰é¡¹å¡ï¼Œç„¶åå•å‡»è®°å½•ã€‚ç„¶ååœ¨åº”ç”¨ç¨‹åºä¸­æ·»åŠ ä¸€äº›TODOï¼Œåœæ­¢å½•åˆ¶å¹¶æ£€æŸ¥æ—¶é—´è½´ã€‚çœ‹çœ‹æ˜¯å¦å¯ä»¥å‘ç°å“ªäº›ç»„ä»¶å¯¼è‡´æ€§èƒ½é—®é¢˜:)</p><h2 id="å·¥å…·ï¼ƒ2ï¼šä¸ºä»€ä¹ˆæ›´æ–°"><a href="#å·¥å…·ï¼ƒ2ï¼šä¸ºä»€ä¹ˆæ›´æ–°" class="headerlink" title="å·¥å…·ï¼ƒ2ï¼šä¸ºä»€ä¹ˆæ›´æ–°"></a>å·¥å…·ï¼ƒ2ï¼šä¸ºä»€ä¹ˆæ›´æ–°</h2><p>å½±å“ React ä¸­æ€§èƒ½çš„æœ€å¸¸è§é—®é¢˜ä¹‹ä¸€æ˜¯ä¸å¿…è¦çš„æ¸²æŸ“å¾ªç¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå³ä½¿ä»–ä»¬çš„ props æ²¡æœ‰æ”¹å˜ï¼ŒReact ç»„ä»¶å°†åœ¨çˆ¶çº§ render æ—¶é‡æ–° renderã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘æœ‰ä¸€ä¸ªè¿™æ ·çš„ç®€å•ç»„ä»¶ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DumbComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;this.props.value&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åŠ ä¸Šçˆ¶ç»„ä»¶:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">DumbComponent</span> <span class="attr">value</span>=<span class="string">&#123;3&#125;</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ— è®ºä½•æ—¶çˆ¶ç»„ä»¶ renderï¼Œ<code>DumbComponent</code> éƒ½ä¼šé‡æ–° renderï¼Œå°½ç®¡å…¶ <code>props</code> æ²¡æœ‰æ”¹å˜ã€‚</p><p>é€šå¸¸ï¼Œå¦‚æœ render è¿è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰å¯¹è™šæ‹ŸDOMè¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªæµªè´¹çš„æ¸²æŸ“å¾ªç¯ï¼Œå› ä¸ºè¯¥ render æ–¹æ³•åº”è¯¥æ˜¯çº¯çš„ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚åœ¨å¤§è§„æ¨¡çš„ React åº”ç”¨ç¨‹åºä¸­ï¼Œæ£€æµ‹å‘ç”Ÿè¿™ç§æƒ…å†µçš„åœ°æ–¹å¯èƒ½å¾ˆæ£˜æ‰‹ï¼Œä½†å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªå¯ä»¥å¸®åŠ©çš„å·¥å…·ï¼</p><h3 id="ä½¿ç”¨-why-did-you-update"><a href="#ä½¿ç”¨-why-did-you-update" class="headerlink" title="ä½¿ç”¨ why-did-you-update"></a>ä½¿ç”¨ why-did-you-update</h3><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1000/1*Lb4nr_WLwnLt63jUoszrnQ.png" data-original="https://cdn-images-1.medium.com/max/1000/1*Lb4nr_WLwnLt63jUoszrnQ.png"></p><p><code>why-did-you-update</code> æ˜¯ä¸€ä¸ªæŒ‚æ¥åˆ° React çš„åº“ï¼Œå¹¶æ£€æµ‹æ½œåœ¨çš„ä¸å¿…è¦çš„ç»„ä»¶æ¸²æŸ“ã€‚å®ƒæ£€æµ‹ç»„ä»¶çš„renderæ–¹æ³•ä½•æ—¶è¢«è°ƒç”¨ï¼Œå°½ç®¡å®ƒçš„ <code>props</code> æ²¡æœ‰æ”¹å˜ã€‚</p><h3 id="å»ºç«‹"><a href="#å»ºç«‹" class="headerlink" title="å»ºç«‹"></a>å»ºç«‹</h3><p>å®‰è£… <code>npmï¼š npm i --save-dev why-did-you-update</code></p><p>åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹æ·»åŠ æ­¤ä»£ç æ®µï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</div><div class="line">  <span class="keyword">const</span> &#123;whyDidYouUpdate&#125; = <span class="built_in">require</span>(<span class="string">'why-did-you-update'</span>)</div><div class="line">  whyDidYouUpdate(React)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œæ­¤å·¥å…·åœ¨æœ¬åœ°å¼€å‘ä¸­éå¸¸å‡ºè‰²ï¼Œä½†ç¡®ä¿åœ¨ç”Ÿäº§ä¸­å·²è¢«ç¦ç”¨ï¼Œå› ä¸ºå®ƒä¼šå‡æ…¢æ‚¨çš„åº”ç”¨ç¨‹åºã€‚</p><h3 id="äº†è§£è¾“å‡º-1"><a href="#äº†è§£è¾“å‡º-1" class="headerlink" title="äº†è§£è¾“å‡º"></a>äº†è§£è¾“å‡º</h3><p><code>why-did-you-update</code> ç›‘è§†æ‚¨çš„åº”ç”¨ç¨‹åºè¿è¡Œå¹¶è®°å½•å¯èƒ½ä¼šä¸å¿…è¦åœ°æ›´æ”¹çš„ç»„ä»¶ã€‚å®ƒå…è®¸æ‚¨åœ¨æ¸²æŸ“å¾ªç¯ä¹‹å‰å’Œä¹‹åçœ‹åˆ° <code>props</code>ï¼Œç¡®å®šå®ƒå¯èƒ½æ˜¯ä¸å¿…è¦çš„ã€‚</p><h3 id="æ¼”ç¤ºï¼ƒ2"><a href="#æ¼”ç¤ºï¼ƒ2" class="headerlink" title="æ¼”ç¤ºï¼ƒ2"></a>æ¼”ç¤ºï¼ƒ2</h3><p>ä¸ºäº†æ¼”ç¤º<code>why-did-you-update</code>ï¼Œæˆ‘å°†åº“å®‰è£…åœ¨ TodoMVC åº”ç”¨ç¨‹åºçš„ Code Sandbox ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨çº¿ React æ¸¸æˆåœºã€‚æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°å¹¶æ·»åŠ ä¸€äº› TODO ä»¥æŸ¥çœ‹è¾“å‡ºã€‚</p><p><a href="https://codesandbox.io/s/xGJP4QExn" target="_blank" rel="noopener">è¿™æ˜¯æ¼”ç¤º</a></p><blockquote><p>è¯·æ³¨æ„ï¼Œåº”ç”¨ç¨‹åºä¸­çš„å‡ ä¸ªç»„ä»¶ä¸å¿…è¦åœ° renderã€‚å°è¯•å®ç°ä¸Šè¿°æŠ€æœ¯æ¥é˜²æ­¢ä¸å¿…è¦çš„æ¸²æŸ“ã€‚å¦‚æœæ­£ç¡®å®Œæˆï¼Œåˆ™<code>why-did-you-update</code>æ§åˆ¶å°ä¸­ä¸åº”æœ‰è¾“å‡ºã€‚</p></blockquote><h2 id="å·¥å…·ï¼ƒ3ï¼šååº”å¼€å‘å·¥å…·"><a href="#å·¥å…·ï¼ƒ3ï¼šååº”å¼€å‘å·¥å…·" class="headerlink" title="å·¥å…·ï¼ƒ3ï¼šååº”å¼€å‘å·¥å…·"></a>å·¥å…·ï¼ƒ3ï¼šååº”å¼€å‘å·¥å…·</h2><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1000/1*1Ih6h8djFyH13tfFK3D1sw.png" data-original="https://cdn-images-1.medium.com/max/1000/1*1Ih6h8djFyH13tfFK3D1sw.png"></p><p>React å¼€å‘è€…å·¥å…· Chrome æ‰©å±•ç¨‹åºå…·æœ‰å¯è§†åŒ–ç»„ä»¶æ›´æ–°çš„å†…ç½®åŠŸèƒ½ã€‚è¿™æœ‰åŠ©äºæ£€æµ‹ä¸å¿…è¦çš„æ¸²æŸ“å¾ªç¯ã€‚è¦ä½¿ç”¨å®ƒï¼Œé¦–å…ˆè¯·ç¡®ä¿åœ¨<a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=zh-CN" target="_blank" rel="noopener">æ­¤å¤„å®‰è£…æ‰©å±•</a>ã€‚</p><p>ç„¶åï¼Œç‚¹å‡»Chrome DevToolsä¸­çš„â€œReactâ€æ ‡ç­¾æ‰“å¼€æ‰©å±•ç¨‹åºï¼Œç„¶åé€‰ä¸­â€œHighlight Updatesâ€ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/800/1*GP4vXvW3WO0vTbggDfus4Q.png" data-original="https://cdn-images-1.medium.com/max/800/1*GP4vXvW3WO0vTbggDfus4Q.png"></p><p>ç„¶åï¼Œåªéœ€ä½¿ç”¨ä½ çš„åº”ç”¨ç¨‹åºã€‚ä¸å„ç§ç»„ä»¶äº¤äº’ï¼Œå¹¶è§‚çœ‹ DevTools å·¥ä½œçš„é­”åŠ›ã€‚</p><h3 id="äº†è§£è¾“å‡º-2"><a href="#äº†è§£è¾“å‡º-2" class="headerlink" title="äº†è§£è¾“å‡º"></a>äº†è§£è¾“å‡º</h3><p>â€œreact å¼€å‘äººå‘˜å·¥å…·â€çªå‡ºæ˜¾ç¤ºåœ¨ç»™å®šæ—¶é—´ç‚¹é‡æ–°å‘ˆç°çš„ç»„ä»¶ã€‚æ ¹æ®æ›´æ–°çš„é¢‘ç‡ï¼Œä½¿ç”¨ä¸åŒçš„é¢œè‰²ã€‚å¯¹äºé¢‘ç¹æ›´æ–°çš„ç»„ä»¶ï¼Œè“è‰²æ˜¾ç¤ºä¸é¢‘ç¹æ›´æ–°ï¼ŒæŒ‰æ›´æ–°é¢‘ç‡ä¾æ¬¡ä¸ºç»¿è‰²ï¼Œé»„è‰²å’Œçº¢è‰²ã€‚</p><p>çœ‹åˆ°é»„è‰²æˆ–çº¢è‰²ä¸ä¸€å®šæ˜¯åäº‹ã€‚å½“è°ƒæ•´æ»‘å—æˆ–è§¦å‘é¢‘ç¹æ›´æ–°çš„å…¶ä»–UIå…ƒç´ æ—¶ï¼Œå¯ä»¥é¢„æœŸã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ç‚¹å‡»ä¸€ä¸ªç®€å•çš„æŒ‰é’®å¹¶çœ‹åˆ°çº¢è‰²ï¼Œè¿™å¯èƒ½æ„å‘³ç€æŸäº›ä¸œè¥¿æ˜¯é”™è¯¯çš„ã€‚è¯¥å·¥å…·çš„ç›®çš„æ˜¯å‘ç°ä¸å¿…è¦çš„æ›´æ–°çš„ç»„ä»¶ã€‚ä½œä¸ºåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªä¸€èˆ¬çš„æƒ³æ³•ï¼Œå“ªäº›ç»„ä»¶åº”è¯¥åœ¨ç»™å®šçš„æ—¶é—´æ›´æ–°ã€‚</p><h3 id="æ¼”ç¤ºï¼ƒ3"><a href="#æ¼”ç¤ºï¼ƒ3" class="headerlink" title="æ¼”ç¤ºï¼ƒ3"></a>æ¼”ç¤ºï¼ƒ3</h3><p>ä¸ºäº†æ¼”ç¤ºç»„ä»¶çªå‡ºæ˜¾ç¤ºï¼Œæˆ‘å®‰è£…äº† TodoMVC åº”ç”¨ç¨‹åºæ¥ä¸å¿…è¦åœ°æ›´æ–°æŸäº›ç»„ä»¶ã€‚</p><p><a href="https://highlight-demo.firebaseapp.com/" target="_blank" rel="noopener">è¿™æ˜¯æ¼”ç¤º</a></p><p>æ‰“å¼€ä¸Šé¢çš„é“¾æ¥ï¼Œç„¶åæ‰“å¼€ React Developer Tools å¹¶å¯ç”¨æ›´æ–°çªå‡ºæ˜¾ç¤ºã€‚å½“æ‚¨è¾“å…¥é¡¶éƒ¨æ–‡æœ¬è¾“å…¥æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°æ‰€æœ‰ TODO éƒ½ä¸å¿…è¦åœ°çªå‡ºæ˜¾ç¤ºã€‚å½“æ‚¨è¾“å…¥æ›´å¿«æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°é¢œè‰²æ›´æ”¹ä»¥æŒ‡ç¤ºæ›´é¢‘ç¹çš„æ›´æ–°ã€‚</p><h2 id="ä¿®å¤ä¸å¿…è¦çš„æ¸²æŸ“"><a href="#ä¿®å¤ä¸å¿…è¦çš„æ¸²æŸ“" class="headerlink" title="ä¿®å¤ä¸å¿…è¦çš„æ¸²æŸ“"></a>ä¿®å¤ä¸å¿…è¦çš„æ¸²æŸ“</h2><p>ä¸€æ—¦è¯†åˆ«å‡ºåº”ç”¨ç¨‹åºä¸­ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“çš„ç»„ä»¶ï¼Œå°±ä¼šæœ‰ä¸€äº›ç®€å•çš„ä¿®å¤ã€‚</p><h3 id="ä½¿ç”¨PureComponent"><a href="#ä½¿ç”¨PureComponent" class="headerlink" title="ä½¿ç”¨PureComponent"></a>ä½¿ç”¨PureComponent</h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>DumbComponent</code> æ˜¯å®ƒ props çš„çº¯å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥ç»„ä»¶åªæœ‰åœ¨å…¶ <code>props</code> æ›´æ”¹æ—¶æ‰éœ€è¦é‡æ–° renderã€‚React æœ‰ä¸€ç§å†…ç½®çš„ç‰¹æ®Šç±»å‹çš„ç»„ä»¶ï¼Œ<code>PureComponent</code> è¿™ä¸ªç±»å‹æ˜¯ä¸ºè¿™ä¸ªç”¨ä¾‹å‡†å¤‡çš„ã€‚</p><p>è€Œä¸æ˜¯ç»§æ‰¿è‡ª <code>React.Component</code>ï¼Œè¯·ä½¿ç”¨ <code>React.PureComponent</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DumbComponent</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;this.props.value&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç„¶åï¼Œè¯¥ç»„ä»¶åªæœ‰åœ¨å…¶ <code>props</code> å®é™…æ›´æ”¹æ—¶æ‰ä¼šé‡æ–° renderã€‚è€Œå·²ï¼</p><p>è¯·æ³¨æ„ï¼Œ<code>PureComponent</code>åšä¸€ä¸ª <code>props</code> çš„æµ…æ¯”è¾ƒï¼Œæ‰€ä»¥å¦‚æœä½ ä½¿ç”¨å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œå®ƒå¯èƒ½ä¼šé”™è¿‡ä¸€äº› <code>props</code> æ›´æ”¹ï¼Œè€Œä¸æ˜¯æ›´æ–°æ‚¨çš„ç»„ä»¶ã€‚</p><h3 id="å®ç°-shouldComponentUpdate"><a href="#å®ç°-shouldComponentUpdate" class="headerlink" title="å®ç° shouldComponentUpdate"></a>å®ç° shouldComponentUpdate</h3><p><code>shouldComponentUpdate</code> æ˜¯ render ä»»ä½•ä¸€ä¸ª <code>props</code> æˆ– <code>state</code> æ›´æ”¹ä¹‹å‰è°ƒç”¨çš„ç»„ä»¶æ–¹æ³•ã€‚å¦‚æœ <code>shouldComponentUpdate</code> è¿”å› <code>true</code>ï¼Œrender å°†è¢«è°ƒç”¨ï¼Œå¦‚æœå®ƒè¿”å› <code>false</code>ï¼Œæ²¡æœ‰ä»»ä½•ååº”ã€‚</p><p>é€šè¿‡å®ç°æ­¤æ–¹æ³•ï¼Œæ‚¨å¯ä»¥æŒ‡ç¤º React é¿å…é‡æ–°æ¸²æŸ“ç»™å®šçš„ç»„ä»¶ï¼Œå½“å…¶ <code>props</code> ä¸æ›´æ”¹çš„æ—¶å€™ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼Œåœ¨ä¸€ä¸ªç»„ä»¶ä¸­å®ç°ä¸€ä¸ª <code>shouldComponentUpdate</code> ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DumbComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  shouldComponentUpdate(nextProps) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.props.value !== nextProps.value) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">render() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="è°ƒè¯•ç”Ÿäº§ä¸­çš„æ€§èƒ½é—®é¢˜"><a href="#è°ƒè¯•ç”Ÿäº§ä¸­çš„æ€§èƒ½é—®é¢˜" class="headerlink" title="è°ƒè¯•ç”Ÿäº§ä¸­çš„æ€§èƒ½é—®é¢˜"></a>è°ƒè¯•ç”Ÿäº§ä¸­çš„æ€§èƒ½é—®é¢˜</h2><p>å¦‚æœæ‚¨åœ¨è‡ªå·±çš„æœºå™¨ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºï¼Œâ€œReact Developer Toolsâ€æ‰èƒ½èµ·ä½œç”¨ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£äº†è§£ç”¨æˆ·åœ¨ç”Ÿäº§ä¸­çœ‹åˆ°çš„æ€§èƒ½é—®é¢˜ï¼Œè¯·å°è¯•ä½¿ç”¨<a href="https://logrocket.com/" target="_blank" rel="noopener">LogRocket</a>ã€‚</p><p><img src="/js/lazyload-plugin/loading.svg" alt="https://cdn-images-1.medium.com/max/1000/1*s_rMyo6NbrAsP-XtvBaXFg.png" data-original="https://cdn-images-1.medium.com/max/1000/1*s_rMyo6NbrAsP-XtvBaXFg.png"></p><p><a href="https://logrocket.com/" target="_blank" rel="noopener">LogRocket</a> å°±åƒæ˜¯ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œè®°å½• DVR å­—é¢ä¸Š çš„ä¸€åˆ‡ï¼Œæ‚¨ç½‘ç«™ä¸Šå‘ç”Ÿçš„ã€‚æ‚¨å¯ä»¥ä½¿ç”¨é”™è¯¯æˆ–æ€§èƒ½é—®é¢˜é‡æ’­ä¼šè¯ï¼Œè€Œä¸æ˜¯çŒœæµ‹ä¸ºä»€ä¹ˆä¼šå‡ºç°é—®é¢˜ï¼Œä»¥å¿«é€Ÿäº†è§£æ ¹æœ¬åŸå› ã€‚</p><p>LogRocket ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºè®°å½•æ€§èƒ½æ•°æ®ï¼ŒRedux actions/stateï¼Œæ—¥å¿—ï¼Œé”™è¯¯ï¼Œç½‘ç»œè¯·æ±‚/å“åº”ä¸æ ‡é¢˜+ä¸»ä½“å’Œæµè§ˆå™¨å…ƒæ•°æ®ã€‚å®ƒè¿˜åœ¨é¡µé¢ä¸Šè®°å½•HTMLå’ŒCSSï¼Œé‡æ–°åˆ›å»ºå³ä½¿æ˜¯æœ€å¤æ‚çš„å•é¡µåº”ç”¨ç¨‹åºçš„åƒç´ è§†é¢‘ã€‚</p><blockquote><p>ã€ç¿»è¯‘åŸæ–‡é“¾æ¥ã€‘ï¼š<a href="https://medium.freecodecamp.org/make-react-fast-again-tools-and-techniques-for-speeding-up-your-react-app-7ad39d3c1b82" target="_blank" rel="noopener">https://medium.freecodecamp.org/make-react-fast-again-tools-and-techniques-for-speeding-up-your-react-app-7ad39d3c1b82</a></p></blockquote><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;é«˜æ€§èƒ½-reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·&quot;&gt;&lt;a href=&quot;#é«˜æ€§èƒ½-reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·&quot; class=&quot;headerlink&quot; title=&quot;é«˜æ€§èƒ½ reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·&quot;&gt;&lt;/a&gt;é«˜æ€§èƒ½ reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·&lt;/h1&gt;&lt;p&gt;react é€šå¸¸å¾ˆå¿«ï¼Œä½†å¾ˆå®¹æ˜“é€ æˆå¯¼è‡´æ€§èƒ½é—®é¢˜çš„å°é”™è¯¯ã€‚ç¼“æ…¢çš„ç»„ä»¶å®‰è£…ï¼Œæ·±å±‚ç»„ä»¶æ ‘å’Œä¸å¿…è¦çš„æ¸²æŸ“å¾ªç¯å¯ä»¥å¿«é€Ÿæ·»åŠ åˆ°ä¸€ä¸ªæ„Ÿè§‰ç¼“æ…¢çš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œæœ‰å¾ˆå¤šå·¥å…·ï¼Œæœ‰äº›ç”šè‡³å†…ç½®äº Reactï¼Œè¿™æœ‰åŠ©äºè¯Šæ–­æ€§èƒ½é—®é¢˜ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å¼ºè°ƒä½¿ React åº”ç”¨ç¨‹åºæ›´å¿«é€Ÿçš„å·¥å…·å’ŒæŠ€æœ¯ã€‚æ¯ä¸ªéƒ¨åˆ†è¿˜æœ‰ä¸€ä¸ªäº’åŠ¨ï¼Œï¼ˆå¸Œæœ›ï¼‰æœ‰è¶£çš„æ¼”ç¤ºï¼
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="react" scheme="http://robin-front.github.io/tags/react/"/>
    
      <category term="tools" scheme="http://robin-front.github.io/tags/tools/"/>
    
  </entry>
  
  <entry>
    <title>Redux å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹ â€”â€” ä¸€ä»½ä¼˜åŒ–æŒ‡å—</title>
    <link href="http://robin-front.github.io/2017/07/17/react-redux-optimization/"/>
    <id>http://robin-front.github.io/2017/07/17/react-redux-optimization/</id>
    <published>2017-07-17T09:12:02.000Z</published>
    <updated>2017-07-17T09:12:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Redux-å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹-â€”â€”-ä¸€ä»½ä¼˜åŒ–æŒ‡å—"><a href="#Redux-å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹-â€”â€”-ä¸€ä»½ä¼˜åŒ–æŒ‡å—" class="headerlink" title="Redux å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹ â€”â€” ä¸€ä»½ä¼˜åŒ–æŒ‡å—"></a>Redux å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹ â€”â€” ä¸€ä»½ä¼˜åŒ–æŒ‡å—</h1><p><em>å¦‚ä½•ä¼˜åŒ–ä½¿ç”¨äº† Redux çš„ react åº”ç”¨ç¨‹åºå¹¶ä¸æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä½†å®é™…ä¸Šç›¸å½“ç®€å•ã€‚è¿™æ˜¯ä¸€ä¸ªç®€çŸ­çš„æŒ‡å—ï¼Œä»¥åŠä¸€äº›ä¾‹å­ã€‚</em></p><p>å½“ä¼˜åŒ–ä½¿ç”¨ Redux çš„ react åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ç»å¸¸å¬åˆ°æœ‰äººè¯´ Redux ç¼“æ…¢ã€‚åœ¨99ï¼…çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½ä¸ä½³çš„åŸå› ï¼ˆé€‚ç”¨äºä»»ä½•å…¶ä»–æ¡†æ¶ï¼‰ä¸ä¸å¿…è¦çš„æ¸²æŸ“ç›¸å…³è”ï¼Œå› ä¸º DOM æ›´æ–°æ˜¯æ˜‚è´µçš„ï¼åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•åœ¨ä½¿ç”¨ Redux ç»‘å®š react æ—¶é¿å…ä¸å¿…è¦çš„ <code>render</code>ã€‚</p><p>é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨<a href="https://github.com/reactjs/react-redux" target="_blank" rel="noopener">å®˜æ–¹ react ç»‘å®šçš„ Redux</a> çš„ <a href="https://github.com/reactjs/react-redux/blob/master/docs/api.md#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options" target="_blank" rel="noopener">connect</a> é«˜é˜¶ç»„ä»¶ï¼Œ å½“æ‚¨çš„ Redux <code>store</code> æ›´æ–°æ—¶ï¼Œreact ç»„ä»¶å°±ä¼šæ›´æ–°ã€‚è¿™æ˜¯ä¸€ä¸ªå°†ç»„ä»¶åŒ…è£…åœ¨å¦ä¸€ä¸ªç»„ä»¶ä¸­çš„å‡½æ•°ï¼Œè¯¥ç»„ä»¶è®¢é˜…äº† Redux <code>store</code> ä¸­çš„æ›´æ”¹ï¼Œå¹¶æ¸²æŸ“ <code>store</code>ï¼Œè¿™å°±æ˜¯å®ƒçš„å­èŠ‚ç‚¹æ›´æ–°çš„åŸå› ã€‚<a id="more"></a></p><h2 id="å¿«é€Ÿå…¥å‘-react-reduxï¼Œå®˜æ–¹-react-ç»‘å®š-Redux"><a href="#å¿«é€Ÿå…¥å‘-react-reduxï¼Œå®˜æ–¹-react-ç»‘å®š-Redux" class="headerlink" title="å¿«é€Ÿå…¥å‘ react-reduxï¼Œå®˜æ–¹ react ç»‘å®š Redux"></a>å¿«é€Ÿå…¥å‘ react-reduxï¼Œå®˜æ–¹ react ç»‘å®š Redux</h2><p>è¯¥ <code>connect</code> é«˜é˜¶ç»„ä»¶å®é™…ä¸Šæ˜¯å·²ç»è¿‡ä¼˜åŒ–ã€‚è¦äº†è§£å¦‚ä½•æœ€å¥½åœ°ä½¿ç”¨å®ƒï¼Œæœ€å¥½äº†è§£å…ˆå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼</p><p>Redux ä»¥åŠ react-redux å®é™…ä¸Šæ˜¯ç›¸å½“å°çš„åº“ï¼Œæ‰€ä»¥æºä»£ç å¹¶ä¸è´¹è§£ã€‚æˆ‘é¼“åŠ±å¤§å®¶é˜…è¯»æºä»£ç ï¼Œæˆ–è‡³å°‘å…¶ä¸­çš„ä¸€äº›ã€‚å¦‚æœä½ æƒ³è¿›ä¸€æ­¥ï¼Œç¼–å†™è‡ªå·±çš„å®ç°ï¼Œå®ƒå°†è®©ä½ æ·±å…¥äº†è§£ä¸ºä»€ä¹ˆåº“çš„è®¾è®¡æ–¹å¼æ˜¯è¿™æ ·çš„ã€‚</p><p>ä¸ç”¨å¤šè¯´ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ react ç»‘å®šçš„å·¥ä½œåŸç†ã€‚æ­£å¦‚æˆ‘ä»¬å…¬è®¤çš„é‚£æ ·ï¼Œreact ç»‘å®šçš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯ <code>connect</code> é«˜é˜¶ç»„ä»¶ï¼Œè¿™æ˜¯å®ƒçš„å†™æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span></span></div><div class="line">  mapStateToProps,</div><div class="line">  mapDispatchToProps,</div><div class="line">  mergeProps,</div><div class="line">  &#123;</div><div class="line">    pure = true,</div><div class="line">    areStatesEqual = strictEqual,</div><div class="line">    areOwnPropsEqual = shallowEqual,</div><div class="line">    areStatePropsEqual = shallowEqual,</div><div class="line">    areMergedPropsEqual = shallowEqual,</div><div class="line">    ...extraOptions</div><div class="line">  &#125; = &#123;&#125;</div><div class="line">) &#123;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä½œä¸ºé™„æ³¨ - å”¯ä¸€çš„å¼ºåˆ¶æ€§å‚æ•°æ˜¯ <code>mapStateToProps</code>ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨åªéœ€è¦å‰ä¸¤ä¸ªå‚æ•°ã€‚ä½†æ˜¯ï¼Œæˆ‘åœ¨è¿™é‡Œä½¿ç”¨å®Œæ•´çš„å†™æ³•æ¥è¯´æ˜ <code>react bindings</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>ä¼ é€’ç»™ <code>connect</code> å‡½æ•°çš„æ‰€æœ‰å‚æ•°éƒ½ç”¨äºç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä½œä¸º <code>props</code> ä¼ é€’åˆ°å°è£…çš„ç»„ä»¶ä¸Šã€‚<code>mapStateToProps</code> ç”¨äºå°†çŠ¶æ€ä» Redux store æ˜ å°„åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œ<code>mapDispatchToProps</code> ç”¨äºç”ŸæˆåŒ…å«å‡½æ•°çš„å¯¹è±¡ - é€šå¸¸è¿™äº›å‡½æ•°æ˜¯ <code>actions</code> åˆ›å»ºè€…ã€‚æœ€åï¼Œ<code>mergeProps</code> æœ‰ä¸‰ä¸ªå‚æ•° <code>stateProps</code>ï¼Œ<code>dispatchProps</code> å’Œ <code>ownProps</code>ã€‚ç¬¬ä¸€ä¸ªæ˜¯ <code>mapStateToProps</code> çš„ç»“æœï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ <code>mapDispatchToProps</code> çš„ç»“æœï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä»ç»„ä»¶æœ¬èº«ç»§æ‰¿çš„ <code>props</code> å¯¹è±¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>mergeProps</code> å°†è¿™äº›å‚æ•°ç®€å•åœ°ç»„åˆåˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯å¦‚æœæ‚¨ä¼ é€’ä¸€ä¸ªå‡½æ•°ä½œä¸º <code>mergeProps</code> å‚æ•°ï¼Œ<code>connect</code> åˆ™å°†ä½¿ç”¨è¯¥å‡½æ•°ç”Ÿæˆå°è£…ç»„ä»¶çš„ <code>props</code>ã€‚</p><p><code>connect</code> å‡½æ•°çš„ç¬¬å››ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª <code>options</code> å¯¹è±¡ã€‚è¿™åŒ…å«5ä¸ªé€‰é¡¹ï¼š<code>pure</code> å¯ä»¥æ˜¯ <code>true</code> æˆ– <code>false</code>ï¼Œä»¥åŠç¡®å®šæ˜¯å¦é‡æ–°æ¸²æŸ“ç»„ä»¶çš„4ä¸ªå‡½æ•°ï¼ˆåº”è¯¥è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼‰ã€‚<code>pure</code> é»˜è®¤è®¾ç½®ä¸º<code>true</code>ã€‚å¦‚æœè®¾ç½®ä¸º<code>false</code>ï¼Œåˆ™<code>connect</code> å°†è·³è¿‡ä»»ä½•ä¼˜åŒ–ï¼Œå¹¶ä¸”<code>options</code>å¯¹è±¡ä¸­çš„4ä¸ªå‡½æ•°å°†ä¸ç”Ÿæ•ˆã€‚æˆ‘ä¸ªäººä¸èƒ½æƒ³åˆ°ä¸€ä¸ªç”¨ä¾‹ï¼Œä½†æ˜¯å¦‚æœæ‚¨å¸Œæœ›å…³é—­ä¼˜åŒ–ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸º<code>false</code>ã€‚</p><p>æˆ‘ä»¬çš„ <code>mergeProps</code> å‡½æ•°äº§ç”Ÿçš„å¯¹è±¡ä¸æœ€åä¸€ä¸ª <code>props</code> å¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæˆ‘ä»¬çš„ <code>connect</code> è®¤ä¸º <code>props</code> å¯¹è±¡å·²ç»æ”¹å˜äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªç»„ä»¶å°±ä¼šé‡æ–°æ¸²æŸ“ã€‚è¦äº†è§£åº“å¦‚ä½•å†³å®šæ˜¯å¦æœ‰å˜æ›´ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹è¯¥ <code>shallowEqual</code> åŠŸèƒ½ã€‚å¦‚æœå‡½æ•°è¿”å› <code>true</code>ï¼Œç»„ä»¶å°†ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œå¦‚æœè¿”å› <code>false</code>ï¼Œå®ƒå°†é‡æ–°æ¸²æŸ“ã€‚<code>shallowEqual</code> æ‰§è¡Œæ­¤æ¯”è¾ƒã€‚ä¸‹é¢ä½ ä¼šçœ‹åˆ° <code>shallowEqual</code> æ–¹æ³•çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå‘Šè¯‰ä½ æ‰€æœ‰ä½ éœ€è¦çŸ¥é“çš„ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keysA.length; i++) &#123;</div><div class="line">  <span class="keyword">if</span> (!hasOwn.call(objB, keysA[i]) ||</div><div class="line">      !is(objA[keysA[i]], objB[keysA[i]])) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ€»è€Œè¨€ä¹‹ï¼Œè¿™æ˜¯ä¸Šé¢çš„ä»£ç ï¼š</p><p>å®ƒåœ¨ object a ä¸­çš„ key ä¸Šå¾ªç¯ï¼Œå¹¶æ£€æŸ¥ object B æ˜¯å¦æ‹¥æœ‰ç›¸åŒçš„å±æ€§ã€‚ç„¶åå®ƒæ£€æŸ¥ object Aä¸­çš„å±æ€§ï¼ˆå…·æœ‰ç›¸åŒåç§°ï¼‰æ˜¯å¦ç­‰äºå¯¹è±¡Bçš„å±æ€§ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªæ¯”è¾ƒè¿”å›falseï¼Œé‚£ä¹ˆå¯¹è±¡å°†è¢«è§†ä¸ºä¸ç›¸ç­‰ï¼Œå¹¶ä¸”ä¼šå‘ç”Ÿé‡æ–°æ¸²æŸ“ã€‚</p><p>è¿™å¯¼è‡´æˆ‘ä»¬ä¸€ä¸ªé»„é‡‘æ³•åˆ™ï¼š</p><h2 id="åªç»™æ‚¨çš„ç»„ä»¶å®ƒéœ€è¦å‘ˆç°çš„æ•°æ®"><a href="#åªç»™æ‚¨çš„ç»„ä»¶å®ƒéœ€è¦å‘ˆç°çš„æ•°æ®" class="headerlink" title="åªç»™æ‚¨çš„ç»„ä»¶å®ƒéœ€è¦å‘ˆç°çš„æ•°æ®"></a>åªç»™æ‚¨çš„ç»„ä»¶å®ƒéœ€è¦å‘ˆç°çš„æ•°æ®</h2><p>è¿™è¯´å¾—å¾ˆå«ç³Šï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç”¨ä¸€äº›å®é™…çš„ä¾‹å­æ¥é˜è¿°ã€‚</p><h3 id="æ‹†åˆ†è¿æ¥çš„ç»„ä»¶"><a href="#æ‹†åˆ†è¿æ¥çš„ç»„ä»¶" class="headerlink" title="æ‹†åˆ†è¿æ¥çš„ç»„ä»¶"></a>æ‹†åˆ†è¿æ¥çš„ç»„ä»¶</h3><p>æˆ‘çœ‹åˆ°äººä»¬è¿™æ ·åš è®¢é˜…å®¹å™¨ç»„ä»¶ä¸€ç³»åˆ—çŠ¶æ€ï¼Œå¹¶é€šè¿‡ <code>props</code> ä¼ é€’æ‰€æœ‰ä¸œè¥¿ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> BigComponent = <span class="function">(<span class="params">&#123; a, b, c, d &#125;</span>) =&gt;</span> (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;CompA a=&#123;a&#125; /&gt;</div><div class="line">    &lt;CompB b=&#123;b&#125; /&gt;</div><div class="line">    &lt;CompC c=&#123;c&#125; /&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">);</div><div class="line"></div><div class="line">const ConnectedBigComponent = connect(</div><div class="line">  (&#123; a, b, c &#125;) =&gt; (&#123; a, b, c &#125;)</div><div class="line">);</div></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæ¯æ¬¡è¦ä¹ˆaï¼Œbæˆ–cå˜åŒ–ï¼ŒBigComponentåŒ…æ‹¬CompAï¼ŒCompBå¹¶ä¸”CompCå°†é‡æ–°å‘ˆç°ã€‚</p><p>ç›¸åï¼Œæ‹†åˆ†æ‚¨çš„ç»„ä»¶ï¼Œä¸è¦å®³æ€•æ›´å¤šåœ°ä½¿ç”¨ connectï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> ConnectedA = connect(CompA, (&#123; a &#125;) =&gt; (&#123; a &#125;));</div><div class="line"><span class="keyword">const</span> ConnectedB = connect(CompB, (&#123; b &#125;) =&gt; (&#123; b &#125;));</div><div class="line"><span class="keyword">const</span> ConnectedC = connect(CompC, (&#123; c &#125;) =&gt; (&#123; c &#125;));</div><div class="line"></div><div class="line"><span class="keyword">const</span> BigComponent = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;ConnectedA a=&#123;a&#125; /&gt;</div><div class="line">    &lt;ConnectedB b=&#123;b&#125; /&gt;</div><div class="line">    &lt;ConnectedC c=&#123;c&#125; /&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">);</div></pre></td></tr></table></figure><p>é€šè¿‡æ­¤æ¬¡æ›´æ–°ï¼Œ<code>CompA</code> å°†åªæœ‰å½“<code>a</code>å·²ç»æ”¹å˜æ‰ä¼šé‡æ–°æ¸²æŸ“ï¼Œ<code>CompB</code>å½“<code>b</code>æ”¹å˜ç­‰ã€‚è€ƒè™‘è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œæ¯ä¸€ä¸ªå€¼<code>a</code>ï¼Œ<code>b</code>å¹¶<code>c</code>åˆ†åˆ«ç»å¸¸æ›´æ–°ã€‚å¯¹äºæ¯æ¬¡æ›´æ–°ï¼Œæˆ‘ä»¬ç°åœ¨é‡æ–°æ¸²æŸ“ä¸€ä¸ªï¼Œè€Œä¸æ˜¯æ‰€æœ‰ç»„ä»¶ã€‚è¿™å‡ ä¹æ²¡æœ‰ä»€ä¹ˆæ˜æ˜¾çš„ä¸‰ä¸ªç»„ä»¶ï¼Œä½†å¦‚æœä½ æœ‰æ›´å¤šï¼</p><h3 id="æ”¹å˜ä½ çš„çŠ¶æ€ï¼Œä½¿å…¶å°½å¯èƒ½çš„æœ€å°"><a href="#æ”¹å˜ä½ çš„çŠ¶æ€ï¼Œä½¿å…¶å°½å¯èƒ½çš„æœ€å°" class="headerlink" title="æ”¹å˜ä½ çš„çŠ¶æ€ï¼Œä½¿å…¶å°½å¯èƒ½çš„æœ€å°"></a>æ”¹å˜ä½ çš„çŠ¶æ€ï¼Œä½¿å…¶å°½å¯èƒ½çš„æœ€å°</h3><p>è¿™æ˜¯ä¸€ä¸ªå‡è®¾ï¼ˆç¨å¾®è®¾è®¡è¿‡ï¼‰çš„ä¾‹å­ï¼š</p><p>ä½ æœ‰ä¸€ä¸ªå¤§çš„é¡¹ç›®åˆ—è¡¨ï¼Œæˆ‘ä»¬å‡è®¾æœ‰300æˆ–æ›´å¤šã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;List&gt;</div><div class="line">  &#123;<span class="keyword">this</span>.props.items.map(<span class="function">(<span class="params">&#123; content, itemId &#125;</span>) =&gt;</span> (</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">ListItem</span></span></span></div><div class="line">      <span class="attr">onClick</span>=<span class="string">&#123;selectItem&#125;</span></div><div class="line">      <span class="attr">content</span>=<span class="string">&#123;content&#125;</span></div><div class="line">      <span class="attr">itemId</span>=<span class="string">&#123;itemId&#125;</span></div><div class="line">      <span class="attr">key</span>=<span class="string">&#123;itemId&#125;</span></div><div class="line">    /&gt;</div><div class="line">  ))&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">List</span>&gt;</span></div></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬ç‚¹å‡»ä¸€â€‹â€‹ä¸ªåˆ—è¡¨é¡¹æ—¶ï¼Œä¸€ä¸ªåŠ¨ä½œè¢«è§¦å‘ï¼Œæ›´æ–°ä¸€ä¸ªå­˜å‚¨å€¼ - <code>selectedItem</code>ã€‚æ¯ä¸ªåˆ—è¡¨é¡¹è¿æ¥åˆ° Redux å¹¶è·å–<code>selectedItem</code>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> ListItem = connect(</div><div class="line">  <span class="function">(<span class="params">&#123; selectedItem &#125;</span>) =&gt;</span> (&#123; selectedItem &#125;)</div><div class="line">)(SimpleListItem);</div></pre></td></tr></table></figure><p>æˆ‘ä»¬æ­£åœ¨åšæ­£ç¡®çš„äº‹æƒ…ï¼Œæˆ‘ä»¬ä»…å°†ç»„ä»¶è¿æ¥åˆ°æ‰€éœ€çš„çŠ¶æ€ã€‚ä½†æ˜¯ï¼Œå½“<code>selectedItem</code>æ›´æ–°æ—¶ï¼Œæ‰€æœ‰<code>ListItem</code>ç»„ä»¶éƒ½å°†é‡æ–°æ¸²æŸ“ï¼Œå› ä¸ºæˆ‘ä»¬è¿”å›çš„å¯¹è±¡<code>selectedItem</code>å·²ç»æ›´æ”¹ã€‚åœ¨æ­¤ä¹‹å‰ <code>{ selectedItem: 123 }</code>ï¼Œç°åœ¨æ˜¯ <code>{ selectedItem: 120 }</code>ã€‚</p><p>è¯·è®°ä½ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨è¯¥ <code>selectedItem</code> å€¼æ¥æ£€æŸ¥å½“å‰é¡¹ç›®æ˜¯å¦è¢«é€‰ä¸­ã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç»„ä»¶çœŸæ­£éœ€è¦çŸ¥é“çš„æ˜¯å®ƒæ˜¯å¦è¢«é€‰æ‹© - å®è´¨ä¸Šæ˜¯ä¸€ä¸ª<code>Boolean</code>ã€‚<code>Boolean</code> æ˜¯ä¼Ÿå¤§çš„ï¼Œå› ä¸ºåªæœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼Œ<code>true</code> æˆ–è€… <code>false</code>ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè€Œä¸æ˜¯ <code>selectedItem</code> ï¼Œä»… <code>Boolean</code> æ›´æ”¹çš„ä¸¤ä¸ªé¡¹ç›®å°†ä¼šé‡æ–°æ¸²æŸ“ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚<code>mapStateToProps</code> å®é™…ä¸Š <code>props</code> å®ƒæ˜¯ç»„ä»¶çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æ£€æŸ¥è¿™æ˜¯å¦å®é™…ä¸Šæ˜¯é€‰å®šçš„é¡¹ç›®ã€‚ä»¥ä¸‹æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> ListItem = connect(</div><div class="line">  <span class="function">(<span class="params">&#123; selectedItem &#125;, &#123; itemId &#125;</span>) =&gt;</span> (&#123; <span class="attr">isSelected</span>: selectedItem === itemId &#125;)</div><div class="line">)(SimpleListItem);</div></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œåªè¦æˆ‘ä»¬çš„ <code>selectedItem</code> å€¼å‘ç”Ÿå˜åŒ–ï¼Œåªæœ‰ä¸¤ä¸ªç»„ä»¶é‡æ–°å‘ˆç° - <code>ListItem</code> ç°åœ¨å·²ç»è¢«é€‰æ‹©äº†ï¼Œè€Œä¸”åŸæ¥é‚£ä¸ªå·²ç»è¢«å–æ¶ˆé€‰æ‹©äº†ã€‚</p><h3 id="ä¿æŒæ•°æ®æ‰å¹³åŒ–"><a href="#ä¿æŒæ•°æ®æ‰å¹³åŒ–" class="headerlink" title="ä¿æŒæ•°æ®æ‰å¹³åŒ–"></a>ä¿æŒæ•°æ®æ‰å¹³åŒ–</h3><p>åœ¨ <a href="http://redux.js.org/docs/recipes/reducers/NormalizingStateShape.html" target="_blank" rel="noopener">Reduxæ–‡æ¡£æåˆ°</a> è¿™æ˜¯ä¸€ç§æœ€ä½³å®è·µã€‚ä¿æŒæ‚¨çš„store æ‰å¹³åŒ–æ˜¯æœ‰ç›Šçš„ä¸€äº›åŸå› ã€‚ä½†æ˜¯å¯¹äºæœ¬æ–‡çš„ä¸»æ—¨ï¼ŒåµŒå¥—ä¼šé€ æˆé—®é¢˜ï¼Œå› ä¸ºä¸ºäº†è®©æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°½å¯èƒ½çš„å¿«ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ›´æ–°å°½å¯èƒ½çš„ç»†å¾®ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿™æ ·çš„åµŒå¥—å½¢çŠ¶ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">articles</span>: [&#123;</div><div class="line">    <span class="attr">comments</span>: [&#123;</div><div class="line">      <span class="attr">users</span>: [&#123;</div><div class="line">      &#125;]</div><div class="line">    &#125;]</div><div class="line">  &#125;],</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸ºäº†ä¼˜åŒ–æˆ‘ä»¬çš„ <code>Article</code>ï¼Œ<code>Comment</code> å’Œ <code>User</code> ç»„ä»¶ï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦æ‰€æœ‰çš„äººè®¢é˜… <code>articles</code>ï¼Œç„¶åæ·±æ·±ä¼¸å…¥è¿™ç§ç»“æ„åªè¿”å›ä»–ä»¬æ‰€éœ€è¦çš„çŠ¶æ€ã€‚ç›¸ååœ°â€‹â€‹ï¼Œå¦‚æ­¤è®¾è®¡ä½ çš„å½¢çŠ¶æ›´æœ‰æ„ä¹‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">articles</span>: [&#123;</div><div class="line">    ...</div><div class="line">  &#125;],</div><div class="line">  <span class="attr">comments</span>: [&#123;</div><div class="line">    <span class="attr">articleId</span>: ..,</div><div class="line">    <span class="attr">userId</span>: ...,</div><div class="line">    ...</div><div class="line">  &#125;],</div><div class="line">  <span class="attr">users</span>: [&#123;</div><div class="line">    ...</div><div class="line">  &#125;]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨æ˜ å°„å‡½æ•°é€‰æ‹©æ³¨é‡Šå’Œç”¨æˆ·ä¿¡æ¯ã€‚å…³äºè¿™ä¸€ç‚¹çš„æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨ <a href="http://redux.js.org/docs/recipes/reducers/NormalizingStateShape.html" target="_blank" rel="noopener">Reduxæ–‡æ¡£ä¸­é˜…è¯»å…³äºè§„èŒƒåŒ–çŠ¶æ€çš„ä¿¡æ¯</a>ã€‚</p><h2 id="å½©è›‹ï¼šç”¨äºé€‰æ‹©-Redux-state-çš„åº“"><a href="#å½©è›‹ï¼šç”¨äºé€‰æ‹©-Redux-state-çš„åº“" class="headerlink" title="å½©è›‹ï¼šç”¨äºé€‰æ‹© Redux state çš„åº“"></a>å½©è›‹ï¼šç”¨äºé€‰æ‹© Redux state çš„åº“</h2><p>è¿™æ˜¯å®Œå…¨å¯é€‰çš„ï¼Œå–å†³äºæ‚¨ã€‚é€šå¸¸æ‰€æœ‰ä»¥ä¸Šçš„å»ºè®®éƒ½è¶³å¤Ÿæ·±å…¥åœ°è®©ä½ å†™å‡ºå¿«é€Ÿçš„ react å’Œ Redux åº”ç”¨ç¨‹åºã€‚ä½†æ˜¯æœ‰ä¸¤ä¸ªä¼˜ç§€çš„åº“ä½¿å¾—é€‰æ‹©çŠ¶æ€æ›´å®¹æ˜“ä¸€äº›ï¼š</p><p><a href="https://github.com/reactjs/reselect" target="_blank" rel="noopener">Reselect</a> æ˜¯ <code>selectors</code> ä¸ºæ‚¨çš„ Redux åº”ç”¨ç¨‹åºç¼–å†™çš„å¼•äººæ³¨ç›®çš„å·¥å…·ã€‚ä»é‡æ–°é€‰æ‹©æ–‡æ¡£ï¼š</p><ul><li>é€‰æ‹©å™¨å¯ä»¥è®¡ç®—æ´¾ç”Ÿæ•°æ®ï¼Œå…è®¸ Redux å­˜å‚¨å°½å¯èƒ½å°çš„çŠ¶æ€ã€‚</li><li>é€‰æ‹©å™¨æ•ˆç‡é«˜ã€‚é™¤éå…¶ä¸­ä¸€ä¸ªå‚æ•°å‘ç”Ÿå˜åŒ–ï¼Œå¦åˆ™ä¸ä¼šé‡æ–°è®¡ç®—é€‰æ‹©å™¨ã€‚</li><li>é€‰æ‹©å™¨æ˜¯å¯ç»„åˆçš„ã€‚å®ƒä»¬å¯ä»¥ç”¨ä½œå…¶ä»–é€‰æ‹©å™¨çš„è¾“å…¥ã€‚</li></ul><p>å¯¹äºå…·æœ‰å¤æ‚æ¥å£ï¼Œå¤æ‚çŠ¶æ€ å’Œ/æˆ– é¢‘ç¹æ›´æ–°çš„åº”ç”¨ç¨‹åºï¼Œé‡æ–°é€‰æ‹©å¯ä»¥å¸®åŠ©æ‚¨è½»æ¾ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºæ›´å¿«ï¼</p><p><a href="http://ramdajs.com/" target="_blank" rel="noopener">Ramda</a> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åº“ï¼Œå…·æœ‰æ›´é«˜é˜¶çš„å‡½æ•°ã€‚æ¢å¥è¯è¯´ - ç”¨å‡½æ•°åˆ›å»ºå‡½æ•°ã€‚ç”±äºæˆ‘ä»¬çš„æ˜ å°„å‡½æ•°åªæ˜¯è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä½¿ç”¨ <code>Ramda</code> åˆ›å»ºæˆ‘ä»¬çš„é€‰æ‹©å™¨ã€‚<code>Ramda</code> å¯ä»¥æœ‰é€‰æ‹©å™¨çš„æ‰€æœ‰åŠŸèƒ½å¹¶åšçš„æ›´å¤šã€‚æŸ¥çœ‹ <a href="https://github.com/ramda/ramda/wiki/Cookbook" target="_blank" rel="noopener">Ramda é£Ÿè°±</a>çš„ä¸€äº›ä¾‹å­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Ramda åšä»€ä¹ˆã€‚</p><script src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Redux-å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹-â€”â€”-ä¸€ä»½ä¼˜åŒ–æŒ‡å—&quot;&gt;&lt;a href=&quot;#Redux-å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹-â€”â€”-ä¸€ä»½ä¼˜åŒ–æŒ‡å—&quot; class=&quot;headerlink&quot; title=&quot;Redux å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹ â€”â€” ä¸€ä»½ä¼˜åŒ–æŒ‡å—&quot;&gt;&lt;/a&gt;Redux å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹ â€”â€” ä¸€ä»½ä¼˜åŒ–æŒ‡å—&lt;/h1&gt;&lt;p&gt;&lt;em&gt;å¦‚ä½•ä¼˜åŒ–ä½¿ç”¨äº† Redux çš„ react åº”ç”¨ç¨‹åºå¹¶ä¸æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä½†å®é™…ä¸Šç›¸å½“ç®€å•ã€‚è¿™æ˜¯ä¸€ä¸ªç®€çŸ­çš„æŒ‡å—ï¼Œä»¥åŠä¸€äº›ä¾‹å­ã€‚&lt;/em&gt;&lt;/p&gt;&lt;p&gt;å½“ä¼˜åŒ–ä½¿ç”¨ Redux çš„ react åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ç»å¸¸å¬åˆ°æœ‰äººè¯´ Redux ç¼“æ…¢ã€‚åœ¨99ï¼…çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½ä¸ä½³çš„åŸå› ï¼ˆé€‚ç”¨äºä»»ä½•å…¶ä»–æ¡†æ¶ï¼‰ä¸ä¸å¿…è¦çš„æ¸²æŸ“ç›¸å…³è”ï¼Œå› ä¸º DOM æ›´æ–°æ˜¯æ˜‚è´µçš„ï¼åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•åœ¨ä½¿ç”¨ Redux ç»‘å®š react æ—¶é¿å…ä¸å¿…è¦çš„ &lt;code&gt;render&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨&lt;a href=&quot;https://github.com/reactjs/react-redux&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å®˜æ–¹ react ç»‘å®šçš„ Redux&lt;/a&gt; çš„ &lt;a href=&quot;https://github.com/reactjs/react-redux/blob/master/docs/api.md#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;connect&lt;/a&gt; é«˜é˜¶ç»„ä»¶ï¼Œ å½“æ‚¨çš„ Redux &lt;code&gt;store&lt;/code&gt; æ›´æ–°æ—¶ï¼Œreact ç»„ä»¶å°±ä¼šæ›´æ–°ã€‚è¿™æ˜¯ä¸€ä¸ªå°†ç»„ä»¶åŒ…è£…åœ¨å¦ä¸€ä¸ªç»„ä»¶ä¸­çš„å‡½æ•°ï¼Œè¯¥ç»„ä»¶è®¢é˜…äº† Redux &lt;code&gt;store&lt;/code&gt; ä¸­çš„æ›´æ”¹ï¼Œå¹¶æ¸²æŸ“ &lt;code&gt;store&lt;/code&gt;ï¼Œè¿™å°±æ˜¯å®ƒçš„å­èŠ‚ç‚¹æ›´æ–°çš„åŸå› ã€‚
    
    </summary>
    
      <category term="javascript" scheme="http://robin-front.github.io/categories/javascript/"/>
    
    
      <category term="react" scheme="http://robin-front.github.io/tags/react/"/>
    
      <category term="redux" scheme="http://robin-front.github.io/tags/redux/"/>
    
  </entry>
  
</feed>
