<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[keep-alive vs http2]]></title>
    <url>%2F2018%2F04%2F10%2Fkeep-alive-vs-http2.html</url>
    <content type="text"><![CDATA[æˆ‘ä»¬ç»å¸¸è°ˆè®º http2 ä¸Ž http1.1ï¼Œå´ç»å¸¸å¿½è§†ä¸€äº›ç»†èŠ‚çš„åŒºåˆ«ã€‚æœ€è¿‘è°ˆåˆ° keep-alive ä¸Ž http2 é“¾è·¯å¤ç”¨çš„åŒºåˆ«ã€‚è™½ç„¶æˆ‘çŸ¥é“ http2 çš„å¤šè·¯å¤ç”¨æŠ€æœ¯æ˜¯æºè‡ªé€šä¿¡å·¥ç¨‹é‡Œçš„æ—¶åˆ†å¤ç”¨ï¼Œä½†å¯¹ keep-alive çš„å¤ç”¨å´æœ‰äº›æ¨¡ç³Šã€‚ä¸‹é¢çœ‹æ¥è¿™äº›æŠ€æœ¯ä¹‹é—´çš„è¿›åŒ–ã€‚ keep-alive æœ‰å¾ˆå¤šæ–‡ç« éƒ½è¯´ http2 ç›¸æ¯” http1.1 å¢žåŠ äº†è¿žæŽ¥å¤ç”¨ã€‚è¿™å¥è¯å…¶å®žæ˜¯ä¸å‡†ç¡®çš„ã€‚ åœ¨ HTTP 1.1 ä¸­ æ‰€æœ‰çš„è¿žæŽ¥é»˜è®¤éƒ½æ˜¯æŒç»­è¿žæŽ¥ï¼Œé™¤éžç‰¹æ®Šå£°æ˜Žä¸æ”¯æŒã€‚ è€Œåœ¨ http1.0 ä¸­ï¼Œå®˜æ–¹æ²¡æœ‰æ”¯æŒ keep-alive, é€šå¸¸ä¼šæ‰‹åŠ¨åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  Connection: Keep-Aliveã€‚ keep-alive å°±æ˜¯ TCP è¿žæŽ¥å¤ç”¨çš„å¼€ç«¯ã€‚æ”¹å–„çš„æ•ˆæžœå°±æ˜¯ä¸å†é‡æ–°å»ºç«‹TCPè¿žæŽ¥ï¼ŒçœåŽ» ä¸‰æ¬¡æ¡æ‰‹ çš„æ—¶é—´ã€‚å¦‚ä¸‹å›¾ï¼š ä¼˜åŠ¿æœ‰ï¼š è¾ƒå°‘çš„CPUå’Œå†…å­˜çš„ä½¿ç”¨ï¼ˆç”±äºŽåŒæ—¶æ‰“å¼€çš„è¿žæŽ¥çš„å‡å°‘äº†ï¼‰ å…è®¸è¯·æ±‚å’Œåº”ç­”çš„HTTPç®¡çº¿åŒ– é™ä½Žæ‹¥å¡žæŽ§åˆ¶ ï¼ˆTCPè¿žæŽ¥å‡å°‘äº†ï¼‰ å‡å°‘äº†åŽç»­è¯·æ±‚çš„å»¶è¿Ÿï¼ˆæ— éœ€å†è¿›è¡Œæ¡æ‰‹ï¼‰ æŠ¥å‘Šé”™è¯¯æ— éœ€å…³é—­TCPè¿žæŽ¥ http pipeliningæœ‰äº›æ–‡ç« ä¸­ä¼šæœ‰ä¸€ä¸ªè¯¯åŒºï¼Œå°±æ˜¯TCPè¿žæŽ¥å¿…é¡»ç­‰ä¸€ä¸ªè¯·æ±‚å“åº”å®ŒæˆåŽï¼Œæ‰èƒ½å¤ç”¨ã€‚è¿™æ˜¯ä¸å¯¹çš„ï¼Œä½†å…¶å®žå¯ä»¥æ³¨æ„ä¸Šé¢ä¼˜åŠ¿é‡Œæåˆ°åˆ° http pipeliningï¼Œå¦‚ä¸‹å›¾ï¼š HTTP1.1 ä¸­ï¼Œä¸€ä¸ªTCPè¿žæŽ¥é‡Œæ˜¯å¯ä»¥åŒæ—¶å‘é€ï¼ˆå®žé™…æœ‰å…ˆåŽï¼Œä½†å¯ä»¥åœ¨å“åº”å‰ï¼‰å¤šä¸ªè¯·æ±‚çš„ã€‚ä½†å®ƒæ˜¯æœ‰åºçš„ï¼Œéµå¾ªå…ˆè¿›å…ˆå‡ºï¼ŒæœåŠ¡ç«¯åªèƒ½æŒ‰é¡ºåºå“åº”è¯·æ±‚ï¼ˆå¦‚æžœå‰é¢çš„è¯·æ±‚æ²¡æœ‰å“åº”å®Œæˆæˆ–éœ€è¦å¾ˆé•¿æ—¶é—´ï¼ŒåŽé¢çš„è¯·æ±‚å°±ä¼šè¢«é˜»å¡žï¼‰ï¼Œæ‰€ä»¥å¯èƒ½å‘ç”Ÿ é˜Ÿå¤´é˜»å¡žï¼ˆHOL blockingï¼‰ï¼Œé€ æˆå»¶è¿Ÿã€‚ è¿žç»­çš„ GET å’Œ HEAD è¯·æ±‚æ€»å¯ä»¥ç®¡çº¿åŒ–çš„ã€‚ä¸€ä¸ªè¿žç»­çš„å¹‚ç­‰è¯·æ±‚ï¼Œå¦‚ GETï¼ŒHEADï¼ŒPUTï¼ŒDELETEï¼Œæ˜¯å¦å¯ä»¥è¢«ç®¡çº¿åŒ–å–å†³äºŽä¸€è¿žä¸²è¯·æ±‚æ˜¯å¦ä¾èµ–äºŽå…¶ä»–çš„ã€‚ æ‰€ä»¥keep-alive çš„åŠ£åŠ¿ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼š Keep-Aliveå¯èƒ½ä¼šæžå¤§çš„å½±å“æœåŠ¡å™¨æ€§èƒ½ï¼Œå› ä¸ºå®ƒåœ¨æ–‡ä»¶è¢«è¯·æ±‚ä¹‹åŽè¿˜ä¿æŒäº†ä¸å¿…è¦çš„è¿žæŽ¥å¾ˆé•¿æ—¶é—´ å¯èƒ½å‘ç”Ÿé˜Ÿå¤´é˜»å¡žï¼ˆHOL blockingï¼‰ï¼Œé€ æˆå»¶è¿Ÿ HTTP2HTTP2 ä¸»è¦è§£å†³çš„é—®é¢˜ä¹Ÿæ˜¯ TCPè¿žæŽ¥å¤ç”¨ã€‚ä½†å®ƒæ¯” keep-alive æ›´å½»åº•ï¼Œç±»ä¼¼äºŽé€šä¿¡å·¥ç¨‹é‡Œçš„æ—¶åˆ†å¤ç”¨ï¼Œå¤šä¸ªè¯·æ±‚å¯ä»¥åŒæ—¶å‘é€ï¼ˆä¸åˆ†å…ˆåŽï¼‰ï¼ŒåŒæ—¶å“åº”ï¼Œè§£å†³äº† é˜Ÿå¤´é˜»å¡žï¼ˆHOL blockingï¼‰çš„é—®é¢˜ï¼Œæžå¤§æé«˜æ•ˆçŽ‡ã€‚ keep-alive çš„ HTTP pipelining ç›¸å½“äºŽå•çº¿ç¨‹çš„ï¼Œè€Œ HTTP2 ç›¸å½“äºŽå¹¶å‘ã€‚ HTTP2 çš„ä¼˜ç‚¹ï¼š å¯¹HTTPå¤´å­—æ®µè¿›è¡Œæ•°æ®åŽ‹ç¼©(å³HPACKç®—æ³•)ï¼› HTTP/2 æœåŠ¡ç«¯æŽ¨é€(Server Push)ï¼› è¯·æ±‚ç®¡çº¿åŒ–ï¼› ä¿®å¤HTTP/1.0ç‰ˆæœ¬ä»¥æ¥æœªä¿®å¤çš„ é˜Ÿå¤´é˜»å¡ž é—®é¢˜ï¼› å¯¹æ•°æ®ä¼ è¾“é‡‡ç”¨å¤šè·¯å¤ç”¨ï¼Œè®©å¤šä¸ªè¯·æ±‚åˆå¹¶åœ¨åŒä¸€ TCP è¿žæŽ¥å†…ã€‚ åŽä¸‰ä¸ªä¼˜ç‚¹å…¶å®žéƒ½æ˜¯ å¤šè·¯å¤ç”¨ å¸¦æ¥çš„ä¼˜ç‚¹ã€‚]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
        <tag>http2</tag>
        <tag>keep-alive</tag>
        <tag>HOL blocking</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react å¼‚æ­¥æ¸²æŸ“çš„æœ€æ–°è¿›å±•]]></title>
    <url>%2F2018%2F04%2F04%2Fupdate-on-async-rendering.html</url>
    <content type="text"><![CDATA[react å¼‚æ­¥æ¸²æŸ“çš„æœ€æ–°è¿›å±•ä¸€å¹´å¤šæ¥ï¼Œreact å›¢é˜Ÿåœ¨å®žçŽ°å¼‚æ­¥æ¸²æŸ“ä¸Šåšäº†è®¸å¤šå·¥ä½œã€‚ä¸Šä¸ªæœˆçš„å†°å²› JSConf æ¼”è®²ä¸Šï¼ŒDan æ­æ™“äº†ä¸€äº›ä»¤äººå…´å¥‹çš„è§£é”å¼‚æ­¥æ¸²æŸ“çš„å¯èƒ½æ€§ã€‚çŽ°åœ¨æˆ‘ä»¬æƒ³ä¸Žæ‚¨åˆ†äº«ä¸€äº›æˆ‘ä»¬ç ”ç©¶è¿™äº›åŠŸèƒ½æ—¶çš„ä¸€äº›ç»éªŒï¼Œä»¥åŠå¸®åŠ©ä½ å‡†å¤‡ç”¨äºŽå¼‚æ­¥æ¸²æŸ“çš„ç»„ä»¶çš„ä¸€äº›ç§˜è¯€ã€‚ æˆ‘ä»¬äº†è§£åˆ°çš„æœ€å¤§çš„æ•™è®­å°±æ˜¯æˆ‘ä»¬ä¼ ç»Ÿçš„ä¸€äº›ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå€¾å‘äºŽé¼“åŠ±ä¸å®‰å…¨çš„å®žè·µã€‚å®ƒä»¬æ˜¯ï¼š componentWillMount componentWillReceiveProps componentWillUpdate è¿™äº›ç”Ÿå‘½å‘¨æœŸç»å¸¸è¢«è¯¯è§£æˆ–ä¸çŸ¥ä¸è§‰åœ°è¯¯ç”¨ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬é¢„æ–™åˆ°è¿™äº›æ½œåœ¨çš„æ»¥ç”¨å¯èƒ½ä¼šç»™å¼‚æ­¥æ¸²æŸ“é€ æˆæ›´å¤šé—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä¼šåœ¨æŽ¥ä¸‹æ¥çš„ç‰ˆæœ¬ç»™è¿™äº›ç”Ÿå‘½å‘¨æœŸæ·»åŠ  â€œUNSAFE_â€ å‰ç¼€ã€‚ï¼ˆè¿™é‡Œï¼Œâ€œunsafeâ€ æŒ‡çš„ä¸æ˜¯å®‰å…¨ï¼Œè€Œæ˜¯æƒ³ä¼ è¾¾åœ¨è¿™äº›ç”Ÿå‘½å‘¨æœŸé‡Œç¼–ç¨‹å¯èƒ½ä¼šåœ¨æœªæ¥çš„ react ç‰ˆæœ¬å¼•èµ· bugï¼Œå°¤å…¶æ˜¯å¼‚æ­¥æ¸²æŸ“å¼€å¯çš„æƒ…å†µä¸‹ã€‚ï¼‰ é€æ­¥è¿ç§»ä¹‹è·¯react éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æŽ§åˆ¶ï¼Œæ‰€ä»¥è¿™ä¸ªæ”¹å˜å°†æ˜¯é€æ­¥çš„ã€‚æˆ‘ä»¬å½“å‰çš„è®¡åˆ’æ˜¯ï¼š 16.3ï¼šä»‹ç»ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸåˆ«åï¼ŒUNSAFE_componentWillMount, UNSAFE_componentWillReceiveProps, å’Œ UNSAFE_componentWillUpdateã€‚ (æ—§çš„ç”Ÿå‘½å‘¨æœŸåå’Œæ–°çš„åˆ«åä¼šåœ¨è¿™ä¸ªç‰ˆæœ¬åŒæ—¶æœ‰æ•ˆã€‚) ä¹‹åŽçš„ 16.x ç‰ˆæœ¬ï¼š å¯¹ componentWillMount, componentWillReceiveProps, and componentWillUpdate å¼€å¯è­¦å‘Šæç¤ºã€‚ï¼ˆæ—§çš„ç”Ÿå‘½å‘¨æœŸåå’Œæ–°çš„åˆ«åä¼šåœ¨è¿™ä¸ªç‰ˆæœ¬åŒæ—¶æœ‰æ•ˆï¼Œä½†æ—§çš„åç§°åœ¨å¼€å‘æ¨¡å¼ä¸‹å°†ä¼šæœ‰ log è­¦å‘Šï¼‰ 17.0: å®Œå…¨ç§»é™¤ componentWillMount, componentWillReceiveProps, and componentWillUpdateã€‚ï¼ˆä»Žè¿™ä¸ªç‰ˆæœ¬å¼€å§‹ï¼Œåªæœ‰æ–°çš„ â€œUNSAFE_â€ ç”Ÿå‘½å‘¨æœŸåç§°æœ‰æ•ˆï¼‰ æ³¨æ„ï¼Œå¦‚æžœä½ æ˜¯ä¸€ä¸ª react åº”ç”¨å¼€å‘è€…ï¼Œä½ è¿˜ä¸éœ€è¦å¯¹ä¼ ç»Ÿçš„æ–¹æ³•åšä»»ä½•æ”¹å˜ã€‚å³å°†å‘å¸ƒçš„ 16.3 ç‰ˆæœ¬ä¸»è¦çš„æ„å›¾æ˜¯ï¼Œè®©å¼€æºé¡¹ç›®ç»´æŠ¤äººå‘˜åœ¨ä»»ä½•å¼ƒç”¨è­¦å‘Šä¹‹å‰æ›´æ–°å…¶åº“ã€‚è¿™äº›è­¦å‘Šè¿˜ä¸ä¼šç”Ÿæ•ˆï¼Œç›´åˆ°ä¹‹åŽçš„16.xç‰ˆæœ¬ æˆ‘ä»¬åœ¨ Facebook ç»´æŠ¤ç€è¶…è¿‡ 50ï¼Œ000 ä¸ª react ç»„ä»¶ï¼Œ å¹¶ä¸”æˆ‘ä»¬å¹¶æ²¡æœ‰è®¡åˆ’ç«‹å³é‡å†™å®ƒä»¬ã€‚æˆ‘ä»¬æ˜Žç™½è¿ç§»éœ€è¦æ—¶é—´ã€‚æˆ‘ä»¬ä¼šå¸¦é¢† react ç¤¾åŒºçš„æ¯ä¸€ä¸ªäººé€æ­¥è¿ç§»ã€‚ ä»Žæ—§çš„ç”Ÿå‘½å‘¨æœŸè¿ç§»å¦‚æžœä½ æƒ³è¦åœ¨ react 16.3 ç‰ˆæœ¬ä½¿ç”¨ä¸Šé¢ä»‹ç»çš„æ–° APIsï¼ˆæˆ–è€…å¦‚æžœä½ æ˜¯ä¸€ä¸ªç»´æŠ¤è€…ï¼Œæƒ³æå‰æ›´æ–°ä½ çš„åº“ï¼‰ï¼Œè¿™é‡Œæœ‰ä¸€äº›ç¤ºä¾‹å¸Œæœ›èƒ½å¸®åŠ©ä½ ä»Žå¦ä¸€ä¸ªè§’åº¦æ€è€ƒç»„ä»¶ã€‚ä¹‹åŽï¼Œæˆ‘ä»¬è®¡åˆ’æ·»åŠ ä¸€äº›â€œç§˜è¯€â€ åˆ°æˆ‘ä»¬çš„æ–‡æ¡£ä¸­ï¼Œä»¥æ­¤å±•ç¤ºå¦‚ä½•ä»¥é¿å…æœ‰é—®é¢˜çš„ç”Ÿå‘½å‘¨æœŸçš„æ–¹å¼ç¼–å†™æ™®é€šä¸šåŠ¡ã€‚ åœ¨å¼€å§‹ä¹‹å‰ï¼Œå¿«é€Ÿå›žé¡¾ä¸€ä¸‹ 16.3 ç‰ˆæœ¬æ‰€è®¡åˆ’çš„ç”Ÿå‘½å‘¨æœŸçš„å˜æ›´ï¼š æ·»åŠ ä»¥ä¸‹åˆ«åï¼š UNSAFE_componentWillMount, UNSAFE_componentWillReceiveProps, and UNSAFE_componentWillUpdateï¼ˆæ–°æ—§ç”Ÿå‘½å‘¨æœŸåŒæ—¶æ”¯æŒï¼‰ ä»‹ç»ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸï¼Œ é™æ€æ–¹æ³• getDerivedStateFromProps and getSnapshotBeforeUpdate. æ–°ç”Ÿå‘½å‘¨æœŸï¼š getDerivedStateFromPropsclass Example extends React.Component { static getDerivedStateFromProps(nextProps, prevState) { // ... } } è¿™ä¸ªæ–°çš„é™æ€ç”Ÿå‘½å‘¨æœŸæ–¹æ³• getDerivedStateFromProps æ˜¯åœ¨ç»„ä»¶å®žä¾‹åŒ–ä¹‹åŽè¢«è°ƒç”¨ï¼ŒåŒæ—¶æŽ¥æ”¶æ–°çš„ props ä½œä¸ºå‚æ•°ã€‚å®ƒå¯ä»¥è¿”å›žä¸€ä¸ªå¯¹è±¡åŽ»æ›´æ–° state, æˆ–è€…è¿”å›ž null æ¥è¡¨æ˜Žè¿™ä¸ªæ–°çš„ props ä¸éœ€è¦æ›´æ–°ä»»ä½• stateã€‚ å’Œ componentDidUpdate ä¸€èµ·ï¼Œè¿™ä¸ªæ–°ç”Ÿå‘½å‘¨æœŸåº”è¯¥è¦†ç›–ä¼ ç»Ÿçš„ componentWillReceiveProps æ–¹æ³•çš„æ‰€æœ‰ç”¨ä¾‹ã€‚ æ–°ç”Ÿå‘½å‘¨æœŸï¼š getSnapshotBeforeUpdateclass Example extends React.Component { getSnapshotBeforeUpdate(prevProps, prevState) { // ... } } è¿™ä¸ªæ–°ç”Ÿå‘½å‘¨æœŸ getSnapshotBeforeUpdate ä¼šåœ¨çªå˜ä¹‹å‰ï¼ˆæ¯”å¦‚DOMæ›´æ–°ä¹‹å‰ï¼‰è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•çš„è¿”å›žå€¼å°†ä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’åˆ° componentDidUpdateã€‚ ï¼ˆè¿™ä¸ªç”Ÿå‘½å‘¨æœŸå¹¶ä¸å¸¸ç”¨ï¼Œä½†å¯¹äºŽ rerender æœŸé—´æ‰‹åŠ¨ä¿ç•™æ»šåŠ¨ä½ç½®éžå¸¸æœ‰ç”¨ã€‚ï¼‰ ä¸Ž componentDidUpdate ä¸€èµ·ï¼Œè¿™ä¸ªæ–°ç”Ÿå‘½å‘¨æœŸåº”è¯¥è¦†ç›–ä¼ ç»Ÿçš„ componentWillUpdate æ–¹æ³•çš„æ‰€æœ‰ç”¨ä¾‹ã€‚ åœ¨è¿™ä¸ª gist é‡Œå¯ä»¥æ‰¾åˆ°å®ƒä»¬çš„ç±»åž‹ç­¾åã€‚ ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€äº›ç¤ºä¾‹å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸã€‚ æ–°ç”Ÿå‘½å‘¨æœŸç¤ºä¾‹åˆå§‹åŒ– stateè¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªç»„ä»¶åœ¨ componentWillMount é‡Œé¢è°ƒç”¨äº† setState: // Before class ExampleComponent extends React.Component { state = {}; componentWillMount() { this.setState({ currentColor: this.props.defaultColor, palette: 'rgb', }); } } ç®€å•åœ°å°† state åˆå§‹åŒ–ç§»åŠ¨åˆ° constructor æˆ–è€… å±žæ€§åˆå§‹åŒ–çš„ä½ç½®æ¥é‡æž„è¿™ä¸ªç»„ä»¶ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·ï¼š // After class ExampleComponent extends React.Component { state = { currentColor: this.props.defaultColor, palette: 'rgb', }; } èŽ·å–å¤–éƒ¨æ•°æ®ä¸‹é¢æ˜¯ä¸€ä¸ªç»„ä»¶åœ¨ componentWillMount é‡Œé¢èŽ·å–æ•°æ®çš„ä¾‹å­ï¼š // Before class ExampleComponent extends React.Component { state = { externalData: null, }; componentWillMount() { this._asyncRequest = asyncLoadData().then( externalData => { this._asyncRequest = null; this.setState({externalData}); } ); } componentWillUnmount() { if (this._asyncRequest) { this._asyncRequest.cancel(); } } render() { if (this.state.externalData === null) { // Render loading state ... } else { // Render real UI ... } } } ä¸Šé¢çš„ä»£ç†åœ¨æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆå¤–éƒ¨æ•°æ®è¿˜æ²¡æœ‰ç”¨åˆ°ï¼‰å’Œå³å°†åˆ°æ¥çš„å¼‚æ­¥æ¸²æŸ“æ¨¡å¼ï¼ˆè¯·æ±‚å¯èƒ½å‘é€å¤šæ¬¡ï¼‰ä¸¤ç§æƒ…å†µä¸‹éƒ½ä¼šæœ‰é—®é¢˜ã€‚ å¯¹äºŽå¤§éƒ¨åˆ†æƒ…å†µï¼ŒæŽ¨èå°†æ•°æ®èŽ·å–ç§»åˆ° componentDidMount: // After class ExampleComponent extends React.Component { state = { externalData: null, }; componentDidMount() { this._asyncRequest = asyncLoadData().then( externalData => { this._asyncRequest = null; this.setState({externalData}); } ); } componentWillUnmount() { if (this._asyncRequest) { this._asyncRequest.cancel(); } } render() { if (this.state.externalData === null) { // Render loading state ... } else { // Render real UI ... } } } è¿™é‡Œæ™®éçš„è¯¯è§£æ˜¯ï¼Œåœ¨ componentWillMount é‡ŒèŽ·å–æ•°æ®å¯ä»¥é¿å…æ¸²æŸ“ç©ºçš„çŠ¶æ€ã€‚åœ¨å®žé™…ä¸­ï¼Œè¿™ä»Žæ¥éƒ½æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸º react æ€»æ˜¯åœ¨ componentWillMount ä¹‹åŽç«‹å³æ‰§è¡Œ renderã€‚å¦‚æžœæ•°æ®åœ¨ componentWillMount è°ƒç”¨çš„æ—¶å€™è¿˜ä¸å¯ç”¨ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡ render ä¹Ÿä»ç„¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼Œè€Œä¸ç®¡ä½ åœ¨å“ªé‡ŒèŽ·å–æ•°æ®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå°†æ•°æ®èŽ·å–ç§»åˆ° componentDidMount æ˜¯æ„Ÿå—ä¸åˆ°å·®åˆ«çš„ã€‚ æ³¨æ„ï¼š ä¸€äº›é«˜çº§ç”¨ä¾‹(æ¯”å¦‚åƒ Relay è¿™æ ·çš„åº“)å¯èƒ½æƒ³è¦é¢„è¯»å–å¼‚æ­¥æ•°æ®ã€‚è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å®ƒæ˜¯å¦‚ä½•æˆä¸ºå¯èƒ½çš„ã€‚ ä»Žé•¿è¿œæ¥çœ‹ï¼Œè¿™ä¸ªåœ¨ react ç»„ä»¶ä¸­èŽ·å–æ•°æ®çš„å…¸ä¾‹å°†å¯èƒ½åŸºäºŽå†°å²› JSConf ä»‹ç»çš„ â€œsuspenseâ€ APIã€‚ç®€å•çš„æ•°æ®èŽ·å–æ–¹æ¡ˆå’Œåƒ Apolloã€ Relayè¿™æ ·çš„åº“å°†å¯ä»¥ä½¿ç”¨è¿™ä¸ªé’©å­ã€‚è¿™æ¯”ä¸Šé¢ä»»ä½•ä¸€ä¸ªè§£å†³æ–¹æ¡ˆéƒ½æ›´ç®€æ´ï¼Œä½†åœ¨ 16.3 ç‰ˆæœ¬å‘å¸ƒæ—¶è¿˜ä¸èƒ½æ•²å®šã€‚ éœ€è¦æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“çš„æ—¶å€™ï¼Œå½“å‰å¾ˆæœ‰å¿…è¦æä¾›åŒæ­¥çš„æ•°æ® â€”â€” componentWillMount ç»å¸¸è¢«ç”¨äºŽè¿™ä¸ªç›®çš„ï¼Œä½† constructor å…¶å®žå¯ä»¥æ›¿ä»£å®ƒã€‚å³å°†åˆ°æ¥çš„ suspense APIs å°†ä¼šè®©æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å¼‚æ­¥æ•°æ®èŽ·å–å°½å¯èƒ½åœ°æ¸…æ™°ã€‚ æ·»åŠ äº‹ä»¶ç›‘å¬ï¼ˆæˆ–è®¢é˜…ï¼‰ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨ mounting è®¢é˜…äº‹ä»¶çš„ç»„ä»¶ç¤ºä¾‹: // Before class ExampleComponent extends React.Component { componentWillMount() { this.setState({ subscribedValue: this.props.dataSource.value, }); // This is not safe; it can leak! this.props.dataSource.subscribe( this.handleSubscriptionChange ); } componentWillUnmount() { this.props.dataSource.unsubscribe( this.handleSubscriptionChange ); } handleSubscriptionChange = dataSource => { this.setState({ subscribedValue: dataSource.value, }); }; } ä¸å¹¸çš„æ˜¯ï¼Œ è¿™ä¼šé€ æˆæœåŠ¡ç«¯ï¼ˆcomponentWillUnmount æ°¸è¿œéƒ½ä¸ä¼šè¢«è°ƒç”¨ï¼‰å’Œå¼‚æ­¥æ¸²æŸ“ï¼ˆåœ¨æ¸²æŸ“å®Œæˆä¹‹å‰å¯èƒ½ä¼šè¢«ä¸­æ–­ï¼Œé€ æˆ componentWillUnmount æ²¡æœ‰è¢«è°ƒç”¨ï¼‰çš„å†…å­˜æ³„æ¼ã€‚ æœ‰äººç»å¸¸å‡è®¾ componentWillMount å’Œ componentWillUnmount æ˜¯å¯¹åº”å­˜åœ¨çš„ï¼Œè¿™å…¶å®žä¸èƒ½ä¿è¯ã€‚åªæœ‰ componentDidMount è¢«è°ƒç”¨ä¹‹åŽï¼Œreact æ‰èƒ½ä¿è¯ componentWillUnmount ä¼šåœ¨æ¸…é™¤æ—¶è¢«è°ƒç”¨ã€‚ å› æ­¤ï¼ŒæŽ¨èåœ¨ componentDidMount ä¸­æ·»åŠ äº‹ä»¶ç›‘å¬å’Œè®¢é˜…ã€‚ // After class ExampleComponent extends React.Component { state = { subscribedValue: this.props.dataSource.value, }; componentDidMount() { // Event listeners are only safe to add after mount, // So they won't leak if mount is interrupted or errors. this.props.dataSource.subscribe( this.handleSubscriptionChange ); // External values could change between render and mount, // In some cases it may be important to handle this case. if ( this.state.subscribedValue !== this.props.dataSource.value ) { this.setState({ subscribedValue: this.props.dataSource.value, }); } } componentWillUnmount() { this.props.dataSource.unsubscribe( this.handleSubscriptionChange ); } handleSubscriptionChange = dataSource => { this.setState({ subscribedValue: dataSource.value, }); }; } æœ‰æ—¶æ›´æ–°è®¢é˜…ä»¥ä¾¿å“åº”å±žæ€§å˜åŒ–æ˜¯å¾ˆé‡è¦çš„ã€‚å¦‚æžœä½ ä½¿ç”¨ redux or mobxï¼Œ è¿™äº›åº“çš„å®¹å™¨ç»„ä»¶åº”è¯¥åšè¿™äº›äº‹ã€‚å¯¹äºŽåº”ç”¨ä½œè€…ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå°å·§çš„åº“ï¼Œcreate-subscription æ¥å¸®åŠ©åšè¿™äº›äº‹ã€‚å®ƒå°†ä¼šå’Œ react v16.3 ä¸€èµ·å‘å¸ƒã€‚ æ¯”èµ·ä¸Šé¢é‚£æ ·ä¼ é€’ä¸€ä¸ªå¯è®¢é˜…çš„ dataSource å±žæ€§ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ create-subscription åŽ»ä¼ é€’è®¢é˜…çš„å€¼ï¼š import {createSubscription} from 'create-subscription'; const Subscription = createSubscription({ getCurrentValue(sourceProp) { // Return the current value of the subscription (sourceProp). return sourceProp.value; }, subscribe(sourceProp, callback) { function handleSubscriptionChange() { callback(sourceProp.value); } // Subscribe (e.g. add an event listener) to the subscription (sourceProp). // Call callback(newValue) whenever a subscription changes. sourceProp.subscribe(handleSubscriptionChange); // Return an unsubscribe method. return function unsubscribe() { sourceProp.unsubscribe(handleSubscriptionChange); }; }, }); // Rather than passing the subscribable source to our ExampleComponent, // We could just pass the subscribed value directly: &lt;Subscription source={dataSource}> {value => &lt;ExampleComponent subscribedValue={value} />} &lt;/Subscription>; æ³¨æ„ï¼š åƒ Relay/Apollo è¿™æ ·çš„åº“åº”è¯¥æ‰‹åŠ¨åœ°ä½¿ç”¨ create-subscription ç›¸åŒçš„æŠ€æœ¯åŽ»ç®¡ç†è®¢é˜…ï¼ˆå‚è€ƒï¼‰ä»¥é€‚åˆè¿™äº›åº“çš„æœ€ä½³å®žè·µã€‚ åŸºäºŽ props æ›´æ–° stateä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ä¼ ç»Ÿ componentWillReceiveProps æ–¹æ³•æ¥æ›´æ–°åŸºäºŽ props çš„ state çš„ç¤ºä¾‹ï¼š // Before class ExampleComponent extends React.Component { state = { isScrollingDown: false, }; componentWillReceiveProps(nextProps) { if (this.props.currentRow !== nextProps.currentRow) { this.setState({ isScrollingDown: nextProps.currentRow > this.props.currentRow, }); } } } è™½ç„¶ä¸Šé¢çš„ä»£ç æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä½† componentWillReceiveProps ç»å¸¸è¢«è¯¯ç”¨æ¥è§£å†³å½“ä¸‹çš„ä¸€äº›é—®é¢˜ã€‚å› æ­¤ï¼Œè¿™ä¸ªæ–¹æ³•å°†ä¼šè¢«å¼ƒç”¨ã€‚ ä»Ž 16.3 ç‰ˆæœ¬å¼€å§‹ï¼ŒæŽ¨èä½¿ç”¨æ–°çš„ é™æ€æ–¹æ³• getDerivedStateFromProps æ¥æ›´æ–°åŸºäºŽ props çš„ state.(è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå°†åœ¨ç»„ä»¶è¢«åˆ›å»ºåŽå’Œæ¯æ¬¡æŽ¥æ”¶åˆ°æ–° props çš„æ—¶å€™è¢«è°ƒç”¨)ï¼š // After class ExampleComponent extends React.Component { // Initialize state in constructor, // Or with a property initializer. state = { isScrollingDown: false, lastRow: null, }; static getDerivedStateFromProps(nextProps, prevState) { if (nextProps.currentRow !== prevState.lastRow) { return { isScrollingDown: nextProps.currentRow > prevState.lastRow, lastRow: nextProps.currentRow, }; } // Return null to indicate no change to state. return null; } } ä½ å¯èƒ½æ³¨æ„åˆ°ä¸Šé¢çš„ä¾‹å­ä¸­ props.currentRow è¢«æ˜ å°„åˆ° state( ä½œä¸º state.lastRow)ã€‚è¿™å…è®¸ getDerivedStateFromProps å’Œ componentWillReceiveProps é‚£æ ·å¯ä»¥è®¿é—®ä¸Šä¸€ä¸ª props çš„å€¼ã€‚ ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç®€å•åœ°å°†å…ˆå‰çš„ props ä½œä¸ºå‚æ•°ä¼ é€’ç»™ getDerivedStateFromPropsã€‚æˆ‘ä»¬åœ¨è®¾è®¡APIæ—¶è€ƒè™‘è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†å› ä¸ºä¸¤ç‚¹åŽŸå› æŽ¨ç¿»è¿™ä¸ªæƒ³æ³•ï¼š prevProps å‚æ•°åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ getDerivedStateFromProps (å®žä¾‹åŒ–åŽ)æ—¶ä¼šæ˜¯ nullã€‚ éœ€è¦åœ¨æ¯æ¬¡è®¿é—® prevProps æ—¶åˆ¤æ–­ if-not-nullã€‚ åœ¨æœªæ¥ç‰ˆæœ¬çš„ react ä¸­ï¼Œä¸ä¼ é€’å…ˆå‰çš„ props åˆ°è¿™ä¸ªå‡½æ•°æ˜¯é‡Šæ”¾å†…å­˜çš„ä¸€æ­¥ã€‚ï¼ˆå¦‚æžœ react ä¸éœ€è¦ä¼ é€’ prevProps åˆ°ç”Ÿå‘½å‘¨æœŸï¼Œå†…å­˜ä¸­å°±ä¸éœ€è¦ä¿æŒ prevProps çš„å¼•ç”¨ã€‚ï¼‰ æ³¨æ„ï¼š å¦‚æžœä½ æ­£åœ¨å†™ä¸€ä¸ªå…¬å…±ç»„ä»¶ï¼Œreact-lifecycles-compat polyfill å…è®¸åœ¨æ—§ç‰ˆæœ¬çš„ react ä¸­ä½¿ç”¨æ–°ç”Ÿå‘½å‘¨æœŸæ–¹æ³• getDerivedStateFromPropsã€‚ è°ƒç”¨å¤–éƒ¨å›žè°ƒè¿™æ˜¯ä¸€ä¸ªå½“å†…éƒ¨ state æ”¹å˜æ—¶è°ƒç”¨å¤–éƒ¨å›žè°ƒçš„ç»„ä»¶ï¼š // Before class ExampleComponent extends React.Component { componentWillUpdate(nextProps, nextState) { if ( this.state.someStatefulValue !== nextState.someStatefulValue ) { nextProps.onChange(nextState.someStatefulValue); } } } æœ‰æ—¶å€™ï¼Œå¤§å®¶ä½¿ç”¨ componentWillUpdate çš„ä¸€ä¸ªè¯¯ç‚¹æ˜¯ï¼šè®¤ä¸º componentDidUpdate è§¦å‘çš„æ—¶æœºâ€œå¤ªæ™šäº†â€ï¼Œ ä¸èƒ½åŠæ—¶æ›´æ–°å…¶ä»–ç»„ä»¶ã€‚å…¶å®žä¸æ˜¯è¿™æ ·ã€‚ react ç¡®ä¿ componentDidMount å’Œ componentDidUpdate æœŸé—´è°ƒç”¨çš„ä»»ä½• setState ä¼šåœ¨ç”¨æˆ·çœ‹åˆ°UIæ›´æ–°ä¹‹å‰æ‰§è¡Œå®Œã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåƒè¿™æ ·è¿™å¾ˆå®¹æ˜“é¿å…çº§è”æ›´æ–°ï¼Œä½†æŸäº›æƒ…å†µä¸‹è¿™æ˜¯å¿…è¦çš„ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æžœä½ éœ€è¦åœ¨æµ‹é‡å·²æ¸²æŸ“çš„ DOM å…ƒç´ åŽå®šä½ä¸€ä¸ªæç¤ºæ¡†ï¼‰ã€‚ æ— è®ºå“ªç§æ–¹å¼ï¼Œåœ¨å¼‚æ­¥æ¨¡å¼ä¸‹ä¸ºäº†è¿™ä¸ªç›®çš„åŽ»ä½¿ç”¨ componentWillUpdate æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¤–éƒ¨å›žè°ƒå¯èƒ½ä¼šåœ¨ä¸€æ¬¡æ›´æ–°ä¸­è¢«è°ƒç”¨å¤šæ¬¡ã€‚ç›¸åï¼Œåº”è¯¥ä½¿æœ‰å’ŒcomponentDidUpdate æ–¹æ³•æ›¿ä»£ï¼Œå› ä¸ºå®ƒèƒ½ä¿è¯æ¯æ¬¡æ›´æ–°åªè¢«è°ƒç”¨ä¸€æ¬¡ï¼š // After class ExampleComponent extends React.Component { componentDidUpdate(prevProps, prevState) { if ( this.state.someStatefulValue !== prevState.someStatefulValue ) { this.props.onChange(this.state.someStatefulValue); } } } å‰¯ä½œç”¨çš„ on props changeå’Œä¸Šé¢çš„ä¾‹å­ç›¸ä¼¼ï¼Œæœ‰æ—¶å€™å½“ç»„ä»¶ props æ”¹å˜æ—¶ä¼šæœ‰å‰¯ä½œç”¨ã€‚ // Before class ExampleComponent extends React.Component { componentWillReceiveProps(nextProps) { if (this.props.isVisible !== nextProps.isVisible) { logVisibleChange(nextProps.isVisible); } } } ç±»ä¼¼ componentWillUpdate, componentWillReceiveProps æ–¹æ³•å¯èƒ½ä¼šåœ¨å•æ¬¡æ›´æ–°ä¸­è¢«è°ƒç”¨å¤šæ¬¡ã€‚å› æ­¤ï¼Œåœ¨è¿™äº›æ–¹æ³•é‡Œé¿å…ä½¿ç”¨æœ‰å‰¯ä½œç”¨çš„å‡½æ•°æ˜¯å¾ˆé‡è¦çš„ã€‚ç›¸åï¼Œåº”è¯¥ä½¿æœ‰å’ŒcomponentDidUpdate æ–¹æ³•æ›¿ä»£ï¼Œå› ä¸ºå®ƒèƒ½ä¿è¯æ¯æ¬¡æ›´æ–°åªè¢«è°ƒç”¨ä¸€æ¬¡ï¼š // After class ExampleComponent extends React.Component { componentDidUpdate(prevProps, prevState) { if (this.props.isVisible !== prevProps.isVisible) { logVisibleChange(this.props.isVisible); } } } å½“ props æ”¹å˜æ—¶èŽ·å–å¤–éƒ¨æ•°æ®è¿™æ˜¯ä¸€ä¸ªå½“ props æ”¹å˜æ—¶èŽ·å–å¤–éƒ¨æ•°æ®çš„ç»„ä»¶ç¤ºä¾‹ï¼š // Before class ExampleComponent extends React.Component { state = { externalData: null, }; componentDidMount() { this._loadAsyncData(this.props.id); } componentWillReceiveProps(nextProps) { if (nextProps.id !== this.props.id) { this.setState({externalData: null}); this._loadAsyncData(nextProps.id); } } componentWillUnmount() { if (this._asyncRequest) { this._asyncRequest.cancel(); } } render() { if (this.state.externalData === null) { // Render loading state ... } else { // Render real UI ... } } _loadAsyncData(id) { this._asyncRequest = asyncLoadData(id).then( externalData => { this._asyncRequest = null; this.setState({externalData}); } ); } } æŽ¨èå‡çº§æˆä½¿ç”¨ componentDidUpdate æ›´æ–°æ•°æ®ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨æ–°ç”Ÿå‘½å‘¨æœŸ getDerivedStateFromProps åœ¨æ¸²æŸ“æ–° props æ—¶æ¸…ç†æ—§æ•°æ®ï¼š // After class ExampleComponent extends React.Component { state = { externalData: null, }; static getDerivedStateFromProps(nextProps, prevState) { // Store prevId in state so we can compare when props change. // Clear out previously-loaded data (so we don't render stale stuff). if (nextProps.id !== prevState.prevId) { return { externalData: null, prevId: nextProps.id, }; } // No state update necessary return null; } componentDidMount() { this._loadAsyncData(this.props.id); } componentDidUpdate(prevProps, prevState) { if (this.state.externalData === null) { this._loadAsyncData(this.props.id); } } componentWillUnmount() { if (this._asyncRequest) { this._asyncRequest.cancel(); } } render() { if (this.state.externalData === null) { // Render loading state ... } else { // Render real UI ... } } _loadAsyncData(id) { this._asyncRequest = asyncLoadData(id).then( externalData => { this._asyncRequest = null; this.setState({externalData}); } ); } } æ³¨æ„ï¼š å¦‚æžœä½ ä½¿ç”¨çš„ HTTP åº“æ”¯æŒå–æ¶ˆåŠŸèƒ½ï¼Œæ¯”å¦‚ axiosï¼Œåªéœ€è¦åœ¨ unmount çš„æ—¶å€™ç®€å•åœ°å–æ¶ˆä¸€ä¸ªæ­£åœ¨å¤„ç†çš„è¯·æ±‚ã€‚å¯¹äºŽåŽŸç”Ÿ Promise, ä½ å¯ä»¥ç”¨è¿™æ ·çš„è§£å†³æ–¹æ¡ˆã€‚ åœ¨æ›´æ–°å‰è¯»å– DOM å±žæ€§è¿™æ˜¯ä¸€ä¸ªåœ¨æ›´æ–°å‰è¯»å– DOM å±žæ€§ä»¥ä¾¿ç»´æŠ¤åˆ—è¡¨çš„æ»šåŠ¨ä½ç½®çš„ç»„ä»¶ç¤ºä¾‹ï¼š class ScrollingList extends React.Component { listRef = null; previousScrollHeight = null; componentWillUpdate(nextProps, nextState) { // Are we adding new items to the list? // Capture the current height of the list so we can adjust scroll later. if (this.props.list.length &lt; nextProps.list.length) { this.previousScrollHeight = this.listRef.scrollHeight; } } componentDidUpdate(prevProps, prevState) { // If previousScrollHeight is set, we've just added new items. // Adjust scroll so these new items don't push the old ones out of view. if (this.previousScrollHeight !== null) { this.listRef.scrollTop += this.listRef.scrollHeight - this.previousScrollHeight; this.previousScrollHeight = null; } } render() { return ( &lt;div ref={this.setListRef}> {/* ...contents... */} &lt;/div> ); } setListRef = ref => { this.listRef = ref; }; } åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ åœ¨ componentWillUpdate ä¸­è¯»å– DOM å±žæ€§ã€‚ä½†æ˜¯åœ¨å¼‚æ­¥æ¸²æŸ“ä¸­ï¼Œè¿™å¯èƒ½è¢«å»¶è¿Ÿåˆ° â€œrenderâ€ é˜¶æ®µï¼ˆåƒ componentWillUpdate and renderï¼‰å’Œ â€œcommitâ€ é˜¶æ®µ(åƒ componentDidUpdate)æ‰æ‰§è¡Œã€‚å¦‚æžœç”¨æˆ·åœ¨è¿™æœŸé—´åšäº†ä¸€äº›ç±»ä¼¼è°ƒæ•´çª—å£å¤§å°ï¼Œä»Ž componentWillUpdate ä¸­è¯»å–çš„ scrollHeight å€¼ä¼šæ˜¯æ—§çš„ã€‚ è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨æ–°çš„ â€œcommitâ€ é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼ŒgetSnapshotBeforeUpdateã€‚è¿™ä¸ªæ–¹å½“ä¼šåœ¨å˜æ›´äº§ç”ŸåŽç«‹å³è¢«è°ƒç”¨ï¼ˆæ¯”å¦‚åœ¨ DOM è¢«æ›´æ–°ä¹‹å‰ï¼‰ã€‚å®ƒå¯ä»¥è¿”å›žä¸€ä¸ªå€¼å¹¶ä½œä¸ºå‚æ•°ä¼ åˆ° componentDidUpdateã€‚ è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå¯ä»¥åƒä¸‹é¢è¿™æ ·ç”¨ï¼š class ScrollingList extends React.Component { listRef = null; getSnapshotBeforeUpdate(prevProps, prevState) { // Are we adding new items to the list? // Capture the current height of the list so we can adjust scroll later. if (prevProps.list.length &lt; this.props.list.length) { return this.listRef.scrollHeight; } return null; } componentDidUpdate(prevProps, prevState, snapshot) { // If we have a snapshot value, we've just added new items. // Adjust scroll so these new items don't push the old ones out of view. // (snapshot here is the value returned from getSnapshotBeforeUpdate) if (snapshot !== null) { this.listRef.scrollTop += this.listRef.scrollHeight - snapshot; } } render() { return ( &lt;div ref={this.setListRef}> {/* ...contents... */} &lt;/div> ); } setListRef = ref => { this.listRef = ref; }; } æ³¨æ„ï¼š å¦‚æžœä½ æ­£åœ¨å†™ä¸€ä¸ªå…¬å…±ç»„ä»¶ï¼Œreact-lifecycles-compat polyfill å…è®¸åœ¨æ—§ç‰ˆæœ¬çš„ react ä¸­ä½¿ç”¨æ–°ç”Ÿå‘½å‘¨æœŸæ–¹æ³• getSnapshotBeforeUpdateã€‚ å…¶ä»–åœºæ™¯å°½ç®¡æˆ‘ä»¬è¯•å›¾åœ¨è¿™ç¯‡æ–‡ç« ä¸­æ¶µç›–æœ€å¸¸è§çš„ç”¨ä¾‹ï¼Œæˆ‘ä»¬æ‰¿è®¤æˆ‘ä»¬å¯èƒ½é”™è¿‡äº†ä¸€äº›ã€‚å¦‚æžœè¿™ç¯‡åšå®¢é‡Œæœ‰ä½ ä½¿ç”¨ componentWillMount, componentWillUpdate, or componentWillReceiveProps å´æ²¡æåˆ°çš„æ¡ˆä¾‹ï¼Œå¹¶æ­¥ä¸ç¡®å®šå¦‚ä½•è¿ç§»ï¼Œå¯ä»¥ç•™ä¸‹è¯„è®ºå’Œç¤ºä¾‹ã€‚ å¼€æºç»´æŠ¤è€…å¼€æºç»´æŠ¤è€…å¯èƒ½æ¯”è¾ƒæƒ³çŸ¥é“è¿™äº›æ”¹å˜å¯¹å¼€æºç»„ä»¶æ„å‘³ç€ä»€ä¹ˆã€‚å¦‚æžœä½ å®žçŽ°äº†ä¸Šè¿°å»ºè®®ï¼Œä¾èµ–äºŽæ–°é™æ€ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ getDerivedStateFromProps ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ ä½ æ˜¯å¦ä¸å¤ä¸å‘å¸ƒä¸€ä¸ªæ–°çš„ä¸»ç‰ˆæœ¬å¹¶å…¼å®¹ react 16.2åŠæ›´è€ç‰ˆæœ¬ï¼Ÿ å¥½æ¶ˆæ¯æ˜¯ï¼Œä¸éœ€è¦ï¼ å½“ react 16.3 å‘å¸ƒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå‘å¸ƒä¸€ä¸ªæ–°çš„ npm åŒ…ï¼Œ react-lifecycles-compatã€‚ è¿™ä¸ªåŒ…æä¾›äº† polyfill ä»¥ä¾¿ä½ èƒ½åœ¨è€ç‰ˆæœ¬çš„ reactï¼ˆ0.14.9+ï¼‰ä½¿ç”¨æ–°çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ getDerivedStateFromProps and getSnapshotBeforeUpdateã€‚ è¦ä½¿ç”¨è¿™ä¸ª polyfill, è¯·å…ˆå®‰è£…ä¾èµ–åˆ°ä½ çš„åº“ï¼š # Yarn yarn add react-lifecycles-compat # NPM npm install react-lifecycles-compat --save æŽ¥ç€ä½¿ç”¨æ–°çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æ›´æ–°ä½ çš„ç»„ä»¶ï¼ˆå°±åƒä¸Šé¢è¯´çš„é‚£æ ·ï¼‰ã€‚ æœ€åŽï¼Œä½¿ç”¨ polyfill è®©ä½ çš„ç»„ä»¶å…¼å®¹æ—§ç‰ˆæœ¬çš„ react: import React from 'react'; import {polyfill} from 'react-lifecycles-compat'; class ExampleComponent extends React.Component { static getDerivedStateFromProps(nextProps, prevState) { // Your state update logic here ... } } // Polyfill your component to work with older versions of React: polyfill(ExampleComponent); export default ExampleComponent;]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>async rendering</tag>
        <tag>lifecycle</tag>
        <tag>getSnapshotBeforeUpdate</tag>
        <tag>getDerivedStateFromProps</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„]]></title>
    <url>%2F2018%2F03%2F13%2Fcritical-rendering-path.html</url>
    <content type="text"><![CDATA[ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ç½‘é¡µä¼˜åŒ–æ¶‰åŠåˆ°æµè§ˆå™¨è¾“å…¥ç½‘å€åŽçš„æ¯ä¸€æ­¥ï¼Œè¿™é‡Œå–å…³æ³¨ç›¸å¯¹å°‘çš„æµè§ˆå™¨æ¸²æŸ“è¿™ä¸€æ­¥æ¥çœ‹çœ‹ã€‚ æµè§ˆå™¨æ¸²æŸ“é¡µé¢æœ‰ä»¥ä¸‹äº”ä¸ªæ­¥éª¤ï¼š å¤„ç† HTML æ ‡è®°å¹¶æž„å»º DOM æ ‘ã€‚ å¤„ç† CSS æ ‡è®°å¹¶æž„å»º CSSOM æ ‘ã€‚ å°† DOM ä¸Ž CSSOM åˆå¹¶æˆä¸€ä¸ªæ¸²æŸ“æ ‘ã€‚ æ ¹æ®æ¸²æŸ“æ ‘æ¥å¸ƒå±€ï¼Œä»¥è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä½•ä¿¡æ¯ã€‚ å°†å„ä¸ªèŠ‚ç‚¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚ ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ å°±æ˜¯æŒ‡æœ€å¤§é™åº¦ç¼©çŸ­æ‰§è¡Œä¸Šè¿°ç¬¬ 1 æ­¥è‡³ç¬¬ 5 æ­¥è€—è´¹çš„æ€»æ—¶é—´. ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ä¸ä»…å¯¹é¦–å±å‘ˆçŽ°æœ‰é‡å¤§æ„ä¹‰ï¼Œå¯¹äºŽæ¸²æŸ“é¡µé¢å¸§çŽ‡ï¼Œæµç•…ç”¨æˆ·ä½“éªŒå¾ˆå…³é”®ã€‚ HTML çš„ç®€åŒ–å¤„ç†HTML åœ¨ SPA ç››è¡Œçš„æƒ…å†µä¸‹æƒ³è¦ç®€åŒ–è¶Šæ¥è¶Šå›°éš¾ï¼Œç‰¹åˆ«æ˜¯å¤æ‚çš„å¤§åž‹åº”ç”¨ï¼Œä¾èµ–äºŽä¸€äº›è´¨é‡ä¸ä¸€çš„ UI ç»„ä»¶åº“ã€‚éšä¾¿å†™å‡ ä¸ªä¸šåŠ¡åŠŸèƒ½ï¼Œå°±ä¼šç”Ÿæˆä¸€å¤§å †çš„ div åµŒå¥—ã€‚ é¦–å…ˆï¼Œæºå¤´èƒ½æŽ§åˆ¶å½“ç„¶æœ€å¥½ï¼Œç²¾ç®€ç»“æž„ï¼Œhtml è¯­ä¹‰åŒ–ã€‚ å…¶æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥å°†é¦–å±å®šä¹‰çš„èŒƒå›´å†ç¼©å°ï¼Œæ¯”å¦‚PCã€ç§»åŠ¨ç«¯å±å¹•å¤§å°çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚å¯¹äºŽ SPAï¼Œå‰ç«¯çš„é¦–å± html è¦ä¹ˆæ˜¯åŒæž„è¾“å‡ºï¼Œè¦ä¹ˆæ˜¯ js ç”Ÿæˆã€‚å…¶å®žè¿™ä¸¤ç§æƒ…å†µéƒ½æ˜¯å¯ä»¥å®šåˆ¶çš„ï¼Œç¬¬ä¸€æ—¶é—´åªè¾“å‡ºâ€œé¦–å±â€ å…ƒç´ ï¼Œå‰©ä¸‹çš„å†…å®¹å»¶è¿Ÿè½½å…¥ã€‚ä¸è¿‡ï¼Œå¯¹äºŽè¿™æ ·çš„æŽ§åˆ¶æ¯”è¾ƒç¹çå’Œç»†èŠ‚ï¼Œéœ€è¦é’ˆå¯¹æ€§ä¼˜åŒ–ï¼Œå“ªäº›éƒ¨åˆ†éœ€è¦å…ˆè¾“å‡ºï¼Œå“ªäº›éƒ¨åˆ†å¯ä»¥å»¶åŽã€‚ å†å°±æ˜¯å¼‚æ­¥å’Œç¢Žç‰‡åŒ–çš„æ¦‚å¿µï¼Œæˆ–è€…å« fiberã€‚åƒ react æž fiberï¼Œç›®å‰æ˜¯ä¸ºäº†èƒ½åŠæ—¶å“åº”ç”¨æˆ·ï¼Œå°† react æ‰§è¡Œçº¤ç»´åŒ–ï¼Œå¼‚æ­¥åŒ–ã€‚æˆ‘è§‰å¾— html ä¹ŸåŒæ ·å¯ä»¥åšï¼Œä¸€ä¸ªç»„ä»¶ä¸€ä¸ªç»„ä»¶åœ°å±•çŽ°é¡µé¢ï¼Œå°†ç¹é‡çš„æµè§ˆå™¨æ¸²æŸ“åˆ‡æˆä¸€ä¸ªä¸ªå°å—ã€‚ä¹Ÿå¯ä»¥è¯´æ˜¯ PWA(Progressive Web App)ã€‚é€šå¸¸æˆ‘ä»¬çš„é€‰æ‹©æ˜¯è¾“å‡º loadingï¼Œç­‰ä¸€åˆ‡å°±ç»ªåŽå†å±•ç¤ºï¼Œè¿™å¾€å¾€è®©æˆ‘ä»¬è‚†æ— å¿Œæƒ®åœ°åœ¨é¦–é¡µåŠ è½½ä¸€åˆ‡èµ„æºï¼Œç„¶åŽè®©ç”¨æˆ·å¯¹ç€ loading å‘å‘†ã€‚å¦‚æžœèƒ½æ­£ç¡®åœ°ï¼Œåˆ†æ­¥åœ°å±•çŽ°å†…å®¹ï¼Œç›¸ä¿¡ç”¨æˆ·èƒ½æ›´å¥½åœ°æŽ¥å—è¿™ä¸ªè¿‡ç¨‹ã€‚åœ¨ Facebook APPä¹Ÿèƒ½çœ‹åˆ°è¿™ç§æ€è·¯çš„å®žçŽ°ï¼Œæ‰“å¼€ APP å¯ä»¥å…ˆçœ‹åˆ°ç°è‰²çš„å ä½ç¬¦ï¼Œç„¶åŽç”±é¡¶éƒ¨å¼€å§‹åˆ†æ­¥åŠ è½½å†…å®¹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»ç„¶å¯ä»¥å“åº”é¡µé¢ä¸Šå·²åŠ è½½å®Œæˆçš„ç»„ä»¶çš„ç”¨æˆ·æ“ä½œã€‚ css çš„ç®€åŒ–å¤„ç†CSS æ˜¯é˜»å¡žæ¸²æŸ“çš„èµ„æºã€‚éœ€è¦å°†å®ƒå°½æ—©ã€å°½å¿«åœ°ä¸‹è½½åˆ°å®¢æˆ·ç«¯ï¼Œä»¥ä¾¿ç¼©çŸ­é¦–æ¬¡æ¸²æŸ“çš„æ—¶é—´ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œcss éƒ½ä¸æ˜¯é¦–å±çš„æ€§èƒ½ç“¶é¢ˆï¼Œä½†å®ƒæ˜¯é«˜å¸§çŽ‡åŠ¨ç”»çš„ç“¶é¢ˆã€‚é€šè¿‡ timeline å¯ä»¥è§‚å¯Ÿ css æ ·å¼è®¡ç®—ã€å¸ƒå±€ã€ç»˜åˆ¶ã€åˆæˆçš„æ€§èƒ½ã€‚ css çš„æ€§èƒ½é—®é¢˜åŒ…æ‹¬ï¼š CSS é€‰æ‹©å™¨çš„åµŒå¥—ï¼Œå¤šå±‚åµŒå¥—ä¸¥é‡å½±å“ CSS æ€§èƒ½ï¼Œå› ä¸ºæµè§ˆå™¨éœ€è¦åˆæˆCSSOMï¼Œè¿›è€Œåˆæˆæ¸²æŸ“æ ‘ã€‚ æ–‡æ¡£ï¼ˆHTMLï¼Œ CSSï¼‰è¶Šå¤§ï¼Œæµè§ˆå™¨éœ€è¦å®Œæˆçš„å·¥ä½œå°±è¶Šå¤šã€‚ æ ·å¼è¶Šå¤æ‚ï¼Œç»˜åˆ¶éœ€è¦çš„æ—¶é—´å°±è¶Šé•¿ï¼ˆä¾‹å¦‚ï¼Œå•è‰²çš„ç»˜åˆ¶å¼€é”€â€œè¾ƒå°â€ï¼Œè€Œé˜´å½±çš„è®¡ç®—å’Œæ¸²æŸ“å¼€é”€åˆ™è¦â€œå¤§å¾—å¤šâ€ï¼‰ é’ˆå¯¹ä¼˜åŒ–çš„æ‰‹æ®µï¼š ä½¿ç”¨ BEM CSS è§„èŒƒè¿›è¡Œç¼–å†™CSS ç®€åŒ– css, æˆ–å¼‚æ­¥ cssï¼Œå°†ä¸å¿…è¦çš„ã€éžå½“å‰é¡µçš„css æŒ‰éœ€åŠ è½½ å¯ä»¥å°è¯•å°†å¼€é”€å¤§çš„ css å±žæ€§è‡ªåŠ¨æå–ï¼Œæ‰“åŒ…åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œå»¶è¿ŸåŠ è½½ã€‚æ¯”å¦‚éžå¸¸ç‚«çš„åŠ¨ç”»ã€é˜´å½±ã€æ¸å˜ç­‰ã€‚å½“ç„¶åªæ˜¯ä¸€ä¸ªæƒ³æ³•ï¼Œéœ€è¦è¿›è¡Œæƒè¡¡ï¼Œä¸€èˆ¬æ²¡æœ‰é‚£ä¹ˆå¤§çš„å½±å“ï¼Œç›¸æ¯”å¤šä¸€ä¸ªè¯·æ±‚ä»£ä»· display: none; çš„åº”ç”¨ï¼Œæµè§ˆå™¨ä¸ä¼šæ¸²æŸ“å¸¦æœ‰äº›å±žæ€§çš„ DOM èŠ‚ç‚¹ã€‚å¯ä»¥åˆ©ç”¨å®ƒå…ˆéšè—ä¸å¿…è¦çš„å†…å®¹ï¼Œå»¶è¿Ÿå±•çŽ° Layout å¸ƒå±€ç®€åŒ–ä¸Žå›ºå®šè§†è§‰å˜åŒ–æ—¶ï¼Œç®¡é“å¯¹æŒ‡å®šå¸§çš„è¿è¡Œé€šå¸¸æ˜¯ï¼š æ ·å¼è®¡ç®—ã€å¸ƒå±€ã€ç»˜åˆ¶ã€åˆæˆ ä½†è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯ä»¥ç®€åŒ–çš„ï¼Œä¹Ÿæ˜¯å®žçŽ°é«˜å¸§çŽ‡åŠ¨ç”»çš„åŸºç¡€ã€‚ å½“ä¸æ”¹å˜å…ƒç´ çš„å‡ ä½•å±žæ€§ï¼ˆä¾‹å¦‚å®½åº¦ã€é«˜åº¦ã€å·¦ä¾§æˆ–é¡¶éƒ¨ä½ç½®ç­‰ï¼‰ï¼Œåªä¿®æ”¹â€œpaint onlyâ€å±žæ€§ï¼ˆä¾‹å¦‚èƒŒæ™¯å›¾ç‰‡ã€æ–‡å­—é¢œè‰²æˆ–é˜´å½±ç­‰ï¼‰ï¼Œå³ä¸ä¼šå½±å“é¡µé¢å¸ƒå±€çš„å±žæ€§ï¼Œåˆ™æµè§ˆå™¨ä¼šè·³è¿‡å¸ƒå±€ï¼Œä½†ä»å°†æ‰§è¡Œç»˜åˆ¶ã€‚ å¦‚æžœæ‚¨æ›´æ”¹ä¸€ä¸ªæ—¢ä¸è¦å¸ƒå±€ä¹Ÿä¸è¦ç»˜åˆ¶çš„å±žæ€§ï¼Œåˆ™æµè§ˆå™¨å°†è·³åˆ°åªæ‰§è¡Œåˆæˆ: å¯ä»¥é€šè¿‡ css trigger æ¥æŸ¥è¯¢ css å±žæ€§æ‰€è§¦å‘çš„å¯¹åº”çš„æ¸²æŸ“è¿‡ç¨‹ã€‚ ä½¿ç”¨ä¸€äº› 3d å±žæ€§ï¼ˆæ¯”å¦‚ translateZ(0)ï¼‰å¯ä»¥æå‡å±‚çš„ç‹¬ç«‹æ¸²æŸ“ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥æé«˜ç»˜åˆ¶æ€§èƒ½ï¼Œä½†ä¼šå¢žåŠ å†…å­˜å’ŒGPUçš„ä½¿ç”¨ï¼Œå¦‚æ— å¿…è¦ï¼Œè¯·å‹¿æå‡å…ƒç´  ç»¼ä¸Šï¼Œå¦‚æžœé¢‘ç¹æ”¹å˜å¸ƒå±€ï¼Œä¼šé€ æˆå›žæµå’Œé‡ç»˜ï¼Œå¯¹ css çš„æ€§èƒ½æ˜¯å½±å“æœ€å¤§çš„ï¼Œç»§è€Œé€ æˆå¡é¡¿ã€‚ æ€»ç»“html, css çš„ä¼˜åŒ–ä¸åƒå…¶ä»–æ–¹é¢çš„ä¼˜åŒ–ï¼Œå®ƒä»¬å’Œä¸šåŠ¡ç»“åˆæ¯”è¾ƒç´§å¯†ï¼Œå¯¹ä¸šåŠ¡å¼€å‘çš„æ„è¯†å’Œè¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¦‚æžœæºå¤´æ²¡æŽ§åˆ¶å¥½ï¼ŒåŽé¢å·¥ç¨‹æž„å»ºä¸Šçš„ä¼˜åŒ–ä¹Ÿæ˜¯æœ‰é™çš„ã€‚ å‚è€ƒï¼š æ¸²æŸ“æ€§èƒ½ By Paul Lewis å…³é”®æ¸²æŸ“è·¯å¾„ By Ilya Grigorik]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>html</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æž„å»º DOM å¯¹è±¡æ¨¡åž‹å’Œ CSSDOM å¯¹è±¡æ¨¡åž‹]]></title>
    <url>%2F2018%2F03%2F11%2Fconstructing-the-DOM-and-CSSDOM-object-model-before-browser-rendering.html</url>
    <content type="text"><![CDATA[By Ilya Grigorik æž„å»º DOM å¯¹è±¡æ¨¡åž‹å’Œ CSSDOM å¯¹è±¡æ¨¡åž‹æµè§ˆå™¨æ¸²æŸ“é¡µé¢å‰éœ€è¦å…ˆæž„å»º DOM å’Œ CSSOM æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å°½å¿«å°† HTML å’Œ CSS éƒ½æä¾›ç»™æµè§ˆå™¨ã€‚ TL;DR å­—èŠ‚ â†’ å­—ç¬¦ â†’ ä»¤ç‰Œ â†’ èŠ‚ç‚¹ â†’ å¯¹è±¡æ¨¡åž‹ã€‚ HTML æ ‡è®°è½¬æ¢æˆæ–‡æ¡£å¯¹è±¡æ¨¡åž‹ (DOM)ï¼›CSS æ ‡è®°è½¬æ¢æˆ CSS å¯¹è±¡æ¨¡åž‹ (CSSOM)ã€‚ DOM å’Œ CSSOM æ˜¯ç‹¬ç«‹çš„æ•°æ®ç»“æž„ã€‚ Chrome DevTools Timeline è®©æˆ‘ä»¬å¯ä»¥æ•èŽ·å’Œæ£€æŸ¥ DOM å’Œ CSSOM çš„æž„å»ºå’Œå¤„ç†å¼€é”€ã€‚ æ–‡æ¡£å¯¹è±¡æ¨¡åž‹ (DOM) Critical Path Hello web performance students! è¯•ä¸€ä¸‹ è®©æˆ‘ä»¬ä»Žå¯èƒ½çš„æœ€ç®€å•æƒ…å†µå…¥æ‰‹ï¼šä¸€ä¸ªåŒ…å«ä¸€äº›æ–‡æœ¬å’Œä¸€å¹…å›¾ç‰‡çš„æ™®é€š HTML é¡µé¢ã€‚æµè§ˆå™¨å¦‚ä½•å¤„ç†æ­¤é¡µé¢ï¼Ÿ è½¬æ¢ï¼š æµè§ˆå™¨ä»Žç£ç›˜æˆ–ç½‘ç»œè¯»å– HTML çš„åŽŸå§‹å­—èŠ‚ï¼Œå¹¶æ ¹æ®æ–‡ä»¶çš„æŒ‡å®šç¼–ç ï¼ˆä¾‹å¦‚ UTF-8ï¼‰å°†å®ƒä»¬è½¬æ¢æˆå„ä¸ªå­—ç¬¦ã€‚ ä»¤ç‰ŒåŒ–ï¼š æµè§ˆå™¨å°†å­—ç¬¦ä¸²è½¬æ¢æˆ W3C HTML5 æ ‡å‡†è§„å®šçš„å„ç§ä»¤ç‰Œï¼Œä¾‹å¦‚ï¼Œâ€œâ€ã€â€œâ€ï¼Œä»¥åŠå…¶ä»–å°–æ‹¬å·å†…çš„å­—ç¬¦ä¸²ã€‚æ¯ä¸ªä»¤ç‰Œéƒ½å…·æœ‰ç‰¹æ®Šå«ä¹‰å’Œä¸€ç»„è§„åˆ™ã€‚ è¯æ³•åˆ†æžï¼š å‘å‡ºçš„ä»¤ç‰Œè½¬æ¢æˆå®šä¹‰å…¶å±žæ€§å’Œè§„åˆ™çš„â€œå¯¹è±¡â€ã€‚ DOM æž„å»ºï¼š æœ€åŽï¼Œç”±äºŽ HTML æ ‡è®°å®šä¹‰ä¸åŒæ ‡è®°ä¹‹é—´çš„å…³ç³»ï¼ˆä¸€äº›æ ‡è®°åŒ…å«åœ¨å…¶ä»–æ ‡è®°å†…ï¼‰ï¼Œåˆ›å»ºçš„å¯¹è±¡é“¾æŽ¥åœ¨ä¸€ä¸ªæ ‘æ•°æ®ç»“æž„å†…ï¼Œæ­¤ç»“æž„ä¹Ÿä¼šæ•èŽ·åŽŸå§‹æ ‡è®°ä¸­å®šä¹‰çš„çˆ¶é¡¹-å­é¡¹å…³ç³»ï¼šHTML å¯¹è±¡æ˜¯ body å¯¹è±¡çš„çˆ¶é¡¹ï¼Œbody æ˜¯ paragraph å¯¹è±¡çš„çˆ¶é¡¹ï¼Œä¾æ­¤ç±»æŽ¨ã€‚ æ•´ä¸ªæµç¨‹çš„æœ€ç»ˆè¾“å‡ºæ˜¯æˆ‘ä»¬è¿™ä¸ªç®€å•é¡µé¢çš„æ–‡æ¡£å¯¹è±¡æ¨¡åž‹ (DOM)ï¼Œæµè§ˆå™¨å¯¹é¡µé¢è¿›è¡Œçš„æ‰€æœ‰è¿›ä¸€æ­¥å¤„ç†éƒ½ä¼šç”¨åˆ°å®ƒã€‚ æµè§ˆå™¨æ¯æ¬¡å¤„ç† HTML æ ‡è®°æ—¶ï¼Œéƒ½ä¼šå®Œæˆä»¥ä¸Šæ‰€æœ‰æ­¥éª¤ï¼šå°†å­—èŠ‚è½¬æ¢æˆå­—ç¬¦ï¼Œç¡®å®šä»¤ç‰Œï¼Œå°†ä»¤ç‰Œè½¬æ¢æˆèŠ‚ç‚¹ï¼Œç„¶åŽæž„å»º DOM æ ‘ã€‚è¿™æ•´ä¸ªæµç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ‰èƒ½å®Œæˆï¼Œæœ‰å¤§é‡ HTML éœ€è¦å¤„ç†æ—¶æ›´æ˜¯å¦‚æ­¤ã€‚ æ³¨ï¼šæˆ‘ä»¬å‡å®šæ‚¨å¯¹ Chrome DevTools æœ‰ç€åŸºç¡€ç¨‹åº¦çš„ç†Ÿæ‚‰ï¼Œå³æ‚¨çŸ¥é“å¦‚ä½•æ•èŽ·ç½‘ç»œç€‘å¸ƒï¼Œæˆ–è®°å½•æ—¶é—´çº¿ã€‚å¦‚æžœæ‚¨éœ€è¦å¿«é€Ÿæ¸©ä¹ ç›¸å…³å†…å®¹ï¼Œè¯·æŸ¥çœ‹ Chrome DevTools æ–‡æ¡£ï¼›å¦‚æžœæ‚¨æœªæŽ¥è§¦è¿‡ DevToolsï¼Œæˆ‘ä»¬å»ºè®®æ‚¨å­¦ä¹  Codeschool Discover DevTools è¯¾ç¨‹ã€‚ å¦‚æžœæ‚¨æ‰“å¼€ Chrome DevTools å¹¶åœ¨é¡µé¢åŠ è½½æ—¶è®°å½•æ—¶é—´çº¿ï¼Œå°±å¯ä»¥çœ‹åˆ°æ‰§è¡Œè¯¥æ­¥éª¤å®žé™…èŠ±è´¹çš„æ—¶é—´ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œå°†ä¸€å † HTML å­—èŠ‚è½¬æ¢æˆ DOM æ ‘å¤§çº¦éœ€è¦ 5 æ¯«ç§’ã€‚å¯¹äºŽè¾ƒå¤§çš„é¡µé¢ï¼Œè¿™ä¸€è¿‡ç¨‹éœ€è¦çš„æ—¶é—´å¯èƒ½ä¼šæ˜¾è‘—å¢žåŠ ã€‚åˆ›å»ºæµç•…åŠ¨ç”»æ—¶ï¼Œå¦‚æžœæµè§ˆå™¨éœ€è¦å¤„ç†å¤§é‡ HTMLï¼Œè¿™å¾ˆå®¹æ˜“æˆä¸ºç“¶é¢ˆã€‚ DOM æ ‘æ•èŽ·æ–‡æ¡£æ ‡è®°çš„å±žæ€§å’Œå…³ç³»ï¼Œä½†å¹¶æœªå‘Šè¯‰æˆ‘ä»¬å…ƒç´ åœ¨æ¸²æŸ“åŽå‘ˆçŽ°çš„å¤–è§‚ã€‚é‚£æ˜¯ CSSOM çš„è´£ä»»ã€‚ CSS å¯¹è±¡æ¨¡åž‹ (CSSOM)åœ¨æµè§ˆå™¨æž„å»ºæˆ‘ä»¬è¿™ä¸ªç®€å•é¡µé¢çš„ DOM æ—¶ï¼Œåœ¨æ–‡æ¡£çš„ head éƒ¨åˆ†é‡åˆ°äº†ä¸€ä¸ª link æ ‡è®°ï¼Œè¯¥æ ‡è®°å¼•ç”¨ä¸€ä¸ªå¤–éƒ¨ CSS æ ·å¼è¡¨ï¼šstyle.cssã€‚ç”±äºŽé¢„è§åˆ°éœ€è¦åˆ©ç”¨è¯¥èµ„æºæ¥æ¸²æŸ“é¡µé¢ï¼Œå®ƒä¼šç«‹å³å‘å‡ºå¯¹è¯¥èµ„æºçš„è¯·æ±‚ï¼Œå¹¶è¿”å›žä»¥ä¸‹å†…å®¹ï¼š body { font-size: 16px } p { font-weight: bold } span { color: red } p span { display: none } img { float: right } æˆ‘ä»¬æœ¬å¯ä»¥ç›´æŽ¥åœ¨ HTML æ ‡è®°å†…å£°æ˜Žæ ·å¼ï¼ˆå†…è”ï¼‰ï¼Œä½†è®© CSS ç‹¬ç«‹äºŽ HTML æœ‰åˆ©äºŽæˆ‘ä»¬å°†å†…å®¹å’Œè®¾è®¡ä½œä¸ºç‹¬ç«‹å…³æ³¨ç‚¹è¿›è¡Œå¤„ç†ï¼šè®¾è®¡äººå‘˜è´Ÿè´£å¤„ç† CSSï¼Œå¼€å‘è€…ä¾§é‡äºŽ HTMLï¼Œç­‰ç­‰ã€‚ ä¸Žå¤„ç† HTML æ—¶ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦å°†æ”¶åˆ°çš„ CSS è§„åˆ™è½¬æ¢æˆæŸç§æµè§ˆå™¨èƒ½å¤Ÿç†è§£å’Œå¤„ç†çš„ä¸œè¥¿ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼šé‡å¤ HTML è¿‡ç¨‹ï¼Œä¸è¿‡æ˜¯ä¸º CSS è€Œä¸æ˜¯ HTMLï¼š CSS å­—èŠ‚è½¬æ¢æˆå­—ç¬¦ï¼ŒæŽ¥ç€è½¬æ¢æˆä»¤ç‰Œå’ŒèŠ‚ç‚¹ï¼Œæœ€åŽé“¾æŽ¥åˆ°ä¸€ä¸ªç§°ä¸ºâ€œCSS å¯¹è±¡æ¨¡åž‹â€(CSSOM) çš„æ ‘ç»“æž„å†…ï¼š CSSOM ä¸ºä½•å…·æœ‰æ ‘ç»“æž„ï¼Ÿä¸ºé¡µé¢ä¸Šçš„ä»»ä½•å¯¹è±¡è®¡ç®—æœ€åŽä¸€ç»„æ ·å¼æ—¶ï¼Œæµè§ˆå™¨éƒ½ä¼šå…ˆä»Žé€‚ç”¨äºŽè¯¥èŠ‚ç‚¹çš„æœ€é€šç”¨è§„åˆ™å¼€å§‹ï¼ˆä¾‹å¦‚ï¼Œå¦‚æžœè¯¥èŠ‚ç‚¹æ˜¯ body å…ƒç´ çš„å­é¡¹ï¼Œåˆ™åº”ç”¨æ‰€æœ‰ body æ ·å¼ï¼‰ï¼Œç„¶åŽé€šè¿‡åº”ç”¨æ›´å…·ä½“çš„è§„åˆ™ï¼ˆå³è§„åˆ™â€œå‘ä¸‹çº§è”â€ï¼‰ä»¥é€’å½’æ–¹å¼ä¼˜åŒ–è®¡ç®—çš„æ ·å¼ã€‚ ä»¥ä¸Šé¢çš„ CSSOM æ ‘ä¸ºä¾‹è¿›è¡Œæ›´å…·ä½“çš„é˜è¿°ã€‚span æ ‡è®°å†…åŒ…å«çš„ä»»ä½•ç½®äºŽ body å…ƒç´ å†…çš„æ–‡æœ¬éƒ½å°†å…·æœ‰ 16 åƒç´ å­—å·ï¼Œå¹¶ä¸”é¢œè‰²ä¸ºçº¢è‰² â€” font-size æŒ‡ä»¤ä»Ž body å‘ä¸‹çº§è”è‡³ spanã€‚ä¸è¿‡ï¼Œå¦‚æžœæŸä¸ª span æ ‡è®°æ˜¯æŸä¸ªæ®µè½ (p) æ ‡è®°çš„å­é¡¹ï¼Œåˆ™å…¶å†…å®¹å°†ä¸ä¼šæ˜¾ç¤ºã€‚ è¿˜è¯·æ³¨æ„ï¼Œä»¥ä¸Šæ ‘å¹¶éžå®Œæ•´çš„ CSSOM æ ‘ï¼Œå®ƒåªæ˜¾ç¤ºäº†æˆ‘ä»¬å†³å®šåœ¨æ ·å¼è¡¨ä¸­æ›¿æ¢çš„æ ·å¼ã€‚æ¯ä¸ªæµè§ˆå™¨éƒ½æä¾›ä¸€ç»„é»˜è®¤æ ·å¼ï¼ˆä¹Ÿç§°ä¸ºâ€œUser Agent æ ·å¼â€ï¼‰ï¼Œå³æˆ‘ä»¬ä¸æä¾›ä»»ä½•è‡ªå®šä¹‰æ ·å¼æ—¶æ‰€çœ‹åˆ°çš„æ ·å¼ï¼Œæˆ‘ä»¬çš„æ ·å¼åªæ˜¯æ›¿æ¢è¿™äº›é»˜è®¤æ ·å¼ï¼ˆä¾‹å¦‚é»˜è®¤ IE æ ·å¼ï¼‰ã€‚ è¦äº†è§£ CSS å¤„ç†æ‰€éœ€çš„æ—¶é—´ï¼Œæ‚¨å¯ä»¥åœ¨ DevTools ä¸­è®°å½•æ—¶é—´çº¿å¹¶å¯»æ‰¾â€œRecalculate Styleâ€äº‹ä»¶ï¼šä¸Ž DOM è§£æžä¸åŒï¼Œè¯¥æ—¶é—´çº¿ä¸æ˜¾ç¤ºå•ç‹¬çš„â€œParse CSSâ€æ¡ç›®ï¼Œè€Œæ˜¯åœ¨è¿™ä¸€ä¸ªäº‹ä»¶ä¸‹ä¸€åŒæ•èŽ·è§£æžå’Œ CSSOM æ ‘æž„å»ºï¼Œä»¥åŠè®¡ç®—çš„æ ·å¼çš„é€’å½’è®¡ç®—ã€‚ æˆ‘ä»¬çš„å°æ ·å¼è¡¨éœ€è¦å¤§çº¦ 0.6 æ¯«ç§’çš„å¤„ç†æ—¶é—´ï¼Œå½±å“é¡µé¢ä¸Šçš„ 8 ä¸ªå…ƒç´  â€” è™½ç„¶ä¸å¤šï¼Œä½†åŒæ ·ä¼šäº§ç”Ÿå¼€é”€ã€‚ä¸è¿‡ï¼Œè¿™ 8 ä¸ªå…ƒç´ ä»Žä½•è€Œæ¥å‘¢ï¼ŸCSSOM å’Œ DOM æ˜¯ç‹¬ç«‹çš„æ•°æ®ç»“æž„ï¼ç»“æžœè¯æ˜Žï¼Œæµè§ˆå™¨éšè—äº†ä¸€ä¸ªé‡è¦æ­¥éª¤ã€‚æŽ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è°ˆä¸€è°ˆå°† DOM ä¸Ž CSSOM å…³è”åœ¨ä¸€èµ·çš„æ¸²æŸ“æ ‘ã€‚ P.S.äº†è§£æµè§ˆå™¨æž„å»ºé¡µé¢çš„åŽŸç†ï¼Œæ˜¯æ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚æ¯”å¦‚ BEM å¯¹ CSS æ€§èƒ½ä¼˜åŒ–çš„ä¼˜åŠ¿ï¼ŒDOM èŠ‚ç‚¹æ“ä½œçš„æ˜‚è´µä»¥åŠå¦‚ä½•æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆã€‚]]></content>
      <categories>
        <category>html</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>DOM</tag>
        <tag>CSSDOM</tag>
        <tag>html</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[reactæ–°APIâ€”â€”contextä¸Šä¸‹æ–‡]]></title>
    <url>%2F2018%2F02%2F12%2Freacts-new-context-api.html</url>
    <content type="text"><![CDATA[Reactâ€™s âš›ï¸ new Context APIè¿™æ˜¯ä¸€ç§æ›´äººæ€§åŒ–çš„æ–¹å¼ï¼Œä¸å†æ˜¯â€œå®žéªŒæ€§åŠŸèƒ½â€ï¼Œå¹¶ä¸”çŽ°åœ¨å®ƒæ˜¯ä¸€çº§APIã€‚å¹¶ä¸”ä½¿ç”¨äº† render prop! ä½ ä¹‹å‰å¬è¯´è¿‡ react çš„ context API å—ï¼Ÿå¦‚æžœä½ å¬è¯´è¿‡ï¼Œä½ æ˜¯å¦å’Œå…¶ä»–ç”¨æˆ·ä¸€æ ·çŠ¹è±«æ˜¯å¦ç›´æŽ¥ä½¿ç”¨å®ƒï¼Œå› ä¸ºä½ ä¼šåœ¨å®˜æ–¹æ–‡æ¡£çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š æœç´¢çš„ç¬¬ä¸€ä¸ªå†…å®¹å°±æ˜¯â€œä¸ºä»€ä¹ˆä¸è¦åŽ»ä½¿ç”¨ contextâ€ã€‚è¿™ä¸èƒ½æ¿€å‘ä½¿ç”¨ context API çš„ä¿¡å¿ƒã€‚ä¸ºäº†è€ƒè™‘é£Žé™©ï¼Œéƒ¨åˆ†æåˆ°ï¼š å¦‚æžœæƒ³è®©ä½ çš„åº”ç”¨æ›´ç¨³å®šï¼Œé‚£ä¸è¦ä½¿ç”¨ contextã€‚è¿™æ˜¯ä¸€ä¸ªå®žéªŒæ€§çš„ APIï¼Œåœ¨æœªæ¥å‘å¸ƒçš„ react ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šè¢«ç§»é™¤ã€‚ æ‰€ä»¥ï¼Œä¸ºä»€ä¹ˆä¼šæƒ³è¦ä½¿ç”¨ context å‘¢ï¼Ÿä½ æ˜¯å¦ç»åŽ†è¿‡å°† state ä»Ž react æ ‘çš„æ ¹ç»„ä»¶ä¸€ç›´ä¼ é€’è‡³å¶èŠ‚ç‚¹çš„ç—›è‹¦å‘¢ï¼Ÿè¿™ç§ç—›è‹¦è¢«ç§°ä¸ºâ€œprop drillingâ€ï¼Œå¹¶ä¸”éžå¸¸çƒ¦äººã€‚ä½ å¿…é¡»è®©ä¸å…³å¿ƒè¯¥çŠ¶æ€çš„ç»„ä»¶ä¼ é€’ props ç»™å…³å¿ƒè¯¥æ•°æ®çš„å­ç»„ä»¶ã€‚ç‰¹åˆ«æ˜¯å½“ä½ ç§»åŠ¨ç»„ä»¶æ—¶ï¼Œè¿™ç§ç—›è‹¦æ„Ÿæ›´å¼ºçƒˆäº†ã€‚ ä½ å½“ç„¶å¯ä»¥ä½¿ç”¨æ ‡å‡† javascript æ¨¡å—æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚åªéœ€è¦å°†æ•°æ®æ”¾åˆ°ä¸€ä¸ªå•ä¾‹æ¨¡å—ä¸­ï¼Œå®ƒå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®æˆ–å¯¼å…¥ã€‚ä½†ä½ å¯èƒ½åœ¨æ›´æ–°æ•°æ®çš„æ—¶å€™é‡åˆ°ä¸€äº›é—®é¢˜ï¼ˆä½ å¿…é¡»å®žçŽ°ä¸€ä¸ªäº‹ä»¶å¹¿æ’­è®©è®¢é˜…è€…çŸ¥é“ä½•æ—¶æ›´æ–°äº†æ•°æ®ï¼‰ï¼Œå¹¶ä¸”æœåŠ¡ç«¯æ¸²æŸ“ä¹Ÿä¼šå¯¹å•ä¾‹é€ æˆå›°æ‰°ã€‚ æ‰€ä»¥ï¼Œåƒ redux è¿™ç±»çš„çŠ¶æ€ç®¡ç†åº“å°±åº”è¿è€Œç”Ÿäº†ã€‚å®ƒå…è®¸ä½ åœ¨ react æ ‘çš„ä»»ä½•åœ°æ–¹èŽ·å–æ•°æ®ã€‚ä½ æ‰€è¦åšçš„äº‹åªæ˜¯ä½¿ç”¨ä¸€ä¸ªå« çš„ä¸œè¥¿ï¼Œç„¶åŽä½ çš„ç»„ä»¶å°±å¯ä»¥é€šè¿‡ connected ç¥žå¥‡èˆ¬åœ°è®¿é—®ä½ çš„ store æ•°æ®ã€‚ å¦‚æžœæˆ‘å‘Šè¯‰ä½  ä½¿ç”¨äº† contextè¿™ä¸ªå®žéªŒæ€§åŠŸèƒ½ä¼šæ€Žä¹ˆæ ·ï¼ŸðŸ˜± è¿™æ˜¯çœŸçš„ï¼provider ç»„ä»¶å°†æ•°æ®æ”¾åœ¨ context ï¼Œç„¶åŽ connect é«˜é˜¶ç»„ä»¶ä»Ž context è¯»å–æ•°æ®ã€‚æ‰€ä»¥å®žé™…ä¸Šï¼Œ redux å¹¶æ²¡æœ‰å®žçŽ°åœ¨ä»»ä½•åœ°æ–¹è®¿é—®æ•°æ®â€¦ æ˜¯ context åšäº†è¿™ä»¶äº‹ï¼ é‚£ä¹ˆï¼ŒçŽ°åœ¨çŸ¥é“ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ context äº†å—ï¼Ÿå¥½å§ã€‚ä½ å¯èƒ½å·²ç»çŸ¥é“å¹¶çˆ±ä¸Šå®ƒäº†ï¼å°±ç®—ä½ æ²¡æœ‰ç›´æŽ¥ä½¿ç”¨ context, ä½ ä¹Ÿå¯èƒ½é€šè¿‡ react-redux, MobX-react, react-router, glamorous ç­‰é—´æŽ¥åœ°ä½¿ç”¨äº†å®ƒï¼ Context é‡ç”Ÿå°½ç®¡æˆ‘ä»¬çŽ°åœ¨å¾ˆå–œæ¬¢ context, ä½†è¿˜è®°å¾—é‚£å¥â€œå®ƒå¾ˆå¯èƒ½åœ¨å°†æ¥çš„ react ç‰ˆæœ¬ä¸­è¢«ç§»é™¤â€è¿™å¥è¯å—ï¼Ÿæ¥å§ï¼Œä½ ä¼šçˆ±ä¸Šå®ƒçš„ï¼ ä¸€ä¸ªå¤šæœˆä»¥å‰ï¼Œ react å›¢é˜Ÿå—åˆ° yarn, Rust, Ember çš„å¯å‘åˆ›å»ºäº† RFCs é¡¹ç›®ã€‚è¿™ä¸ªé¡¹ç›®çš„ç¬¬ä¸€ä¸ª PR æ¥è‡ª Andrew Clarkï¼ˆreact æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ï¼‰å¹¶ç§°ä¹‹ä¸ºâ€œæ–°ç‰ˆ contextâ€ã€‚åœ¨è¿™ä¸ªæäº¤ä¸­ï¼ŒAndrew åˆ—å‡ºäº†æ–°ç‰ˆ context è¦å®žçŽ°çš„åŠŸèƒ½ã€‚è¿™é‡Œé¢æœ‰ä¸€äº›æœ‰è¶£çš„è®¨è®ºã€‚å‡ å¤©åŽï¼ŒAndrew å¼€äº†ä¸€ä¸ªæ–° PR â€œæ–° context APIâ€ã€‚ æ‰€ä»¥ï¼Œå®ƒçœ‹èµ·æ¥åƒä»€ä¹ˆï¼Ÿå®ƒæ¯”æ—§çš„ context API è¦ç›´è§‚ä¸€ç™¾ä¸‡å€ã€‚è¿™æ˜¯æˆ‘æƒ³åˆ°çš„æœ€ç®€å•æœ‰ç”¨çš„ä¾‹å­ï¼š è¿™æ˜¯æœ€ç®€å•çš„ç‰ˆæœ¬ï¼š const ThemeContext = React.createContext('light') class ThemeProvider extends React.Component { state = {theme: 'light'} render() { return ( &lt;ThemeContext.Provider value={this.state.theme}> {this.props.children} &lt;/ThemeContext.Provider> ) } } class App extends React.Component { render() { &lt;ThemeProvider> &lt;ThemeContext.Consumer> {val => &lt;div>{val}&lt;/div>} &lt;/ThemeContext.Consumer> &lt;/ThemeProvider> } } ä½ å¯èƒ½æ³¨æ„åˆ°æˆ‘åœ¨æ¶ˆè´¹ç»„ä»¶ä¸­ä½¿ç”¨äº† render propsï¼ˆæœ€ä½³å®žè·µï¼ï¼‰ï¼Œä½†å¦‚æžœè¿™ä¸æ˜¯ä½ çš„èœï¼Œä½ ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨é«˜é˜¶ç»„ä»¶æˆ–ç”¨äº† context API çš„å…¶ä»–æ–¹æ³•åŽ»å®žçŽ°ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒæ˜¯æœ€ä½³çš„ï¼‰ã€‚ æ–°çš„ context API ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„ä»¶ï¼š React.createContext ä¼ é€’åˆå§‹å€¼ï¼ˆå¯é€‰çš„ä½¿ç”¨ä½æŽ©ç åŠŸèƒ½ï¼‰ã€‚è¿™è¿”å›žäº†ä¸€ä¸ªåŒ…å« Provider å’Œ Consumer çš„å¯¹è±¡ã€‚ Provider åœ¨ç»„ä»¶æ ‘ä¸­ä½¿ç”¨é¢‘çŽ‡æ›´é«˜ï¼Œå¹¶ä¸”æŽ¥å—ä¸€ä¸ª value å±žæ€§ï¼ˆå¯ä»¥æ˜¯ä»»ä½•å€¼ï¼‰ã€‚ Consumer ç»„ä»¶å¯ä»¥åœ¨ Provider ç»„ä»¶æ ‘ä¸‹çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œå¹¶æŽ¥å—ä¸€ä¸ªâ€œchildrenâ€å±žæ€§ï¼Œ children å¿…é¡»æ˜¯ä¸€ä¸ªæŽ¥å— value å€¼å¹¶è¿”å›ž react å…ƒç´ ï¼ˆJSXï¼‰çš„å‡½æ•°ã€‚ çœ‹åˆ°è¿™ä¸ªAPI æˆ‘å¼‚å¸¸åœ°å…´å¥‹ã€‚react å›¢é˜Ÿå°†ä¼šç§»é™¤ context æ˜¯ä¸€ä¸ªå®žéªŒæ€§åŠŸèƒ½çš„è­¦å‘Šï¼Œå› ä¸ºå®ƒçŽ°åœ¨æ˜¯è¿™ä¸ªæ¡†æž¶çš„ä¸€ç­‰åŠŸèƒ½ã€‚è¿™æ„å‘³ç€å¼€å‘è€…æœ‰å¸Œæœ›ä½¿ç”¨ context ç®€å•åœ°è§£å†³ prop-drilling é—®é¢˜ï¼Œè€Œä¸å¿…å€ŸåŠ© redux è¿™ç±»å·¥å…·æ¥è§£å†³è¿™ä¸ªç—›ç‚¹ï¼Œä¹Ÿèƒ½æ›´å¥½æ›´è‡ªç”±åœ°ä½¿ç”¨ç®€å•çš„ react ã€‚ï¼ˆåˆæˆ–è€…ï¼Œ James Kyleæœªå‘å¸ƒçš„çš„è§£å†³æ–¹æ¡ˆæ˜¯æˆ‘ä»¬æ‰€æœŸå¾…çš„ï¼‰ Context å®žè·µå…³äºŽè¿™ä¸ªæ–°çš„ context APIï¼Œæˆ‘é‡åˆ°çš„æ¯”è¾ƒå¤šçš„é—®é¢˜æ˜¯ï¼ˆæˆ–è€…å…¶ä»–çš„ props renderæ¨¡å¼ï¼‰ï¼Œå¦‚ä½•ç»„åˆ providers å’Œ consumers ç»„ä»¶ã€‚å½“ä½ å°†ä¸€å †çš„ render prop ç»„ä»¶æ”¾åœ¨ä¸€èµ·æ—¶ï¼Œå°±ä¼šå˜æˆ åµŒå¥—: I mean come on (screen shot of actual code Iâ€™m playing with right now) pic.twitter.com/Ucc8gaxPMpâ€” Andrew Clark (@acdlite) January 24, 2018 é‚£æˆ‘ä»¬å¦‚ä½•é¿å…è¿™ä¸ªé—®é¢˜ï¼Ÿå¦‚æžœè¿™è®©ä½ å¾ˆçƒ¦æ¼ï¼Œé‚£ä½ å¯ä»¥åƒè§£å†³å¸¸è§„çš„ javascript é—®é¢˜ä¸€æ ·ï¼šä½¿ç”¨å®žç”¨å‡½æ•°/ç»„ä»¶ã€‚è¿™æœ‰ä¸ªä¾‹å­ï¼š const ThemeContext = React.createContext('light') class ThemeProvider extends React.Component {/* code */} const ThemeConsumer = ThemeContext.Consumer const LanguageContext = React.createContext('en') class LanguageProvider extends React.Component {/* code */} const LanguageConsumer = LanguageContext.Consumer function AppProviders({children}) { return ( &lt;LanguageProvider> &lt;ThemeProvider> {children} &lt;/ThemeProvider> &lt;/LanguageProvider> ) } function ThemeAndLanguageConsumer({children}) { return ( &lt;LanguageConsumer> {language => ( &lt;ThemeConsumer> {theme => children({language, theme})} &lt;/ThemeConsumer> )} &lt;/LanguageConsumer> ) } class App extends React.Component { render() { &lt;AppProviders> &lt;ThemeAndLanguageConsumer> {({theme, language}) => &lt;div>{theme} and {language}&lt;/div>} &lt;/ThemeAndLanguageConsumer> &lt;/AppProviders> } } ä¸Šé¢ä¸¾ä¾‹äº†ä¸€ä¸ªå¸¸è§çš„æ¡ˆä¾‹ï¼Œå¹¶ä½¿ç”¨ç‰¹æ®Šçš„å‡½æ•°æˆ–ç»„ä»¶åŽ»è®©è¿™äº›æ¡ˆä¾‹æ›´äººæ€§åŒ–ã€‚å°±åƒä½ å¹³æ—¶å¤„ç†é—®é¢˜ä¸€æ ·ï¼Œä¸¾å¯¹ä¾‹å­äº†å—ï¼Ÿæˆ‘å¸Œæœ›æœ‰ç”¨ ðŸ˜… æ€»ç»“å°±åƒæˆ‘ä¸Šé¢è¯´çš„ï¼Œæˆ‘å¯¹è¿™ä¸ª API éžå¸¸æ„Ÿå…´è¶£ã€‚å®ƒçŽ°åœ¨è¿˜æœªå‘å¸ƒï¼Œä½†å°†å‘å¸ƒåœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„ reactã€‚ä¸è¦æ‹…å¿ƒï¼Œæ—§çš„ context API å°†æ”¯æŒåˆ°ä¸‹ä¸€ä¸ªä¸»ç‰ˆæœ¬å·å‘å¸ƒã€‚æ‰€ä»¥æ¯ä¸ªäººéƒ½ä¼šæœ‰è¶³å¤Ÿçš„æ—¶é—´è¿ç§»ã€‚ä¸è¦å¿˜äº†ï¼Œreact å›¢é˜Ÿæœ‰è¶…è¿‡ 50,000 react ç»„ä»¶ï¼Œå¾ˆå¯èƒ½ä¼šå‘å¸ƒä¸€ä¸ª codemod æ¥è‡ªåŠ¨å‡çº§å¤§å®¶çš„ä»£ç ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>context</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascript åˆ¤æ–­æ­£è´Ÿ0]]></title>
    <url>%2F2018%2F01%2F14%2Fjudge-positive-and-negative-0.html</url>
    <content type="text"><![CDATA[javascript åˆ¤æ–­æ­£è´Ÿ0ES 2015/ ES 6 æ–°å¢žäº†ä¸€ä¸ªæ–¹æ³•ç”¨äºŽ javascript ç›¸ç­‰æ€§åˆ¤æ–­ â€“ Object.is()ã€‚å®ƒä¸Žä¹‹å‰çš„ç›¸ç­‰æ¯”è¾ƒè¿ç®—ç¬¦æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ ä¸‰ç§ä¸åŒçš„å€¼æ¯”è¾ƒæ“ä½œ æŠ½è±¡ç›¸ç­‰æ¯”è¾ƒ (==)ï¼šå°†æ‰§è¡Œç±»åž‹è½¬æ¢å†è¿›è¡Œæ¯”è¾ƒï¼Œç‰¹æ®Šåœ°ï¼šNull ä¸Ž undefined è¿”å›ž true, ä»»ä½•ç±»åž‹ä¸Ž NaNè¿”å›ž false, +0ä¸Ž-0ä¸ºtrue. ä¸¥æ ¼ç­‰äºŽè¿ç®—ç¬¦ï¼ˆ===ï¼‰:ä¸ä¼šæ‰§è¡Œç±»åž‹è½¬æ¢ï¼Œç±»åž‹ä¸ä¸€è‡´è¿”å›žfalse,ç‰¹æ®Šåœ°ï¼šNaNä¸ŽNaNä¸ºfalse,+0ä¸Ž-0ä¸ºtrue. Object.is: åŸºæœ¬ä¸Žå…¨ç­‰ï¼ˆ===ï¼‰ç›¸åŒï¼Œç‰¹æ®Šåœ°ï¼šNaNä¸ŽNaNä¸ºtrue,+0ä¸Ž-0ä¸ºfalse. +0 ä¸Ž -0 åˆ°åº•æ˜¯å¦ç›¸åŒç­”æ¡ˆæ˜¯ä¸åŒã€‚ ä¸€èˆ¬åœ°ï¼Œä½¿ç”¨å…¨ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰æ˜¯æ¯”è¾ƒå®‰å…¨çš„æ“ä½œï¼Œä½†æ˜¯æ­£è´Ÿé›¶æ˜¯è¿”å›žtrueï¼Œå®¹æ˜“è®©äººæœ‰ä¸€ç§å­˜åœ¨ä¸€ç§0çš„é”™è§‰ã€‚ åœ¨é«˜ç‰ˆæœ¬çš„Nodeä¸­ï¼Œæ­£è´Ÿ0çš„ç¬¦å·æ˜¯åŒºåˆ«å¯¹å¾…çš„ï¼Œæ­£0æ˜¾ç¤ºä¸º0ï¼Œè´Ÿ0æ˜¾ç¤ºä¸º -0ã€‚ åœ¨é™¤æ³•ä¸­ï¼Œ1/+0 ä¸º +Infinity, 1/-0 ä¸º -Infinityï¼Œè€Œ +Infinity === -Infinity è¿”å›ž false. åŒæ—¶æ ¹æ® javascript 64ä½åŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œç¬¬ 1 ä½æ˜¯æ­£è´Ÿæ•°ç¬¦å·ä½ï¼ˆsignï¼‰ï¼Œ0ä»£è¡¨æ­£æ•°ï¼Œ1ä»£è¡¨è´Ÿæ•°ï¼Œä¸­é—´çš„ 11 ä½å­˜å‚¨æŒ‡æ•°ï¼ˆexponentï¼‰ï¼Œç”¨æ¥è¡¨ç¤ºæ¬¡æ–¹æ•°ï¼Œæœ€åŽçš„ 52 ä½æ˜¯å°¾æ•°ï¼ˆmantissaï¼‰ï¼Œè¶…å‡ºçš„éƒ¨åˆ†è‡ªåŠ¨è¿›ä¸€èˆé›¶ã€‚æ‰€ä»¥æ­£è´Ÿ0çš„è¡¨ç¤ºæ˜¯ä¸åŒçš„ã€‚ ç–‘é—®ï¼šå¦‚æžœæ­£è´Ÿ 0 ç¡®å®žæ˜¯ä¸¤ä¸ªæ•°ï¼Œä¸ºä»€ä¹ˆå…¨ç­‰åˆ¤æ–­ä¸­ä¼šç›¸åŒï¼Ÿ é€šè¿‡æŸ¥çœ‹è§„èŒƒï¼Œ æ¯”è¾ƒ x === yï¼Œx å’Œ y ä¸ºå€¼ï¼Œéœ€è¦äº§å‡º true æˆ– falseã€‚æ¯”è¾ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š - å¦‚æžœ Type(x) ä¸Ž Type(y) çš„ç»“æžœä¸ä¸€è‡´ï¼Œè¿”å›ž falseã€‚ - å¦‚æžœ Type(x) ç»“æžœä¸º Undefinedï¼Œè¿”å›ž trueã€‚ - å¦‚æžœ Type(x) ç»“æžœä¸º Nullï¼Œè¿”å›ž trueã€‚ - å¦‚æžœ Type(x) ç»“æžœä¸º Numberï¼Œåˆ™ - å¦‚æžœ x ä¸º NaNï¼Œè¿”å›ž falseã€‚ - å¦‚æžœ y ä¸º NaNï¼Œè¿”å›ž falseã€‚ - å¦‚æžœ x ä¸Ž y ä¸ºåŒä¸€ä¸ªæ•°å­—ï¼Œè¿”å›ž trueã€‚ - å¦‚æžœ x ä¸º +0ï¼Œy ä¸º -0ï¼Œè¿”å›ž trueã€‚ - å¦‚æžœ x ä¸º -0ï¼Œy ä¸º +0ï¼Œè¿”å›ž trueã€‚ - è¿”å›ž falseã€‚ - å¦‚æžœ Type(x) ç»“æžœä¸º Stringï¼Œå¦‚æžœ x ä¸Ž y ä¸ºå®Œå…¨ç›¸åŒçš„å­—ç¬¦åºåˆ—ï¼ˆç›¸åŒçš„é•¿åº¦å’Œç›¸åŒçš„å­—ç¬¦å¯¹åº”ç›¸åŒçš„ä½ç½®ï¼‰ï¼Œè¿”å›ž trueï¼Œå¦åˆ™ï¼Œè¿”å›ž falseã€‚ - å¦‚æžœ Type(x) ç»“æžœä¸º Booleanï¼Œå¦‚æžœ x ä¸Ž y éƒ½ä¸º true æˆ– falseï¼Œåˆ™è¿”å›ž trueï¼Œå¦åˆ™ï¼Œè¿”å›ž falseã€‚ - å¦‚æžœ x å’Œ y å¼•ç”¨åˆ°åŒä¸€ä¸ª Object å¯¹è±¡ï¼Œè¿”å›ž trueï¼Œå¦åˆ™ï¼Œè¿”å›ž falseã€‚ å…¨ç­‰è¿ç®—ç¬¦è™½ç„¶æ²¡æœ‰ä½œç±»åž‹è½¬æ¢ï¼Œä½†ä¹Ÿæ˜¯é’ˆå¯¹ NaNã€+0ã€-0 ä½œäº†ç‰¹æ®Šå¤„ç†ã€‚ åŒºåˆ†æ­£è´Ÿé›¶çš„æ–¹æ³•é€šè¿‡ä»¥ä¸ŠçŸ¥è¯†ç‚¹ï¼Œå¯ä»¥æ€»ç»“å‡ºï¼š 1ã€é€šè¿‡é™¤ 0 æ³•åˆ¤æ–­ï¼š const isNegativeZero = num => num === 0 &amp;&amp; 1/num === -Infinity; 2ã€é€šè¿‡ object.is const isNegativeZero = num => Object.is(num, -0); æ€»ç»“Object.is æ˜¯ES2015 æ–°ç‰¹æ€§ï¼Œä¸Ž === ä¸ä¸€æ ·çš„æ˜¯ï¼šå®ƒå¯ä»¥æ­£ç¡®åˆ†è¾¨ æ­£è´Ÿé›¶ åŠ NaNã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŸºç¡€</tag>
        <tag>isNegativeZero</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»Žå¾®ä¿¡è·³ä¸€è·³çœ‹åŠ å¯†ç®—æ³•é€‰æ‹©]]></title>
    <url>%2F2018%2F01%2F03%2Fthrough-wechat-t1t-think-about-crypto.html</url>
    <content type="text"><![CDATA[é€šè¿‡å¾®ä¿¡å°æ¸¸æˆè·³ä¸€è·³ï¼Œçœ‹åŠ å¯†ç®—æ³•çš„é€‰æ‹©è¿‘æœŸå¾®ä¿¡æ›´æ–°ï¼Œæœ‰è·³ä¸€è·³çš„æ¸¸æˆï¼Œå¹¶è¢«ç½‘å‹æ‰¾å‡ºæºç å¹¶åˆ·åˆ†ï¼Œæˆ‘ä¹Ÿè¯•äº†ä¸€ä¸‹ï¼ŒæˆåŠŸåˆ·äº† 1024ã€‚å…¶ä¸­çœ‹åˆ°è¿™ä¸ªæ¸¸æˆä½¿ç”¨äº†å¸¸ç”¨åŠ å¯†åº“ crypto-jsï¼ˆä¸æ”¯æŒRSAï¼‰ï¼Œå®ƒå¯ä»¥åœ¨æµè§ˆå™¨ç«¯ä½¿ç”¨ã€‚è€Œ nodejs ä¹Ÿæœ‰ crypto æ¨¡å—ï¼Œè€Œä¸”æ”¯æŒçš„åŠ å¯†ç®—æ³•æ›´å¤šã€‚ä¸‹é¢å°±æ¥çœ‹çœ‹åŠ å¯†ç®—æ³•æœ‰å“ªäº›ï¼Œå¹¶å¦‚ä½•æ ¹æ®åœºæ™¯é€‰æ‹©ç®—æ³•ã€‚ å¸¸ç”¨åŠ å¯†ç®—æ³•Hash ç®—æ³•èƒ½è®¡ç®—å‡ºä¸€ä¸ªæ¶ˆæ¯æ‰€å¯¹åº”åˆ°çš„ï¼Œé•¿åº¦å›ºå®šçš„å­—ç¬¦ä¸²ï¼ˆåˆç§°æ¶ˆæ¯æ‘˜è¦ï¼‰çš„ç®—æ³•ã€‚ ç»“æžœå€¼é•¿çš„ Hash ç®—æ³•ä¹Ÿèƒ½ç”¨äºŽéªŒè¯æ–‡ä»¶æˆ–æ•°æ®çš„å®Œæ•´æ€§ã€‚ Hash ç®—æ³•é€šå¸¸æœ‰ï¼šmd5,sha,sha1,sha256,sha512,RSA-SHA; ä½† crypto-js ä¸æ”¯æŒ RSAã€‚è¿™é‡ŒæŒ‘å‡ ä¸ªã€‚ æµ‹è¯•æ•ˆçŽ‡å’Œç»“æžœï¼š var CryptoJS = require('crypto-js'); function test(hashs, txt) { hashs.forEach(name => hashAlgorithm(name, txt);) } function hashAlgorithm(algorithm, txt) { algorithm = algorithm.toUpperCase(); console.time(algorithm); console.log(algorithm, CryptoJS[algorithm](txt).toString()); console.timeEnd(algorithm); } const algs = ['md5', 'sha1', 'sha256', 'sha512', 'sha3', 'sha384', 'ripemd160']; test(algs, 'robin'); // `crypto-js` // MD5 8ee60a2e00c90d7e00d5069188dc115b // MD5: 3.229ms // SHA1 474ee9ee179b0ecf0bc27408079a0b15eda4c99d // SHA1: 0.485ms // SHA256 287782ef42356ef3d6551590f1ef0117b71d876df0f9b3eb58d088864770c74c // SHA256: 0.505ms // SHA512 071b38098125700fe49e65ef0059bfda1fbd110472a8d7490e0b3af6a8260712f958b9c7f27be61a8ddfe4fecb71f9e8002360f894f06dd4b1f383963d71db41 // SHA512: 1.519ms // SHA3 a621609aa4b8be7efac720538c86e998ebfa1ea67e4d10fa94df74388bbf443e18d92ca5bf483b789f6b42ea4f98bb086f48664bd5c1f4df476629419fa9e8b8 // SHA3: 1.150ms // SHA384 2750a9f5dadea58259fb17a3259b00a94648d40481eea91dc0e585e151e751001dc86457aa765019b0ca9721841b59f9 // SHA384: 0.498ms // RIPEMD160 9ef3a5f5ede0a741e38740cc3cc3e1bfcdeaece5 // RIPEMD160: 0.661ms // &lt;!--node crypto --> // md5,8ee60a2e00c90d7e00d5069188dc115b // md5: 0.093ms // sha,0894ec72c817d851286dd9c7309db3408b1dd620 // sha: 0.056ms // sha1,474ee9ee179b0ecf0bc27408079a0b15eda4c99d // sha1: 0.023ms // sha256,287782ef42356ef3d6551590f1ef0117b71d876df0f9b3eb58d088864770c74c // sha256: 0.029ms // sha512,071b38098125700fe49e65ef0059bfda1fbd110472a8d7490e0b3af6a8260712f958b9c7f27be61a8ddfe4fecb71f9e8002360f894f06dd4b1f383963d71db41 // sha512: 0.033ms // RSA-SHA,0894ec72c817d851286dd9c7309db3408b1dd620 // RSA-SHA: 0.023ms é€šå¸¸å“ˆå¸Œç®—æ³•ç”¨äºŽç™»é™†å¯†ç çš„åŠ å¯†ã€‚è¿™é‡Œçœ‹åˆ° SHA1 å±…ç„¶æ¯” MD5è¦å¿«ï¼Œè€Œä¸”å®‰å…¨æ€§æ›´é«˜ï¼Œå»ºè®®ä½¿ç”¨ SHA1 æˆ– SHA256ã€SHA512, MD5 ä¹Ÿç”±äºŽå­—å…¸åº“çš„å‡ºçŽ°å’Œè®¡ç®—æœºæ€§èƒ½çš„æå‡è€Œå˜å¾—ç›¸å¯¹ä¸å®‰å…¨ã€‚ ä»¥ä¸‹æ˜¯ç»´åŸºç™¾ç§‘çš„å‚è€ƒï¼š salt åŠ ç›ç”±äºŽè¢«åŠ å¯†ä¿¡æ¯ï¼Œå¾ˆå®¹æ˜“è¢«ä½¿ç”¨å½©è™¹è¡¨æš´åŠ›ç ´è§£ï¼Œç‰¹åˆ«æ˜¯ md5 è¿™ç±»å·²ç»å‡ºçŽ°æ¡ˆä¾‹çš„æƒ…å†µã€‚å¦ä¸€ç§æƒ…å†µæ˜¯å¤§å®¶çš„æ–¹æ³•éƒ½æ˜¯ä½¿ç”¨ md5 æˆ– SHA1ï¼Œé‚£å…¶å®žåªæ˜¯æŠŠæ˜Žæ–‡å¯†ç å˜æˆæ›´å¤æ‚å¯†æ–‡ï¼Œå¹¶ä¸èƒ½å¾ˆæœ‰æ•ˆåœ°é˜²æ­¢æ’žåº“ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æŽ¥ç”¨åŠ å¯†åŽçš„å¯†æ–‡è¿›è¡Œä¼ªé€ è¯·æ±‚è¿›è¡Œç™»é™†ã€‚ è¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ salt, æŠŠ salt åˆ°å¯†ç çš„å‰ã€ä¸­ã€åŽéƒ¨åˆ†ï¼Œå†åŠ å¯†ï¼Œè¿™æ ·åªè¦æ”»å‡»è€…æ²¡æœ‰åŽŸå§‹å¯†ç æˆ–ä½ çš„ salt ä¸Žå…¶ä»–ç½‘ç«™ä¸åŒå°±èƒ½ä¿è¯ç›¸å¯¹å®‰å…¨ã€‚è¿˜å¯ä»¥å°† salt åˆ†å¼€ã€å€’åºã€hashåŽæ’å…¥ã€‚ ä¾‹å¦‚ï¼š SHA3(SHA3(password) + salt); å¦å¤–è¿˜æœ‰ pbkdf2ã€ bcrypt ç®—æ³•ï¼Œå®ƒæ˜¯ä¸€ç§é€‚åº”æ€§åŠ å¯†ç®—æ³•ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®è¿­ä»£å¼ºåº¦ï¼Œä»¥é˜²æ­¢æ—¥ç›Šå¢žé•¿çš„ç”µè„‘æ€§èƒ½ã€‚ bcrypt(password, salt, cost) cost æ˜¯æ¯«ç§’ã€‚æ”»å‡»è€…å°±éœ€è¦èŠ±æ›´é•¿çš„æ—¶é—´ã€‚ Hmac å¯†é’¥æ•£åˆ—æ¶ˆæ¯è®¤è¯ç (Keyed-hash message authentication code)ç±»ä¼¼åŠ ç›å¤„ç†ï¼ŒHMAC è¿ç®—åˆ©ç”¨ Hash ç®—æ³•ï¼Œä»¥ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ªæ¶ˆæ¯ä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªæ¶ˆæ¯æ‘˜è¦ä½œä¸ºè¾“å‡ºã€‚HMAC ä¹Ÿå¯ä»¥æœ‰æ•ˆé˜²æ­¢ä¸€äº›ç±»ä¼¼md5çš„å½©è™¹è¡¨ç­‰æ”»å‡»ï¼Œæ¯”å¦‚ä¸€äº›å¸¸è§çš„å¯†ç ç›´æŽ¥MD5å­˜å…¥æ•°æ®åº“çš„ï¼Œå¯èƒ½è¢«åå‘ç ´è§£ã€‚å› ä¸ºé™¤äº†å¯†ç ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯ä»¥æ˜¯ä»»æ„å€¼çš„ keyã€‚ç›¸åŒå¯†ç ï¼Œä¸åŒçš„ key ç”Ÿæˆçš„å€¼æ˜¯ä¸ä¸€æ ·çš„ã€‚ çœ‹ä¸€ä¸‹ç”¨æ³•ï¼š var CryptoJS = require('crypto-js'); function run(hashs, txt, key) { hashs.forEach(name => hmacAlgorithm(name, txt, key);) } function hmacAlgorithm(algorithm, txt, key) { algorithm = algorithm.toUpperCase(); console.time(algorithm); console.log(algorithm, CryptoJS['Hmac'+algorithm](txt, key).toString()); console.timeEnd(algorithm); } var algs = ['md5', 'sha1', 'sha256', 'sha512', 'sha3', 'sha384', 'ripemd160']; run(algs, 'robin', 'abc'); run(algs, 'robin', 'adaslfjklsjdsafdasflsjfklasdhgkjashdfkasdklyreoiwqurenwmehrqoewnfknoineclwqnrewqmewqlrnewqfeqrbkwviwbqovbdpcsabveiwbqvibwvwibqvkbwibvkbwibvfldsalfjdklsaflkausld'); // short key // MD5 97ddf30a37c08700f6b8668b1b6cc4e5 // MD5: 4.226ms // SHA1 131e69c8d75cf3f5735c4320386f35dc93da2c89 // SHA1: 2.286ms // SHA256 4890c6579ce63619e31452ce80d1f917143987dfc131c0f61c195066b62753e3 // SHA256: 1.063ms // SHA512 64c34aff6f972dc8bef245c03198e8f3a7c9bda7bc208f01793fd03a93d89db0ca0d0235615c976d5ff331425adae7a5812c8d42b5bff30ab2e95683ad06eed8 // SHA512: 1.937ms // SHA3 27dc845b20795d64d25feabcac3d4f90297f32947780886bc16f4b18de850b7ac7d5bd021788d7b17fd4ad7da06cdadf650b7bfdb916394881902759b96dc8a6 // SHA3: 3.293ms // SHA384 cfe9ad71dc48deb9a778a68c8106370ead173e13fbcb77160a75ac190d2a4e201f962811d3c439f241892d4c69e604f1 // SHA384: 2.487ms // RIPEMD160 30de5538bfb0063ee42da27cdffe1c9f11f7acd0 // RIPEMD160: 1.327ms // ****long key // MD5 6c6d9995b33e4b7c992201bf54add3c4 // MD5: 0.244ms // SHA1 b71857c24215ab762033cf48a39b385eb5e299f6 // SHA1: 0.246ms // SHA256 7a9cbb46c0506bf52051c32f487142696316831af3d7af258389b9d83249660e // SHA256: 0.280ms // SHA512 05d1928b5a977cfe0a1e016e193f5f9c0e7ea7243e4b233d9a77508ec9ee18c4834485eb1a8a7803f8c8eb04a7b03df390e7bbf677c57d989c2c0101b10433f1 // SHA512: 0.750ms // SHA3 940fbf3853c76c70e0f50577bbc8b8252eee3d4404049e2bb2106c01419c1aa5b84a46ff0a6eedb699b3b1508e9d14915aceaaa3b037a04f6916c0c1f4e5f84c // SHA3: 1.589ms // SHA384 757946847447f8f52ade051b64cc1ad5c475c356a356cca7c81f36238ab4fce7c3af7fb69fc23eb4039aa7c7f20a077d // SHA384: 2.396ms // RIPEMD160 b92809af726d17aad164a128a19643a388213aa3 // RIPEMD160: 0.596ms å¯ä»¥çœ‹åˆ°é•¿çŸ­ key ç®—æ³•ä¸åŒï¼Œæ€§èƒ½ä¹Ÿä¸åŒï¼Œä¸€èˆ¬æŽ¨è key é•¿åº¦å¤§äºŽ å“ˆå¸Œå€¼é•¿åº¦ã€‚Node åŽŸç”Ÿæ¨¡å—å°±ä¸æµ‹äº†ï¼Œæ€§èƒ½åªèƒ½æ›´å¥½ã€‚ åŠ å¯†ä¸Žè§£å¯†ä¸Šé¢çš„å“ˆå¸Œç®—æ³•ä¸¥æ ¼æ„ä¹‰ä¸Šè¯´ä¸ç®—åŠ å¯†ç®—æ³•ï¼Œå› ä¸ºä¸€èˆ¬å‚¨å­˜çš„ä¹Ÿæ˜¯å¯†æ–‡ï¼Œåªæ˜¯ä¸ºäº†ä¼ è¾“è¿‡ç¨‹ä¸­æˆ–æ³„æ¼ä¹‹åŽä¸è¢«çœ‹åˆ°æ˜Žæ–‡å¯†ç ï¼Œæˆ–åŠ å¤§æš´åŠ›ç ´è§£çš„éš¾åº¦ï¼Œä»Žè€Œé™ä½Žé£Žé™©ã€‚æ›´é«˜å®‰å…¨è¦æ±‚çš„å°±éœ€è¦ç”¨åˆ°è§£å¯†ã€‚å¯ä»¥åˆ†ä¸ºå¯¹ç§°åŠ å¯†å’Œä¸å¯¹ç§°åŠ å¯†ã€‚ å¯¹ç§°åŠ å¯†ï¼šåŠ å¯†å’Œè§£å¯†å¯†é’¥ç›¸åŒã€‚ä»£è¡¨æ˜¯ AESï¼Œ é€Ÿåº¦å¿«ï¼Œå®‰å…¨æ€§é«˜ï¼Œæœ€æµè¡Œçš„åŠ å¯†ç®—æ³•ä¹‹ä¸€ï¼Œä¸­æ–‡ä¹Ÿå« é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆAdvanced Encryption Standardï¼‰ã€‚å¦å¤–è¿˜æœ‰DESã€3DESã€Blowfishã€IDEAã€RC5ã€RC6 éžå¯¹ç§°åŠ å¯†ï¼š åŠ å¯†å’Œè§£å¯†å¯†é’¥ä¸åŒã€‚ä»£è¡¨æ˜¯ RSAï¼Œ é€Ÿåº¦æ…¢ï¼Œå®‰å…¨æ€§é«˜ï¼›è¿˜æœ‰ECCï¼ˆæ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼‰ã€ElGamalã€èƒŒåŒ…ç®—æ³•ã€Rabinï¼ˆRSAçš„ç‰¹ä¾‹ï¼‰ åŠ å¯†ä¸Žè§£å¯†æœ€é‡è¦çš„æ˜¯å¯†é’¥ã€‚ å¯¹ç§°åŠ å¯†ï¼š ï¼ˆå¦‚ä½•é€‰æ‹©ï¼Œå°±çœ‹æ€§èƒ½å’Œå®‰å…¨æ€§çš„è¦æ±‚äº†ï¼‰ const CryptoJS = require('crypto-js'); function run(hashs, ...args) { hashs.forEach(name => encrypt(name, ...args)); } function encrypt(algorithm, txt, key) { const shasum = CryptoJS[algorithm]; console.time(algorithm); console.log(algorithm, shasum.encrypt(txt, key).ciphertext.toString()); console.timeEnd(algorithm); } var algs = ['AES', 'TripleDES', 'RC4', 'Rabbit', 'RabbitLegacy']; run(algs, 'robin', 'reiki'); // output // AES 4fe1199d6a3aee50fd285017ba841109 // AES: 5.589ms // TripleDES 90374ffa15857553 // TripleDES: 1.739ms // RC4 a9a8932b19 // RC4: 0.738ms // Rabbit 49fa9bd558 // Rabbit: 1.063ms // RabbitLegacy 6b8d025024 // RabbitLegacy: 1.022ms å®¢æˆ·ç«¯å¦‚ä½•é€‰æ‹©åŠ å¯†ç®—æ³•å¯¹äºŽå®¢æˆ·ç«¯ï¼Œç”±äºŽæºç å¯æ³„éœ²ï¼Œä¹Ÿå°±ç›¸å½“äºŽå®¢æˆ·ç«¯çš„åŠ å¯†æ–¹æ³•å¯æš´éœ²ã€‚ä»¥åŠ http å¯è¢«åŠ«æŒç­‰ä¸å®‰å…¨å› ç´ ã€‚æ™®é€šçš„åŠ å¯†æ ¹æœ¬æ²¡ä»€ä¹ˆç”¨ã€‚ä½†å¹¶ä¸æ˜¯è¯´å®¢æˆ·ç«¯ä¸ç”¨åŠ å¯†ï¼Œè€Œæ˜¯è¦æ±‚æœåŠ¡ç«¯å¿…é¡»å†æ¬¡åŠ å¯†ï¼Œæˆ–å®¢æˆ·ç«¯é‡‡ç”¨å®‰å…¨ç³»æ•°æ›´é«˜çš„åŠ å¯†æ–¹å¼ã€‚å¦å¤–ä¹ŸæŽ¨èå‡çº§ httpsã€‚ æˆ‘ä¹Ÿå¹¶ä¸äº†è§£æ‰€æœ‰ç®—æ³•ï¼Œä½†æ˜¯å¯ä»¥çœ‹éœ€æ±‚ï¼Œçœ‹åœºæ™¯ï¼ŒæŠ›å¼€åœºæ™¯è°ˆæŠ€æœ¯å°±æ˜¯è€æµæ°“ã€‚ é¦–å…ˆæ˜¯å¦éœ€è¦è§£å¯†ï¼Œå®‰å…¨æ€§è¦æ±‚å¦‚ä½•ï¼Œä¸€èˆ¬çš„å°±ä½¿ç”¨ hash ç®—æ³•ï¼Œè¦æ±‚é«˜ä¸€ç‚¹å°±ç”¨ hmacã€‚ å¦‚æžœéœ€è¦è§£å¯†ï¼Œè¿˜è¦è€ƒè™‘æ€§èƒ½åŠå¯†é’¥çš„å®‰å…¨æ€§ã€‚ å¾®ä¿¡è·³ä¸€è·³ä¸ºä»€ä¹ˆé€‰ AESï¼Ÿ // è·³ä¸€è·³ game.js é‡Œçš„åŠ å¯†ç®—æ³• e.encrypt = function(t, e) { var e = e.slice(0, 16), // sessionID å‰16ä½ i = n.default.enc.Utf8.parse(e), // base64 utf8 r = n.default.enc.Utf8.parse(e), // åŒä¸Š a = t; a = JSON.stringify(a); var o = n.default.AES.encrypt(a, i, { // AES éžå¯¹ç§°åŠ å¯†ï¼Œaä¸ºåŠ å¯†å†…å®¹ï¼Œiæ˜¯å¯†é’¥ï¼Œ iv: r, // ivå‚æ•° mode: n.default.mode.CBC, // åŠ å¯†æ¨¡å¼ï¼ŒAESåŒ…å«ECBï¼ŒCBCï¼ŒCFBç­‰åŠ å¯†æ¨¡å¼ï¼Œè¿™äº›æ¨¡å¼é™¤äº†ECBç”±äºŽæ²¡æœ‰ä½¿ç”¨IVè€Œä¸å¤ªå®‰å…¨ padding: n.default.pad.Pkcs7 // åŠ å¯†å¡«å……ï¼Œå—åŠ å¯†çš„ä¸€ä¸ªè¦é¢ä¸´çš„é—®é¢˜å°±æ˜¯å¦‚ä½•å¡«æ»¡æœ€åŽä¸€å— }); return o = o.toString() }; å…¶å®žè¿™ä¸ªæ–¹æ³•æ˜¯éµå¾ªå°ç¨‹åºæ–‡æ¡£é‡Œçš„åŠ å¯†è§£å¯†æŒ‡å¯¼çš„ï¼š ç”¨æˆ·æ•°æ®çš„ç­¾åéªŒè¯å’ŒåŠ è§£å¯† é¦–å…ˆåˆ†æžä¸Šä¼ æ¸¸æˆåˆ†æ•°éœ€è¦å®¢æˆ·ç«¯åŠ å¯†ï¼Œç„¶åŽæœåŠ¡ç«¯è§£å¯†æå–åˆ†æ•°è®°å½•ã€‚é‚£å°±æœ‰å¯¹ç§°åŠ å¯†å’Œéžå¯¹ç§°åŠ å¯†ä¸¤ç§ã€‚å¯¹äºŽéžå¯¹ç§°åŠ å¯†ï¼Œéœ€è¦ä¸‹å‘å…¬é’¥ï¼Œå¹¶ä¸”å…¬é’¥å’Œç§é’¥å¿…é¡»é…å¯¹ï¼Œé€Ÿåº¦ä¹Ÿæ…¢ï¼Œè¿™å¯¹ä¸€ä¸ªå°æ¸¸æˆæ¥è¯´æ“ä½œå¤ªéº»çƒ¦ã€‚é‚£å°±é”å®šå¯¹ç§°åŠ å¯†ã€‚ä½†å¦‚ä½•ä¼ é€’å¯†é’¥å‘¢ï¼Œæ‰€ä»¥å®ƒç”¨äº† sessionID ä½œä¸ºå¯†é’¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½çŸ¥é“ï¼Œå¹¶ä¸”å¯ä»¥æ¯æ¬¡ç™»é™†æ›´æ–°ï¼Œå®‰å…¨æ€§é«˜ã€‚å¹¶ä¸”å¾®ä¿¡ API ä½¿ç”¨äº† httpsï¼Œé˜²æ­¢ä¸€èˆ¬æŠ“åŒ…ï¼Œå®‰å…¨æ€§æ›´é«˜ã€‚ å¦å¤–ï¼Œå¯¹äºŽæºç ï¼Œä¸€èˆ¬ä¹Ÿä¼šå·¥ç¨‹åŒ–æž„å»ºï¼Œè¿›è¡ŒåŽ‹ç¼©ï¼Œæ··æ·†ã€‚ä½†å¯¹äºŽæºç ä¼šæ³„æ¼çš„æƒ…å†µä¸‹ï¼Œåˆæ˜¯ç”¨æˆ·æœ¬èº«ä¸»åŠ¨æŠ“åŒ…ï¼Œè¿˜èƒ½çœ‹æ‡‚ç¨‹åºï¼Œæ¸¸æˆç±»åž‹åªæ˜¯ä¸Šä¼ åˆ†æ•°ï¼Œè¿™å°±å‡ºçŽ°äº†åˆ·åˆ†çš„å¯èƒ½æ€§ã€‚å½“ç„¶ï¼Œåˆ†é«˜æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œè¿™æœ¬èº«åªæ˜¯å¨±ä¹ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>wechat</tag>
        <tag>crypto</tag>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[css counters è®¡æ•°å™¨]]></title>
    <url>%2F2017%2F12%2F21%2Fusing-css-counters.html</url>
    <content type="text"><![CDATA[è®© css åƒç¼–ç¨‹è¯­è¨€ä¸€æ ·å®žçŽ°è®¡æ•°ï¼ŒIE 8 ä¹Ÿæ”¯æŒçš„ css è®¡æ•°å™¨css counters æ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç‰¹å®šå±žæ€§å¢žå‡è®¡ç®—çš„å˜é‡ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥åšä¸€äº›ç±»ä¼¼ç¼–ç¨‹è¯­è¨€çš„é€šç”¨çš„è¿­ä»£ã€‚ è¿™ä¸ªæ–¹å¼å¯ä»¥ç”¨äºŽä¸€äº›åˆ›é€ æ€§çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä¸€äº›é‡å¤ä»£ç çš„è®¡æ•°å™¨ã€‚ ä¸ºäº†æŽ§åˆ¶è®¡æ•°å™¨ï¼Œä½ éœ€è¦ä½¿ç”¨ counter-reset å’Œ counter-increment å±žæ€§ï¼ŒåŒæ—¶ä¸Ž counter() å’Œ counters() å‡½æ•°é…å¯¹ã€‚å¦‚æžœæ²¡æœ‰åœ°æ–¹å±•ç¤ºè®¡æ•°å™¨ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ²¡æœ‰ä»»ä½•å­˜åœ¨çš„ä»·å€¼ï¼Œå¯¹æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç®€åŒ–çš„ content å±žæ€§ã€‚ è¡¨çŽ°ä¹Ÿå¾ˆç®€å•ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªæ— åºåˆ—è¡¨ï¼Œä½ æƒ³è¦è®¡ç®—åˆ—è¡¨é¡¹ã€‚åœ¨ ul å…ƒç´ ä¸ŠæŒ‡å®šä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¹¶ä¸”åœ¨ li å…ƒç´ ä¸Šå¢žåŠ è®¡æ•°ã€‚ counter-reset å±žæ€§æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ counter-reset å±žæ€§å®šä¹‰æˆ‘ä»¬çš„è®¡æ•°å™¨å˜é‡ã€‚å¯¹äºŽè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„å‘½åå¹¶ä¸”å¯é€‰æ‹©ä¸€ä¸ªè®¡æ•°åˆå§‹å€¼ã€‚é»˜è®¤èµ·å§‹å€¼æ˜¯ 0ã€‚è¿™ä¸ªåº”è®¾ç½®åœ¨çˆ¶å…ƒç´ ã€‚ counter-increment å±žæ€§é€šè¿‡ä½¿ç”¨ counter-increment å±žæ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¢žåŠ æˆ–å‡å°‘æˆ‘ä»¬çš„è®¡æ•°å™¨çš„å€¼ã€‚è¿™ä¸ªå±žæ€§ä¹Ÿæœ‰ç¬¬äºŒä¸ªå¯é€‰å‚æ•°å€¼ï¼Œå¯ä»¥æŒ‡å®šæ¯æ¬¡å¢žå‡çš„å¹…åº¦ã€‚ counter() å‡½æ•°counter() å‡½æ•°ä¸»è¦ä¸ºäº†å±•çŽ°è®¡æ•°å™¨ã€‚å±•ç¤ºçš„åœ°æ–¹å°±æ˜¯ content å±žæ€§ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªä½ å¯ä»¥å°†æ•°æ®é€šè¿‡ css å›žå¡«åˆ° html çš„å±žæ€§ï¼›ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è®¡æ•°å™¨å˜é‡åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è®¡æ•°å™¨ç±»åž‹ï¼ˆå¯é€‰ï¼‰ã€‚ æ³¨æ„ï¼šåœ¨ css ä¸­æ²¡æœ‰è¿žæŽ¥è¿ç®—ç¬¦ï¼Œæ‰€ä»¥å¦‚æžœä½ æƒ³è¿žæŽ¥ content å±žæ€§é‡Œçš„ä¸¤ä¸ªå€¼ï¼Œåªèƒ½å€¼ç”¨ç©ºæ ¼ã€‚ counters() å‡½æ•°è¿™ä¸ªå‡½æ•°å’Œ counter() å‡½æ•°ä¸€æ ·ã€‚ä¸»è¦çš„ä¸åŒæ˜¯ counters() ä½ å¯ä»¥åµŒå¥—è®¡æ•°å™¨åˆ°å¦ä¸€ä¸ªï¼Œå°±åƒå¤šçº§åµŒå¥—çš„ ul åˆ—è¡¨ã€‚å®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è®¡æ•°å™¨åï¼Œç¬¬äºŒä¸ªæ˜¯åˆ†éš”ç¬¦ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è®¡æ•°å™¨ç±»åž‹ï¼ˆå¯é€‰ï¼‰ã€‚ ä½¿ç”¨æ¡ˆä¾‹æ¡ˆä¾‹1 - æ–‡æ¡£ issue è‡ªåŠ¨è¿½è¸ªå½“ä½ æœ‰ä¸€äº›é‡å¤çš„å…ƒç´ ï¼Œå¹¶ä¸”æƒ³åŽ»ç»Ÿè®¡å®ƒä»¬ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥æ–¹ä¾¿ä½ è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª counter-reset åœ¨æˆ‘ä»¬çš„ .container çˆ¶çº§å…ƒç´ ã€‚ä¹‹åŽï¼Œæˆ‘ä»¬ç»™ issues çš„ç±»åè®¾ç½® counter-increment å±žæ€§ã€‚æœ€åŽï¼Œæˆ‘ä»¬é€šè¿‡ content å±žæ€§åœ¨ .issues:before å…ƒç´ ä¸Šè¾“å‡ºè®¡æ•°å™¨çš„å€¼ã€‚ See the Pen CSS Counter Example by Adam Laki (@adamlaki) on CodePen. æ¡ˆä¾‹2 - åµŒå¥—åˆ—è¡¨ä½¿ç”¨ counters() ï¼Œæˆ‘ä»¬å¯ä»¥è®©åµŒå¥—åˆ—è¡¨å®žçŽ°æ–‡æœ¬ç¼–è¾‘å™¨é‡Œçš„æ•ˆæžœã€‚ See the Pen MrjmLX by robin-l (@robin-l) on CodePen. æ¡ˆä¾‹3 - å¤é€‰æ¡†é€‰æ‹©è®¡æ•°å™¨ä½¿ç”¨ input çš„ :checked ä¼ªç±»ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å¤é€‰æ¡†æ˜¯å¦é€‰ä¸­ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿèƒ½é€’å¢žæˆ‘ä»¬çš„è®¡æ•°å™¨ã€‚ See the Pen OzRmGW by robin-l (@robin-l) on CodePen. å…¶ä»–æ¡ˆä¾‹ Å ime Vidas å‘å¸ƒçš„è„šæ³¨ä¾‹å­ Sam Dutton åˆ¶ä½œçš„æœ‰è¶£çš„è¡Œæ•°ä¾‹å­]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css counters</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç®€æ´ä»£ç ä¸Žå†—ä½™ä»£ç ]]></title>
    <url>%2F2017%2F11%2F29%2Fclean-code-dirty-code.html</url>
    <content type="text"><![CDATA[ç®€æ´ä»£ç ä¸Žå†—ä½™ä»£ç è¿™ç¯‡æ–‡ç« å°†é‡ç‚¹ä»‹ç»é€‚ç”¨äºŽçŽ°ä»£ react è½¯ä»¶å¼€å‘çš„ç®€æ´ä»£ç ä¹‹é“ã€‚æˆ‘è¿˜ä¼šè°ˆè°ˆ ES6/ES2015 å¸¦æ¥çš„ä¸€äº›â€œè¯­æ³•ç³–â€ã€‚ ä»€ä¹ˆæ˜¯ç®€æ´ä»£ç ä¹‹é“ï¼Œä¸ºä»€ä¹ˆæˆ‘å¦‚æ­¤å…³å¿ƒï¼Ÿç®€æ´ä»£ç ä¹‹é“çš„ä¸€è´¯ç¼–ç é£Žæ ¼æ˜¯è®©ä½ çš„ä»£ç æ›´æ˜“å†™ã€æ˜“è¯»å’Œæ˜“ç»´æŠ¤ã€‚ç»å¸¸ï¼Œç¨‹åºå‘˜åœ¨ä¸€ä¸ªé—®é¢˜ä¸ŠèŠ±äº†è®¸å¤šæ—¶é—´ï¼Œä¸€æ—¦é—®é¢˜è¢«è§£å†³ï¼Œå°±æäº¤ä»£ç ã€‚æˆ‘ä¸€ç›´ä¸»å¼ ï¼Œä½ çš„å·¥ä½œå¹¶æ²¡æœ‰å®Œæˆï¼Œå› ä¸ºä½ åªæ˜¯è®©ä½ çš„ä»£ç â€œæ­£å¸¸å·¥ä½œâ€è€Œå·²ã€‚ è¿™æ˜¯ä¸€ä¸ªæœºä¼šæ¥ç²¾ç®€ä½ çš„ä»£ç ï¼Œé€šè¿‡åˆ é™¤æ­»ä»£ç ï¼ˆåƒµå°¸ä»£ç ï¼‰ã€é‡æž„ã€åˆ é™¤è¢«æ³¨é‡Šçš„ä»£ç ï¼åŠªåŠ›æé«˜å¯ç»´æŠ¤æ€§ã€‚æ‰ªå¿ƒè‡ªé—®ï¼Œâ€œ6ä¸ªæœˆåŽå…¶ä»–äººè¿˜èƒ½ç†è§£ä½ çš„ä»£ç å—ï¼Ÿâ€ ç®€å•æ¥è¯´ï¼Œç¼–å†™èƒ½è®©ä½ è‡ªè±ªåˆ°å¸¦å›žå®¶å’Œæ¯äº²ç‚«è€€çš„ä»£ç ã€‚ ä¸ºä»€ä¹ˆä½ è¦è¿™ä¹ˆå…³å¿ƒè¿™ä¸ªé—®é¢˜ï¼Ÿå› ä¸ºå¦‚æžœä½ æ˜¯ä¸€ä¸ªå¥½å¼€å‘è€…ï¼Œä½ ä¼šå¾ˆæ‡’ã€‚å¬æˆ‘è¯´å®Œï¼Œæˆ‘æ˜¯èµžæ‰¬çš„æ„æ€ã€‚ä¸€ä¸ªå¥½çš„å¼€å‘è€…ï¼Œé¢å¯¹åŒä¸€ä»¶äº‹è¦åšå¾ˆå¤šéçš„çŠ¶å†µï¼Œé€šå¸¸ä¼šå¯»æ‰¾ä¸€ä¸ªè‡ªåŠ¨è§£å†³ï¼ˆæˆ–æ›´å¥½çš„ï¼‰æ–¹æ¡ˆæ¥å®Œæˆçœ¼å‰çš„ä»»åŠ¡ã€‚æ‰€ä»¥ï¼Œå› ä¸ºä½ å¾ˆæ‡’ï¼Œå…³æ³¨ç®€æ´ä»£ç çš„æŠ€æœ¯å°†ä¼šå‡å°‘ä½ æ‹‰å–ä»£ç ä¸€éåˆä¸€éåœ° review åŒä¸€æ®µä»£ç çš„é¢‘çŽ‡ã€‚ é€šè¿‡å—…è§‰æµ‹è¯•ç²¾ç®€ä»£ç ç²¾ç®€ä»£ç åº”è¯¥é€šè¿‡å—…è§‰æµ‹è¯•ã€‚ä¸æ˜Žç™½æˆ‘æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ä»¬éƒ½çœ‹ç€ï¼ˆè‡ªå·±çš„æˆ–åˆ«äººçš„ï¼‰ä»£ç è¯´ï¼šâ€œè¿™é‡Œä¸å¤ªå¯¹åŠ²ã€‚â€ è®°ä½ï¼Œå¦‚æžœæ„Ÿè§‰ä¸å¤ªå¯¹åŠ²ï¼Œé‚£å¯èƒ½çœŸçš„ä¸å¯¹åŠ²ã€‚ä¸€èµ·å¯¹ä»£ç æ·±æ€ç†Ÿè™‘æ˜¯å¥½çš„ã€‚ä½†å¦‚æžœä½ å‘è§‰ä½ æ­£åœ¨æŠŠä¸€ä¸ªæ–¹å½¢çš„é’‰å­æ’è¿›ä¸€ä¸ªåœ†å½¢çš„æ´žé‡Œï¼Œé‚£å°±è¯·åœä¸‹æ¥ï¼Œé€€ä¸€æ­¥ï¼Œå¹¶ä¸”ä¼‘æ¯ä¸€ä¸‹ã€‚æœ€å¤šåæ¬¡ï¼Œä½ ä¼šæ‰¾åˆ°æ›´å¥½çš„è§£å†³åŠžæ³•çš„ã€‚ ç²¾ç®€ä»£ç å°±æ˜¯ DRY ï¼ˆç¦æ­¢é‡å¤ï¼‰DRY æ˜¯ â€œDonâ€™t repeat yourself!â€ çš„ç¼©å†™ã€‚å¦‚æžœä¸€ä»¶äº‹ä½ åšäº†å¾ˆå¤šéï¼Œåˆå¹¶é‡å¤çš„ä»£ç ã€‚å¦‚æžœä½ åœ¨ä½ ä»£ç é‡Œå‘çŽ°äº†è®¾è®¡æ¨¡å¼ï¼Œé‚£æ˜¯ä¸€ä¸ªåˆ é™¤é‡å¤çš„è¿¹è±¡ã€‚æœ‰æ—¶å€™è¿™æ„å‘³ç€ä½ ç«™å¾—ç¦»å±å¹•è¿œè¿œåœ°ï¼Œç›´åˆ°ä½ çœ‹ä¸æ¸…æ–‡å­—ï¼Œä¹Ÿæ— æ³•å¯»æ‰¾æ¨¡å¼ã€‚ // Dirty const MyComponent = () => ( &lt;div> &lt;OtherComponent type="a" className="colorful" foo={123} bar={456} /> &lt;OtherComponent type="b" className="colorful" foo={123} bar={456} /> &lt;/div> ); // Clean const MyOtherComponent = ({ type }) => ( &lt;OtherComponent type={type} className="colorful" foo={123} bar={456} /> ); const MyComponent = () => ( &lt;div> &lt;MyOtherComponent type="a" /> &lt;MyOtherComponent type="b" /> &lt;/div> ); æœ‰æ—¶å€™ï¼Œå°±åƒä¸Šé¢çš„ä¾‹å­é‚£æ · â€”â€” åˆ é™¤é‡å¤ä»£ç å¹¶ä¸ä¼šå‡å°‘ä»£ç é‡ã€‚ä½†æ˜¯ï¼Œåˆ é™¤é‡å¤ä»£ç ä¸€èˆ¬ä¼šæé«˜å¯ç»´æŠ¤æ€§ã€‚ è¦æ³¨æ„ï¼Œä¸è¦åœ¨åˆ é™¤é‡å¤ä»£ç è¿™ä»¶äº‹ä¸Šåšå¾—å¤ªè¿‡åˆ†äº†ï¼Œæ‰€ä»¥è¦çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥è¯´ä»€ä¹ˆã€‚ ç®€æ´çš„ä»£ç æ˜¯å¯é¢„æµ‹å’Œå¯æµ‹è¯•çš„ç¼–å†™å•å…ƒæµ‹è¯•ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå®ƒå·²ç»å‡ ä¹Žå˜æˆå¼ºåˆ¶æ€§çš„ã€‚æ¯•ç«Ÿï¼Œä½ æ€Žæ ·ç¡®ä¿æ–°ç‰¹æ€§æ²¡æœ‰åœ¨æŸäº›åœ°æ–¹å¼•èµ·ä¸€äº› bugsã€‚ è®¸å¤š react å¼€å‘è€…ä¾é é›¶é…ç½®çš„ jest æµ‹è¯•åº“ï¼Œå¹¶äº§å‡ºè¦†ç›–æŠ¥å‘Šã€‚å¦‚æžœä½ å¯¹å‰åŽè§†è§‰å¯¹ç…§æµ‹è¯•æ„Ÿå…´è¶£ï¼Œè¯·å°è¯•ä¸€ä¸‹ ç¾Žå›½è¿é€šå¼€æºçš„ Jest Image Snapshotã€‚ ç®€æ´çš„ä»£ç èƒ½è‡ªæˆ‘è¯´æ˜Žä½ ä¹‹å‰æœ‰é‡åˆ°è¿‡å—ï¼Ÿä½ å†™äº†ä¸€äº›ä»£ç ï¼Œå¹¶ç¡®ä¿å®ƒæ‹¥æœ‰å®Œæ•´çš„æ³¨é‡Šã€‚å°†ä¼šå‘ç”Ÿè¿™æ ·çš„æƒ…å†µï¼Œä½ å‘çŽ°ä¸€ä¸ª bug, æ‰€ä»¥ä½ å›žåŽ»ä¿®æ”¹ä»£ç ã€‚ä½ è¿˜è®°å¾—ä¿®æ”¹æ³¨é‡Šå¹¶å¯¹åº”æ–°çš„é€»è¾‘å—ï¼Ÿä¹Ÿè®¸è®°å¾—ã€‚ä¹Ÿè®¸ä¸è®°å¾—ã€‚ä¸‹ä¸€ä¸ªçœ‹ä½ ä»£ç çš„äººå¯èƒ½å·²ç»æŽ‰è¿›å…”å­æ´žï¼ˆè¢«ç»•è¿›åŽ»äº†ï¼‰å› ä¸ºä»–è¿˜åœ¨çœ‹ä»¥å‰çš„æ³¨é‡Šã€‚ åªç»™å¤æ‚çš„æ€è·¯æ·»åŠ æ³¨é‡Šã€‚ä¸è¦ç»™æ˜¾è€Œæ˜“è§çš„ä»£ç æ·»åŠ æ³¨é‡Šã€‚æ›´å°‘é‡çš„æ³¨é‡Šä¹Ÿæœ‰åˆ©äºŽå‡å°‘è§†è§‰å¹²æ‰°ã€‚ // Dirty const fetchUser = (id) => ( fetch(buildUri`/users/${id}`) // Get User DTO record from REST API .then(convertFormat) // Convert to snakeCase .then(validateUser) // Make sure the the user is valid ); è€Œç®€æ´ç‰ˆï¼Œæˆ‘ä»¬é‡å‘½åå‡½æ•°ä»¥ä¾¿æ›´å¥½åœ°æè¿°ä»–ä»¬æ˜¯åšä»€ä¹ˆçš„ï¼Œå› æ­¤æ¶ˆé™¤äº†æ³¨é‡Šçš„å¿…è¦å¹¶å‡å°‘è§†è§‰å¹²æ‰°ã€‚è¿™é™åˆ¶äº†ä»£ç ä¸Žæ³¨é‡Šä¸åŒ¹é…çš„æ½œåœ¨æ··ä¹±ã€‚ // Clean const fetchUser = (id) => ( fetch(buildUri`/users/${id}`) .then(snakeToCamelCase) .then(validateUser) ); å‘½åçš„é‡è¦æ€§åœ¨æˆ‘å‰é¢çš„æ–‡ç«  å­ç»„ä»¶çš„å‡½æ•°æ˜¯ä¸€ç§åæ¨¡å¼, æˆ‘å¼ºè°ƒäº†å‘½åçš„é‡è¦æ€§ã€‚æˆ‘ä»¬åº”è¯¥ä¸¥è‚ƒæ€è€ƒå˜é‡åã€å‡½æ•°åã€ç”šè‡³æ–‡ä»¶åã€‚ ä¸‹é¢æ˜¯ä¸€äº›æŒ‡å—ï¼š å¸ƒå°”å€¼å˜é‡ã€æˆ–è¿”å›žå¸ƒå°”å€¼çš„å‡½æ•°ï¼Œåº”è¯¥ä»¥ â€œisâ€, â€œhasâ€, â€œshouldâ€ å¼€å¤´ã€‚ // Dirty const done = current >= goal; // Clean const isComplete = current >= goal; å‡½æ•°ååº”è¯¥æè¿°å‡½æ•°çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ€Žæ ·å®žçŽ°è¿™ä¸ªåŠŸèƒ½ã€‚æ¢å¥è¯è¯´ï¼Œä¸è¦åœ¨å‘½åä¸­æš´éœ²å®žçŽ°ç»†èŠ‚ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºä¸çŸ¥é“å“ªä¸€å¤©ä½ å°±ä¼šæ¢ä¸€ç§å®žçŽ°ï¼Œè€Œä½ ä¸åº”è¯¥ä¸ºé‡æž„å®žçŽ°æ–¹å¼è€ŒåŽ»æ›´æ”¹ä¸šåŠ¡ä»£ç ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä»Šå¤©ä½ å¯èƒ½é€šè¿‡ REST API åŠ è½½ä½ çš„é…ç½®ï¼Œä½†å¯èƒ½æ˜Žå¤©ä½ åˆæ”¹æˆç”¨ javascipt å®žçŽ°ã€‚ // Dirty const loadConfigFromServer = () => { ... }; // Clean const loadConfig = () => { ... }; ç®€æ´ä»£ç éµå¾ªæˆç†Ÿçš„è®¾è®¡æ¨¡å¼å’Œæœ€ä½³å®žè·µè®¡ç®—æœºæ™®åŠå¾ˆé•¿æ—¶é—´äº†ã€‚å¤šå¹´æ¥ï¼Œç¨‹åºå‘˜åœ¨è§£å†³æŸäº›é—®é¢˜çš„æ—¶å€™å‘çŽ°æ¨¡å¼ã€‚è¢«ç§°ä¸º è®¾è®¡æ¨¡å¼ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯éšç€æ—¶é—´æŽ¨ç§»è¢«è¯æ˜Žçš„æœ‰ç”¨çš„ç®—æ³•ã€‚ä½ å¯ä»¥ç«™åœ¨è¿™äº›å·¨äººçš„è‚©ä¸Šï¼Œä»¥ä¾¿é¿å…å†çŠ¯è¿™äº›é”™è¯¯ã€‚ ç„¶åŽæœ‰ä¸€äº›æœ€ä½³å®žè·µï¼Œå®ƒä»¬å’Œè®¾è®¡æ¨¡å¼å¾ˆç±»ä¼¼ï¼Œä½†æ›´å¹¿ä¹‰ï¼Œä¸å…·ä½“æŒ‡ç¼–ç ç®—æ³•ã€‚å®ƒä»¬å¯èƒ½æ¶‰åŠåˆ°ç±»ä¼¼â€œä½ åº”è¯¥åœ¨ç¼–ç æ—¶ä½¿ç”¨ lint å·¥å…·â€ æˆ–è€… â€œå½“ä½ å†™ä¸€ä¸ªç±»åº“æ—¶ï¼Œè¯·åŒ…å« react ä½œä¸º peerDependencyâ€ã€‚ å°†å‡½æ•°åŠŸèƒ½ç¼©å°ï¼Œæ¯ä¸€ä¸ªéƒ½èŒè´£å•ä¸€ã€‚è¿™ä¸ªå«åšèŒè´£å•ä¸€åŽŸåˆ™ã€‚ç¡®ä¿æ¯ä¸ªå‡½æ•°åšå¥½å¹¶åªåšä¸€ä»¶äº‹ã€‚æ„æ€æ˜¯ä½ å¯ä»¥å°†ä¸€ä¸ªå¤æ‚çš„ç»„ä»¶æ‹†åˆ†æˆè®¸å¤šå°çš„éƒ¨åˆ†ã€‚è¿™ä¹Ÿä¼šè®©ä»£ç æ›´æ˜“æµ‹è¯•ã€‚ æ³¨æ„æŠ½è±¡æŽ¥å£ã€‚æ¢å¥è¯è¯´ï¼Œä¸è¦å¼ºåˆ¶è®©ä½ çš„ä¸šåŠ¡ä»£ç ä½¿ç”¨ç§æœ‰å˜é‡æˆ–ç§æœ‰æ–¹æ³•ã€‚ éµå¾ªä¸¥æ ¼çš„ linting è§„åˆ™ï¼Œå®ƒä¼šå¸®åŠ©ä½ ç¼–å†™ç®€æ´ã€é£Žæ ¼ç»Ÿä¸€çš„ä»£ç ã€‚ ç®€æ´çš„ä»£ç ä¸ä¸€å®šè¦èŠ±è´¹æ›´é•¿æ—¶é—´æˆ‘å¬åˆ°ç¼–å†™ç®€æ´çš„ä»£ç ä¼šé™ä½Žå·¥ä½œæ•ˆçŽ‡ã€‚çœŸæ˜¯ä¸€æ´¾èƒ¡è¨€ã€‚æ˜¯çš„ï¼Œä¸ºäº†å†²åˆºï¼Œä¸€å¼€å§‹ä½ éœ€è¦æ”¾æ…¢è„šæ­¥ï¼Œä½†æ˜¯å†™äº†å‡ è¡Œä»£ç åŽï¼Œä½ çš„æ­¥ä¼ä¼šè¶Šæ¥è¶Šå¿«ã€‚ å¹¶ä¸”ä¸è¦è€ƒè™‘å°†æ¥å†â€œé‡æž„â€å®ƒï¼Œå¹¶èŠ±æ—¶é—´ä¿®å¤æ¥è‡ª code review çš„è¯„è®ºã€‚å¦‚æžœä½ å°†ä»£ç æ‹†åˆ†æˆå°æ¨¡å—ï¼Œæ¯ä¸ªéƒ½èŒè´£å•ä¸€ï¼Œå¾ˆå¯èƒ½å°†æ¥å¤§éƒ¨åˆ†æ¨¡å—éƒ½ä¸ä¼šç¢°ã€‚è¿™å°±æ˜¯é€šè¿‡â€œå†™ä¸‹å®ƒï¼Œå¿˜äº†å®ƒâ€æ¥äº†çœæ—¶é—´ã€‚ å†—ä½™ä»£ç  VS. ç®€æ´ä»£ç çš„å®žè·µä¾‹å­çœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚ç»§ç»­çœ‹ï¼Œå¹¶è¿”å›žåˆ°å‰é¢æˆ‘æ‰€è®²çš„å†…å®¹ã€‚ä½ æœ‰çœ‹åˆ°ä»€ä¹ˆæ¨¡å¼å—ï¼Ÿæ³¨æ„åˆ° Thingie ç»„ä»¶å’Œ ThingieWithTitle ç»„ä»¶é™¤äº† Title ç»„ä»¶ä¹‹å¤–éƒ½å®Œå…¨ç›¸åŒã€‚è¿™æ»¡è¶³äº† DRY çš„æ¡ä»¶ã€‚ // Dirty import Title from './Title'; export const Thingie = ({ description }) => ( &lt;div class="thingie"> &lt;div class="description-wrapper"> &lt;Description value={description} /> &lt;/div> &lt;/div> ); export const ThingieWithTitle = ({ title, description }) => ( &lt;div> &lt;Title value={title} /> &lt;div class="description-wrapper"> &lt;Description value={description} /> &lt;/div> &lt;/div> ); è¿™é‡Œå…è®¸æˆ‘ä»¬ä¼ é€’ children åˆ° Thingie, ç„¶åŽåˆ›å»ºä¸€ä¸ª ThingieWithTitle åŒ…è£¹ Thingieï¼Œä¼ é€’ Title ä½œä¸ºå®ƒçš„å­èŠ‚ç‚¹ã€‚ // Clean import Title from './Title'; export const Thingie = ({ description, children }) => ( &lt;div class="thingie"> {children} &lt;div class="description-wrapper"> &lt;Description value={description} /> &lt;/div> &lt;/div> ); export const ThingieWithTitle = ({ title, ...others }) => ( &lt;Thingie {...others}> &lt;Title value={title} /> &lt;/Thingie> ); é»˜è®¤å€¼çœ‹ä¸‹é¢çš„ä»£ç æ®µã€‚å®ƒé»˜è®¤ä½¿ç”¨ icon-large ä½œä¸º className çš„å£°æ˜Žå€¼ã€‚ // Dirty const Icon = ({ className, onClick }) => { const additionalClasses = className || 'icon-large'; return ( &lt;span className={`icon-hover ${additionalClasses}`} onClick={onClick}> &lt;/span> ); }; è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ ES6 é»˜è®¤è¯­æ³•ï¼Œç”¨å­—ç¬¦ä¸²æ¥æ›¿æ¢æœªå®šä¹‰çš„å€¼ã€‚è¿™ä¹Ÿå…è®¸æˆ‘ä»¬ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå¹¶æ¶ˆé™¤ return çš„ä½¿ç”¨ã€‚ // Clean const Icon = ({ className = 'icon-large', onClick }) => ( &lt;span className={`icon-hover ${className}`} onClick={onClick} /> ); ä¸‹é¢æ˜¯æ›´ç®€æ´çš„ç‰ˆæœ¬ï¼Œé»˜è®¤å€¼é€šè¿‡ react è®¾ç½®ã€‚ // Cleaner const Icon = ({ className, onClick }) => ( &lt;span className={`icon-hover ${className}`} onClick={onClick} /> ); Icon.defaultProps = { className: 'icon-large', }; ä¸ºä»€ä¹ˆè¿™æ ·æ›´ç®€æ´ï¼Ÿä¸ºä»€ä¹ˆè¿™æ ·æ›´å¥½ï¼Ÿä¸‰ä¸ªç‰ˆæœ¬åšçš„ä¸æ˜¯åŒæ ·ä¸€ä»¶äº‹å—ï¼Ÿå¯¹äºŽå¤§éƒ¨åˆ†æƒ…å†µæ¥è¯´ï¼Œç¡®å®žæ˜¯çš„ã€‚ä½†æ˜¯ï¼Œè®© react è®¾ç½®é»˜è®¤å€¼çš„å¥½å¤„æ˜¯ä¼šäº§ç”Ÿæ›´é«˜æ•ˆçš„ä»£ç ã€‚é»˜è®¤ props åŸºäºŽç±»çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ,åŒæ—¶å…è®¸ä½ ä½¿ç”¨ propTypes æ£€æŸ¥é»˜è®¤å€¼ã€‚ä½†è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼šç®€åŒ–ç»„ä»¶è‡ªèº«çš„é»˜è®¤é€»è¾‘ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼Œåœ¨ä¸€ä¸ªå˜é‡é‡Œå­˜å‚¨æ‰€æœ‰é»˜è®¤çš„ propsã€‚æˆ‘ä¸å»ºè®®ä½ è¿™æ ·åšï¼Œæˆ‘åªæ˜¯è¯´ä½ å¯ä»¥æœ‰è¿™ç§åšæ³•ã€‚ import defaultProps from './defaultProps'; ... Icon.defaultProps = defaultProps.Icon; ä»Ž render å‡½æ•°ä¸­åˆ†ç¦»çŠ¶æ€åœ¨ render å‡½æ•°ä¸­æ··åˆä½ çš„çŠ¶æ€æ•°æ®åŠ è½½é€»è¾‘ä¼šè®©ç»„ä»¶å˜å¾—æ›´å¤æ‚ã€‚ç›¸åï¼Œå†™ä¸€ä¸ªèŒè´£å•ä¸€çš„çŠ¶æ€å®¹å™¨ç»„ä»¶åŽ»åŠ è½½æ•°æ®ã€‚ç„¶åŽç”¨å¦ä¸€ä¸ªèŒè´£å•ä¸€çš„ç»„ä»¶åŽ»æ˜¾ç¤ºæ•°æ®ã€‚è¿™å«åš å®¹å™¨æ¨¡å¼ã€‚ ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œç”¨æˆ·æ•°æ®åœ¨åŒä¸€ä¸ªç»„ä»¶ä¸­åŠ è½½å’Œæ˜¾ç¤ºã€‚ // Dirty class User extends Component { state = { loading: true }; render() { const { loading, user } = this.state; return loading ? &lt;div>Loading...&lt;/div> : &lt;div> &lt;div> First name: {user.firstName} &lt;/div> &lt;div> First name: {user.lastName} &lt;/div> ... &lt;/div>; } componentDidMount() { fetchUser(this.props.id) .then((user) => { this.setState({ loading: false, user })}) } } åœ¨ç®€æ´ç‰ˆæœ¬ï¼Œå…³æ³¨ç‚¹ â€”â€” æ•°æ®åŠ è½½ï¼Œæ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼Œå’Œæ˜¾ç¤ºæ•°æ®è¢«åˆ†ç¦»äº†ã€‚ä¸ä»…è®©ä»£ç æ›´å®¹æ˜“ç†è§£ã€‚è€Œä¸”å¾ˆå®¹æ˜“ç‹¬ç«‹åœ°æµ‹è¯•æ¯ä¸ªå…³æ³¨ç‚¹ã€‚åŒæ—¶ RenderUser æ˜¯ä¸€ä¸ªæ— çŠ¶æ€ç»„ä»¶ã€‚ç»“æžœæ˜¯å¯é¢„æµ‹çš„ã€‚ // Clean import RenderUser from './RenderUser'; class User extends Component { state = { loading: true }; render() { const { loading, user } = this.state; return loading ? &lt;Loading /> : &lt;RenderUser user={user} />; } componentDidMount() { fetchUser(this.props.id) .then(user => { this.setState({ loading: false, user })}) } } ä½¿ç”¨æ— çŠ¶æ€ç»„ä»¶ SFCæ— çŠ¶æ€ç»„ä»¶ï¼ˆSFCï¼‰åœ¨ React v0.14.0 çš„æ—¶å€™è¢«æŽ¨å‡ºã€‚å®ƒä»¬è¢«ç”¨æ¥å¤§å¤§ç®€åŒ–ä¸€ä¸ªä»…ç”¨äºŽæ¸²æŸ“çš„ç»„ä»¶ã€‚ä½†å¾ˆå¤šå¼€å‘è€…è¿˜æ²¡æœ‰æ”¾ä¸‹è¿‡åŽ»ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢è¿™ä¸ªç»„ä»¶å…·å¤‡è½¬æ¢æˆ SFC çš„æ¡ä»¶ã€‚ // Dirty class TableRowWrapper extends Component { render() { return ( &lt;tr> {this.props.children} &lt;/tr> ); } } ç®€æ´ç‰ˆæ¸…ç†äº†å¾ˆå¤šå†—ä½™ç‰ˆæœ¬çš„å¹²æ‰°çš„ä¸œè¥¿ã€‚é€šè¿‡ react çš„æ ¸å¿ƒä¼˜åŒ–ï¼Œæœ‰å¯èƒ½ä½¿ç”¨æ›´å°‘çš„å†…å­˜ï¼Œæ²¡æœ‰å®žä¾‹è¢«åˆ›å»ºã€‚ // Clean const TableRowWrapper = ({ children }) => ( &lt;tr> {children} &lt;/tr> ); Rest/spread (â€¦æ“ä½œç¬¦)å¤§çº¦ä¸€å¹´å‰ï¼Œåœ¨æˆ‘å¿ƒä¸­ Object.assign å°†ä¼šå˜æˆæ¯ä¸ªäººæœ€å¥½çš„æ–°æœ‹å‹ã€‚ä½†æ˜¯ï¼Œæ—¶ä»£å˜äº†ï¼ŒES2016/ES7 çš„ rest/spread spec æ¥äº†ã€‚ çœ‹ä¸€ä¸ªç»™ç»„ä»¶ä¼ é€’ props çš„æ¡ˆä¾‹ã€‚ä½ æƒ³åœ¨ç»„ä»¶å†…ä½¿ç”¨ classNameï¼Œä½†æŠŠå‰©ä½™çš„ props ä¼ é€’ç»™å­ç»„ä»¶ã€‚ä½ å¯èƒ½ä¼šè¿™æ ·åšã€‚ // Dirty const MyComponent = (props) => { const others = Object.assign({}, props); delete others.className; return ( &lt;div className={props.className}> {React.createElement(MyOtherComponent, others)} &lt;/div> ); }; ä¸å¤Ÿä¼˜é›…ï¼Œä¸æ˜¯ä¹ˆï¼Ÿä½†ä½¿ç”¨ rest/spread, å°±åƒçœ‹åˆ°ä¸€å—è›‹ç³•ä¸€æ ·ã€‚ // Clean const MyComponent = ({ className, ...others }) => ( &lt;div className={className}> &lt;MyOtherComponent {...others} /> &lt;/div> ); é€‚æ—¶ä½¿ç”¨è§£æž„ES6 æœ‰ä¸€ä¸ªæ¦‚å¿µå« destructureè§£æž„èµ‹å€¼ã€‚å®ƒå…è®¸ä½ å–å‡º object æˆ– array é‡Œçš„æŸä¸ªå€¼ã€‚ object destructuring å¯¹è±¡è§£æž„æ¯”å¦‚ï¼Œç»™ componentWillReceiveProps ä¼ é€’äº† newPropsï¼Œæˆ‘ä»¬ç»™ state.active è®¾ç½®ä¸€ä¸ªæ–°çš„ active å€¼ã€‚ // Dirty componentWillReceiveProps(newProps) { this.setState({ active: newProps.active }); } åœ¨ç®€æ´ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å°†è§£æž„ newProps é‡Œçš„ activeï¼Œ ä¸ä»…ä¸å†éœ€è¦å¼•ç”¨ newProps.active, è€Œä¸”å¯ä»¥åªä½¿ç”¨å¯¹è±¡ä¸­çš„å±žæ€§å setState: // Clean componentWillReceiveProps({ active }) { this.setState({ active }); } array destructuring æ•°ç»„è§£æž„ç»å¸¸å¿½è§† ES6 çš„æ•°ç»„è§£æž„ç‰¹æ€§ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œå®ƒä»Ž local å–å‡ºä¸€ä¸ªå€¼,æ¯”å¦‚ â€œes-USâ€, æ‹†åˆ†å¹¶èµ‹å€¼ç»™ language(en) å’Œ country(US) // Dirty const splitLocale = locale.split('-'); const language = splitLocale[0]; const country = splitLocale[1]; // Clean const [language, country] = locale.split('-'); æ€»ç»“æˆ‘å¸Œæœ›æˆ‘è®©ä½ çœ‹åˆ°ç¼–å†™ç®€æ´ä»£ç çš„å¥½å¤„ï¼Œå¹¶å¯ä»¥åº”ç”¨è¿™é‡Œå‘ˆçŽ°çš„å®žé™…ä¾‹å­ã€‚ä¸€æ—¦ä½ æ‹¥æŠ±ç®€æ´ä»£ç ï¼Œå®ƒå°†æˆä¸ºä½ çš„ç¬¬äºŒå¤©æ€§ã€‚ä½ å’Œæœªæ¥çš„ä½ å°†ä¼šæ„Ÿæ¿€â€œå†™ä¸‹å®ƒï¼Œå¿˜äº†å®ƒâ€çš„ç”Ÿæ´»æ–¹å¼ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>best practices</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dynamic import() ä¸Ž é™æ€ import ç›¸æ¯”è¾ƒï¼Œæœ‰å“ªäº›ä¸åŒ]]></title>
    <url>%2F2017%2F11%2F27%2Fdynamic-import.html</url>
    <content type="text"><![CDATA[Dynamic import() æœ‰å“ªäº›ç‰¹ç‚¹ Dynamic import() å·²è¢« Chrome 63 å’Œ Safari Technology Preview 24 æ”¯æŒã€‚ Dynamic import() é‡‡ç”¨ ç±»å‡½æ•° çš„æ–¹æ³•æ¥å¡‘é€  importï¼Œç›¸æ¯” static import è§£é”äº†æ–°åŠŸèƒ½ã€‚è¿™ç¯‡æ–‡ç« å¯¹æ¯”äº†ä¸¤è€…å¹¶æ¦‚è§ˆæ–°åŠŸèƒ½ã€‚ Static importï¼ˆæ¦‚æ‹¬ï¼‰ä¹æœˆä»½ï¼ŒChrome 61 å‘å¸ƒå¹¶æ”¯æŒåœ¨ modules ä¸­ä½¿ç”¨ ES2015 import å£°æ˜Žã€‚ ä»”ç»†çœ‹ä¸‹é¢è¿™ä¸ªæ¨¡å—ï¼Œä½äºŽ ./utils.mjs: // Default export export default () => { console.log('Hi from the default export!'); }; // Named export `doStuff` export const doStuff = () => { console.log('Doing stuffâ€¦'); }; ä¸‹é¢æ˜¯ä½¿ç”¨ é™æ€ import å¼•å…¥ ./utils.mjs æ¨¡å—ï¼š import * as module from './utils.mjs'; module.default(); // â†’ logs 'Hi from the default export!' module.doStuff(); // â†’ logs 'Doing stuffâ€¦' æ³¨æ„ï¼š ä¸Šé¢è¿™ä¸ªä¾‹å­ä½¿ç”¨ .mjs æ¥æ ‡è¯†è¿™æ˜¯ä¸€ä¸ªæ¨¡å—æ–‡ä»¶è€Œä¸æ˜¯æ™®é€šè„šæœ¬ã€‚åœ¨ç½‘é¡µç«¯ï¼Œæ–‡ä»¶æ‰©å±•åå¹¶ä¸æ˜¯é—®é¢˜ï¼Œåªè¦æœåŠ¡ç«¯è®¾ç½®äº†æ­£ç¡®çš„ MIME ç±»åž‹ï¼ˆæ¯”å¦‚ç»™ javascript æ–‡ä»¶è®¾ç½® Content-Type:text/javascriptï¼‰åœ¨ HTTP headerã€‚.mjs åœ¨å…¶ä»–ä¸€äº›å¹³å°ä¸Šç‰¹åˆ«æœ‰ç”¨ï¼Œå¦‚ Node.js è¿™ç±»æ²¡æœ‰ MIME ç±»åž‹æˆ–å…¶ä»– Hooks å¦‚ type=â€moduleâ€ æ¥ç¡®å®šæ¨¡å—æˆ–æ™®é€šè„šæœ¬ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ç›¸åŒçš„æ‰©å±•åæ¥ä¿æŒè·¨å¹³å°çš„ä¸€è‡´æ€§ï¼Œå¹¶æ¸…æ¥šåœ°åŒºåˆ†æ¨¡å—å’Œæ™®é€šè„šæœ¬ã€‚ è¿™ä¸ªå¯¼å…¥æ¨¡å—çš„è¯­æ³•å½¢å¼æ˜¯ é™æ€ å£°æ˜Žï¼šå®ƒåªæŽ¥å—å­—ç¬¦ä¸²ä½œä¸ºæ¨¡å—æ ‡è¯†ç¬¦ï¼Œå¹¶é€šè¿‡è¿è¡Œå‰çš„ â€œlinkingâ€ è¿‡ç¨‹å°†æ¨¡å—ç»‘å®šåˆ°æœ¬åœ°ä½œç”¨åŸŸã€‚é™æ€ import è¯­æ³•åªèƒ½ç”¨äºŽæ–‡ä»¶é¡¶éƒ¨ã€‚é™æ€import æ”¯æŒä¸€äº›é‡è¦çš„ç”¨ä¾‹ï¼Œå¦‚ï¼šstatic analysis, bundling tools, å’Œ tree-shakingã€‚ åœ¨ä¸€äº›æ¡ˆä¾‹ä¸­ï¼Œä¸‹é¢è¿™äº›ç‰¹æ€§ä¼šéžå¸¸æœ‰ç”¨ï¼š è¯·æ±‚æ—¶å¯¼å…¥æ¨¡å—ï¼ˆæˆ–æœ‰æ¡ä»¶åœ°ï¼‰ è¿è¡Œæ—¶è®¡ç®—æ¨¡å—æ ‡è¯†ç¬¦ åœ¨æ™®é€šè„šæœ¬ä¸­å¯¼å…¥æ¨¡å—ï¼ˆè€Œä¸æ˜¯åœ¨æ¨¡å—ä¸­å¯¼å…¥ï¼‰ ä½†æ˜¯è¿™äº›ç”¨ é™æ€ import éƒ½æ— æ³•åšåˆ°ã€‚ Dynamic import() ðŸ”¥Dynamic import() é‡‡ç”¨ ç±»å‡½æ•° çš„æ–¹æ³•æ¥å¡‘é€ æ»¡è¶³è¿™äº›ç”¨ä¾‹çš„ importã€‚import(moduleSpecifier) ä¸ºè¯·æ±‚æ¨¡å—çš„æ¨¡å—åç§°ç©ºé—´è¿”å›žä¸€ä¸ª promiseã€‚å®ƒæ˜¯åœ¨èŽ·å–ï¼Œå®žä¾‹åŒ–å’Œè¯„ä¼°æ¨¡å—çš„æ‰€æœ‰ä¾èµ–å…³ç³»ä¹‹åŽåˆ›å»ºçš„ï¼Œæ¨¡å—æœ¬èº«ä¹Ÿæ˜¯ã€‚ ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨ åŠ¨æ€ importï¼Œå¹¶ä½¿ç”¨ ./utils.mjs æ¨¡å—ï¼š const moduleSpecifier = './utils.mjs'; import(moduleSpecifier) .then((module) => { module.default(); // â†’ logs 'Hi from the default export!' module.doStuff(); // â†’ logs 'Doing stuffâ€¦' }); æ³¨æ„ï¼š å°½ç®¡ import() çœ‹èµ·æ¥åƒä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œä½†å®ƒåªæ˜¯æ°å¥½è¢«è§„å®šä¸ºä½¿ç”¨æ‹¬å·çš„ä¸€ç§ è¯­æ³• ï¼ˆç±»ä¼¼äºŽ super()ï¼‰ã€‚è¿™æ„å‘³ç€ import ä¸ä¼šç»§æ‰¿ Function.prototype ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ call å’Œ applyã€‚åƒ const importAlias = import è¿™æ ·çš„ä»£ç ä¹Ÿä¸èƒ½è¿è¡Œ â€”â€” import ç”šè‡³ä¸æ˜¯ä¸€ä¸ª object å¯¹è±¡ï¼ä½†æ˜¯è¿™åœ¨å®žè·µä¸­å¹¶ä¸é‡è¦ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ä¸€ä¸ªå°åž‹å•é¡µåº”ç”¨çš„å¯¼èˆªä¸Šä½¿ç”¨ åŠ¨æ€ import() å¯ç”¨æ‡’åŠ è½½æ¨¡å—ï¼š &lt;!DOCTYPE html> &lt;meta charset="utf-8"> &lt;title>My library&lt;/title> &lt;nav> &lt;a href="books.html" data-entry-module="books">Books&lt;/a> &lt;a href="movies.html" data-entry-module="movies">Movies&lt;/a> &lt;a href="video-games.html" data-entry-module="video-games">Video Games&lt;/a> &lt;/nav> &lt;main>This is a placeholder for the content that will be loaded on-demand.&lt;/main> &lt;script> const main = document.querySelector('main'); const links = document.querySelectorAll('nav > a'); for (const link of links) { link.addEventListener('click', async (event) => { event.preventDefault(); try { const module = await import(`/${link.dataset.entryModule}.mjs`); // The module exports a function named `loadPageInto`. module.loadPageInto(main); } catch (error) { main.textContent = error.message; } }); } &lt;/script> å½“æ­£ç¡®ä½¿ç”¨ åŠ¨æ€ import() å¼€å¯æ‡’åŠ è½½åŠŸèƒ½æ—¶å°†ä¼šéžå¸¸å¼ºå¤§ã€‚ä¸ºäº†æ¼”ç¤ºç›®çš„ï¼ŒAddy ä¿®æ”¹äº†ä¸€ä¸ª Hacker News PWA ç¤ºä¾‹ï¼Œåœ¨é¦–æ¬¡åŠ è½½æ—¶é™æ€åœ°å¯¼å…¥æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…æ‹¬è¯„è®ºã€‚å‡çº§ç‰ˆ ä½¿ç”¨ åŠ¨æ€ import()å»¶è¿ŸåŠ è½½è¯„è®ºï¼Œé¿å…åŠ è½½ï¼Œè§£æžå’Œç¼–è¯‘æˆæœ¬ï¼Œç›´åˆ°ç”¨æˆ·ç¡®å®žéœ€è¦å®ƒä»¬ã€‚ å»ºè®®é™æ€ import å’ŒåŠ¨æ€ import() éƒ½å¾ˆæœ‰ç”¨ã€‚å®ƒä»¬éƒ½æœ‰å„è‡ªçš„ç‰¹ç‚¹å’Œä½¿ç”¨åœºæ™¯ã€‚ä½¿ç”¨é™æ€ import æ¥åˆå§‹ç»˜åˆ¶ä¾èµ–å…³ç³»ï¼Œå°¤å…¶æ˜¯é¦–å±å†…å®¹ã€‚å¦ä¸€ç§æƒ…å†µï¼Œè€ƒè™‘åˆ°æŒ‰éœ€åŠ è½½åˆ™ä½¿ç”¨åŠ¨æ€ import()ã€‚ è¯‘è€…æ³¨ï¼š static import æ˜¯æ²¡æœ‰æ‹¬å·çš„ï¼Œdynamic import() æ˜¯å¸¦æ‹¬å·çš„ã€‚ä¸æ³¨æ„çš„å¯èƒ½ä¼šæ··æ·†ã€‚ç”¨æ³•çš„åŒºåˆ«ï¼š static import: import $ from 'jquery' æœ‰å£°æ˜Žæå‡ï¼Œä¸€èˆ¬åªæ”¾åœ¨å¤´éƒ¨ä½ç½® dynamic import(): const $ = import('jquery') å¯ä»¥æ”¾åœ¨ä»»ä½•ä½ç½®]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>dynamic import</tag>
        <tag>es6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ react 16 portal åšä¸€äº›å¾ˆé…·çš„äº‹æƒ…]]></title>
    <url>%2F2017%2F11%2F16%2Fusing-a-react-16-portal-to-do-something-cool.html</url>
    <content type="text"><![CDATA[React 16 å·²ç»å‘å¸ƒäº†ï¼Œå…¶ä¸­ä¸€ä¸ªå¾ˆæœ‰è¶£çš„æ˜¯æ·»åŠ äº† â€œPortalsâ€ã€‚ Portals å¯ä»¥è®©ä½ åœ¨çˆ¶ç»„ä»¶å¤–æ¸²æŸ“ react å—æŽ§ DOM èŠ‚ç‚¹ã€‚react doc ä¹Ÿä½¿ç”¨äº†ä¸€ä¸ªæ¨¡æ€æ¡†çš„ä¾‹å­å¾ˆå¥½åœ°è§£é‡Šäº†å®ƒã€‚ç”¨ä¹Ÿåš tooltips ä¹Ÿå¾ˆåˆé€‚ï¼ˆè¿™æ˜¯æˆ‘æ—©å‰åšçš„ä¸€ä¸ªä¾‹å­ï¼‰ã€‚ ä½†è¿™äº›éƒ½å¹¶ä¸æ˜¯å¾ˆæœ‰è¶£ï¼Œè®©æˆ‘ä»¬åšä¸€äº›æ›´ä¸å¯æ€è®®çš„äº‹æƒ…â€¦ å› ä¸ºæ‰€æœ‰ portal åšçš„ï¼Œéƒ½æ˜¯å°†ä¸€ä¸ªå…ƒç´ æ”¾åˆ°å…¶ä»–å…ƒç´ ä¸Šï¼Œä½ å¹¶æ²¡æœ‰è¢«é™åˆ¶æ”¾åœ¨ å½“å‰ document çš„ä»»ä½•åœ°æ–¹ã€‚ä½ å¯ä»¥æ·»åŠ åˆ°å¦ä¸€ä¸ª document çš„ body ä¸­ï¼Œå¯èƒ½æ˜¯å®Œå…¨ä¸åŒæµè§ˆå™¨çª—å£çš„ä¸€ä¸ª documentã€‚ ä¸‹é¢æˆ‘æœ‰ä¸€ä¸ªåŸºæœ¬çš„é¡µé¢ï¼ˆå·¦è¾¹ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ªè®¡æ•°å™¨åŠæ·±çº¢è‰²æŒ‰é’®ã€‚å¦ä¸€ä¸ªçª—å£ï¼ˆå³è¾¹ï¼‰åŒæ ·æ˜¯ react app çš„ä¸€éƒ¨åˆ†ã€‚ å³è¾¹çš„çª—å£æ˜¯å±žäºŽ åŒä¸€ä¸ª React app è¿™ä¸ªäº‹å®žåº”è¯¥è®©ä½ æ„Ÿåˆ°æƒŠè®¶ã€‚ ä¸Šé¢å›¾ç‰‡ä¸­èƒ½çœ‹åˆ°çš„æ‰€æœ‰ä¸œè¥¿ï¼ˆé™¤äº†æ ‘ï¼‰éƒ½æ˜¯åœ¨ä¸‹é¢ä»£ç å±•ç¤ºçš„åŒä¸€ä¸ªç»„ä»¶ä¸­ï¼š ä½ å·²ç»æˆåŠŸäº†ï¼Œ æœ‰ä¸€ç‚¹ç‰¹æ®Šï¼Œé‡Œé¢çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè¢«æ¸²æŸ“åˆ°å¦ä¸€ä¸ª window ä¸‹ã€‚ å°¤å…¶æ˜¯ï¼Œ åšäº†ä¸¤ä»¶äº‹ã€‚ 1ã€ å½“ç»„ä»¶æ¸²æŸ“æ—¶æ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨çª—å£ã€‚ 2ã€ åˆ›å»ºä¸€ä¸ª portal å¹¶å°† props.children æ·»åŠ åˆ°æ–°çª—å£çš„ bodyã€‚ è¿™ä¸æ˜¯æœ€é…·çš„äº‹æƒ…å—ï¼Ÿ æˆ‘æ˜¯å¤šä¹ˆå…´å¥‹ï¼Œå¿…é¡»å¾—å†·é™ä¸€ä¸‹ã€‚ â€¦ I saw a duck! â€¦ ä¸Šé¢æåˆ°çš„ bodyä¸­çš„ç»„ä»¶å°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚ React 16 æ–°å¢žçš„éƒ¨åˆ† ReactDOM.createPortal åœ¨ 11 è¡Œ â€”â€” é‚£å°±æ˜¯é»‘é­”æ³•ã€‚ é‚£æœ‰æ„ä¹‰å—ï¼Ÿç»„ä»¶å¹¶æ²¡æœ‰è¿”å›žä»€ä¹ˆï¼Œåªæ˜¯åšäº†ä¸€äº›å…¶ä»–äº‹æƒ…ã€‚ æ¢ä¸€ä¸ªè§’åº¦æ¥æƒ³å¯èƒ½æ˜¯è¿™æ ·çš„ï¼šæŒ‰ç†æ¥è¯´ï¼Œä¸€ä¸ªçˆ¶ç»„ä»¶å¯¹å­ç»„ä»¶è¯´ï¼šâ€œå˜¿ï¼Œæ¸²æŸ“ DOMï¼Œ ç„¶åŽæŠŠç»“æžœæ·»åŠ åˆ°æˆ‘è¿™é‡Œã€‚â€ï¼Œç„¶åŽå­ç»„ä»¶ç…§åšäº†ã€‚ä½†æ˜¯è¿™æ¬¡ï¼Œä»»æ€§çš„å­ç»„ä»¶è¯´ï¼Œâ€œä¸ï¼æˆ‘è¦å°†ä¸œä¸œæ¸²æŸ“åˆ°å¦ä¸€ä¸ªçª—å£ï¼Œç„¶åŽå†™ä¸€ç¯‡å…³äºŽå®ƒçš„åšå®¢ã€‚â€ çŽ°åœ¨ï¼Œæˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆã€‚ ä½ æœ‰ç‚¹æ¸´ï¼Œå¹¶ä¸”æƒ³çŸ¥é“ä½ æ˜¯å¦è¯¥å–ç‚¹æ°´äº†ã€‚æ˜¯çš„ï¼ŒåŽ»å§ã€‚ å¦ä¸€ä»¶ä½ å¯èƒ½åœ¨æƒ³çš„äº‹æƒ…æ˜¯ï¼šå°†ä¸€äº› DOM æ³¨å…¥åˆ°æ— æ ·å¼çš„ç©ºç™½çª—å£æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå¯èƒ½ Craigslist æˆ– Wikipedia ä¹Ÿä¸çŸ¥é“ã€‚ä½†ä½ çš„ç½‘ç«™å¾ˆç¾Žï¼Œä»»ä½•æ—¶å€™éƒ½ä¸èƒ½å¼¹å‡ºå°çª—å£ã€‚ å¥½å§ï¼Œå¥½æ¶ˆæ¯æ¥äº†ï¼Œå¤§å®¶æ³¨æ„äº†ï¼ èµ·åˆï¼Œæˆ‘è¿˜åœ¨æƒ³æ˜¯å¦æœ‰ä¸€ä¸ªç®€å•çš„æ–¹å¼å°†æ ·å¼å¤åˆ¶åˆ°æ–°çª—å£ã€‚ç„¶åŽæˆ‘æƒ³èµ·æˆ‘çš„ç”Ÿæ´»åªæ˜¯è¢«ä¸€äº›æ¯«æ— æ„ä¹‰çš„äº‹ä»¶å¡«å……ï¼Œå®ƒä»¬å”¯ä¸€çš„ç›®çš„åªæ˜¯è®©æˆ‘åˆ†å¿ƒï¼Œé˜»æ­¢æˆ‘å†…å¿ƒçš„ç©ºè™šå¯‚å¯žå†·ã€‚ æ‰€ä»¥äº²è‡ªå†™è¿™ä¸ªå‡½æ•°å°±æ˜¯ä¹è¶£ï¼ çœ‹ä¸‹é¢ï¼š äº‹å®žä¸Šï¼Œæˆ‘å¹¶ä¸æ˜¯å¾ˆäº†è§£ styleSheetã€‚æˆ‘æœŸå¾…ä»Žè¯„è®ºä¸­å¾—çŸ¥æœ‰ä»€ä¹ˆå¥‡æŠ€æ·«å·§ã€‚ çŽ°åœ¨æˆ‘å¯ä»¥åœ¨æ‰“å¼€æ–°çª—å£çš„æ—¶å€™å¾ˆç®€å•åœ°å¤åˆ¶æ ·å¼ï¼Œåƒè¿™æ ·ï¼š See the Pen React Portal Chat Window by David Gilbertson (@davidgilbertson) on CodePen. æˆ‘ä¸è®¤ä¸ºè¿™èƒ½åœ¨ Medium app çš„ iOS/Android å¹³å°ä¸Šè¿è¡Œï¼Œæ‰€ä»¥è¯·åœ¨æµè§ˆå™¨æ‰“å¼€ã€‚ å¥½äº†ï¼Œæˆ‘è®¤ä¸ºè¿™ç¯‡æ–‡ç« è¯¥ç»“æŸäº†ã€‚ Bye!]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>portal</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react ç»„ä»¶è®¾è®¡æ¨¡å¼]]></title>
    <url>%2F2017%2F11%2F09%2Freact-component-patterns.html</url>
    <content type="text"><![CDATA[react component æ¨¡å¼ æœ‰çŠ¶æ€ç»„ä»¶ï¼ˆStatefulï¼‰å’Œæ— çŠ¶æ€ç»„ä»¶ï¼ˆStatelessï¼‰ã€å®¹å™¨ç»„ä»¶ï¼ˆContainerï¼‰ä¸Žå±•ç¤ºç»„ä»¶ï¼ˆPresentationalï¼‰ã€é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ã€æ¸²æŸ“å›žè°ƒï¼ˆRender Callbacksï¼‰ç­‰ æˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨ React æœ‰ä¸€æ®µæ—¶é—´äº†â€”â€”ä¸€ä¸ª facebook ä½¿ç”¨ js æ¸²æŸ“ç”¨æˆ·ç•Œé¢çš„æ¡†æž¶â€”â€”åˆšå¼€å§‹çš„æ—¶å€™æˆ‘æƒ³çŸ¥é“ä¸€äº›æ¦‚å¿µã€‚è¿™äº›æ–‡å­—æ˜¯å°è¯•æ€»ç»“æˆ‘å®žè·µè¿™ä¹ˆä¹…ä»¥æ¥å­¦åˆ°çš„ä¸€äº›æ¨¡å¼â€”â€”å¯èƒ½å¯¹äºŽåˆšå¼€å§‹è¿›å…¥ç»„ä»¶ä¸–ç•Œçš„å¼€å‘è€…æœ‰ç”¨ã€‚ æœ‰çŠ¶æ€(Stateful) ä¸Ž æ— çŠ¶æ€(Stateless) ç»„ä»¶å°±åƒæœ‰çŠ¶æ€å’Œæ— çŠ¶æ€çš„ web æœåŠ¡ä¸€æ ·ï¼Œ React ç»„ä»¶ä¹Ÿèƒ½åœ¨ç”¨æˆ·ä½¿ç”¨æ—¶ä¿å­˜å’Œæ“ä½œçŠ¶æ€ï¼ˆæœ‰çŠ¶æ€ï¼‰ã€‚æˆ–åªæ˜¯ä¸€ä¸ªç®€å•çš„ç»„ä»¶ï¼ŒæŒ‰å— props å¹¶è¿”å›žéœ€è¦æ˜¾ç¤ºçš„å†…å®¹ï¼ˆæ— çŠ¶æ€ï¼‰ã€‚ ä¸€ä¸ªç®€å•çš„ æ— çŠ¶æ€ æŒ‰é’®ç»„ä»¶åªæŽ¥å— props: è€Œä¸‹é¢æ˜¯ä¸€ä¸ª æœ‰çŠ¶æ€ çš„è®¡æ•°ç»„ä»¶ï¼ˆä½¿ç”¨äº† Button ç»„ä»¶ï¼‰ï¼š å°±åƒä½ æ‰€çœ‹åˆ°çš„ï¼Œæœ€åŽä¸€ä¸ªç»„ä»¶çš„ constructor ä¿æŒäº†ä¸€ä¸ªç»„ä»¶çš„ state, è€Œç¬¬ä¸€ä¸ªç»„ä»¶åˆ™æ˜¯ä¸€ä¸ªç®€å•ç»„ä»¶ï¼Œåªé€šè¿‡ props æ¸²æŸ“äº†æ–‡å­—ã€‚è¿™ä¸ªå…³æ³¨åˆ†ç¦»å¯èƒ½éžå¸¸ç®€å•ï¼Œä½†æ˜¯è®© Button ç»„ä»¶é«˜åº¦å¤ç”¨ã€‚ å®¹å™¨(Container) ä¸Ž å±•ç¤º(Presentational) ç»„ä»¶å½“ä½¿ç”¨å¤–éƒ¨æ•°æ®è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªç»„ä»¶åˆ†æˆè¿™ä¸¤ä¸ªæ–°ç±»åˆ«ã€‚å®¹å™¨ç»„ä»¶ è´Ÿè´£èŽ·å–æ•°æ®ï¼Œå­˜åœ¨åœ¨ react ä½œç”¨åŸŸå¤–éƒ¨ï¼Œå°±åƒè¿žæŽ¥ Redux æˆ– Relay â€”â€”â€”â€” è€Œ å±•ç¤ºç»„ä»¶ åˆ™ä¸ä¾èµ– react åº”ç”¨çš„å…¶ä»–éƒ¨åˆ†ï¼Œä»…ä»…å–å†³äºŽå®ƒè‡ªèº«çš„ state å’ŒæŽ¥æ”¶çš„ propsã€‚è®©æˆ‘ä»¬æ‹¿ç”¨æˆ·åˆ—è¡¨ä½œä¸ºå±•ç¤ºç»„ä»¶çš„ä¾‹å­ï¼š è¿™ä¸ªåˆ—è¡¨å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ å®¹å™¨ç»„ä»¶ æ›´æ–°ï¼š è¿™ç§æ–¹æ³•å°†æ•°æ®èŽ·å–ä¸Žæ¸²æŸ“åˆ†ç¦»ï¼ŒåŒæ—¶è®© UserList é«˜åº¦å¤ç”¨ã€‚å¦‚æžœä½ æƒ³è¿›ä¸€æ­¥å­¦ä¹ è¿™ç§æ¨¡å¼ï¼Œè¿™é‡Œæœ‰ä¸€ç¯‡æ–‡ç« è§£é‡Šåœ°å¾ˆå¥½ã€‚ é«˜é˜¶ç»„ä»¶é«˜é˜¶ç»„ä»¶â€”â€”â€”â€”æˆ–å« HOCã€‚å½“ä½ æƒ³è¦é‡ç”¨é€»è¾‘çš„æ—¶å€™éžå¸¸æ„Ÿå…´è¶£ã€‚ä»–ä»¬æ˜¯ javascript å‡½æ•°ï¼Œå°†ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›žæ–°ç»„ä»¶ã€‚ å‡è®¾ä½ éœ€è¦åšä¸€ä¸ªå¯ä¼¸ç¼©çš„çš„èœå•ç»„ä»¶ï¼Œå½“ç”¨æˆ·ç‚¹çš„æ—¶å€™ï¼Œå±•ç¤ºå®ƒé‡Œé¢çš„å†…å®¹ã€‚æ‰€ä»¥ï¼Œä¸ºäº†æ›¿ä»£åœ¨çˆ¶çº§ç»„ä»¶ä¸ŠæŽ§åˆ¶ stateï¼Œä½ å¯ä»¥ç®€å•åœ°åˆ›å»ºä¸€ä¸ªé€šç”¨çš„ é«˜é˜¶ç»„ä»¶ æ¥å¤„ç†å®ƒï¼š è¿™ç§æ–¹å¼å…è®¸æˆ‘ä»¬å°†é€»è¾‘åº”ç”¨é€šè¿‡è£…é¥°æ¨¡å¼ï¼ˆdecoratorï¼‰åº”ç”¨åœ¨ ToggleableMenu ç»„ä»¶ä¸Šã€‚ çŽ°åœ¨æˆ‘ä»¬å¯ä»¥ä»»æ„ä¼ é€’å­çº§åˆ° ToggleableMenu ç»„ä»¶äº†ï¼š å¦‚æžœä½ ç†Ÿæ‚‰ä½¿ç”¨ redux çš„ connect æˆ– react router çš„ withRouter å‡½æ•°ï¼Œé‚£ä½ å·²ç»åœ¨ç”¨ HOCs äº†ã€‚ æ¸²æŸ“å›žè°ƒï¼ˆRender Callbacksï¼‰å¦ä¸€ç§è®©ç»„ä»¶é€»è¾‘å¤ç”¨çš„å¾ˆæ£’çš„æ–¹æ³•æ˜¯ å°†ç»„ä»¶å­çº§è½¬æ¢æˆå‡½æ•°ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ æ¸²æŸ“å›žè°ƒï¼ˆRender Callbacksï¼‰ ä¹Ÿå«ä½œ Function as Child Componentsã€‚æˆ‘ä»¬å¯ä»¥æ‹¿å¯ä¼¸å±•çš„èœå•é«˜é˜¶ç»„ä»¶ä½œä¸ºä¾‹å­ï¼Œå¹¶ä½¿ç”¨ æ¸²æŸ“å›žè°ƒ é‡å†™å®ƒã€‚ çŽ°åœ¨æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°ä½œä¸º Toggleable çš„å­ç»„ä»¶ï¼š ä¸Šé¢çš„ä»£ç å·²ç»ä½¿ç”¨å‡½æ•°ä½œä¸ºå­çº§ï¼Œä½†ï¼Œå¦‚æžœæˆ‘ä»¬æƒ³è¦åƒé«˜é˜¶ç»„ä»¶çš„ä¾‹å­é‚£æ ·å¤ç”¨å®ƒï¼ˆå¤šä¸ªèœå•ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ Toggleable é€»è¾‘åˆ›å»ºä¸€ä¸ªæ–°ç»„ä»¶ï¼š æˆ‘ä»¬çš„æ–°äº§å“ ToggleableMenu ç»„ä»¶å·²ç»å‡†å¤‡å¥½äº†ï¼š è¿™ç§æ–¹å¼çœŸçš„éžå¸¸æœ‰ç”¨ï¼Œå½“æˆ‘ä»¬éœ€è¦æ›´æ”¹æ¸²æŸ“å†…å®¹è€Œä¸ç”¨ç®¡ state æ“ä½œæ—¶ï¼šå°±åƒä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¸²æŸ“é€»è¾‘ç§»åŠ¨åˆ° ToggleableMenu çš„å­çº§å‡½æ•°ä¸­ï¼Œä½†å´ä¿æŒæˆ‘ä»¬ Toggleable ç»„ä»¶çš„ state é€»è¾‘ï¼ è¿›ä¸€æ­¥é˜…è¯»ä¸Šé¢çš„ä¾‹å­åªæ˜¯ä¸€äº›å¯ä»¥ç”¨åœ¨ react ç¼–ç¨‹ä¸­çš„åŸºç¡€æ¨¡å¼ï¼Œå¦‚æžœä½ çœŸçš„æƒ³æ·±å…¥è¿™ä¸ªä¸»é¢˜ï¼Œæˆ‘å»ºè®®ä½ çœ‹çœ‹è¿™äº›äº†ä¸èµ·çš„æ–‡ç« ï¼š React Component Patterns by Michael Chan React Patterns Presentational and Container Components React Higher Order Components in depth Function as Child Components Recompose Downshift]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>React</tag>
        <tag>Components</tag>
        <tag>Higher Order ComponentsRender</tag>
        <tag>Callback</tag>
        <tag>patterns</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascript äº‹ä»¶å¾ªçŽ¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼]]></title>
    <url>%2F2017%2F11%2F06%2Fhow-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-async-and-await.html</url>
    <content type="text"><![CDATA[javascript äº‹ä»¶å¾ªçŽ¯æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠä½¿ç”¨asyncï¼awaitæå‡å¼‚æ­¥ç¼–ç¨‹çš„5ç§æ–¹å¼è¿™æ¬¡æˆ‘ä»¬å°†é€šè¿‡å›žé¡¾åœ¨å•çº¿ç¨‹çŽ¯å¢ƒä¸­ç¼–ç¨‹çš„ç¼ºç‚¹æ¥æ‰©å±•å…ˆå‰çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä»¥åŠå¦‚ä½•å…‹æœå®ƒæ¥å»ºç«‹ä¸€ä¸ªä»¤äººæƒŠå¹çš„ javascript UIsã€‚åƒä»¥å¾€ä¸€æ ·ï¼Œåœ¨æ–‡ç« çš„æœ€åŽï¼Œæˆ‘ä¼šåˆ†äº«ä½¿ç”¨ async/await å†™ç®€æ´ä»£ç çš„ 5 ä¸ªå°è´´å£«ã€‚ ä¸ºä»€ä¹ˆå•çº¿ç¨‹æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Ÿåœ¨æˆ‘ä»¬æŽ¨å‡ºçš„ç¬¬ä¸€ç¯‡æ–‡ç« , æˆ‘ä»¬ä»”ç»†æ€è€ƒäº†è¿™ä¸ªé—®é¢˜ï¼Œå½“æˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ªéžå¸¸è€—æ—¶çš„å‡½æ•°æ—¶å‘ç”Ÿäº†ä»€ä¹ˆã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œä¾‹å¦‚æµè§ˆå™¨ä¸­è¿è¡Œç€ä¸€ä¸ªå¤æ‚çš„å›¾åƒå˜æ¢ç®—æ³•ã€‚ å½“è°ƒç”¨æ ˆæ‰§è¡Œå‡½æ•°æ—¶ï¼Œæµè§ˆå™¨ä¸èƒ½åšä»»ä½•å…¶ä»–äº‹â€”â€”å®ƒè¢«é˜»å¡žäº†ã€‚è¿™æ„å‘³ç€æµè§ˆå™¨ä¸èƒ½æ¸²æŸ“ï¼Œä¸èƒ½æ‰§è¡Œå…¶ä»–ä»£ç ï¼Œæš‚æ—¶å¡ä½äº†ã€‚é‚£é—®é¢˜ä¹Ÿæ¥äº†â€”â€”â€”â€”ä½ çš„UIç•Œé¢ä¹Ÿä¸å†é¡ºç•…å’Œé«˜æ•ˆã€‚ ä½ çš„åº”ç”¨è¢«å¡ä½äº†ã€‚ å®ƒå¾ˆä¸‘é™‹ï¼Œå®Œå…¨æ¯äº†ä½ çš„ç”¨æˆ·ä½“éªŒï¼š javascript ç¨‹åºçš„ç»„æˆéƒ¨åˆ†ä½ å¯èƒ½ä¼šæŠŠä½ çš„ javascript åº”ç”¨å†™åœ¨å•ä¸ª .js æ–‡ä»¶é‡Œï¼Œä½†ä½ çš„ç¨‹åºè‚¯å®šåŒ…å«ç€å¥½å‡ å—ï¼Œåªæœ‰å…¶åªä¸€å—æ­£åœ¨æ‰§è¡Œï¼Œå…¶ä»–çš„ä¼šç¨åŽæ‰§è¡Œã€‚æœ€å¸¸è§çš„å—å°±æ˜¯å‡½æ•°ã€‚ é—®é¢˜æ˜¯ï¼Œå¤§å¤šæ•°æ–°å¼€å‘è€…ä¼¼ä¹Žéƒ½è§‰å¾—ï¼Œè¿™ä¸ª ç¨åŽæ‰§è¡Œ å¹¶ä¸æ˜¯ä¸¥æ ¼åœ°åœ¨ å½“å‰æ‰§è¡Œ ä¹‹åŽç«‹å³æ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œä»»åŠ¡å½“å‰ä¸èƒ½ç«‹å³å®Œæˆï¼Œé€šè¿‡å®šä¹‰ï¼Œå°†ä¼šå¼‚æ­¥å®Œæˆã€‚æ„å‘³ç€ä¸ä¼šå‡ºçŽ°ä¸Šé¢æ‰€è¯´çš„é˜»å¡žè¡Œä¸ºï¼Œå°±åƒä½ æ‰€æœŸæœ›æˆ–å¸Œæœ›å‘ç”Ÿçš„é‚£æ ·ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š ä½ å¯èƒ½å·²ç»æ„è¯†åˆ°ï¼Œæ ‡å‡†çš„ Ajax äº‹ä»¶ä¸ä¼šåŒæ­¥å®Œæˆã€‚æ„å‘³ç€å½“æ‰§è¡Œä»£ç  ajax(...) çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šç«‹å³è¿”å›žå€¼å¹¶èµ‹å€¼ç»™å˜é‡ responseã€‚ ä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå« å›žè°ƒå‡½æ•°ï¼ˆcallbackï¼‰çš„å‡½æ•°åŽ»ç­‰å¾…å¼‚æ­¥å‡½æ•°è¿”å›žçš„ç»“æžœã€‚ æé†’ä¸€ä¸‹ï¼šä½ å®žé™…å¯ä»¥å‘èµ·ä¸€ä¸ª åŒæ­¥ çš„ Ajax è¯·æ±‚ã€‚ä½†æ°¸è¿œä¸è¦è¿™æ ·åšã€‚å¦‚æžœä½ å‘é€ä¸€ä¸ªåŒæ­¥ Ajax è¯·æ±‚, ä½  javascript åº”ç”¨çš„ UI å°±ä¼šè¢«é˜»å¡žâ€”â€”â€”â€”ç”¨æˆ·å°†ä¸èƒ½ç‚¹å‡»ï¼Œè¾“å…¥æ•°æ®ï¼Œå¯¼èˆªæˆ–æ»šåŠ¨ã€‚è¿™ä¼šé˜»ç¢ç”¨æˆ·äº¤äº’ï¼Œéžå¸¸ç³Ÿç³•çš„ä½“éªŒã€‚ å°±åƒä¸‹é¢è¿™æ ·ï¼Œä½†è¯·æ°¸è¿œä¸è¦è¿™æ ·åšï¼Œä¸è¦æ¯äº†ç½‘é¡µï¼š æˆ‘ä»¬åªæ˜¯ç”¨ Ajax è¯·æ±‚åšä¸€ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥å¼‚æ­¥æ‰§è¡Œä»»æ„ä¸€æ®µä»£ç ã€‚ å¯ä»¥é€šè¿‡ setTimeout(callback, milliseconds) å‡½æ•°æ¥åšåˆ°ã€‚setTimeout å‡½æ•°å»ºç«‹ä¸€ä¸ªå»¶åŽå‘ç”Ÿçš„äº‹ä»¶ã€‚å°±åƒè¿™æ ·ï¼š å°†ä¼šè¾“å‡º first third second å‰–æžäº‹ä»¶å¾ªçŽ¯æˆ‘ä»¬ä¼šä»Žä¸€ä¸ªå¥‡æ€ªçš„è¦æ±‚å¼€å§‹â€”â€”â€”â€”å°½ç®¡å…è®¸å¼‚æ­¥ç¼–ç ï¼ˆå°±åƒåˆšåˆšè®¨è®ºçš„setTimeoutï¼‰ï¼Œç›´åˆ° ES6ï¼Œ javascriptä»Žæœªæœ‰è¿‡çœŸæ­£ç›´æŽ¥çš„å¼‚æ­¥çš„æ¦‚å¿µã€‚javascript å¼•æ“Žåœ¨æ‰§è¡Œå•ä¸€ä»£ç å—çš„æ—¶åˆ»ä¸ä¼šå†åšä»»ä½•äº‹æƒ…ã€‚ å…³äºŽjavascript å¼•æ“Žï¼ˆgoogleä¸“ç”¨çš„V8å¼•æ“Žï¼‰çš„æ›´å¤šç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬ä¹‹å‰çš„æ–‡ç« . é‚£ä¹ˆï¼Œè°è®© javascript å¼•æ“Žæ‰§è¡Œç¨‹åºå—å‘¢ï¼ŸçŽ°å®žä¸­ï¼Œjavascript å¼•æ“Žå¹¶ä¸æ˜¯å­¤ç«‹è¿è¡Œçš„â€”â€”â€”â€”å®ƒè¿è¡Œåœ¨ä¸€ä¸ª å®¿ä¸» çŽ¯å¢ƒä¸­ï¼Œå¯¹äºŽå¤§å¤šæ•°å¼€å‘è€…æ¥è¯´ï¼Œå…¸åž‹çš„æ˜¯ç½‘é¡µæµè§ˆå™¨æˆ–è€… Node.jsã€‚äº‹å®žä¸Šï¼Œjavascript è¢«åµŒå…¥åˆ°å„ç§è®¾å¤‡ä¸­ï¼Œä»Žæœºå™¨äººåˆ°å°ç¯æ³¡ã€‚æ¯ä¸ªè®¾å¤‡ä»£è¡¨ javascript å¼•æ“Žçš„ä¸åŒçš„å®¿ä¸»çŽ¯å¢ƒç±»åž‹ã€‚ åœ¨æ‰€æœ‰çŽ¯å¢ƒä¸­ï¼Œä¸å˜çš„æ˜¯æ‹¥æœ‰å…±åŒçš„ç§°ä¸º äº‹ä»¶å¾ªçŽ¯ çš„å†…ç½®æœºåˆ¶ï¼ŒæŽ§åˆ¶å¤„ç†å¤šä¸ªç¨‹åºå—çš„æ‰§è¡Œæ—¶æœºã€‚ è¿™æ„å‘³ç€ JS å¼•æ“Žåªæ˜¯åœ¨æ‰§è¡ŒçŽ¯å¢ƒä¸­æŒ‰éœ€è°ƒç”¨ä»»æ„ä»£ç ã€‚å®ƒï¼ˆæ‰§è¡ŒJSä»£ç çš„ï¼‰æ˜¯ä¸€ä¸ªäº‹ä»¶è°ƒåº¦çš„çŽ¯å¢ƒã€‚ é‚£ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ çš„ JS ç¨‹åºå‘èµ·ä¸€ä¸ª Ajax è¯·æ±‚åŽ»ä»ŽæœåŠ¡å™¨ä¸­èŽ·å–ä¸€äº›æ•°æ®ï¼Œä½ åœ¨ä¸€ä¸ªå‡½æ•°é‡Œè®¾ç½®äº†â€œå“åº”â€çš„ä»£ç ï¼ˆç§°ä¸ºâ€œå›žè°ƒå‡½æ•°â€ï¼‰ï¼ŒJS å¼•æ“Žå‘Šè¯‰å®¿ä¸»çŽ¯å¢ƒï¼šâ€œå˜¿ï¼Œæˆ‘çŽ°åœ¨ä¼šæš‚åœæ‰§è¡Œï¼Œä½†å½“ç½‘ç»œè¯·æ±‚å®Œæˆæ—¶ï¼Œå¹¶è¿”å›žä¸€äº›æ•°æ®ï¼Œè¯·å›žæ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚â€ æµè§ˆå™¨ä¼šç›‘å¬ç½‘ç»œå“åº”ï¼Œå¹¶åœ¨æ‹¿åˆ°æ•°æ®æ—¶è¿”å›žç»™ä½ ï¼Œå®ƒä¼šé€šè¿‡æ’å…¥åˆ° äº‹ä»¶å¾ªçŽ¯ ä¸­æ¥è°ƒåº¦å›žè°ƒå‡½æ•°ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„å›¾è¡¨ï¼š ä½ å¯ä»¥åœ¨ä»¥å‰çš„æ–‡ç« é˜…è¯»åˆ°æ›´å¤šå…³äºŽå †å†…å­˜å’Œè°ƒç”¨æ ˆçš„è®¨è®ºã€‚ è¿™äº› web APIs æ˜¯ä»€ä¹ˆï¼Ÿæœ¬è´¨ä¸Šæ¥è®²ï¼Œå®ƒä»¬æ˜¯æ— æ³•è®¿é—®çš„çº¿ç¨‹ï¼Œä½ åªèƒ½åˆ©ç”¨å®ƒã€‚å®ƒä»¬åªæ˜¯æµè§ˆå™¨çš„å¹¶å‘è®¿é—®çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æžœä½ æ˜¯ Node.js å¼€å‘è€…ï¼Œå®ƒä»¬æ˜¯ C++ APIsã€‚ é‚£ä¹ˆï¼Œäº‹ä»¶å¾ªçŽ¯ åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ äº‹ä»¶å¾ªçŽ¯æœ‰ä¸€ä¸ªç®€å•çš„å·¥ä½œâ€”â€”â€”â€”ç›‘è§†è°ƒç”¨æ ˆå’Œå›žè°ƒé˜Ÿåˆ—ã€‚å¦‚æžœè°ƒç”¨æ ˆæ¸…ç©ºäº†ï¼Œå®ƒä¼šèŽ·å–é˜Ÿåˆ—é‡Œçš„ç¬¬ä¸€ä¸ªäº‹ä»¶æ”¾å…¥è°ƒç”¨æ ˆï¼Œé«˜æ•ˆåœ°è¿è¡Œã€‚ åœ¨äº‹ä»¶å¾ªçŽ¯ä¸­ï¼Œåƒè¿™æ ·çš„ä¸€ä¸ªè¿­ä»£è¢«ç§°ä¸º tickã€‚æ¯ä¸ªäº‹ä»¶éƒ½åªæ˜¯ä¸€ä¸ªå›žè°ƒå‡½æ•°ã€‚ è®©æˆ‘ä»¬ä¸€èµ·â€œæ‰§è¡Œâ€è¿™æ®µä»£ç ï¼Œç„¶åŽçœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š 1ã€çŠ¶æ€æ˜¯æ¸…ç©ºçš„ã€‚æµè§ˆå™¨æŽ§åˆ¶å°æ˜¯æ¸…ç©ºçš„ï¼Œè°ƒç”¨æ ˆä¹Ÿæ˜¯ç©ºçš„ã€‚ 2ã€console.log('Hi')è¢«æ·»åŠ è¿›è°ƒç”¨æ ˆã€‚ 3ã€console.log('Hi')è¢«æ‰§è¡Œã€‚ 4ã€ console.log('Hi') è¢«ç§»å‡ºè°ƒç”¨æ ˆã€‚ 5ã€setTimeout(function cb1() { ... })è¢«æ·»åŠ è¿›è°ƒç”¨æ ˆã€‚ 6ã€ setTimeout(function cb1() { ... })è¢«æ‰§è¡Œã€‚æµè§ˆå™¨é€šè¿‡ web api åˆ›å»ºäº†ä¸€ä¸ªå®šæ—¶å™¨ã€‚å®ƒå°†ä¸ºä½ å¤„ç†å€’è®¡æ—¶ã€‚ 7ã€setTimeout(function cb1() { ... })è¢«æ‰§è¡Œå®Œæ¯•å¹¶ç§»å‡ºè°ƒç”¨æ ˆã€‚ 8ã€console.log('Bye')è¢«æ·»åŠ è¿›è°ƒç”¨æ ˆã€‚ 9ã€console.log('Bye')è¢«æ‰§è¡Œã€‚ 10ã€console.log('Bye')è¢«ç§»å‡ºè°ƒç”¨æ ˆã€‚ 11ã€åœ¨ è‡³å°‘ 5000æ¯«ç§’ä¹‹åŽï¼Œå®šæ—¶å™¨å®Œæˆï¼Œå¹¶å°† cb1 å›žè°ƒæŽ¨å…¥å›žè°ƒé˜Ÿåˆ—ã€‚ 12ã€äº‹ä»¶å¾ªçŽ¯ä»Žå›žè°ƒé˜Ÿåˆ—é‡Œå–å‡º cb1 å¹¶æŽ¨å…¥è°ƒç”¨æ ˆã€‚ 13ã€cb1 è¢«æ‰§è¡Œï¼Œå¹¶æ·»åŠ  console.log('cb1') åˆ°è°ƒç”¨æ ˆã€‚ 14ã€console.log('cb1') è¢«æ‰§è¡Œã€‚ 15ã€console.log('cb1') è¢«ç§»å‡ºè°ƒç”¨æ ˆã€‚ 16ã€cb1 è¢«ç§»å‡ºè°ƒç”¨æ ˆã€‚ å¿«é€Ÿå›žé¡¾ä¸€ä¸‹ï¼š æœ‰è¶£çš„æ˜¯ ES6 æŒ‡å®šäº† äº‹ä»¶å¾ªçŽ¯å¦‚ä½•å·¥ä½œï¼Œæ„å‘³ç€æŠ€æœ¯ä¸Šæ¥è®²ï¼Œäº‹ä»¶å¾ªçŽ¯æ˜¯åœ¨ JS å¼•æ“Žçš„èŒè´£èŒƒå›´å†…çš„ï¼Œå®ƒå°†ä¸å†æ‰®æ¼”å®¿ä¸»çŽ¯å¢ƒçš„è§’è‰²ã€‚è¿™ä¸€å˜åŒ–çš„ä¸€ä¸ªä¸»è¦åŽŸå› æ˜¯ ES6 Promise çš„ä»‹ç»è¯´ï¼šå› ä¸ºåŽè€…éœ€è¦ç›´æŽ¥è®¿é—®å’Œç»†ç²’åº¦åœ°æŽ§åˆ¶äº‹ä»¶é˜Ÿåˆ—å¾ªçŽ¯çš„è°ƒåº¦æ“ä½œã€‚ï¼ˆç¨åŽæˆ‘ä»¬ä¼šæ›´è¯¦ç»†åœ°è®¨è®ºå®ƒä»¬ï¼‰ setTimeout(â€¦) å¦‚ä½•å·¥ä½œå€¼å¾—æ³¨æ„åœ°çš„ï¼Œ setTimeout(â€¦) å¹¶ä¸ä¼šè‡ªåŠ¨å°†å›žè°ƒå‡½æ•°æ·»åŠ è¿›äº‹ä»¶å¾ªçŽ¯é˜Ÿåˆ—ã€‚å®ƒåªæ˜¯è®¾å®šä¸€ä¸ªå®šæ—¶å™¨ã€‚å½“å®šæ—¶å™¨åˆ°æœŸæ—¶ï¼Œè¿è¡ŒçŽ¯å¢ƒå°†å›žè°ƒäº‹ä»¶æŽ¨å…¥äº‹ä»¶å¾ªçŽ¯ã€‚æ‰€ä»¥æœªæ¥ tick ä¼šå–å‡ºå›žè°ƒå¹¶æ‰§è¡Œå®ƒã€‚çœ‹ä¸€çœ¼è¿™ä¸ªä»£ç ï¼š å®ƒå¹¶ä¸æ„å‘³ç€ myCallback å°†ä¼šåœ¨1000æ¯«ç§’çš„æ—¶å€™ç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨1000æ¯«ç§’åŽï¼ŒmyCallback è¢«æ·»åŠ è¿›äº‹ä»¶å¾ªçŽ¯é˜Ÿåˆ—ã€‚ä½†æ˜¯ï¼Œé˜Ÿåˆ—é‡Œå¯èƒ½å·²ç»æœ‰å…¶ä»–äº‹ä»¶è¢«æ›´æ—©åœ°æ·»åŠ è¿›æ¥â€”â€”â€”â€”ä½ çš„å›žè°ƒå¿…é¡»ç­‰å¾…ã€‚ æœ‰ç›¸å½“å¤šçš„æ–‡ç« å’Œæ•™ç¨‹åœ¨å¼€å§‹ä½¿ç”¨å¼‚æ­¥jsæ—¶å»ºè®®ä½¿ç”¨ setTimeout(callback, 0)ã€‚çŽ°åœ¨ä½ çŸ¥é“äº‹ä»¶å¾ªçŽ¯æ˜¯æ€Žä¹ˆå›žäº‹ä»¥åŠ setTimeout å¦‚ä½•å·¥ä½œï¼šè°ƒç”¨ç¬¬äºŒä¸ªå‚æ•°ä¸º 0 çš„ setTimeout åªæ˜¯æŽ¨è¿Ÿæ‰§è¡Œå›žè°ƒå‡½æ•°ç›´è‡³è°ƒç”¨æ ˆæ¸…ç©ºã€‚ çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä»£ç ï¼š å°½ç®¡å®šæ—¶å™¨è®¾ç½®ä¸º 0ms, ä½†æµè§ˆå™¨æŽ§åˆ¶å°çš„ç»“æžœæ˜¯ï¼š Hi Bye callback ES6 é‡Œçš„ Jobs æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ ES6 ä»‹ç»ä¸­ï¼Œå‡ºçŽ°äº†ä¸€ä¸ªæ–°æ¦‚å¿µ â€œJobs Queueâ€ã€‚å®ƒæ˜¯äº‹ä»¶å¾ªçŽ¯ä¹‹ä¸Šçš„ä¸€å±‚ã€‚å½“ä½ å¤„ç† Promise å¼‚æ­¥æ“ä½œçš„æ—¶å€™ï¼Œä½ å‡ ä¹Žç»å¸¸ç¢°åˆ°å®ƒï¼ˆæˆ‘ä»¬ä¹Ÿä¼šè°ˆè°ˆå®ƒï¼‰ã€‚ æˆ‘ä»¬å…ˆæ¥è°ˆè°ˆè¿™ä¸ªæ¦‚å¿µï¼Œä»¥ä¾¿ç¨åŽè®¨è®ºå¼‚æ­¥ Promise è¡¨çŽ°çš„æ—¶å€™ï¼Œä½ èƒ½ç†è§£é‚£äº›è¡Œä¸ºæ˜¯å¦‚ä½•è¢«è°ƒåº¦å’Œå¤„ç†çš„ã€‚ æƒ³åƒä¸€ä¸‹ï¼ŒJob Queue æ˜¯ä¸€ä¸ªé™„å±žäºŽäº‹ä»¶é˜Ÿåˆ—ä¸­æ¯ä¸€ä¸ª tick ç»“å°¾çš„é˜Ÿåˆ—ã€‚æŸäº›å¼‚æ­¥è¡Œä¸ºå¯èƒ½ä¼šå‘ç”Ÿåœ¨äº‹ä»¶å¾ªçŽ¯çš„æŸä¸€åˆ»ï¼Œå´ä¸ä¼šå¼•èµ·ä¸€ä¸ªå…¨æ–°çš„äº‹ä»¶æ·»åŠ åˆ°äº‹ä»¶å¾ªçŽ¯é˜Ÿåˆ—ä¸­ã€‚ä½†ä¼šæ·»åŠ ä¸€ä¸ªé¡¹ç›®ï¼ˆä¹Ÿå«Jobï¼‰åˆ°å½“å‰ tick çš„ Job Queueã€‚ è¿™æ„å‘³ç€ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œè®©å®ƒç¨åŽæ‰§è¡Œã€‚å¹¶ä¸”ä½ å¯ä»¥æ”¾å¿ƒï¼Œå®ƒåˆšå¥½ä¼šåœ¨å…¶ä»–äº‹ä»¶ä¹‹å‰ï¼Œåœ¨é‚£ä¹‹åŽæ‰§è¡Œã€‚ ä¸€ä¸ª Job ä¹Ÿèƒ½å¼•èµ·å…¶ä»–çš„ Job æ·»åŠ åˆ°ç›¸åŒçš„é˜Ÿåˆ—åŽé¢ã€‚ç†è®ºä¸Šï¼ŒJob â€œå¾ªçŽ¯â€ä¹Ÿæ˜¯æœ‰å¯èƒ½äº§ç”Ÿçš„ï¼ˆä¸€ä¸ªä¸æ–­æ·»åŠ å…¶ä»– Jobsçš„Jobä¹‹ç±»ï¼‰ã€‚è¿™æ ·éœ€è¦èµ„æºçš„ç¨‹åºå°±å¿…é¡»ç§»åŠ¨åˆ°äº‹ä»¶å¾ªçŽ¯çš„ä¸‹ä¸€ä¸ª tickã€‚æ¦‚å¿µä¸Šçœ‹ï¼Œè¿™å°±ç±»ä¼¼äºŽéœ€è¦é•¿æ—¶å€™è¿è¡Œæˆ–æ­»å¾ªçŽ¯ï¼ˆå°±åƒ while (true) ..ï¼‰ã€‚ Job å°±åƒ setTimeout(callback, 0) çš„ hackï¼Œä½†é€šè¿‡å¼•å…¥ä¸€ä¸ªæ›´åŠ æ˜Žç¡®çš„æ¦‚å¿µæ¥å®žçŽ°ï¼šç¨åŽæ‰§è¡Œï¼Œä½†å°½å¯èƒ½å¿«ã€‚ å›žè°ƒå‡½æ•°æ­£å¦‚ä½ æ‰€çŸ¥é“çš„ï¼Œå›žè°ƒå‡½æ•°æ˜¯è¿„ä»Šä¸ºæ­¢ javascript ç¨‹åºä¸­æœ€å¸¸è§çš„è¡¨è¾¾å’Œç®¡ç†å¼‚æ­¥çš„æ–¹å¼ã€‚çš„ç¡®ï¼Œå›žè°ƒæ˜¯ javascript è¯­è¨€ä¸­æœ€åŸºæœ¬çš„å¼‚æ­¥æ¨¡å¼ã€‚æ— æ•°çš„JSç¨‹åºï¼Œç”šè‡³æ˜¯å³ä½¿æ˜¯éžå¸¸å¤æ‚çš„ä¸€ä¸ªï¼Œä¹Ÿä¸ä¼šå°‘äº†æœ€åŸºç¡€çš„å›žè°ƒå¼‚æ­¥æ¨¡å¼ã€‚ é™¤äº†å›žè°ƒï¼Œå…¶ä»–çš„ä¸ä¼šæ²¡æœ‰ç¼ºç‚¹ã€‚è®¸å¤šå¼€å‘è€…å°è¯•å¯»æ‰¾æ›´å¥½çš„å¼‚æ­¥æ¨¡å¼ã€‚ä½†æ˜¯ï¼Œå¦‚æžœä¸èƒ½å¾ˆå¥½åœ°ç†è§£å¼•æ“Žä¸‹çš„å·¥ä½œåŽŸç†ï¼Œå°±ä¸å¯èƒ½æœ‰æ•ˆåœ°ä½¿ç”¨ä»»ä½•æŠ½è±¡æ¦‚å¿µã€‚ åœ¨æŽ¥ä¸‹æ¥çš„ç« èŠ‚ï¼Œæˆ‘ä»¬å°†æŽ¢ç´¢è¿™äº›æŠ½è±¡æ¦‚å¿µï¼Œæ·±å…¥åœ°å±•ç¤ºä¸ºä»€ä¹ˆæ›´å¤æ‚çš„å¼‚æ­¥æ¨¡å¼ï¼ˆè¿™å°†åœ¨éšåŽçš„å¸–å­ä¸­è®¨è®ºï¼‰æ˜¯å¿…é¡»çš„ï¼Œç”šè‡³æ˜¯æŽ¨èçš„ã€‚ åµŒå¥—å›žè°ƒçœ‹ä¸‹é¢çš„ä»£ç ï¼š æˆ‘ä»¬æœ‰ä¸‰ä¸ªå‡½æ•°åµŒå¥—åœ¨ä¸€èµ·ï¼Œæ¯ä¸€ä¸ªå°±ä»£è¡¨å¼‚æ­¥ç³»åˆ—çš„ä¸€æ­¥ã€‚ è¿™ç§ä»£ç ç»å¸¸è¢«ç§°ä¸ºâ€œå›žè°ƒåœ°ç‹±ï¼ˆcallback hellï¼‰â€ã€‚ä½†â€œå›žè°ƒåœ°ç‹±â€å®žé™…ä¸Šä¸ŽåµŒå¥—ã€ç¼©è¿›æ²¡ä»€ä¹ˆå…³ç³»ã€‚è¿™æ˜¯ä¸€ä¸ªæ›´æ·±å…¥çš„é—®é¢˜ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬ç­‰å¾…â€œç‚¹å‡»â€äº‹ä»¶ï¼Œç„¶åŽç­‰å¾…å®šæ—¶å™¨è¢«è§¦å‘ï¼Œç„¶åŽç­‰å¾… Ajax è¯·æ±‚å“åº”æ•°æ®ï¼Œåœ¨è¿™ä¸€ç‚¹ï¼Œå®ƒå¯èƒ½ä¼šå†æ¬¡é‡å¤ã€‚ ç²—ç•¥åœ°çœ‹ï¼Œè¿™æ®µä»£ç ä¼¼ä¹Žè‡ªç„¶è€Œç„¶åœ°å°†å¼‚æ­¥æ˜ å°„ä¸ºè¿žç»­çš„æ­¥éª¤ï¼š ç„¶åŽæˆ‘ä»¬æœ‰ï¼š å†ç„¶åŽæœ‰ï¼š æœ€åŽæˆ‘ä»¬æœ‰ï¼š è¿™æ ·ç”¨è¿žç»­çš„æ–¹å¼è¡¨è¾¾å¼‚æ­¥çœ‹èµ·æ¥æ›´è‡ªç„¶ï¼Œä¸æ˜¯å—ï¼Ÿè¿™ç§æ–¹å¼ä¸€å®šè¡Œå¾—é€šï¼Œå¯¹å§ï¼Ÿ Promiseçœ‹ä¸€ä¸‹è¿™ä¸ªä»£ç ï¼š è¿™éžå¸¸ç®€å•ï¼šå°† x å’Œ y çš„å€¼ç›¸åŠ ç„¶åŽè¾“å‡ºåœ¨æŽ§åˆ¶å°ã€‚ä½†æ˜¯ï¼Œå¦‚æžœ x å’Œ y çš„å€¼åœ¨ç”¨äºŽè¡¨è¾¾å¼ä¹‹å‰ä¸¢å¤±äº†ï¼Œæˆ–è¿˜ä¸ç¡®å®šæ€Žä¹ˆåŠžå‘¢ï¼Ÿè®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‡½æ•° loadx å’Œ loady åˆ†åˆ«ä»ŽæœåŠ¡ç«¯åŠ è½½ x å’Œ y çš„å€¼ã€‚ç„¶åŽï¼Œæœ‰ä¸€ä¸ªå‡½æ•° sum ä¼šåœ¨ x å’Œ y éƒ½èŽ·å–åˆ°å€¼çš„æ—¶å€™ç›¸åŠ ã€‚ ä»£ç çœ‹èµ·æ¥å¯èƒ½æ˜¯è¿™æ ·çš„ï¼ˆéžå¸¸ä¸‘é™‹ï¼Œä¸æ˜¯å—ï¼‰ï¼š è¿™é‡Œæœ‰ä¸€äº›éžå¸¸å€¼å¾—æ³¨æ„çš„äº‹æƒ…â€”â€”åœ¨ä¸Šé¢çš„ä»£ç æ®µä¸­ï¼Œæˆ‘ä»¬å‡è®¾ x å’Œ y éƒ½æ˜¯æœªæ¥å€¼ï¼Œå¹¶ä¸”æˆ‘ä»¬è¡¨è¾¾äº†ä¸€ä¸ªæ“ä½œå‡½æ•° sum å¹¶ä¸å…³å¿ƒ xæˆ–yæˆ–ä¸¤è€…æ˜¯å¦éƒ½å¯ç”¨ã€‚ å½“ç„¶ï¼Œè¿™ç§åŸºäºŽå›žè°ƒçš„æ–¹å¼ä¸å°½äººæ„ã€‚è¿™åªæ˜¯é¦–å…ˆçš„ä¸€å°æ­¥ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£ä¸ºä»€ä¹ˆä¸éœ€è¦å…³å¿ƒ æœªæ¥å€¼ ä½•æ—¶å¯ç”¨è¿™æ–¹é¢ã€‚ Promise Valueè®©æˆ‘ä»¬ç²—ç•¥åœ°çœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•ä½¿ç”¨ Promise æ¥è¡¨è¾¾ x + y: è¿™ä¸ªä»£ç æ®µä¸­æœ‰ä¸¤å±‚ Promise. fetchX() å’Œ fetchY() è¢«ç›´æŽ¥è°ƒç”¨ï¼Œå¹¶ä¸”ä»–ä»¬çš„è¿”å›žå€¼è¢«ä¼ é€’åˆ° sum(...) ã€‚æ½œåœ¨çš„å€¼å¯èƒ½åœ¨çŽ°åœ¨æˆ–ç¨åŽå‡†å¤‡å¥½ï¼Œä½†æ¯ä¸ª Promise è§„å®šäº†å®ƒä»¬çš„è¡¨çŽ°æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬ä»¥ç‹¬ç«‹çš„æ–¹å¼åˆ†æž x å’Œ yçš„å€¼ã€‚å®ƒä»¬æ˜¯æœªæ¥çš„å€¼ï¼Œæœ‰ä¸€æ®µæœŸé™ã€‚ ç¬¬äºŒå±‚æ˜¯sum(...) åˆ›å»ºçš„ Promise(æ¥æºäºŽ Promise.all([ ... ]))ã€‚æˆ‘ä»¬ç­‰å¾…ç€è°ƒç”¨ then(...) .å½“ sum(...) æ“ä½œç¬¦å®Œæˆæ—¶ï¼Œæˆ‘ä»¬ç›¸åŠ çš„æœªæ¥çš„å€¼å·²ç»å‡†å¤‡å¥½ï¼Œå¹¶ä¸”å¯ä»¥è¾“å‡ºã€‚æˆ‘ä»¬ä¸ºäº†ç­‰å¾… x å’Œy å€¼ï¼Œåœ¨ sum(...)ä¸­éšè—äº†é€»è¾‘ã€‚ æ³¨æ„ï¼š åœ¨sum(â€¦)ä¹‹ä¸­ï¼Œè°ƒç”¨ Promise.all([ â€¦ ]) åˆ›å»ºä¸€ä¸ª Promise ï¼ˆç­‰å¾… promiseX å’Œ promiseY å®Œæˆï¼‰ã€‚è°ƒç”¨é“¾ .then(...) åˆ›å»ºå¦ä¸€ä¸ª Promiseï¼Œç«‹å³è¿”å›ž values[0] + values[1] ï¼ˆç›¸åŠ çš„ç»“æžœï¼‰ã€‚sum(...) åŽé¢è°ƒç”¨çš„ then(...) å®žé™…ä¸Šæ˜¯ç¬¬äºŒä¸ªPromise è¿”å›žçš„ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€ä¸ª Promise.all([ ... ]) è¿”å›žçš„ã€‚åŒæ ·ï¼Œæˆ‘ä»¬æ²¡æœ‰é“¾æŽ¥ç¬¬äºŒä¸ª then(...), å®ƒä¹ŸåŒæ ·å·²ç»åˆ›å»ºäº†å¦ä¸€ä¸ª Promiseã€‚è¿™ä¸€ Promise é“¾çš„å†…å®¹å°†åœ¨æœ¬ç« ç»“å°¾è¯¦ç»†è§£é‡Šã€‚ ä½¿ç”¨ Promise, then(...) å®žé™…ä¸Šå¯ä»¥ä¼ å…¥ä¸¤ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå¯¹åº”å®ŒæˆçŠ¶æ€ï¼Œç¬¬äºŒä¸ªæ˜¯å¯¹åº”å¤±è´¥çŠ¶æ€ã€‚ å¦‚æžœåœ¨èŽ·å– x æˆ– y çš„æ—¶å€™å‘ç”Ÿé”™è¯¯ï¼Œæˆ–è€…åœ¨ç›¸åŠ çš„æ—¶å€™å‡ºé”™ï¼Œsum(...) ä¼šè¿”å›žå¤±è´¥ï¼Œå¹¶ä¸”ä¼ å…¥ then(...) çš„ç¬¬äºŒä¸ªé”™è¯¯å¤„ç†å‡½æ•°ä¼šæ”¶åˆ° Promise è¿”å›žçš„å€¼ã€‚ å› ä¸º Promise å°è£…äº†ä¾èµ–æ—¶é—´çš„çŠ¶æ€â€”â€”ç­‰å¾…åº•å±‚å€¼çš„å®Œæˆæˆ–å¤±è´¥â€”â€”ä»Žå¤–éƒ¨çœ‹ï¼ŒPromise æœ¬èº«æ˜¯ä¾èµ–æ—¶é—´çš„ï¼Œå› æ­¤ Promise å¯ä»¥ä»¥å¯é¢„æµ‹çš„æ–¹å¼ç»„åˆèµ·æ¥ï¼Œè€Œä¸ç”¨è€ƒè™‘æ—¶é—´å’Œç»“æžœã€‚ æ­¤å¤–ï¼Œä¸€æ—¦ Promise è§£å†³äº†ï¼Œå®ƒå°†æ°¸å…¥åœç•™åœ¨é‚£ä¸ªçŠ¶æ€â€”â€”å®ƒè¿™æ—¶å˜æˆä¸€ä¸ª ä¸å¯å˜çš„ å€¼â€”â€”å¹¶ä¸”æ ¹æ®éœ€è¦å¯ä»¥è§‚å¯Ÿå¤šæ¬¡ã€‚ é“¾å¼è°ƒç”¨ Promise çœŸçš„éžå¸¸æœ‰ç”¨ï¼š è°ƒç”¨ delay(2000) åˆ›å»ºä¸€ä¸ª Promise å°†ä¼šåœ¨ 2000ms åŽè¾¾åˆ°æ¡ä»¶ï¼Œç„¶åŽä»Žç¬¬ä¸€ä¸ª then(...) æˆåŠŸå›žè°ƒè¿”å›žï¼Œè¿™ä¼šé€ æˆç¬¬äºŒä¸ª then(...) ä¼šç­‰å¾… 2000ms çš„ Promise. æ³¨æ„ï¼š å› ä¸º Promise ä»Žå¤–éƒ¨çœ‹æ¥å¦‚æžœè¢«è§£å†³äº†æ˜¯æ— æ³•å†æ”¹å˜çš„ï¼ŒçŽ°åœ¨æŠŠå€¼ä¼ åˆ°ä»»ä½•ä¸€éƒ¨åˆ†éƒ½æ˜¯å®‰å…¨çš„ï¼Œå®ƒä¸èƒ½è¢«æ¶æ„æˆ–æ„å¤–åœ°ä¿®æ”¹ã€‚å°¤å…¶æ˜¯å…³ç³»åˆ°å¤šä¸ª Promise éµå®ˆåè®®ã€‚ä¸€æ–¹ä¸å¯èƒ½å½±å“å¦ä¸€æ–¹éµå®ˆåè®®çš„èƒ½åŠ›ã€‚ä¸å˜æ€§å¬èµ·æ¥å…³ç³»åˆ°å­¦æœ¯æ€§çš„è¯é¢˜ã€‚ä½†å®ƒå®žé™…ä¸Šæ˜¯ Promise è®¾è®¡çš„æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œä¸åº”è¯¥éšä¾¿é”™è¿‡ã€‚ ç”¨è¿˜æ˜¯ä¸ç”¨ Promiseå…³äºŽ Promise æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ç»†èŠ‚å°±æ˜¯è¦çŸ¥é“æŸä¸ªå€¼æ˜¯å¦æ˜¯ Promiseã€‚æ¢å¥è¯è¯´ï¼ŒæŸä¸ªå€¼è¡¨çŽ°å¾—åƒ Promise å—ï¼Ÿ æˆ‘ä»¬çŸ¥é“ï¼ŒPromise é€šè¿‡ new Promise(â€¦) è¯­æ³•æž„é€ ï¼Œç„¶åŽä½ è®¤ä¸º p instanceof Promise è¶³ä»¥æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ª Promiseã€‚ä½†ï¼Œå¹¶ä¸å®Œå…¨æ˜¯ã€‚ ä¸»è¦æ˜¯å› ä¸ºä½ å¯ä»¥æœ‰é€šè¿‡å…¶ä»–çš„æµè§ˆçª—å£æŽ¥æ”¶ä¸€ä¸ª Promise å€¼ï¼ˆæ¯”å¦‚ï¼šiframeï¼‰ï¼Œå®ƒæœ‰å®ƒæ‰€å±žçš„ Promiseï¼Œ ä¸åŒäºŽå½“å‰çª—å£çš„ï¼Œå¹¶ä¸”æ£€æµ‹æ˜¯å¦æ˜¯ Promise å®žä¾‹ä¼šè¿”å›žå¤±è´¥ã€‚ æ­¤å¤–ï¼Œä¸€ä¸ªç±»åº“æˆ–æ¡†æž¶å¯èƒ½ä¼šé€‰æ‹©è‡ªå·±ä½¿ç”¨çš„ Promise å®žçŽ°ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ ES6 åŽŸç”Ÿå®žçŽ°çš„ Promiseã€‚é€šè¿‡ç±»åº“ä½¿ç”¨ Promise å¯èƒ½åœ¨ä¸æ”¯æŒ Promise çš„æµè§ˆå™¨ä¸Šå·¥ä½œå¾—å¾ˆå¥½ã€‚ è¢«åžæŽ‰çš„å¼‚å¸¸å¦‚æžœä»»ä½•æ—¶å€™åˆ›å»ºä¸€ä¸ª Promise ï¼Œæˆ–æ­£åœ¨ç›‘å¬å®ƒå†³ç­–çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†æ„å¤–é”™è¯¯ï¼Œæ¯”å¦‚ TypeError æˆ–è€… ReferenceError, å¼‚å¸¸å°†ä¼šè¢«æ•èŽ·ï¼Œå¹¶ä¸”è¿™ä¸ª Promise å°†ä¼šè¢«å¼ºåˆ¶å˜æˆå¤±è´¥çŠ¶æ€ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š ä½†å¦‚æžœä¸€ä¸ª Promise è¿˜æ²¡æœ‰å˜æˆæˆåŠŸçŠ¶æ€ï¼Œå´åœ¨è§‚å¯ŸæœŸé—´å‘ç”Ÿäº†å¼‚å¸¸ä¼šæ€Žæ ·å‘¢ï¼ˆåœ¨ then(...) æ³¨å†Œäº†å›žè°ƒï¼‰ï¼Ÿå°½ç®¡è¿™ä¸ªå¼‚å¸¸å¯ä»¥æ•èŽ·ï¼Œä½†å®ƒçš„å¤„ç†æ–¹å¼å¯èƒ½è®©ä½ æœ‰ç‚¹åƒæƒŠã€‚è®©æˆ‘ä»¬æŒ–å¾—æ›´æ·±ä¸€ç‚¹ã€‚ è¿™çœ‹èµ·æ¥å‘ç”Ÿåœ¨ foo.bar() çš„å¼‚å¸¸ç¡®å®žè¢«åžæŽ‰äº†ã€‚è™½ç„¶äº‹å®žå¹¶æ²¡æœ‰ã€‚æœ‰ä¸€äº›æ›´æ·±çš„ä¸œè¥¿å‘ç”Ÿäº†é”™è¯¯ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›‘å¬åˆ°ã€‚p.then(â€¦) è¿”å›žå¦ä¸€ä¸ª Promiseï¼Œè€Œä¸”è¿™ä¸ª Promise ä¼šå› ä¸º TypeError å˜æˆå¤±è´¥çŠ¶æ€ã€‚ å¤„ç†æœªæ•èŽ·çš„å¼‚å¸¸è¿˜æœ‰å…¶ä»–ä¸€äº›è®¸å¤šäººè®¤ä¸º æ›´å¥½ çš„è§£å†³åŠžæ³•ã€‚ ä¸€ä¸ªæ™®éçš„å»ºè®®å°±æ˜¯ Promise åº”è¯¥æ·»åŠ ä¸€ä¸ª done(â€¦)ï¼Œæ„å‘³ç€ Promise é“¾å¼è°ƒç”¨å·²â€œå®Œæˆâ€ã€‚done(â€¦) ä¸ä¼šå†åˆ›å»ºå¹¶è¿”å›žä¸€ä¸ª Promiseï¼Œæ‰€ä»¥ä¼ é€’å›žè°ƒå‡½æ•°åˆ° done(..) æ˜¾ç„¶ä¸èƒ½ä¸Žä¸å­˜åœ¨çš„ Promise è¿žæŽ¥ä¸ŠæŠ¥å¼‚å¸¸ã€‚ ä½ å¯èƒ½æœŸæœ›å‘çŽ°ä»»ä½•æœªæ•èŽ·çš„é”™è¯¯çš„æƒ…å†µï¼šä»»ä½• done(..) ä¸­çš„å¼‚å¸¸éƒ½ä¼šæŠ›å‡ºå…¨å±€çš„æœªæ•èŽ·çš„é”™è¯¯ï¼ˆåŸºæœ¬éƒ½ä¼šå‡ºçŽ°åœ¨æŽ§åˆ¶å°ï¼‰ï¼š ES8 æœ‰ä»€ä¹ˆå˜åŒ–ï¼ŸAsync/awaitjavascript ES8 æŽ¨å‡ºäº† async/await è®© Promise çš„å·¥ä½œæ›´å®¹æ˜“æ›´ç®€å•ã€‚æˆ‘ä»¬ç®€è¦åœ°çœ‹çœ‹ async/await æä¾›äº†ä»€ä¹ˆå¹¶åˆ©ç”¨å®ƒä»¬å†™ä¸€äº›å¼‚æ­¥ä»£ç ã€‚ é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ async/await æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ ä½ å¯ä»¥ä½¿ç”¨ async å£°æ˜Žå®šä¹‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ã€‚è¿™æ ·çš„å‡½æ•°è¿”å›žä¸€ä¸ªå¼‚æ­¥å‡½æ•°å¯¹è±¡ã€‚AsyncFunction å¯¹è±¡ä»£è¡¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œä»£ç ï¼Œå¹¶åŒ…å«åœ¨é‚£ä¸ªå®¿ä¸»å‡½æ•°ä¸­ã€‚ å½“å¼‚æ­¥å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒè¿”å›žä¸€ä¸ª Promiseã€‚å½“å¼‚æ­¥å‡½æ•°è¿”å›žä¸€ä¸ªå€¼æ—¶ï¼Œé‚£å°±ä¸æ˜¯ä¸€ä¸ª Promiseã€‚Promise ä¼šè¢«è‡ªåŠ¨åˆ›å»ºï¼Œå¹¶ä¸”ä¼šé€šè¿‡è¿”å›žå€¼æ¥å®ŒæˆçŠ¶æ€ã€‚å½“ async æŠ›å‡ºå¼‚å¸¸ï¼ŒPromise å°†æŠ›å‡ºå€¼å¹¶å˜æˆå¤±è´¥çŠ¶æ€ã€‚ ä¸€ä¸ª async å‡½æ•°å¯ä»¥åŒ…å«ä¸€ä¸ª await è¡¨è¾¾å¼ï¼Œå®ƒä¼šæš‚åœæ‰§è¡Œå‡½æ•°å†…çš„ä»£ç å¹¶ç­‰å¾… Promise è¿”å›žç»“æžœï¼Œç„¶åŽç»§ç»­æ‰§è¡Œå¼‚æ­¥å‡½æ•°å¹¶è¿”å›žç»“æžœã€‚ ä½ å¯ä»¥è®¤ä¸º Promise ä¸Ž Javaä¸­çš„Futureæˆ–è€… C# çš„ä»»åŠ¡ã€‚ ä½¿ç”¨ async/await çš„ç›®çš„æ˜¯ä¸ºäº†ç®€åŒ–ä½¿ç”¨ Promise çš„è¡Œä¸ºã€‚ çœ‹ä¸‹é¢çš„ä»£ç ï¼š åŒæ ·çš„ï¼Œå¼‚æ­¥å‡½æ•°å†…æŠ›å‡ºå¼‚å¸¸ç›¸å½“äºŽæ™®é€šå‡½æ•°æŠ›å‡ºä¸€ä¸ªè¢«æ‹’ç»çš„ Promiseï¼š await è¯­å¥åªæœ‰ç”¨åœ¨ async å‡½æ•°å†…ï¼Œå¹¶å…è®¸ä½ åœ¨ Promise è¿›è¡ŒåŒæ­¥ç­‰å¾…ã€‚å¦‚æžœæˆ‘ä»¬è¦åœ¨ async å‡½æ•°å¤–ä½¿ç”¨ Promise, æˆ‘ä»¬ä»è¦ä½¿ç”¨ then æ¥æ‰§è¡Œå›žè°ƒï¼š ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨â€œå¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼â€æ¥å®šä¹‰å¼‚æ­¥å‡½æ•°ã€‚ä¸€ä¸ªå¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼å’Œä¸€ä¸ªå¼‚æ­¥å‡½æ•°å£°æ˜Žå¾ˆç±»ä¼¼ï¼Œå‡ ä¹Žæœ‰ç›¸åŒçš„è¯­æ³•ã€‚ä»–ä»¬ä¹‹å‰ä¸»è¦çš„ä¸åŒå°±æ˜¯å‡½æ•°åã€‚å¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼å¯ä»¥çœç•¥å‡½æ•°åï¼Œåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚å¼‚æ­¥å‡½æ•°è¡¨è¾¾å¼å¯ä»¥è¢«å½“æˆ IIFEï¼ˆè‡ªæ‰§è¡Œå‡½æ•°ï¼‰æ¥ä½¿ç”¨ï¼Œä¸€ç»å®šä¹‰å°±æ‰§è¡Œã€‚ çœ‹ä¸‹è¿™ä¸ªï¼š æ›´é‡è¦çš„åœ°ï¼Œasync/await åœ¨ä¸»æµæµè§ˆå™¨ä¸­çš„æ”¯æŒæƒ…å†µï¼š æœ€åŽï¼Œæœ€é‡è¦çš„æ˜¯ä¸è¦ç›²ç›®åœ°é€‰æ‹©â€œæœ€æ–°â€çš„å†™æ³•åŽ»å®žçŽ°å¼‚æ­¥å‡½æ•°ã€‚æœ¬è´¨æ˜¯è¦ç†è§£å¼‚æ­¥ javascript çš„å†…éƒ¨åŽŸç†ã€‚äº†è§£å®ƒä¸ºä»€ä¹ˆå¦‚æ­¤å…³é”®ï¼Œå¹¶æ·±å…¥ç†è§£ä½ çš„é€‰æ‹©çš„å†…éƒ¨åŽŸç†ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰ä¼˜ç¼ºç‚¹ï¼Œå°±åƒç¼–ç¨‹ä¸­çš„å…¶ä»–éƒ¨åˆ†ä¸€æ ·ã€‚ ç¼–å†™é«˜å¯ç»´æŠ¤æ€§ï¼Œå¥å£®çš„ä»£ç çš„5ä¸ªæç¤º1ã€ ç®€æ´çš„ä»£ç ä½¿ç”¨ async/await å…è®¸ä½ å†™å¾ˆå°‘çš„ä»£ç ã€‚æ¯æ¬¡ä½ ä½¿ç”¨ async/await è·³è¿‡ä¸€äº›ä¸å¿…é¡»è¦æ­¥éª¤ï¼šå†™ .then æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°åŽ»å¤„ç†å›žåº”ï¼Œç»™è¿”å›žå€¼å‘½åã€‚ä¾‹å¦‚ï¼š ä¸Žï¼š 2ã€é”™è¯¯å¤„ç†Async/await è®©å¤„ç†åŒæ­¥å’Œå¼‚æ­¥é”™è¯¯ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•â€”â€”å¹¿ä¸ºäººçŸ¥çš„ try/catchã€‚ ä¸Žï¼š 3ã€æ¡ä»¶è¯­å¥ä½¿ç”¨ async/await å†™æ¡ä»¶å¥æ›´ç®€å•ï¼š ä¸Žï¼š 4ã€å †æ ˆå¸§ä¸Ž async/await ä¸åŒï¼ŒPromise æŠ›å‡ºçš„é”™è¯¯æ ˆå¹¶æ²¡æœ‰åŒ…å«é”™è¯¯å‘ç”Ÿåœ¨å“ªé‡Œã€‚ ä¸Žï¼š 5ã€è°ƒè¯•å¦‚æžœä½ ä½¿ç”¨è¿‡ Promise, ä½ ä¸€å®šçŸ¥é“è°ƒè¯•å®ƒä»¬æ˜¯ä¸€ä¸ªå™©æ¢¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœä½ åœ¨ä¸€ä¸ª .then æ‰“äº†ä¸ªæ–­ç‚¹ï¼Œå¹¶ä¸”ä½¿ç”¨è°ƒè¯•å¿«æ·é”®æ“ä½œï¼Œåƒâ€œstop-overâ€ï¼Œè°ƒè¯•å™¨å¹¶ä¸ä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ª .then ï¼Œå› ä¸ºå®ƒåªæ˜¯åŒæ­¥ä»£ç çš„â€œä¸€æ­¥â€ã€‚ä½¿ç”¨ async/await ä½ å¯ä»¥ç²¾ç¡®åœ°å®šä½åˆ°æ¯ä¸€æ­¥ awaitï¼Œå°±å¥½åƒä»–ä»¬æ˜¯æ­£å¸¸çš„åŒæ­¥å‡½æ•°ä¸€æ ·ã€‚ ä¹¦å†™å¼‚æ­¥å‡½æ•°ä¸ä»…å¯¹åº”ç”¨ç¨‹åºå¾ˆé‡è¦ï¼Œå¯¹ç±»åº“ä¹ŸåŒæ ·å¦‚æ­¤ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š Sessionstak ç±»è®°å½•äº†ç½‘é¡µä¸Šå‘ç”Ÿçš„æ‰€æœ‰äº‹æƒ…ã€‚æ‰€æœ‰ DOM æ“ä½œï¼Œç”¨æˆ·äº¤äº’ï¼Œjavascript å¼‚å¸¸ï¼Œå †æ ˆè·Ÿè¸ªï¼Œå¤±è´¥çš„ç½‘ç»œè¯·æ±‚ï¼Œä»¥åŠè°ƒè¯•ä¿¡æ¯ã€‚ è¿™ä¸€åˆ‡éƒ½å‘ç”Ÿåœ¨ç”Ÿäº§çŽ¯å¢ƒä¸‹å´ä¸å½±å“ç”¨æˆ·ä½“éªŒã€‚æˆ‘ä»¬å¿…é¡»é«˜åº¦ä¼˜åŒ–æˆ‘ä»¬çš„ä»£ç ï¼Œè®©å®ƒä»¬å°½å¯èƒ½åœ°å¼‚æ­¥ï¼Œè¿™æ ·å°±å¯ä»¥å¢žåŠ äº‹ä»¶å¾ªçŽ¯å¤„ç†äº‹ä»¶çš„æ•°é‡ã€‚ ä¹Ÿä¸æ­¢æ˜¯ç±»åº“ï¼Œå½“ä½ åœ¨ SessionStack é‡æ’­ç”¨æˆ·çš„ä¼šè¯æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å‘ç”Ÿé—®é¢˜æ—¶ï¼Œå°†ç”¨æˆ·æµè§ˆå™¨çš„çŠ¶æ€é‡çŽ°å‡ºæ¥ï¼Œæˆ‘ä»¬å¿…é¡»é‡å»ºæ•´ä¸ªçŠ¶æ€ï¼Œå…è®¸ä½ åœ¨æ—¶é—´è½´ä¸Šå‘åŽæˆ–å‘å‰è·³è·ƒã€‚ä¸ºäº†è®©è¿™æˆä¸ºå¯èƒ½ï¼Œæˆ‘ä»¬å¤§é‡ä½¿ç”¨äº†å¼‚æ­¥javascriptæä¾›çš„æœºä¼šã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªå…è´¹çš„è®¡åˆ’è®©ä½ æ¥ä½“éªŒä¸€ä¸‹ã€‚ å‚è€ƒï¼š https://github.com/getify/You-Dont-Know-JS/blob/master/async%20%26%20performance/ch2.md https://github.com/getify/You-Dont-Know-JS/blob/master/async%20%26%20performance/ch3.md http://nikgrozev.com/2017/10/01/async-await/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>tutorial</tag>
        <tag>web development</tag>
        <tag>programming</tag>
        <tag>asynchronous</tag>
        <tag>events loop</tag>
        <tag>promise</tag>
        <tag>async await</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ å¯èƒ½å¹¶ä¸éœ€è¦ redux]]></title>
    <url>%2F2017%2F10%2F25%2Fyou-might-not-need-redux.html</url>
    <content type="text"><![CDATA[ä½ å¯èƒ½å¹¶ä¸éœ€è¦ reduxäººä»¬å¸¸å¸¸åœ¨çœŸæ­£éœ€è¦ç”¨åˆ° redux ä¹‹å‰å°±é€‰æ‹©äº†å®ƒã€‚ â€œå¦‚æžœæˆ‘ä»¬çš„åº”ç”¨æ²¡æœ‰ä½¿ç”¨ reduxï¼Œå˜å¾—ä¸å¥½æ‰©å±•æ€Žä¹ˆåŠžï¼Ÿâ€ åŽæ¥ï¼Œå¼€å‘è€…ä»¬åˆéƒ½çš±ç€çœ‰å¤´æŒ‡å¤´ä»–ä»¬çš„ä»£ç é—´æŽ¥åœ°è¯„è®º redux.â€œä¸ºä»€ä¹ˆå®žçŽ°ä¸€ä¸ªå°åŠŸèƒ½éœ€è¦æ›´æ”¹ä¸‰ä¸ªæ–‡ä»¶ï¼Ÿâ€ ä¸ºä»€ä¹ˆä¸€å®šè¦ç”¨ redux å‘¢! å¤§å®¶ç—›è‹¦åœ°æŒ‡è´£ redux, react, å‡½æ•°å¼ç¼–ç¨‹ã€ ä¸å˜æ€§ç­‰è¿™äº›ä¸œè¥¿ï¼Œæˆ‘èƒ½ç†è§£ä»–ä»¬ã€‚æˆ‘ä»¬å¾ˆè‡ªç„¶åœ°ä¼šæ‹¿ redux å’Œä¸éœ€è¦â€˜æŒ‰æ¨¡æ¿â€™æ¥æ›´æ–° state çš„å®žçŽ°æ–¹å¼è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å¾—å‡º redux åªä¼šè®©äº‹æƒ…å˜å¤æ‚çš„ç»“è®ºã€‚æŸç§ç¨‹åº¦ä¸Šçœ‹ï¼Œredux æ˜¯è¢«è®¾è®¡æˆè¿™æ ·çš„ã€‚ redux åšäº†ä¸€ä¸ªæƒè¡¡ï¼Œå®ƒè¦æ±‚ä½ ï¼š å°†åº”ç”¨çš„çŠ¶æ€æŠ½è±¡æˆç®€å•å¯¹è±¡æˆ–æ•°ç»„ã€‚ å°†ç³»ç»Ÿçš„å˜åŒ–æŠ½è±¡æˆç®€å•å¯¹è±¡ã€‚ å°†å¤„ç†é€»è¾‘æŠ½è±¡æˆçº¯å‡½æ•°ã€‚ ä¸ç®¡æ˜¯ä¸æ˜¯åº”ç”¨åœ¨ react åº”ç”¨ç¨‹åºä¸Šï¼Œè¿™äº›é™åˆ¶éƒ½æ˜¯å¿…éœ€çš„ã€‚äº‹å®žä¸Šï¼Œè¿™äº›éƒ½æ˜¯å¾ˆä¸¥æ ¼çš„çº¦æŸã€‚å°±ç®—åªæ˜¯åœ¨ä½ åº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ä¸­ä½¿ç”¨ï¼Œä¹Ÿåº”è¯¥è®¤çœŸè€ƒè™‘å®ƒã€‚ æœ‰äººä¼šé—®ï¼Œä½ æœ‰å……åˆ†çš„ç†ç”±è§£é‡Šä¸ºä»€ä¹ˆè¦åšè¿™äº›é™åˆ¶å—ï¼Ÿ è¿™äº›é™åˆ¶å¯¹æˆ‘å¾ˆæœ‰å¸å¼•åŠ›ï¼Œå› ä¸ºå®ƒä»¬è®©æˆ‘çš„åº”ç”¨æ‹¥æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š å°† state å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå¹¶ç”¨å®ƒå¯åŠ¨ï¼Œå¼€ç®±å³ç”¨ åœ¨æœåŠ¡ç«¯é¢„æ¸²æŸ“ stateï¼Œå¹¶éš html å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œä»Žå®ƒå¯åŠ¨ï¼Œå¼€ç®±å³ç”¨ åºåˆ—åŒ–ç”¨æˆ·äº¤äº’å¹¶è§¦å‘å®ƒï¼Œä»¥åŠè¿›è¡ŒçŠ¶æ€å¿«ç…§ï¼Œè‡ªåŠ¨ bugs ä¸ŠæŠ¥ï¼Œä»¥ä¾¿è®©å¼€å‘è€…é‡çŽ° errors é€šè¿‡ç½‘ç»œä¼ é€’ action å¯¹è±¡ï¼Œè€Œä¸ä¼šå¯¹å†™ä»£ç çš„æ–¹å¼äº§ç”Ÿå¤§çš„å½±å“ ä¿æŒé‡åšåŽ†å²å’Œå®žçŽ°å¯é¢„æµ‹çš„å˜åŒ–ï¼Œè€Œä¸ä¼šå¯¹å†™æ³•äº§ç”Ÿå‰§å¤§çš„å½±å“ å¼€å‘çŽ¯å¢ƒä¸­å¯ä»¥éšæ„ç©¿æ¢­åœ¨åŽ†å²çš„å„ä¸ªçŠ¶æ€ä¸­ï¼Œå¹¶åœ¨ä»£ç æ›´æ”¹æ—¶æ ¹æ®äº¤äº’åŽ†å²é‡æ–°è®¡ç®—å½“å‰çŠ¶æ€ï¼Œä¸€ç§ TDD é©±åŠ¨ ä¸ºå¼€å‘å·¥å…·æä¾›å…¨é¢çš„æ£€æµ‹å’ŒæŽ§åˆ¶èƒ½åŠ›ï¼Œä»¥ä¾¿äº§å“å¼€å‘è€…ä¸ºä»–ä»¬çš„ app æž„å»ºè‡ªå®šä¹‰å¼€å‘å·¥å…· å½“å¤ç”¨å¤§éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘çš„åŒæ—¶ï¼Œä¹Ÿæä¾›å¤‡ç”¨ UI å¦‚æžœä½ æ­£åœ¨å¼€å‘å¯æ‰©å±•çš„ terminal, javascript è°ƒè¯•å™¨, æˆ–æŸäº›ç±»åž‹çš„ webapp, redux å¯èƒ½å¾ˆå€¼å¾—ä¸€è¯•ï¼Œæˆ–è€…è‡³å°‘å€Ÿé‰´å®ƒçš„ä¸€äº›æ€æƒ³ï¼ˆé¡ºä¾¿æä¸€ä¸‹ï¼Œè¿™äº›å¹¶ä¸æ˜¯ æ–°äº‹ç‰©ï¼‰ã€‚ ä½†æ˜¯ï¼Œå¦‚æžœä½ åªæ˜¯åœ¨å­¦ä¹  react, é‚£ä¹ˆä¸è¦æŠŠ redux å½“æˆä½ çš„é¦–é€‰ã€‚ ç›¸åï¼Œå­¦ä¼š æ€è€ƒ react, å¦‚æžœä½ å‘çŽ°ä½ çœŸçš„éœ€è¦å®ƒï¼Œæˆ–è€…ä½ æƒ³å°è¯•ä¸€äº›æ–°ä¸œè¥¿ï¼Œé‚£å°±é‡æ–°è€ƒè™‘ redux å§ã€‚ä½†æ˜¯ä¸€å®šè¦è°¨æ…Žå¯¹å¾…å®ƒï¼Œå°±åƒå¯¹å¾…å›ºæ‰§å·²è§çš„å·¥å…·ä¸€æ ·ã€‚ å¦‚æžœä½ å¯¹ redux çš„æ–¹å¼æ„Ÿåˆ°åŽ‹åŠ›ã€‚è¿™æ˜¯ä¸€ä¸ªä¿¡å·ï¼Œå¯èƒ½ä½ çš„é˜Ÿå‹å¤ªè®¤çœŸäº†ã€‚ å®ƒåªæ˜¯ä½ å·¥å…·ç®±é‡Œçš„ä¸€ä¸ªå·¥å…·ï¼Œä¸€ä¸ªç–¯ç‹‚ çš„å®žéªŒã€‚ æœ€åŽï¼Œä¸è¦å¿˜è®°ï¼Œä½ å¯ä»¥ä¸ç”¨ redux,è€Œå®žçŽ° redux çš„æ€æƒ³ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œè€ƒè™‘ä¸€ä¸ªå¸¦æœ‰ local state çš„ react ç»„ä»¶: çœ‹ä¸ŠåŽ»å¾ˆå¥½ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œå®ƒæ²¡æœ‰è¾¾åˆ°é«˜åº¦å¤ç”¨ã€‚ ä½†æ˜¯ï¼Œè¿™æ ·ä½¿ç”¨ Local state å°±å¾ˆå¥½ã€‚ æƒè¡¡ä¹‹ä¸‹ï¼Œredux æä¾›è§£è€¦ï¼Œå°†â€œå‘ç”Ÿäº†ä»€ä¹ˆäº¤äº’â€ä¸Žâ€œæ•°æ®å¦‚ä½•æ”¹å˜â€è§£è€¦ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå¯ä»¥ä»Žæˆ‘ä»¬çš„ç»„ä»¶ä¸­æå–å‡ºä¸€ä¸ª reducer: æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰è¿è¡Œ npm install å´åº”ç”¨äº† redux ! å“‡å“¦ï¼ ä½ çš„çŠ¶æ€ç»„ä»¶æ˜¯å¦ä¹Ÿéœ€è¦è¿™æ ·å†™å‘¢ï¼Ÿå¯èƒ½ä¸éœ€è¦ã€‚é™¤éžä½ æœ‰è®¡åˆ’åœ°ä»Žè¿™ç§è§£è€¦æ–¹å¼ä¸­èŽ·ç›Šã€‚æœ‰è®¡åˆ’æ˜¯æˆ‘ä»¬çš„ä¸€ç§è¯´æ³•ï¼Œè¿™æ˜¯å…³é”®ã€‚ redux åº“æœ¬èº«åªæ˜¯â€œå®‰è£…â€ reducer å’Œå•ä¸ªå…¨å±€ store å¯¹è±¡çš„å·¥å…·é›†ã€‚ä½ å¯ä»¥åªä½¿ç”¨éƒ¨åˆ†æˆ–è€…å…¨éƒ¨åŠŸèƒ½ï¼Œè¿™å–å†³äºŽä½ ã€‚ ä½†ï¼Œå¦‚æžœä½ ä»˜å‡ºäº†ä»€ä¹ˆï¼Œä¸€å®šè¦ç¡®ä¿ä½ æœ‰æ‰€æ”¶èŽ·ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>redux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£ ios11 webview çš„ viewport]]></title>
    <url>%2F2017%2F09%2F21%2FUnderstanding-the-WebView-Viewport-in-iOS-11.html</url>
    <content type="text"><![CDATA[æ·±å…¥ç†è§£ ios11 webview çš„ viewportios11 å¸¦æ¥äº†ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œå‡­ç›´è§‰ï¼Œå›´ç»•çŠ¶æ€æ åŒºåŸŸçš„å±•çŽ°å¯¹äºŽç¨‹åºå‘˜ä½¿ç”¨çš„åƒ Apache Cordova æˆ– Ionic è¿™æ ·çš„å·¥å…·æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚å°¤å…¶æ˜¯ï¼Œè¿™ä¸ªæ”¹åŠ¨å½±å“åˆ°æ‰€æœ‰ä¸º ios11 æž„å»ºçš„ã€åŸºäºŽ web çš„ã€ä½¿ç”¨äº†å›ºå®šæ ‡é¢˜æ çš„ app ä¹‹ä¸­ã€‚è¿™ç¯‡æ–‡ç« å¸®åŠ©ä½ ç†è§£ ios11 webview çš„ viewportã€‚ æ³¨ï¼š çŽ°æœ‰çš„ app å¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œï¼Œå› ä¸ºåŽŸæœ‰çš„ viewport è¡¨çŽ°å¹¶æ²¡æœ‰è¢«æ”¹å˜ã€‚è¿™ä¸ªæ”¹å˜åªå½±å“é‚£äº›ä½¿ç”¨ xcode9 æ¥ä¸º ios11 æž„å»ºçš„åº”ç”¨ã€‚ ä¸ºäº†ç†è§£è¿™ä¸ªæ”¹åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹èƒŒæ™¯çŸ¥è¯†ã€‚ çŠ¶æ€æ å’Œå®‰å…¨åŒºåŸŸåœ¨ ios çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼ŒçŠ¶æ€æ æ˜¯å±å¹•é¡¶éƒ¨çš„ä¸å¯è§¦æ‘¸çš„é»‘è‰²é•¿æ¡ã€‚å®ƒæ˜¯ç³»ç»Ÿ UI çš„ä¸€éƒ¨åˆ†ï¼Œè€Œ app è¿è¡Œåœ¨å®ƒçš„ä¸‹é¢ã€‚ éšç€ ios7 çš„å‘å¸ƒï¼Œä¸€åˆ‡å‘ç”Ÿäº†æ”¹å˜ã€‚å®ƒå˜æˆäº†ä¸€ä¸ªé€æ˜Žçš„çŠ¶æ€æ ï¼Œä»Žè€Œæ˜¾ç¤ºäº† app å¯¼èˆªæ çš„é¢œè‰²ã€‚å¯¹äºŽåƒ Cordova è¿™æ ·æ˜¾ç¤ºåœ¨ webview çš„ app, æ„å‘³ç€é€šå¸¸éœ€è¦æ£€æµ‹æ˜¯å¦ ios å¹¶æ·»åŠ  padding-top: 20px åˆ°å›ºå®šçš„å¤´éƒ¨å¯¼èˆª, ä»¥ä¾¿æ­£ç¡®å¡«å……é‚£éƒ¨åˆ†ç©ºé—´ã€‚ åŽæ¥å‘å¸ƒçš„è¾ƒæ–°ç‰ˆæœ¬çš„ ios æ·»åŠ äº†ä¸€äº›å°ä¿®è®¢ã€‚åŒ…å«äº†ä¸€äº›æ–°åŠŸèƒ½ï¼Œæ¯”å¦‚å½“æœ‰ç”µè¯å‘¼å…¥æˆ–åœ¨åŽå°ä½¿ç”¨å®šä½åŠŸèƒ½æ—¶é¡¶éƒ¨ä¼šå±•ç¤ºé¢å¤–çš„çŠ¶æ€æ ã€‚ åœ¨åŽŸç”Ÿåº”ç”¨æ–¹é¢ï¼Œå­˜åœ¨å¤§é‡çš„å¯¼èˆªæ å’Œè‡ªåŠ¨å¸ƒå±€æŒ‡å—ã€‚ä¼šæœ‰ä¸€äº›å¸ƒå±€æŒ‡ç¤ºåœ¨å±å¹•çš„é¡¶éƒ¨æˆ–åº•éƒ¨ä»¥ä¾¿è‡ªåŠ¨è°ƒæ•´é«˜åº¦ï¼Œè®©çŠ¶æ€æ ä¸ä¼šé®ä½åº”ç”¨ã€‚å¦‚æžœåœ¨é¡¶éƒ¨è®¾ç½®äº† UINavigationBarï¼Œ ios ä¼šè‡ªåŠ¨åœ¨çŠ¶æ€æ æ‹“å±•å®ƒçš„é¢œè‰²ã€‚å¯¹äºŽ webï¼Œå¾ˆä¸å¹¸ï¼Œæ²¡æœ‰ç­‰ä»·çš„åŠžæ³•ã€‚ iOS11 çš„æ”¹å˜ ios11 å’Œå…ˆå‰ç‰ˆæœ¬çš„ä¸åŒä¹‹å¤„åœ¨äºŽï¼Œ webview å†…å®¹çŽ°åœ¨é‡è§†å®‰å…¨åŒºåŸŸäº†ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æžœè®¾ç½®å¤´éƒ¨æ  top: 0, å®ƒä¼šæ¸²æŸ“åœ¨å±å¹•é¡¶éƒ¨çš„20pxä¹‹ä¸‹ï¼Œä¹Ÿå°±æ˜¯çŠ¶æ€æ ä¸‹é¢ã€‚å½“å‘ä¸‹æµè§ˆæ—¶ï¼Œä¼šç§»åˆ°çŠ¶æ€æ åŽé¢ã€‚å½“å‘ä¸Šæµè§ˆæ—¶ï¼Œåˆä¼šç§»åŠ¨çŠ¶æ€æ ä¸‹é¢ä¸ŽçŠ¶æ€æ éƒ¨å¯¹é½ã€‚ï¼ˆç•™ä¸‹å°´å°¬çš„20åƒç´ ç©ºç™½ï¼‰ å¯ä»¥çœ‹çœ‹ä¸‹é¢å‰ªè¾‘çš„è§†é¢‘ä¸­äº†è§£åˆ°æœ‰å¤šä¹ˆç³Ÿç³•ï¼š ä¸ºä»€ä¹ˆè‹¹æžœå…¬å¸ä¼šæ”¹æˆè¿™ä¸ªæ ·å­å¦‚æžœä½ çœ‹è¿‡ iPhone X çš„è®¾è®¡ï¼Œå°±çŸ¥é“å®ƒè¿™æ ·æ”¹åŠ¨æ˜¯æœ‰é“ç†çš„ï¼š iPhone X çš„å±å¹•é¡¶éƒ¨æœ‰ä¸ªä¸ºæ‘„åƒå¤´å’Œè¯ç­’ç•™å‡ºçš„ä¸è§„åˆ™åŒºåŸŸã€‚å¦‚æžœçœŸçš„æ¸²æŸ“åˆ°å±å¹•é¡¶éƒ¨ï¼Œå°±ä¼šè¢«éº¦å…‹é£ŽæŒ¡ä½ã€‚ é€šè¿‡å¯¹é½çŠ¶æ€æ åº•éƒ¨ï¼Œå¯ä»¥ç¡®ä¿å¤´éƒ¨æ å¯ä»¥ä¸€ç›´è¢«è®¿é—®ã€‚ é…·ï¼â€¦é™¤äº†çŽ°åœ¨ app ä¸Šé¢æ»‘åŠ¨å†…å®¹æ—¶åœ¨çŠ¶æ€æ åº•ä¸‹ç•™ä¸‹çš„å°´å°¬çš„ç©ºç™½ã€‚ iOS11 è§£å†³æ–¹æ¡ˆå€¼å¾—åº†å¹¸çš„æ˜¯ï¼ŒApple ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªé€šè¿‡è®¾ç½® viewport meta æ ‡ç­¾çš„è§£å†³æ–¹æ¡ˆã€‚æ›´å¹¸è¿çš„æ˜¯ï¼Œå®ƒè¿˜å‘ä¸‹å…¼å®¹æ—§çš„ï¼Œè¿‡æœŸçš„ UIWebViewã€‚ æˆ‘ä»¬æ­£åœ¨æ‰¾çš„ viewport é€‰é¡¹å°±æ˜¯ viewport-fit,å®ƒæœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼š containï¼š è¿™æ„å‘³ç€ iOS11 ä¸‹ï¼Œå›ºå®šæ ä¼šè¢«åŒ…å«åœ¨å®‰å…¨åŒºåŸŸå†…ã€‚ coverï¼š è¿™æ„å‘³ç€å›ºå®šæ æ˜¯ç›¸å¯¹ viewport å›ºå®šçš„ï¼Œå°±ç®—ä¼šè¢«ç«‹å¤§çŠ¶æ€æ é®è”½ã€‚è¿™å°±å›žåˆ°äº† iOS10 çš„è¡¨çŽ°ã€‚ autoï¼š è¿™å’Œ contain é€‰é¡¹çš„è¡¨çŽ°æ˜¯ä¸€æ ·çš„ã€‚ æ‰€ä»¥ä¸ºäº†æ¢å¤åˆ°å›ºå®šåœ¨å±å¹•çš„æœ€é¡¶ç«¯ï¼Œå°±åƒ iOS10 ä¸€æ ·åœ¨çŠ¶æ€æ ä¸‹é¢ã€‚å¯ä»¥æ·»åŠ  viewport-fit=cover åˆ° viewport meta æ ‡ç­¾ã€‚ iPhone Xä½† iPhone X çš„å°åˆ˜æµ·æ€Žä¹ˆåŠžï¼Ÿè¿™ä¸ªçŠ¶æ€æ ä¸å†æ˜¯ 20px é«˜ï¼Œå¹¶ä¸”å› ä¸ºé‡Œé¢æœ‰æ‘„åƒå¤´å’Œæ‰¬å£°å™¨ï¼Œå¤´éƒ¨æ ä¼šå®Œå…¨æ— æ³•è®¿é—®ã€‚åŒæ ·è¦æ³¨æ„å›ºå®šåœ¨å±å¹•åº•éƒ¨çš„é¡µè„šï¼Œå®ƒä¼šè¢«éº¦å…‹é£Žé®ä½ã€‚ æ³¨ï¼šå¦‚æžœæœ‰å¯åŠ¨è„šæœ¬ï¼Œåº”ç”¨å°†åªä¼šè¿è¡Œåœ¨ iPhone X çš„å…¨å±å¹•ä¸Šã€‚çŽ°æœ‰çš„ app ä¼šåœ¨é¡¶éƒ¨å’Œåº•éƒ¨æœ‰é»‘è‰²åŒºåŸŸã€‚ å¹¸è¿çš„æ˜¯ï¼ŒApple ç»™å‡ºäº†ä¸€ä¸ªå…³äºŽå®‰å…¨åŒºåŸŸçš„ css æŒ‡å—ã€‚ä»–ä»¬æ·»åŠ ä¸€ä¸ªç±»ä¼¼ css å˜é‡ï¼Œå«åš css å¸¸æ•°ã€‚å¯ä»¥æŠŠå®ƒçœ‹åšæ˜¯ç³»ç»Ÿçš„ css å˜é‡å¹¶ä¸”ä¸å¯è¦†ç›–ã€‚å¯ä»¥åœ¨ css ä¸­é€šè¿‡constant() å‡½æ•°æ¥è°ƒç”¨å®ƒä»¬ï¼Œå¹¶ä¸”å·²å‘ css æ ‡å‡†åŒ–å·¥ä½œå°ç»„ææ¡ˆã€‚ è¿™å››ä¸ªå¸ƒå±€å¸¸é‡æ˜¯ï¼š constant(safe-area-inset-top): viewport é¡¶éƒ¨æ’å…¥çš„å®‰å…¨åŒºåŸŸï¼ˆä½¿ç”¨ css åƒç´ ï¼‰ constant(safe-area-inset-bottom): viewport åº•éƒ¨æ’å…¥çš„å®‰å…¨åŒºåŸŸï¼ˆä½¿ç”¨ css åƒç´ ï¼‰ constant(safe-area-inset-left): viewport å·¦è¾¹æ’å…¥çš„å®‰å…¨åŒºåŸŸï¼ˆä½¿ç”¨ css åƒç´ ï¼‰ constant(safe-area-inset-right): viewport å³è¾¹æ’å…¥çš„å®‰å…¨åŒºåŸŸï¼ˆä½¿ç”¨ css åƒç´ ï¼‰ è¿™æ˜¯ Apple ç»™æˆ‘ä»¬çš„æœ€åŽä¸€ä¸ªç¤¼ç‰©ï¼Œä¹Ÿæ˜¯å‘ä¸‹å…¼å®¹çš„ã€‚ css constants çš„ä¾‹å­å‡è®¾æœ‰ä¸€ä¸ªå¤´éƒ¨å›ºå®šæ ï¼ŒçŽ°åœ¨ iOS10 ä¸‹çš„ css å¦‚ä¸‹ï¼š header { position: fixed; top: 0; left: 0; right: 0; height: 44px; padding-top: 20px; /* Status bar height */ } ä¸ºäº†è°ƒæ•´è‡ªé€‚åº” iPhone X å’Œ iOS11 è®¾å¤‡ï¼Œä¼šæ·»åŠ  viewport-fit=cover é€‰é¡¹åˆ° viewport meta æ ‡ç­¾ä¸Šï¼Œå¹¶ä¸”æ›´æ”¹ cssï¼Œ å¼•ç”¨ css constantã€‚ header { /* ... */ /* Status bar height on iOS 10 */ padding-top: 20px; /* Status bar height on iOS 11+ */ padding-top: constant(safe-area-inset-top); } é‡è¦çš„æ˜¯ï¼Œè¦ä¿ç•™å›žé€€å€¼ï¼Œå› ä¸ºæ—§è®¾å¤‡ä¸èƒ½è§£é‡Š css constant() è¯­æ³•ã€‚åˆ«å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨ css calc() è¡¨è¾¾å¼ä¸­ä½¿ç”¨ constants. è®°ä½ï¼Œä½ ä¹Ÿä¼šæƒ³è¦åœ¨å±å¹•åº•éƒ¨åšè¿™ä»¶äº‹çš„ã€‚]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>ios11</tag>
        <tag>viewport</tag>
        <tag>css-constant</tag>
        <tag>viewport-fit</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IphoneX çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆ]]></title>
    <url>%2F2017%2F09%2F21%2Fthe-notch-and-css.html</url>
    <content type="text"><![CDATA[IphoneX çš„ç¼ºå£ï¼ˆå°åˆ˜æµ·ï¼‰åŠå…¶cssæ ·å¼è§£å†³æ–¹æ¡ˆè‹¹æžœå…¬å¸çš„ IphoneX æ‹¥æœ‰äº†å…¨é¢å±ï¼Œåªä¿ç•™äº†â€˜å°åˆ˜æµ·â€™ç»™æ‘„åƒå¤´å’Œä¸€äº›ä¼ æ„Ÿè®¾å¤‡ã€‚ç»“æžœå°±æ˜¯è®©å±å¹•è®¾è®¡é™·å…¥å°´å°¬çš„å¢ƒåœ°ï¼Œå°±åƒé™åˆ¶ç½‘é¡µæœ‰ä¸€ä¸ªâ€œå®‰å…¨åŒºåŸŸâ€å’Œç™½è‰²è¾¹ç¼˜æ¡ã€‚è™½ç„¶æ²¡æœ‰å¤ªå¤šçš„é»‘é­”æ³•åŽ»æ¶ˆé™¤å®ƒï¼Œä½†ç»™ body è®¾ç½®ä¸€ä¸ª background-color å±žæ€§ä¹Ÿå¯ä»¥åšåˆ°ã€‚æˆ–è€…æ‰©å±•ç½‘é¡µä»¥è¦†ç›–æ•´ä¸ªå±å¹•ï¼ˆè¯¥æ­»çš„ç¼ºå£ï¼‰ï¼Œå¯ä»¥ç»™ viewport çš„ meta æ ‡ç­¾æ·»åŠ  viewport-fit=coverã€‚ ç„¶åŽï¼Œç”±ä½ è‡ªå·±å†³å®šå¦‚ä½•å¤„ç†å®‰å…¨åŒºåŸŸçš„é‡å ã€‚è¿™é‡Œæœ‰ä¸€äº›æ–°çš„ css å¯ä»¥å¸®åŠ©é€‚é…å®ƒã€‚Stephen Radford documents ä¸ºäº†é€‚é…ç¼ºå£ï¼Œå¯ä»¥å¼•å…¥ ios 11 ç‰ˆæœ¬åŒ…å«çš„ä¸€äº›å¸¸é‡ï¼Œè¿™äº›å¸¸é‡éœ€è¦ä½¿ç”¨äº† viewport-fit=cover æ‰ä¼šç”Ÿæ•ˆã€‚ safe-area-inset-top safe-area-inset-right safe-area-inset-left safe-area-inset-bottom è¿™äº›å¸¸é‡å¯ä»¥è¢«ç”¨åœ¨ margin, padding, æˆ–è€…ç»å¯¹å®šä½çš„ top, left ç­‰å±žæ€§ä¸Šã€‚ padding: constant(safe-area-inset-top) constant(safe-area-inset-right) constant(safe-area-inset-bottom) constant(safe-area-inset-left); è¿˜æœ‰å¦å¤–ä¸€ä¸ªå°´å°¬çš„å±€é¢å…³äºŽç¼ºå£ï¼Œå®‰å…¨åŒºåŸŸå’Œ fixed å®šä½ã€‚Darryl Pogue reports: ios 11ä¸Žæ—©æœŸçš„ç‰ˆæœ¬ä¸å¤ªä¸€æ ·ï¼Œå®ƒçŽ°åœ¨éµå®ˆå®‰å…¨åŒºåŸŸè¿™ä¸€è§„åˆ™ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æžœä½ æœ‰ä¸€ä¸ª header barï¼Œ å¹¶ä¸”è®¾ç½® position: fixed;top: 0;ï¼Œå®ƒåˆå§‹åŒ–æ—¶ä¼šæ¸²æŸ“åœ¨é¡¶éƒ¨çš„ 20px ä¸‹é¢ï¼šå¯¹é½é¡¶éƒ¨çŠ¶æ€æ çš„åº•éƒ¨ã€‚å½“ä½ å‘ä¸‹æµè§ˆç½‘é¡µï¼Œå®ƒä¼šéšè—çŠ¶æ€æ ã€‚å¦‚æžœå‘ä¸Šæ»šåŠ¨ï¼ŒçŠ¶æ€æ åˆæ¥è·‘å‡ºæ¥ï¼ˆç•™ä¸‹å°´å°¬çš„20pxé—´éš™ï¼‰ã€‚ å¹¸è¿çš„æ˜¯è¿™ä¹Ÿå¾ˆå®¹æ˜“è§£å†³ã€‚åªéœ€è¦æ·»åŠ  viewport-fit=cover åˆ° meta viewport æ ‡ç­¾ä¸Šã€‚ å¦‚æžœè¦†ç›–äº†å…¨å±å¹•ï¼Œé‚£å¯èƒ½éœ€è¦è€ç‚¹å°èªæ˜ŽåŽ»é¿å…æŒ¡ä½å†…å®¹ã€‚ I think Iâ€™ve fixed the notch issue in landscape ðŸ¾ #iphoneX pic.twitter.com/hGytyO3DRVâ€” Vojta Stavik (@vojtastavik) September 13, 2017]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>viewport</tag>
        <tag>css</tag>
        <tag>iphoneX</tag>
        <tag>notch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²]]></title>
    <url>%2F2017%2F09%2F19%2Fhow-to-handle-4-common-memory-leaks.html</url>
    <content type="text"><![CDATA[å¦‚ä½•å¤„ç†4ç§å¸¸è§çš„å†…å­˜æ³„éœ²ä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²æœ¬è´¨ä¸Šæ¥è¯´ï¼Œå†…å­˜æ³„éœ²å¯ä»¥è¢«å®šä¹‰ä¸º å½“å†…å­˜ä¸å†è¢«åº”ç”¨ä½¿ç”¨ï¼Œå´å› ä¸ºæŸäº›åŽŸå› æ²¡æœ‰è¢«æ“ä½œç³»ç»Ÿå›žæ”¶æˆ–é‡Šæ”¾åˆ°è‡ªç”±å†…å­˜æ±  ç¼–ç¨‹è¯­è¨€æ”¯æŒå¤šç§ä¸åŒçš„å†…å­˜ç®¡ç†ã€‚æŸäº›å†…å­˜æ˜¯å¦åœ¨ä½¿ç”¨å®žé™…ä¸Šæ˜¯ä¸å¯åˆ¤å®šçš„ã€‚æ¢å¥è¯è¯´ï¼Œåªè¦å¼€å‘è€…æ‰æ¸…æ¥šå“ªäº›å†…å­˜å—æ˜¯å¯ä»¥è¢«æ“ä½œç³»ç»Ÿå›žæ”¶ã€‚ æŸäº›ç¼–ç¨‹è¯­è¨€æä¾›ä¸€äº›ç‰¹æ€§å¸®åŠ©å¼€å‘è€…è¿›è¡Œå†…å­˜å›žæ”¶ã€‚å…¶ä»–çš„æœŸæœ›å¼€å‘è€…å®Œå…¨æ˜Žç™½å“ªäº›å†…å­˜æ˜¯æ— ç”¨çš„ã€‚ç»´åŸºæœ‰ä¸€ç³»åˆ—å…³äºŽå†…å­˜ç®¡ç†çš„å¥½æ–‡ç« ã€‚ å››ç§å¸¸è§çš„å†…å­˜æ³„éœ²1. å…¨å±€å˜é‡javascript é€šè¿‡ä¸€ä¸ªæœ‰è¶£çš„æ–¹å¼å¤„ç†æœªå£°æ˜Žçš„å˜é‡ï¼šå¼•ç”¨æœªå£°æ˜Žçš„å˜é‡ä¼šåœ¨å…¨å±€å¯¹è±¡é‡Œåˆ›å»ºä¸€ä¸ªå˜é‡ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œå…¨å±€å¯¹è±¡æ˜¯window, æ¢å¥è¯è¯´ï¼š function foo(arg) { bar = "some text"; } ç­‰ä»·äºŽï¼š function foo(arg) { window.bar = "some text"; } å¦‚æžœ bar é¢„æƒ³ä¸­æ˜¯ foo å‡½æ•°ä½œç”¨åŸŸå†…çš„å±€éƒ¨å˜é‡ï¼Œä½†åˆå¿˜è®°ä½¿ç”¨ var åŽ»å£°æ˜Žï¼Œé‚£ä¹ˆé¢„æ–™ä¹‹å¤–çš„å…¨å±€å˜é‡å°±è¢«åˆ›å»ºäº†ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²æ³„éœ²ä¸ä¼šæœ‰å¤šå¤§å®³å¤„ï¼Œä½†è¿™ç§å†™æ³•å½“ç„¶ä¼šæœ‰æ›´ç³Ÿæƒ…å†µã€‚ å¦ä¸€ä¸ªæ„å¤–åˆ›å»ºå…¨å±€å˜é‡çš„æ–¹å¼æ˜¯é€šè¿‡ thisï¼š function foo() { this.var1 = "potential accidental global"; } // Foo called on its own, this points to the global object (window) // rather than being undefined. foo(); ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œéœ€è¦åœ¨ javascript æ–‡ä»¶çš„å¼€å¤´æ·»åŠ  'use strict'.è¿™ä¼šä½¿ç”¨ä¸¥æ ¼æ¨¡å¼è§£æžjavascriptä»¥é˜²æ­¢æ„å¤–çš„å…¨å±€å˜é‡ã€‚äº†è§£æ›´å¤šjavascriptä¸¥æ ¼æ¨¡å¼çš„æ‰§è¡Œæƒ…å†µ å°½ç®¡æˆ‘ä»¬åœ¨è°ˆè®ºæ„å¤–çš„å…¨å±€å˜é‡ï¼Œä½†ä»ç„¶ä¼šæœ‰æ— æ•°çš„æ˜Žç¡®çš„å…¨å±€å˜é‡ã€‚è¿™äº›è¢«å®šä¹‰ä¸ºä¸å¯å›žæ”¶çš„ï¼ˆé™¤éžæŒ‡å®šä¸ºnullæˆ–é‡æ–°åˆ†é…ï¼‰ã€‚ç‰¹åˆ«æ˜¯åº”è¯¥å…³æ³¨ç”¨äºŽä¸´æ—¶å­˜å‚¨å’Œå¤„ç†å¤§é‡æ•°æ®çš„å…¨å±€å˜é‡ã€‚å¦‚æžœå¿…é¡»è¦ç”¨å…¨å±€å˜é‡åŽ»å­˜å‚¨å¤§é‡æ•°æ®ï¼Œå½“ä½ å¤„ç†å®Œä¹‹åŽï¼Œè¯·å‹¿å¿…è®°å¾—æŒ‡å®šä¸ºnullæˆ–é‡æ–°å…¨é… 2. è¢«é—å¿˜çš„å®šæ—¶å™¨å’Œå›žè°ƒåœ¨ javascript ä¸­ä½¿ç”¨ setInterval éžå¸¸å¸¸è§ã€‚ å¤§éƒ¨åˆ†ç±»åº“æä¾›è§‚å¯Ÿè€…å’Œå…¶ä»–è°ƒç”¨å›žè°ƒçš„å·¥å…·ï¼Œå°å¿ƒåœ°å¼•ç”¨é‚£äº› æ‹¥æœ‰ä¼šå˜å¾—ä¸å¯è®¿é—®çš„å®žä¾‹ çš„å›žè°ƒã€‚setInterval çš„ä¾‹å­ï¼Œå°½ç®¡è¿™å¾ˆå¸¸è§ï¼š var serverData = loadData(); setInterval(function() { var renderer = document.getElementById('renderer'); if(renderer) { renderer.innerHTML = JSON.stringify(serverData); } }, 5000); //This will be executed every ~5 seconds. è¿™ä¸ªä¾‹å­è¯´æ˜Žäº†å®šæ—¶å™¨ä¼šå‘ç”Ÿçš„äº‹ï¼šå®šæ—¶å™¨å¼•ç”¨äº†ä¸å†éœ€è¦çš„nodeèŠ‚ç‚¹å’Œæ•°æ®ã€‚ è¢« renderer å¼•ç”¨çš„å¯¹è±¡åœ¨å°†æ¥æŸä¸ªæ—¶åˆ»å¯èƒ½ä¼šè¢«åˆ é™¤ï¼Œè®©æ•´ä¸ªå†…éƒ¨å—éƒ½å˜å¾—ä¸å¿…è¦äº†ã€‚ä½†æ˜¯ï¼Œå› ä¸ºå®šæ—¶å™¨è¿˜åœ¨è¿è¡Œï¼Œæ‰€ä»¥å¤„ç†ç¨‹åºä¸èƒ½è¢«å›žæ”¶ï¼ˆå®šæ—¶å™¨éœ€è¦è¢«åœæ­¢æ‰èƒ½å›žæ”¶ï¼‰ã€‚å¦‚æžœå®šæ—¶å¤„ç†ç¨‹åºä¸èƒ½è¢«å›žæ”¶ï¼Œé‚£ä¹ˆç›¸å…³çš„ä¸€åˆ‡éƒ½ä¸èƒ½è¢«å›žæ”¶ã€‚è¿™æ„å‘³ç€å¯èƒ½å­˜å‚¨ç€å¤§é‡æ•°æ®çš„ serverData ä¹Ÿä¸èƒ½è¢«å›žæ”¶ã€‚ è§‚å¯Ÿè€…çš„ä¾‹å­ä¸­ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯å½“ä¸åœ¨éœ€è¦çš„æ—¶å€™ï¼Œå¿…é¡»æ˜Žç¡®ç§»é™¤ä»–ä»¬ï¼ˆæˆ–è€…è®©ç›¸å…³çš„å¯¹è±¡å˜å¾—ä¸å¯è®¿é—®ï¼‰ã€‚ åœ¨è¿‡åŽ»ï¼Œè¿™å¯¹äºŽæŸäº›ä¸èƒ½å¾ˆå¥½åœ°ç®¡ç†å†…å­˜çš„æµè§ˆå™¨ï¼ˆåƒIE6ï¼‰æ˜¯éžå¸¸é‡è¦çš„ã€‚å¦‚ä»Šï¼Œå¤§éƒ¨åˆ†æµè§ˆå™¨æœ‰èƒ½åŠ›å¹¶ä¸”ä¼šå›žæ”¶ä¸å¯è®¿é—®çš„è§‚å¯Ÿè€…å¤„ç†ç¨‹åºï¼Œå°±ç®—æœ‰æ—¶ç›‘å¬å™¨æ²¡æœ‰è¢«æ˜Žç¡®åœ°ç§»é™¤ã€‚è¿™ä»ç„¶æ˜¯å¾ˆå¥½çš„åšæ³•ï¼Œä¸ç®¡æ€Žæ ·ï¼Œåœ¨å¯¹è±¡è¢«å¤„ç†æŽ‰ä¹‹å‰æ˜Žç¡®åœ°ç§»é™¤è§‚å¯Ÿè€…ã€‚ä¸¾ä¸ªå®žä¾‹ï¼š var element = document.getElementById('launch-button'); var counter = 0; function onClick(event) { counter++; element.innerHtml = 'text ' + counter; } element.addEventListener('click', onClick); // Do stuff element.removeEventListener('click', onClick); element.parentNode.removeChild(element); // Now when element goes out of scope, // both element and onClick will be collected even in old browsers // that don't handle cycles well. æ¡†æž¶æˆ–ç±»åº“ï¼Œæ¯”å¦‚ jQuery åœ¨åˆ é™¤ node èŠ‚ç‚¹çš„æ—¶å€™å°±ç§»é™¤äº†ç›‘å¬äº‹ä»¶ï¼ˆå½“ä½¿ç”¨å®ƒçš„APIçš„æ—¶å€™ï¼‰ï¼Œè¿™æ˜¯ç±»åº“å†…éƒ¨å¤„ç†çš„ï¼Œä¸ºäº†é˜²æ­¢å†…å­˜æ³„éœ²äº§ç”Ÿã€‚å°±ç®—åœ¨æœ‰é—®é¢˜çš„æµè§ˆå™¨ä¸‹è¿è¡Œï¼Œæ¯”å¦‚â€¦å¯¹ï¼ŒIE6 ï¼šï¼‰ é—­åŒ…ï¼ˆclosureï¼‰javascript å¼€å‘ä¸€ä¸ªå…³é”®ç‚¹æ˜¯ é—­åŒ…ï¼š ä¸€ä¸ªå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®ï¼ˆå°é—­çš„ï¼‰å¤–éƒ¨å‡½æ•°çš„å˜é‡ã€‚ç”±äºŽ javascript è¿è¡ŒçŽ¯å¢ƒçš„å®žçŽ°ï¼Œä»¥ä¸‹æ–¹å¼å¾ˆå¯èƒ½é€ æˆå†…å­˜æ³„éœ²ï¼š var theThing = null; var replaceThing = function () { var originalThing = theThing; var unused = function () { if (originalThing) // a reference to 'originalThing' console.log("hi"); }; theThing = { longStr: new Array(1000000).join('*'), someMethod: function () { console.log("message"); } }; }; setInterval(replaceThing, 1000); è¿™æ®µä»£ç åšäº†ä¸€ä»¶äº‹ï¼šæ¯æ¬¡è°ƒç”¨ replaceThing æ—¶ï¼ŒtheThing æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«å¤§æ•°æ®å’Œé—­åŒ…ï¼ˆsomeMethodï¼‰çš„æ–°å¯¹è±¡ï¼ŒåŒæ—¶ï¼Œ unused ä¹ŸæŒ‡å‘ä¸€ä¸ªå¼•ç”¨äº† originalThingï¼ˆtheThing æŒ‡å‘å‰ä¸€æ¬¡ replaceThing è°ƒç”¨ï¼‰ çš„é—­åŒ…ï¼Œå·²ç»æœ‰ç‚¹æ··ä¹±äº†ï¼Œå•Šå“ˆï¼Ÿé‡ç‚¹æ˜¯ï¼Œä¸€æ—¦ä¸ºä¸€ä¸ªå…·æœ‰ç›¸åŒçˆ¶çº§ä½œç”¨åŸŸçš„é—­åŒ…åˆ›å»ºä½œç”¨åŸŸï¼Œä½œç”¨åŸŸæ˜¯å…±äº«çš„ è¿™ç§æƒ…å†µä¸‹ï¼Œ ä¸ºé—­åŒ… someMethod åˆ›å»ºçš„ä½œç”¨åŸŸä¸Ž unused å…±äº«ã€‚unused æœ‰ä¸€ä¸ªæŒ‡å‘ originalThing çš„å¼•ç”¨ã€‚å°½ç®¡ unused ä»Žæœªè¢«ä½¿ç”¨ï¼Œä½†æ˜¯ someMethod å¯ä»¥é€šè¿‡ theThing ä¹Ÿå°±æ˜¯ replaceThing å¤–å›´çš„ä½œç”¨åŸŸï¼ˆä¾‹å¦‚ï¼šå…¨å±€èŒƒå›´å†…ï¼‰è°ƒç”¨ã€‚ä¸Žæ­¤åŒæ—¶ someMethod ä¸Ž unused å…±äº«é—­åŒ…ä½œç”¨åŸŸï¼Œunused å¼•ç”¨ originalThing è¿«ä½¿å®ƒä¿æŒåœ¨å†…å­˜ä¸­ï¼ˆåœ¨ä¸¤ä¸ªé—­åŒ…å…±äº«çš„ä½œç”¨åŸŸèŒƒå›´ï¼‰ã€‚è¿™é˜»æ­¢äº†å®ƒè¢«å›žæ”¶ã€‚ å½“è¿™æ®µä»£ç åå¤åœ°è¿è¡Œæ—¶ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°å†…å­˜ä½¿ç”¨çŽ‡ç¨³å®šåœ°å¢žé•¿ã€‚GC è¿è¡Œæ—¶ä¹Ÿå¹¶æœªå‡å°‘ã€‚æœ¬è´¨ä¸Šï¼Œä¸€ä¸ªé—­åŒ…é“¾è¢«åˆ›å»ºäº†ï¼ˆé€šè¿‡æ ¹ä½œç”¨åŸŸçš„ theThing å˜é‡ï¼‰ã€‚è€Œæ¯ä¸€ä¸ªé—­åŒ…ä½œç”¨åŸŸé™„å¸¦ç€å¼•ç”¨äº†å¤§æ•°æ®ï¼Œç»“æžœå°±æ˜¯å†…å­˜æ³„éœ²ã€‚ è¿™ä¸ªé—®é¢˜è¢« Meteor å›¢é˜Ÿå‘çŽ°å¹¶å‘è¡¨äº†è‘—åçš„æ–‡ç« æè¿°è¿™ä¸ªé—®é¢˜ã€‚ 4. é¢å¤–çš„ DOM å¼•ç”¨æœ‰æ—¶åœ¨æ•°æ®ç»“æž„ä¸­å¼•ç”¨ DOM èŠ‚ç‚¹å¾ˆæœ‰ç”¨ã€‚å‡è®¾ä½ æƒ³è¿…é€Ÿåœ°æ›´æ–°ä¸€ä¸ªè¡¨æ ¼ä¸­çš„å‡ è¡Œå†…å®¹ã€‚å¯èƒ½æ„Ÿè§‰åœ¨å­—å…¸ä¸­æˆ–æ•°æ®ä¸­å¼•ç”¨ DOM row æ˜¯æœ‰æ„ä¹‰çš„ã€‚åœ¨è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œä¸¤ä¸ªå¯¹ç›¸åŒ DOM çš„å¼•ç”¨è¢«ä¿æŒï¼šä¸€ä¸ªåœ¨ DOM æ ‘ï¼Œå¦ä¸€ä¸ªåœ¨å­—å…¸ä¸­ã€‚å¦‚æžœå°†æ¥æŸä¸ªæ—¶é—´ç‚¹ï¼Œä½ æƒ³åˆ é™¤è¿™å‡ è¡Œè¡¨æ ¼ï¼Œä½ è¦ç¡®ä¿è¿™ä¸¤ä¸ªè€…å¤±åŽ»å¼•ç”¨ã€‚ var elements = { button: document.getElementById('button'), image: document.getElementById('image') }; function doStuff() { image.src = 'http://example.com/image_name.png'; } function removeImage() { // The image is a direct child of the body element. document.body.removeChild(document.getElementById('image')); // At this point, we still have a reference to #button in the //global elements object. In other words, the button element is //still in memory and cannot be collected by the GC. } è¿™é‡Œè¿˜æœ‰é¢å¤–çš„ç‚¹éœ€è¦æ³¨æ„ï¼Œå½“æ¶‰åŠåˆ° DOM æ ‘æˆ–å­èŠ‚ç‚¹çš„å¼•ç”¨ã€‚æ¯”å¦‚è¯´åœ¨ javascript ä»£ç ä¸­å¼•ç”¨äº†è¡¨æ ¼çš„æŸä¸ªæ ¼å­ï¼ˆä¸€ä¸ªæ ‡ç­¾ï¼‰ã€‚æŸå¤©ä½ å†³å®šåˆ é™¤è¡¨æ ¼ä½†è¿˜ä¿æŒç€å•å…ƒæ ¼çš„å¼•ç”¨ã€‚ç›´è§‚çš„å‡è®¾å°±æ˜¯ GC ä¼šå›žæ”¶è¡¨æ ¼ï¼Œä½†ä¿ç•™å•å…ƒæ ¼ã€‚äº‹å®žä¸Šï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼šå•å…ƒæ ¼æ˜¯è¡¨æ ¼çš„å­èŠ‚ç‚¹ï¼Œå®ƒä¿æŒç€å¯¹çˆ¶çº§è¡¨æ ¼çš„å¼•ç”¨ã€‚javascript ä»£ç ä¿æŒå•å…ƒæ ¼çš„å¼•ç”¨å¯¼è‡´ æ•´ä¸ªè¡¨æ ¼è¢«ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚æ‰€ä»¥è¯·è°¨æ…Žè€ƒè™‘å¼•ç”¨ DOM å…ƒç´ ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>memory leaks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¿å…å¤§åž‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†]]></title>
    <url>%2F2017%2F08%2F30%2Favoid-large-complex-layouts-and-layout-thrashing.html</url>
    <content type="text"><![CDATA[é¿å…å¤§åž‹ï¼Œå¤æ‚çš„å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†å¸ƒå±€æ˜¯æµè§ˆå™¨æŸ¥æ‰¾å…ƒç´ çš„å‡ ä½•ä¿¡æ¯ï¼šå…¶å¤§å°å’Œé¡µé¢ä¸­çš„ä½ç½®ã€‚æ¯ä¸ªå…ƒç´ å°†åŸºäºŽæ‰€ä½¿ç”¨çš„CSSï¼Œå…ƒç´ çš„å†…å®¹æˆ–çˆ¶å…ƒç´ æ˜¾ç¤ºæˆ–éšå¼çš„å¤§å°è°ƒæ•´ä¿¡æ¯ã€‚è¯¥è¿‡ç¨‹åœ¨ Chromeï¼ŒOperaï¼ŒSafari å’Œ Internet Explorerä¸­ç§°ä¸ºâ€œå¸ƒå±€â€ã€‚åœ¨ Firefox ä¸­ï¼Œå®ƒè¢«ç§°ä¸º Reflow ï¼ˆå›žæµï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„ä½œç”¨æ˜¯ç›¸åŒçš„ã€‚ ç±»ä¼¼äºŽ style è®¡ç®—ï¼Œå¸ƒå±€æˆæœ¬çš„ç›´æŽ¥ç›¸å…³æ˜¯ï¼š éœ€è¦å¸ƒå±€çš„å…ƒç´ æ•°é‡ã€‚ è¿™äº›å¸ƒå±€çš„å¤æ‚æ€§ã€‚ TL; DR å¸ƒå±€é€šå¸¸ä½œç”¨äºŽæ•´ä¸ªæ–‡æ¡£ã€‚ DOM å…ƒç´ çš„æ•°é‡å°†å½±å“æ€§èƒ½; æ‚¨åº”å°½å¯èƒ½é¿å…è§¦å‘å¸ƒå±€ã€‚ è¯„ä¼°å¸ƒå±€æ¨¡åž‹æ€§èƒ½; æ–°çš„Flexboxé€šå¸¸æ¯”æ—§ç‰ˆFlexboxæˆ–åŸºäºŽæµ®åŠ¨çš„å¸ƒå±€æ¨¡åž‹æ›´å¿«ã€‚ é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€å’Œå¸ƒå±€é¢ è¦†; å…ˆè¯»å–æ ·å¼å€¼ï¼Œç„¶åŽå†è¿›è¡Œæ ·å¼æ›´æ”¹ã€‚ å°½å¯èƒ½é¿å…å¸ƒå±€å½“æ‚¨æ›´æ”¹æ ·å¼æ—¶ï¼Œæµè§ˆå™¨å°†æ£€æŸ¥ä»¥æŸ¥çœ‹æ˜¯å¦æœ‰ä»»ä½•æ›´æ”¹éœ€è¦è®¡ç®—å¸ƒå±€ï¼Œå¹¶ä¸ºè¯¥æ¸²æŸ“æ ‘è¿›è¡Œæ›´æ–°ã€‚å¯¹â€œå‡ ä½•å±žæ€§â€çš„æ›´æ”¹ï¼Œå¦‚å®½åº¦ï¼Œé«˜åº¦ï¼Œå·¦ä¾§æˆ–é¡¶éƒ¨éƒ½éœ€è¦å¸ƒå±€ã€‚ .box { width: 20px; height: 20px; } /** * æ”¹å˜å®½é«˜ * è§¦å‘ layout. */ .box--expanded { width: 200px; height: 350px; } å¸ƒå±€å‡ ä¹Žæ€»æ˜¯ä½œç”¨äºŽæ•´ä¸ªæ–‡æ¡£ã€‚å¦‚æžœä½ æœ‰å¾ˆå¤šå…ƒç´ ï¼Œé‚£ä¹ˆéœ€è¦å¾ˆé•¿æ—¶é—´æ¥ç¡®å®šå®ƒä»¬çš„ä½ç½®å’Œå°ºå¯¸ã€‚ å¦‚æžœä¸å¯èƒ½é¿å…å¸ƒå±€ï¼Œé‚£ä¹ˆå…³é”®æ˜¯å†æ¬¡ä½¿ç”¨ Chrome DevTools æ¥æŸ¥çœ‹èŠ±è´¹å¤šé•¿æ—¶é—´ï¼Œå¹¶ç¡®å®šå¸ƒå±€æ˜¯å¦æ˜¯ç“¶é¢ˆçš„åŽŸå› ã€‚é¦–å…ˆï¼Œæ‰“å¼€ DevToolsï¼Œè½¬åˆ°â€œæ—¶é—´è½´â€é€‰é¡¹å¡ï¼Œç‚¹å‡»è®°å½•å¹¶ä¸Žæ‚¨çš„ç½‘ç«™è¿›è¡Œäº¤äº’ã€‚å½“æ‚¨åœæ­¢å½•åˆ¶æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°æ‚¨çš„ç½‘ç«™æ‰§è¡Œçš„ç»†ç›®ï¼š å½“åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æŒ–æŽ˜æ¯ä¸€å¸§æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨å¸ƒå±€ä¸­èŠ±è´¹äº†è¶…è¿‡20æ¯«ç§’ï¼Œå½“æˆ‘ä»¬çš„å±å¹•åœ¨åŠ¨ç”»ä¸­æœ‰16msæ—¶ï¼Œè¿™å¤ªé«˜äº†ã€‚æ‚¨è¿˜å¯ä»¥çœ‹åˆ°ï¼ŒDevTools ä¼šå‘Šè¯‰æ‚¨ DOM æ ‘çš„å¤§å°ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º1,618ä¸ªå…ƒç´ ï¼‰ï¼Œä»¥åŠéœ€è¦å¤šå°‘ä¸ªèŠ‚ç‚¹è¿›è¡Œå¸ƒå±€ã€‚ æ³¨æ„ï¼šæƒ³è¦æ˜Žç¡®åˆ—å‡ºå“ªäº› CSS å±žæ€§è§¦å‘å¸ƒå±€(layout)ï¼Œç»˜ç”»(paint)æˆ–å¤åˆ(composite)ï¼ŸæŸ¥çœ‹CSSè§¦å‘å™¨ã€‚ åœ¨æ—§çš„å¸ƒå±€æ¨¡åž‹ä¸Šä½¿ç”¨ flexboxç½‘ç»œä¸Šæœ‰ä¸€ç³»åˆ—çš„å¸ƒå±€æ¨¡å¼ï¼Œå…¶ä¸­ä¸€äº›æ¯”å…¶ä»–æ¨¡åž‹æ›´å—å¹¿æ³›æ”¯æŒã€‚æœ€æ—§çš„ CSS å¸ƒå±€æ¨¡åž‹å…è®¸æˆ‘ä»¬åœ¨å±å¹•ä¸Šè¿›è¡Œç›¸å¯¹ï¼Œç»å¯¹åœ°å®šä½å…ƒç´ å’Œæµ®åŠ¨å…ƒç´ ã€‚ ä¸‹é¢çš„æˆªå›¾æ˜¾ç¤ºäº†åœ¨1,300ä¸ªç›’å­ä¸Šä½¿ç”¨æµ®ç‚¹æ•°æ—¶çš„å¸ƒå±€æˆæœ¬ã€‚è¯šç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªä¾‹è¯ï¼Œå› ä¸ºå¤§å¤šæ•°åº”ç”¨ç¨‹åºå°†ä½¿ç”¨å„ç§æ–¹æ³•æ¥å®šä½å…ƒç´ ã€‚ å¦‚æžœæˆ‘ä»¬æ›´æ–°æ ·æœ¬ä»¥ä½¿ç”¨ Flexboxï¼Œè¿™æ˜¯Webå¹³å°ä¸Šæœ€è¿‘çš„ä¸€ä¸ªè¡¥å……ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªä¸åŒçš„å›¾ç‰‡ï¼š çŽ°åœ¨ï¼Œåœ¨ç›¸åŒæ•°é‡çš„å…ƒç´ å’Œç›¸åŒçš„è§†è§‰å¤–è§‚çš„å¸ƒå±€ä¸­ï¼Œæˆ‘ä»¬èŠ±è´¹æ›´å°‘çš„æ—¶é—´ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ3.5mså¯¹14msï¼‰ã€‚é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œå¯¹äºŽæŸäº›æµè§ˆå™¨çŽ¯å¢ƒï¼Œæ‚¨å¯èƒ½æ— æ³•é€‰æ‹© Flexboxï¼Œå› ä¸ºå®ƒæ¯”æµ®åŠ¨å¸ƒå±€æ›´ä¸å—æ”¯æŒï¼Œä½†æ‚¨åº”è¯¥è‡³å°‘åº”è¯¥è°ƒæŸ¥å¸ƒå±€æ¨¡åž‹å¯¹æ‚¨çš„æ€§èƒ½çš„å½±å“ï¼Œå¹¶å°†å…¶æœ€å°åŒ–æ‰§è¡Œæˆæœ¬ æ— è®ºæ‚¨æ˜¯å¦é€‰æ‹©Flexboxï¼Œæ‚¨ä»ç„¶åº”è¯¥ å°è¯•é¿å… åœ¨åº”ç”¨ç¨‹åºçš„é«˜åŽ‹ç‚¹ å®Œå…¨è§¦å‘å¸ƒå±€ï¼ é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€è¿é€ä¸€ä¸ªæ¡†æž¶åˆ°å±å¹•æœ‰è¿™æ ·çš„é¡ºåºï¼š é¦–å…ˆ JavaScript è¿è¡Œï¼Œç„¶åŽè¿›è¡Œé£Žæ ¼è®¡ç®—ï¼Œç„¶åŽè¿›è¡Œå¸ƒå±€ã€‚ç„¶è€Œï¼Œå¯ä»¥å¼ºåˆ¶æµè§ˆå™¨ä½¿ç”¨ JavaScript æ›´æ—©åœ°æ‰§è¡Œå¸ƒå±€ã€‚å®ƒè¢«ç§°ä¸º å¼ºåˆ¶åŒæ­¥å¸ƒå±€ã€‚ è¦è®°ä½çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼Œç”±äºŽ JavaScript è¿è¡Œï¼Œæ‰€æœ‰æ—§çš„å¸ƒå±€å€¼éƒ½æ˜¯å·²çŸ¥çš„ï¼Œå¯ä¾›æ‚¨æŸ¥è¯¢ã€‚æ‰€ä»¥å¦‚æžœä½ æƒ³åœ¨ä¸‹ä¸€å¸§ä¹‹å‰å†™å‡ºä¸€ä¸ªå…ƒç´ çš„é«˜åº¦ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œboxâ€ï¼‰ï¼Œä½ å¯ä»¥ç¼–å†™ä¸€äº›è¿™æ ·çš„ä»£ç ï¼š // Schedule our function to run at the start of the frame. requestAnimationFrame(logBoxHeight); function logBoxHeight() { // Gets the height of the box in pixels and logs it out. console.log(box.offsetHeight); } å¦‚æžœæ‚¨åœ¨è¦æ±‚å…¶é«˜åº¦ä¹‹å‰æ›´æ”¹äº† box çš„æ ·å¼ï¼Œé‚£ä¹ˆäº‹æƒ…ä¼šå˜å¾—æœ‰é—®é¢˜ï¼š function logBoxHeight() { box.classList.add('super-big'); // Gets the height of the box in pixels // and logs it out. console.log(box.offsetHeight); } çŽ°åœ¨ï¼Œä¸ºäº†å›žç­”é«˜åº¦é—®é¢˜ï¼Œæµè§ˆå™¨å¿…é¡»é¦–å…ˆåº”ç”¨æ ·å¼æ›´æ”¹ï¼ˆå› ä¸ºæ·»åŠ äº† super-big ç±»ï¼‰ï¼Œç„¶åŽè¿è¡Œå¸ƒå±€ã€‚åªæœ‰è¿™æ ·æ‰èƒ½æ¢å¤æ­£ç¡®çš„é«˜åº¦ã€‚è¿™æ˜¯ä¸å¿…è¦çš„å’Œæ½œåœ¨çš„æ˜‚è´µçš„å·¥ä½œã€‚ å› æ­¤ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆæ‰¹è¯„è¿™ç±»çš„æ ·å¼è¯»å–ï¼Œå¹¶é¦–å…ˆæ‰§è¡Œï¼ˆæµè§ˆå™¨å¯ä»¥ä½¿ç”¨ä¸Šä¸€å¸§çš„å¸ƒå±€å€¼ï¼‰ï¼Œç„¶åŽæ‰§è¡Œä»»ä½•å†™æ“ä½œï¼š å®Œæˆä¸Šè¿°åŠŸèƒ½å°†æ˜¯ï¼š function logBoxHeight() { // Gets the height of the box in pixels // and logs it out. console.log(box.offsetHeight); box.classList.add('super-big'); } åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ä¸åº”è¯¥éœ€è¦åº”ç”¨æ ·å¼ï¼Œç„¶åŽæŸ¥è¯¢å€¼; ä½¿ç”¨æœ€åŽä¸€å¸§çš„å€¼åº”è¯¥æ˜¯è¶³å¤Ÿçš„ã€‚è¿‡æ—©åœ°è¿è¡Œ style è®¡ç®—å’Œå¸ƒå±€æ˜¯æµè§ˆå™¨åŒæ­¥å’Œå¸ƒå±€æ½œåœ¨çš„ç“¶é¢ˆï¼Œè¿™ä¸æ˜¯æ‚¨é€šå¸¸æƒ³è¦åšçš„äº‹æƒ…ã€‚ é¿å…å¸ƒå±€é¢ è¦†æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥ä½¿å¼ºåˆ¶åŒæ­¥å¸ƒå±€æ›´åŠ ç³Ÿç³•ï¼šå¿«é€Ÿè¿žç»­åœ°åšå¾ˆå¤šäº‹æƒ…ã€‚çœ‹çœ‹è¿™æ®µä»£ç ï¼š function resizeAllParagraphsToMatchBlockWidth() { // Puts the browser into a read-write-read-write cycle. for (var i = 0; i &lt; paragraphs.length; i++) { paragraphs[i].style.width = box.offsetWidth + 'px'; } } æ­¤ä»£ç å¾ªçŽ¯éåŽ†ä¸€ç»„æ®µè½ï¼Œå¹¶è®¾ç½®æ¯ä¸ªæ®µè½çš„å®½åº¦ä»¥åŒ¹é…åä¸ºâ€œboxâ€çš„å…ƒç´ çš„å®½åº¦ã€‚å®ƒçœ‹èµ·æ¥å¾ˆæ— å®³ï¼Œä½†é—®é¢˜æ˜¯å¾ªçŽ¯çš„æ¯æ¬¡è¿­ä»£è¯»å–ä¸€ä¸ªæ ·å¼å€¼ï¼ˆbox.offsetWidthï¼‰ï¼Œç„¶åŽç«‹å³ä½¿ç”¨å®ƒæ¥æ›´æ–°ä¸€ä¸ªparagraphï¼ˆparagraphs[i].style.widthï¼‰çš„å®½åº¦ã€‚åœ¨å¾ªçŽ¯çš„ä¸‹ä¸€ä¸ªè¿­ä»£ä¸­ï¼Œæµè§ˆå™¨å¿…é¡»è€ƒè™‘åˆ° offsetWidth ä¸Šä¸€æ¬¡è¯·æ±‚ï¼ˆåœ¨ä¸Šä¸€æ¬¡è¿­ä»£ä¸­ï¼‰æ ·å¼å·²ç»æ”¹å˜çš„äº‹å®žï¼Œå› æ­¤å®ƒå¿…é¡»åº”ç”¨æ ·å¼æ›´æ”¹å¹¶è¿è¡Œå¸ƒå±€ã€‚è¿™å°†åœ¨æ¯ä¸€æ¬¡è¿­ä»£ä¸­å‘ç”Ÿï¼ æ­¤ç¤ºä¾‹çš„è§£å†³æ–¹æ³•æ˜¯ç¼“å­˜è¯»å–å€¼ï¼Œç„¶åŽå†™å€¼ï¼š // Read. var width = box.offsetWidth; function resizeAllParagraphsToMatchBlockWidth() { for (var i = 0; i &lt; paragraphs.length; i++) { // Now write. paragraphs[i].style.width = width + 'px'; } } å¦‚æžœæ‚¨æƒ³ä¿è¯å®‰å…¨æ€§ï¼Œæ‚¨åº”è¯¥æ£€æŸ¥FastDOMï¼Œè¿™å°†è‡ªåŠ¨ä¸ºæ‚¨åˆ†é…è¯»å–å’Œå†™å…¥æ•°æ®ï¼Œå¹¶ä¸”åº”é˜²æ­¢æ‚¨æ„å¤–è§¦å‘å¼ºåˆ¶åŒæ­¥å¸ƒå±€æˆ–å¸ƒå±€é¢ è¦†ã€‚ ã€ç¿»è¯‘åŽŸæ–‡ã€‘:Avoid Large, Complex Layouts and Layout Thrashing]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>layout</tag>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ requestIdleCallback]]></title>
    <url>%2F2017%2F08%2F25%2Fusing-requestIdleCallback.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨ requestIdleCallbackè®¸å¤šç½‘ç«™å’Œåº”ç”¨ç¨‹åºéƒ½æœ‰å¾ˆå¤šè„šæœ¬æ¥æ‰§è¡Œã€‚æ‚¨çš„ JavaScript é€šå¸¸éœ€è¦å°½å¿«è¿è¡Œï¼Œä½†åŒæ—¶æ‚¨ä¸å¸Œæœ›å®ƒé˜»ç¢ç”¨æˆ·é‚£æ¡è·¯ã€‚å¦‚æžœæ‚¨åœ¨ç”¨æˆ·æ»šåŠ¨é¡µé¢æ—¶å‘é€åˆ†æžæ•°æ®ï¼Œæˆ–è€…åœ¨è½»è§¦æŒ‰é’®æ—¶å°†å…ƒç´ é™„åŠ åˆ° DOMï¼Œåˆ™æ‚¨çš„ Web åº”ç”¨ç¨‹åºå°†æ— æ³•å“åº”ï¼Œä»Žè€Œå¯¼è‡´ç”¨æˆ·ä½“éªŒä¸ä½³ã€‚ å¥½æ¶ˆæ¯æ˜¯ï¼ŒçŽ°åœ¨æœ‰ä¸€ä¸ª API å¯ä»¥å¸®åŠ©ï¼šrequestIdleCallbackã€‚ä»¥åŒæ ·çš„æ–¹å¼ï¼ŒrequestAnimationFrame æˆ‘ä»¬å¯ä»¥æ­£ç¡®åœ°å®‰æŽ’åŠ¨ç”»ï¼Œå¹¶æœ€å¤§é™åº¦åœ°æé«˜ 60fps çš„æœºä¼šï¼ŒrequestIdleCallback å½“ä¸€ä¸ªæ¡†æž¶ç»“æŸæ—¶ï¼Œæˆ–å½“ç”¨æˆ·å¤„äºŽéžæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œå¯ä»¥å®‰æŽ’å·¥ä½œã€‚è¿™æ„å‘³ç€æœ‰æœºä¼šåœ¨ç”¨æˆ·ä¸ä½¿ç”¨çš„æƒ…å†µä¸‹è¿›è¡Œå·¥ä½œã€‚å®ƒå¯ç”¨äºŽ Chrome 47ï¼è¿™æ˜¯ä¸€ä¸ªå®žéªŒæ€§çš„åŠŸèƒ½ï¼Œè§„æ ¼è¿˜åœ¨ä¸æ–­å˜åŒ–ï¼Œæ‰€ä»¥å°†æ¥ä¼šå‘ç”Ÿå˜åŒ–ã€‚ æ£€æŸ¥ requestIdleCallback æ”¯æŒè¿™æ˜¯æ—©æœŸçš„ requestIdleCallbackï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨å®ƒä¹‹å‰ï¼Œæ‚¨åº”è¯¥æ£€æŸ¥å®ƒæ˜¯å¦å¯ç”¨ï¼š if ('requestIdleCallback' in window) { // Use requestIdleCallback to schedule work. } else { // Do what youâ€™d do today. } ä½ ä¹Ÿå¯ä»¥ polyfill å®ƒçš„è¡Œä¸ºï¼Œè¿™éœ€è¦å›žåˆ° setTimeoutï¼š window.requestIdleCallback = window.requestIdleCallback || function (cb) { var start = Date.now(); return setTimeout(function () { cb({ didTimeout: false, timeRemaining: function () { return Math.max(0, 50 - (Date.now() - start)); } }); }, 1); } window.cancelIdleCallback = window.cancelIdleCallback || function (id) { clearTimeout(id); } ä½¿ç”¨ setTimeout ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºå®ƒä¸çŸ¥é“ requestIdleCallback çš„ç©ºé—²æ—¶é—´æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†æ˜¯å¦‚æžœ requestIdleCallback ä¸å¯ç”¨çš„è¯ï¼Œä½ å¯ä»¥ç›´æŽ¥è°ƒç”¨ä½ çš„å›žè°ƒï¼Œä½ æ²¡æœ‰æ¯”è¿™æ›´å·®çš„æ–¹å¼ã€‚æœ‰äº†åž«ç‰‡ï¼ŒrequestIdleCallback å°±å¯ä»¥ä½¿ç”¨ï¼Œä½ å°†è¢«é»˜è®¤é‡å®šå‘åˆ°ç›´æŽ¥è°ƒç”¨ï¼Œè¿™æ˜¯å¾ˆæ£’çš„ã€‚ çŽ°åœ¨ï¼Œæˆ‘ä»¬å‡è®¾å®ƒå­˜åœ¨ã€‚ ä½¿ç”¨requestIdleCallbackè°ƒç”¨ requestIdleCallback éžå¸¸ç±»ä¼¼äºŽ requestAnimationFrame, å®ƒéœ€è¦å›žè°ƒå‡½æ•°ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ï¼š requestIdleCallback(myNonEssentialWork); å½“ myNonEssentialWork è¢«è°ƒç”¨æ—¶ï¼Œå®ƒå°†è¢«èµ‹äºˆä¸€ä¸ª deadline, å®ƒæ˜¯ä¸€ä¸ªåŒ…å«å‡½æ•°çš„å¯¹è±¡ï¼Œè¯¥å‡½æ•°è¿”å›žä¸€ä¸ªæ•°å­—ï¼ŒæŒ‡ç¤ºæ‚¨çš„å·¥ä½œå‰©ä½™å¤šå°‘æ—¶é—´ï¼š function myNonEssentialWork (deadline) { while (deadline.timeRemaining() > 0) doWorkIfNeeded(); } timeRemaining å¯ä»¥è°ƒç”¨è¯¥å‡½æ•°æ¥èŽ·å–æœ€æ–°å€¼ã€‚å½“ timeRemaining() è¿”å›žé›¶æ—¶ï¼Œæ‚¨å¯ä»¥å®‰æŽ’å¦ä¸€ä¸ª requestIdleCallback, å¦‚æžœæ‚¨è¿˜æœ‰æ›´å¤šçš„å·¥ä½œè¦åšï¼š function myNonEssentialWork (deadline) { while (deadline.timeRemaining() > 0 &amp;&amp; tasks.length > 0) doWorkIfNeeded(); if (tasks.length > 0) requestIdleCallback(myNonEssentialWork); } è°ƒç”¨ä½ çš„ä»»åŠ¡å¦‚æžœæµè§ˆå™¨çœŸçš„å¾ˆå¿™ï¼Œä½ è¯¥æ€Žä¹ˆåŠžï¼Ÿæ‚¨å¯èƒ½ä¼šæ‹…å¿ƒæ‚¨çš„å›žè°ƒå¯èƒ½æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ã€‚å—¯ï¼Œè™½ç„¶ requestIdleCallback ç±»ä¼¼ requestAnimationFrameï¼Œä½†å®ƒä¹Ÿæœ‰æ‰€ä¸åŒï¼Œå®ƒéœ€è¦ä¸€ä¸ªå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ï¼šå…·æœ‰ timeout å±žæ€§çš„ options å¯¹è±¡ã€‚æ­¤è¶…æ—¶ï¼ˆå¦‚æžœè®¾ç½®ï¼‰ä¸ºæµè§ˆå™¨æä¾›äº†å¿…é¡»æ‰§è¡Œå›žè°ƒçš„æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ï¼š // Wait at most two seconds before processing events. requestIdleCallback(processPendingAnalyticsEvents, { timeout: 2000 }); å¦‚æžœæ‚¨çš„å›žè°ƒç”±äºŽè¶…æ—¶è§¦å‘è€Œæ‰§è¡Œï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ä¸¤ä»¶äº‹æƒ…ï¼š timeRemaining() å°†è¿”å›žé›¶ã€‚ å¯¹è±¡çš„ didTimeout å±žæ€§ deadline å°†ä¸º trueã€‚ å¦‚æžœä½ çœ‹åˆ°è¿™ didTimeout æ˜¯çœŸçš„ï¼Œä½ å¾ˆå¯èƒ½åªæƒ³è¿è¡Œè¿™ä¸ªå·¥ä½œå¹¶å®Œæˆå®ƒï¼š function myNonEssentialWork (deadline) { // Use any remaining time, or, if timed out, just run through the tasks. while ((deadline.timeRemaining() > 0 || deadline.didTimeout) &amp;&amp; tasks.length > 0) doWorkIfNeeded(); if (tasks.length > 0) requestIdleCallback(myNonEssentialWork); } ç”±äºŽæ½œåœ¨çš„ä¸­æ–­ï¼Œè¿™ç§è¶…æ—¶å¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„ç”¨æˆ·ï¼ˆå·¥ä½œå¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„åº”ç”¨ç¨‹åºå˜å¾—æ— å“åº”æˆ–jankyï¼‰è®¾ç½®æ­¤å‚æ•°æ—¶è¦è°¨æ…Žã€‚åœ¨å“ªé‡Œå¯ä»¥è®©æµè§ˆå™¨å†³å®šä½•æ—¶è°ƒç”¨å›žè°ƒã€‚ ä½¿ç”¨ requestIdleCallback å‘é€åˆ†æžæ•°æ®è®©æˆ‘ä»¬æ¥çœ‹çœ‹ requestIdleCallback å‘é€åˆ†æžæ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæƒ³è·Ÿè¸ªä¸€ä¸ªäº‹ä»¶ï¼Œæ¯”å¦‚è¯´ - ç‚¹å‡»å¯¼èˆªèœå•ã€‚ä¸è¿‡ï¼Œç”±äºŽé€šå¸¸åœ¨è¤å¹•ä¸Šè®¾å®šåŠ¨ç”»ï¼Œæˆ‘ä»¬å¸Œæœ›é¿å…ç«‹å³å°†æ­¤äº‹ä»¶å‘é€åˆ° Google Analyticsï¼ˆåˆ†æžï¼‰ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ç³»åˆ—äº‹ä»¶æ¥å‘é€å’Œè¯·æ±‚åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´å‘é€å®ƒä»¬ï¼š var eventsToSend = []; function onNavOpenClick () { // Animate the menu. menu.classList.add('open'); // Store the event for later. eventsToSend.push( { category: 'button', action: 'click', label: 'nav', value: 'open' }); schedulePendingEvents(); } çŽ°åœ¨æˆ‘ä»¬éœ€è¦ä½¿ç”¨ requestIdleCallback æ¥å¤„ç†ä»»ä½•å¾…å¤„ç†çš„äº‹ä»¶ï¼š function schedulePendingEvents() { // Only schedule the rIC if one has not already been set. if (isRequestIdleCallbackScheduled) return; isRequestIdleCallbackScheduled = true; if ('requestIdleCallback' in window) { // Wait at most two seconds before processing events. requestIdleCallback(processPendingAnalyticsEvents, { timeout: 2000 }); } else { processPendingAnalyticsEvents(); } } åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æˆ‘è®¾ç½®äº†2ç§’çš„è¶…æ—¶æ—¶é—´ï¼Œä½†è¿™ä¸ªå€¼å–å†³äºŽä½ çš„åº”ç”¨ç¨‹åºã€‚å¯¹äºŽåˆ†æžæ•°æ®ï¼Œæœ‰æ„ä¹‰çš„æ˜¯ï¼Œå°†ä½¿ç”¨è¶…æ—¶æ—¶é—´æ¥ç¡®ä¿æ•°æ®åœ¨åˆç†çš„æ—¶é—´å†…æŠ¥å‘Šï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹ã€‚ æœ€åŽæˆ‘ä»¬éœ€è¦ç¼–å†™ requestIdleCallback å°†æ‰§è¡Œçš„å‡½æ•°ã€‚ function processPendingAnalyticsEvents (deadline) { // Reset the boolean so future rICs can be set. isRequestIdleCallbackScheduled = false; // If there is no deadline, just run as long as necessary. // This will be the case if requestIdleCallback doesnâ€™t exist. if (typeof deadline === 'undefined') deadline = { timeRemaining: function () { return Number.MAX_VALUE } }; // Go for as long as there is time remaining and work to do. while (deadline.timeRemaining() > 0 &amp;&amp; eventsToSend.length > 0) { var evt = eventsToSend.pop(); ga('send', 'event', evt.category, evt.action, evt.label, evt.value); } // Check if there are more events still to send. if (eventsToSend.length > 0) schedulePendingEvents(); } å¯¹äºŽè¿™ä¸ªä¾‹å­ï¼Œæˆ‘å‡è®¾å¦‚æžœ requestIdleCallback ä¸å­˜åœ¨åˆ†æžæ•°æ®åº”è¯¥ç«‹å³å‘é€ã€‚ç„¶è€Œï¼Œåœ¨ç”Ÿäº§åº”ç”¨ç¨‹åºä¸­ï¼Œå»¶è¿Ÿå‘é€è¶…æ—¶å¯èƒ½ä¼šæ›´å¥½ï¼Œä»¥ç¡®ä¿å®ƒä¸ä¼šä¸Žä»»ä½•äº¤äº’å†²çªï¼Œå¹¶å¯¼è‡´ jankã€‚ ä½¿ç”¨ requestIdleCallback è¿›è¡Œ DOM æ›´æ”¹å¦ä¸€ç§ requestIdleCallback çœŸæ­£æœ‰åŠ©äºŽè¡¨çŽ°çš„æƒ…å†µæ˜¯å½“æ‚¨è¿›è¡Œéžå¿…è¦çš„ DOM æ›´æ”¹æ—¶ï¼Œä¾‹å¦‚å°†é¡¹ç›®æ·»åŠ åˆ°ä¸æ–­å¢žé•¿çš„æƒ°æ€§åˆ—è¡¨çš„æœ«å°¾ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•å°† requestIdleCallback å®žé™…åº”ç”¨åœ¨ä¸€ä¸ªå…¸åž‹çš„æ¡†æž¶ã€‚ æµè§ˆå™¨å¯èƒ½å¤ªå¿™ï¼Œæ— æ³•åœ¨ç»™å®šçš„æ¡†æž¶ä¸­è¿è¡Œä»»ä½•å›žè°ƒï¼Œæ‰€ä»¥æ‚¨ä¸åº”è¯¥æœŸæœ›åœ¨æ¡†æž¶ç»“å°¾å¤„æœ‰ä»»ä½•ç©ºé—²æ—¶é—´æ¥æ‰§è¡Œä»»ä½•æ›´å¤šçš„å·¥ä½œã€‚è¿™ä½¿å¾—å®ƒä¸åŒäºŽ setImmediate è¿™ç±»æ¯å¸§éƒ½è¿è¡Œçš„ä¸œè¥¿ã€‚ å¦‚æžœå›žè°ƒåœ¨æ¡†æž¶ç»“æŸæ—¶è¢«è§¦å‘ï¼Œå®ƒå°†è¢«è°ƒåº¦åˆ°å½“å‰å¸§å·²ç»æäº¤ä¹‹åŽï¼Œè¿™æ„å‘³ç€å°†åº”ç”¨æ ·å¼æ›´æ”¹ï¼Œå¹¶ä¸”é‡è¦çš„æ˜¯å¸ƒå±€è®¡ç®—ã€‚å¦‚æžœæˆ‘ä»¬åœ¨ç©ºé—²å›žè°ƒå†…éƒ¨è¿›è¡Œ DOM æ›´æ”¹ï¼Œè¿™äº›å¸ƒå±€è®¡ç®—å°†æ— æ•ˆã€‚å¦‚æžœæœ‰ä»»ä½•è¯»å–ä¸‹ä¸€å¸§å¸ƒå±€çš„äº‹ä»¶ï¼Œä¾‹å¦‚ getBoundingClientRectï¼ŒclientWidthç­‰ç­‰ï¼Œæµè§ˆå™¨å°†ä¸å¾—ä¸è¿›è¡Œå¼ºåˆ¶åŒæ­¥å¸ƒå±€ï¼Œè¿™æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ€§èƒ½ç“¶é¢ˆã€‚ ä¸è¦åœ¨ç©ºé—²å›žè°ƒä¸­ DOM æ›´æ”¹çš„å¦ä¸€ä¸ªåŽŸå› æ˜¯æ›´æ”¹ DOM çš„æ—¶é—´å½±å“æ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è¶…è¿‡æµè§ˆå™¨æä¾›çš„æœŸé™ã€‚ æœ€å¥½çš„åšæ³•æ˜¯åªèƒ½åœ¨ requestAnimationFrame å›žè°ƒå†…éƒ¨è¿›è¡Œ DOM æ›´æ”¹ï¼Œå› ä¸ºå®ƒæ˜¯ç”±æµè§ˆå™¨å®‰æŽ’çš„é‚£ç§ç±»åž‹çš„å·¥ä½œã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„ä»£ç å°†éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–‡æ¡£ç‰‡æ®µï¼Œç„¶åŽå¯ä»¥å°†å…¶é™„åŠ åœ¨ä¸‹ä¸€ä¸ª requestAnimationFrame å›žè°ƒä¸­ã€‚å¦‚æžœæ‚¨æ­£åœ¨ä½¿ç”¨ VDOM åº“ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ requestIdleCallback è¿›è¡Œæ›´æ”¹ï¼Œä½†æ˜¯æ‚¨å¯ä»¥åœ¨ä¸‹ä¸€ä¸ªå›žè°ƒä¸­åº”ç”¨ DOM ä¿®è¡¥ç¨‹åº requestAnimationFrameï¼Œè€Œä¸æ˜¯ç©ºé—²å›žè°ƒã€‚ æ‰€ä»¥è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç ï¼š function processPendingElements (deadline) { // If there is no deadline, just run as long as necessary. if (typeof deadline === 'undefined') deadline = { timeRemaining: function () { return Number.MAX_VALUE } }; if (!documentFragment) documentFragment = document.createDocumentFragment(); // Go for as long as there is time remaining and work to do. while (deadline.timeRemaining() > 0 &amp;&amp; elementsToAdd.length > 0) { // Create the element. var elToAdd = elementsToAdd.pop(); var el = document.createElement(elToAdd.tag); el.textContent = elToAdd.content; // Add it to the fragment. documentFragment.appendChild(el); // Don't append to the document immediately, wait for the next // requestAnimationFrame callback. scheduleVisualUpdateIfNeeded(); } // Check if there are more events still to send. if (elementsToAdd.length > 0) scheduleElementCreation(); } åœ¨è¿™é‡Œæˆ‘åˆ›å»ºå…ƒç´ å¹¶ä½¿ç”¨è¯¥ textContent å±žæ€§æ¥å¡«å……å®ƒï¼Œä½†æ˜¯æ‚¨çš„å…ƒç´ åˆ›å»ºä»£ç å¯èƒ½ä¼šæ›´å¤šçš„æ“ä½œï¼åœ¨åˆ›å»ºå…ƒç´ åŽ scheduleVisualUpdateIfNeededï¼Œè°ƒç”¨è¯¥å…ƒç´ å°†ä¼šå»ºç«‹ä¸€ä¸ªå•ç‹¬çš„ requestAnimationFrame å›žè°ƒï¼Œç„¶åŽä¾æ¬¡å°†æ–‡æ¡£ç‰‡æ®µé™„åŠ åˆ°æ­£æ–‡ä¸­ï¼š function scheduleVisualUpdateIfNeeded() { if (isVisualUpdateScheduled) return; isVisualUpdateScheduled = true; requestAnimationFrame(appendDocumentFragment); } function appendDocumentFragment() { // Append the fragment and reset. document.body.appendChild(documentFragment); documentFragment = null; } ä¸€åˆ‡é¡ºåˆ©ï¼Œæˆ‘ä»¬çŽ°åœ¨å°†æŠŠé¡¹ç›®é™„åŠ åˆ° DOM æ—¶çœ‹èµ·æ¥æ›´å°‘ jankã€‚ä¼˜ç§€ï¼ å¸¸é—®é—®é¢˜ æ˜¯å¦æœ‰ polyfillï¼Ÿ å¯æ‚²çš„æ˜¯ï¼Œæ²¡æœ‰ã€‚å¦‚æžœä½ æƒ³è¦é€æ˜Žçš„é‡å®šå‘åˆ° setTimeoutï¼Œé‚£å°±æœ‰ä¸€ä¸ª shim ã€‚è¯¥APIå­˜åœ¨çš„åŽŸå› æ˜¯å› ä¸ºå®ƒåœ¨Webå¹³å°ä¸­æ’å…¥äº†éžå¸¸çœŸå®žçš„å·®è·ã€‚ä½†æ˜¯æ²¡æœ‰JavaScript APIæ¥ç¡®å®šæ¡†æž¶ç»“æŸæ—¶çš„ç©ºé—²æ—¶é—´ï¼Œæ‰€ä»¥æœ€å¤šåªèƒ½åšå‡ºçŒœæµ‹ã€‚åƒ setTimeoutï¼ŒsetInterval æˆ–è€… setImmediate è¿™æ ·çš„ API å¯ä»¥ç”¨äºŽè°ƒåº¦å·¥ä½œï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æŒ‰ç…§ requestIdleCallback è¿™æ ·çš„æ–¹å¼é¿å¼€ç”¨æˆ·äº¤äº’ã€‚ å¦‚æžœæˆ‘è®¾ç½® timeoutï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å¦‚æžœ timeRemaining() è¿”å›žé›¶ï¼Œä½†æ˜¯æ‚¨é€‰æ‹©è¿è¡Œæ›´é•¿æ—¶é—´ï¼Œæ‚¨å¯ä»¥è¿™æ ·åšï¼Œè€Œä¸ç”¨æ‹…å¿ƒæµè§ˆå™¨åœæ­¢å·¥ä½œã€‚ä½†æ˜¯ï¼Œæµè§ˆå™¨ä¸ºæ‚¨æä¾›äº†æœ€ç»ˆæœŸé™ï¼Œä»¥ç¡®ä¿æ‚¨çš„ç”¨æˆ·é¡ºåˆ©ä½“éªŒï¼Œå› æ­¤é™¤éžæœ‰éžå¸¸å¥½çš„ç†ç”±ï¼Œå¦åˆ™æ‚¨åº”å§‹ç»ˆéµå®ˆæœ€ç»ˆæœŸé™ã€‚ timeRemaining() ä¼šè¿”å›žæœ‰æœ€å¤§å€¼å—ï¼Ÿ æ˜¯çš„ï¼ŒçŽ°åœ¨æ˜¯ 50ms ã€‚åœ¨å°è¯•ç»´æŠ¤å“åº”å¼åº”ç”¨ç¨‹åºæ—¶ï¼Œæ‰€æœ‰å¯¹ç”¨æˆ·äº¤äº’çš„å“åº”åº”ä¿æŒåœ¨ 100ms ä»¥ä¸‹ã€‚å¦‚æžœç”¨æˆ·åœ¨ 50ms çª—å£ä¸­è¿›è¡Œäº¤äº’ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åº”å…è®¸ç©ºé—²å›žè°ƒå®Œæˆï¼Œå¹¶ä¸”æµè§ˆå™¨å¯ä»¥å“åº”ç”¨æˆ·çš„äº¤äº’ã€‚æ‚¨å¯èƒ½ä¼šå¾—åˆ°å¤šä¸ªç©ºé—²çš„å›žè°ƒï¼ˆå¦‚æžœæµè§ˆå™¨ç¡®å®šæœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥è¿è¡Œå®ƒä»¬ï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬å°†è¢«ä¸€ä¸ªä¸ªå®‰æŽ’ã€‚ æœ‰æ²¡æœ‰ä»€ä¹ˆå·¥ä½œæˆ‘ä¸åº”è¯¥åœ¨ requestIdleCallback é‡Œæ‰§è¡Œï¼Ÿ ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨æ‰€åšçš„å·¥ä½œåº”è¯¥æ˜¯å…·æœ‰ç›¸å¯¹å¯é¢„æµ‹ç‰¹å¾çš„å°å—ï¼ˆå¾®ä»»åŠ¡ï¼‰ã€‚ä¾‹å¦‚ï¼Œç‰¹åˆ«æ˜¯æ›´æ”¹ DOM å°†å…·æœ‰ä¸å¯é¢„æµ‹çš„æ‰§è¡Œæ—¶é—´ï¼Œå› ä¸ºå®ƒå°†è§¦å‘æ ·å¼è®¡ç®—ï¼Œå¸ƒå±€ï¼Œç»˜ç”»å’Œåˆæˆã€‚å› æ­¤ï¼Œæ‚¨åº”è¯¥ä»…åœ¨ä¸Šè¿° requestAnimationFrame å›žè°ƒä¸­è¿›è¡Œ DOM æ›´æ”¹ã€‚è¦æ³¨æ„çš„å¦ä¸€ä»¶äº‹æ˜¯è§£å†³ï¼ˆæˆ–æ‹’ç»ï¼‰Promisesï¼Œå› ä¸ºåœ¨ç©ºé—²å›žè°ƒå®ŒæˆåŽå›žè°ƒå°†ç«‹å³æ‰§è¡Œï¼Œå³ä½¿æ²¡æœ‰æ›´å¤šçš„æ—¶é—´å‰©ä½™ã€‚ æˆ‘ä¼šæ€»æ˜¯åœ¨ä¸€å¸§ç»“æŸæ—¶è¢«æ‰§è¡Œ requestIdleCallback ï¼Ÿä¸ï¼Œä¸æ€»æ˜¯ã€‚æµè§ˆå™¨å°†åœ¨å¸§ç»“æŸæ—¶çš„ç©ºé—²æ—¶é—´æˆ–ç”¨æˆ·å¤„äºŽéžæ´»åŠ¨çŠ¶æ€çš„æ—¶æ®µå†…è°ƒåº¦å›žè°ƒã€‚æ‚¨ä¸åº”è¯¥æœŸæœ›æ¯å¸§è°ƒç”¨å›žè°ƒï¼Œå¹¶ä¸”å¦‚æžœè¦æ±‚å®ƒåœ¨ç»™å®šçš„æ—¶é—´èŒƒå›´å†…è¿è¡Œï¼Œåˆ™åº”è¯¥ä½¿ç”¨è¶…æ—¶ã€‚ æˆ‘å¯ä»¥æœ‰å¤šä¸ª requestIdleCallback å›žè°ƒå—ï¼Ÿ æ˜¯çš„ï¼Œä½ å¯ä»¥æ‹¥æœ‰éžå¸¸å¤šä¸ª requestAnimationFrame å›žè°ƒã€‚å€¼å¾—è®°ä½çš„æ˜¯ï¼Œå¦‚æžœä½ çš„ç¬¬ä¸€ä¸ªå›žè°ƒä½¿ç”¨äº†å®ƒåœ¨å›žè°ƒæœŸé—´çš„å‰©ä½™æ—¶é—´ï¼Œé‚£ä¹ˆä»»ä½•å…¶ä»–å›žè°ƒéƒ½ä¸ä¼šæœ‰æ›´å¤šçš„æ—¶é—´ã€‚ç„¶åŽï¼Œå…¶ä»–å›žè°ƒå°†ä¸å¾—ä¸ç­‰å¾…æµè§ˆå™¨ä¸‹ä¸€ä¸ªç©ºé—²ï¼Œæ‰èƒ½è¿è¡Œã€‚æ ¹æ®æ‚¨è¦å®Œæˆçš„å·¥ä½œï¼Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªç©ºé—²çš„å›žè°ƒï¼Œå¹¶å°†å·¥ä½œåˆ†é…åˆ°é‚£é‡Œã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¶…æ—¶æ—¶é—´æ¥ç¡®ä¿å›žè°ƒéƒ½æœ‰æœºä¼šæ‰§è¡Œã€‚ å¦‚æžœæˆ‘åœ¨å¦ä¸€ä¸ªå†…éƒ¨è®¾ç½®ä¸€ä¸ªæ–°çš„ç©ºé—²å›žè°ƒï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ æ–°çš„ç©ºé—²å›žè°ƒå°†è¢«å®‰æŽ’å°½å¿«è¿è¡Œï¼Œä»Žä¸‹ä¸€ä¸ªå¸§å¼€å§‹ï¼ˆè€Œä¸æ˜¯å½“å‰çš„ï¼‰ã€‚ åˆ©ç”¨ç©ºé—²requestIdleCallback æ˜¯ä¸€ä¸ªéžå¸¸æ£’çš„æ–¹æ³•ï¼Œä»¥ç¡®ä¿æ‚¨å¯ä»¥è¿è¡Œæ‚¨çš„ä»£ç ï¼Œä½†æ²¡æœ‰é˜»ç¢ç”¨æˆ·çš„äº¤äº’ã€‚ä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œéžå¸¸çµæ´»ã€‚ä½†ä»ç„¶å±žäºŽæ—©æœŸï¼Œè€Œä¸”è§„èŒƒè¿˜æ²¡æœ‰å®Œå…¨è§£å†³ï¼Œæ‰€ä»¥ä½ æ‰€æä¾›çš„ä»»ä½•åé¦ˆéƒ½æ˜¯å€¼å¾—æ¬¢è¿Žçš„ã€‚ ã€ç¿»è¯‘åŽŸæ–‡ã€‘:useing requestIdleCallback]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>performance</tag>
        <tag>optimization</tag>
        <tag>requestIdleCallback</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IntersectionObserver API]]></title>
    <url>%2F2017%2F08%2F24%2Fintersectionobserver.html</url>
    <content type="text"><![CDATA[IntersectionObserverå‡è®¾ä½ æƒ³è¿½è¸ª DOM é‡Œçš„ä¸€ä¸ªå…ƒç´ æ˜¯å¦è¿›å…¥ viewport çš„å¯è§†åŒºã€‚ä½ åšè¿™ä»¶äº‹å¯èƒ½æ˜¯å› ä¸ºä½ æƒ³åœ¨è¿™ä¸ªæ—¶æœº lazyload å›¾ç‰‡æˆ–è€…ä½ éœ€è¦çŸ¥é“ç”¨æˆ·æ˜¯å¦çœŸçš„åœ¨çœ‹ä¸€ä¸ªæŸä¸ªå¹¿å‘Šæ¨ªå¹…ã€‚ä½ å¯ä»¥é€šè¿‡æ·»åŠ  scroll äº‹ä»¶é’©å­æˆ–ä½¿ç”¨å®šæ—¶å™¨åŽ»è°ƒç”¨å…ƒç´ çš„ getBoundingClientRect() æ–¹æ³•ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•çœŸçš„å¾ˆæ…¢ï¼Œå› ä¸ºæ¯æ¬¡è°ƒç”¨ getBoundingClientRect() ä¼šé€ æˆæµè§ˆå™¨ re-layout å½“å‰é¡µé¢ å¹¶ä¼šåœ¨ä½ çš„é¡µé¢é€ æˆå¾ˆå¤§çš„å¡é¡¿å’Œé—ªçƒã€‚ iframe é‡Œçš„å…ƒç´ æ˜¯å¦å¯è§è¿™æ ·çš„äº‹æƒ…å‡ ä¹Žå¾ˆéš¾åšåˆ°ã€‚ åŸºäºŽå•ä¸€æºæ¨¡åž‹ï¼Œæµè§ˆå™¨ä¸ä¼šè®©ä½ è®¿é—®åŒ…å« iframe çš„é¡µé¢çš„ä»»ä½•æ•°æ®ã€‚è¿™æ˜¯é¢‘ç¹ä½¿ç”¨ iframe åŠ è½½å¹¿å‘Šçš„å¸¸è§é—®é¢˜ã€‚ ä¸ºäº†è®©å¯è§åº¦æµ‹è¯•æ›´æœ‰æ•ˆçŽ‡ï¼Œ IntersectionObserver è¢«è®¾è®¡å‡ºæ¥äº†ã€‚IntersectionObserver è®©ä½ çŸ¥é“è§‚å¯Ÿçš„å…ƒç´ ä½•æ—¶è¿›å…¥æˆ–é€€å‡ºæµè§ˆå™¨ viewportã€‚ å¦‚ä½•åˆ›å»ºä¸€ä¸ª IntersectionObserverAPI ç›¸å½“ç®€å•ï¼Œä¾‹å­ä¸€çœ‹å°±æ‡‚ï¼š var io = new IntersectionObserver( entries => { console.log(entries); }, { /* ä½¿ç”¨é»˜è®¤é€‰é¡¹ï¼Œè¯¦ç»†åœ¨ä¸‹é¢ä¼šä»‹ç» */ } ); // å¼€å§‹è§‚å¯Ÿä¸€ä¸ªå…ƒç´  io.observe(element); // åœæ­¢è§‚å¯Ÿä¸€ä¸ªå…ƒç´  // io.unobserve(element); // ç¦ç”¨æ•´ä¸ª IntersectionObserver // io.disconnect(); ä½¿ç”¨é»˜è®¤é€‰é¡¹ï¼Œå›žè°ƒä¼šåœ¨å…ƒç´ è¿›å…¥å’Œå®Œå…¨é€€å‡º viewport çš„æ—¶å€™è§¦å‘ã€‚ å¦‚æžœä½ éœ€è¦è§‚å¯Ÿå¤šä¸ªå…ƒç´ ï¼Œå»ºè®®åœ¨åŒä¸€ä¸ª IntersectionObserver å®žä¾‹ä¸Šå¤šæ¬¡è°ƒç”¨ observe() æ¥è§‚å¯Ÿå¤šä¸ªå…ƒç´ ï¼Œè¿™ä¹Ÿæ˜¯å…è®¸çš„è°ƒç”¨æ–¹å¼ã€‚ å›žè°ƒå‡½æ•°å›žä¼ çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„å¯¹è±¡ IntersectionObserverEntry ã€‚æ¯ä¸ªè¿™æ ·çš„å¯¹è±¡éƒ½åŒ…å«äº†æ¯ä¸ªè§‚å¯Ÿå…ƒç´ çš„æœ€æ–°æ•°æ®ã€‚ ðŸ”½[IntersectionObserverEntry] ðŸ”½ 0: IntersectionObserverEntry time: 3893.92 ðŸ”½ rootBounds: ClientRect bottom: 920 height: 1024 left: 0 right: 1024 top: 0 width: 920 ðŸ”½ boundingClientRect: ClientRect // ... ðŸ”½ intersectionRect: ClientRect // ... intersectionRatio: 0.54 ðŸ”½ target: div#observee // ... rootBounds æ˜¯å¯¹ root å…ƒç´ è°ƒç”¨ getBoundingClientRect çš„ç»“æžœï¼Œé»˜è®¤ root å…ƒç´ æ˜¯ viewport ã€‚ boundingClientRect æ˜¯è¢«è§‚å¯Ÿå…ƒç´ è°ƒç”¨ getBoundingClientRect çš„ç»“æžœã€‚ intersectionRect æ˜¯ä¸¤ä¸ªçŸ©å½¢çš„äº¤å‰éƒ¨åˆ†ï¼Œå¯èƒ½æœ‰æ•ˆåœ°å‘Šè¯‰ä½ è¢«è§‚å¯Ÿçš„å…ƒç´ çš„å“ªä¸€éƒ¨åˆ†æ˜¯å¯è§çš„ã€‚ intersectionRatio æ˜¯æœ€ç›¸å…³çš„ï¼Œå‘Šè¯‰ä½ å…ƒç´ æœ‰ç™¾åˆ†ä¹‹å‡ æ˜¯å¯è§çš„ã€‚ æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œä½ çŽ°åœ¨å¯ä»¥å®žçŽ°å…ƒç´ è¿›å…¥ viewport å‰åŠæ—¶åŠ è½½çš„ç‰¹æ€§ã€‚éžå¸¸æœ‰ç”¨ã€‚ IntersectionObservers æ˜¯å¼‚æ­¥æŽ¨é€ä»–ä»¬çš„æ•°æ®ï¼Œè€Œå›žè°ƒæ˜¯è¿è¡Œåœ¨ä¸»çº¿ç¨‹çš„ã€‚å¦å¤–ï¼Œè§„èŒƒæåˆ° IntersectionObserver åº”è¯¥ä½¿ç”¨ requestIdleCallback()ã€‚ è¿™æ„å‘³ç€è°ƒç”¨å›žè°ƒå‡½æ•°çš„ä¼˜å…ˆçº§æ˜¯éžå¸¸ä½Žçš„ï¼Œåªä¼šåœ¨æµè§ˆå™¨æœ‰ç©ºé—²çš„æ—¶å€™è°ƒç”¨ã€‚è¿™æ˜¯æœ‰æ„è®¾è®¡çš„ã€‚ Scrolling divsæˆ‘å¹¶ä¸å–œæ¬¢åœ¨ div ä¸­æ»šåŠ¨å…ƒç´ , ä½†æˆ‘ä¸ä¼šç”¨ scroll åˆ¤å®š, è€Œæ˜¯ç”¨ IntersectionObserverã€‚ option å¯¹è±¡æœ‰ä¸€ä¸ª root é€‰é¡¹è®©ä½ å®šä¹‰ä¸€ä¸ªä»£æ›¿ viewport çš„ root å…ƒç´ ã€‚éœ€è¦è®°ä½çš„æ˜¯ï¼Œè¦ä¿è¯ root å…ƒç´ æ˜¯æ‰€æœ‰è¢«è§‚å¯Ÿå…ƒç´ çš„ç¥–å…ˆã€‚ é‡å æ‰€æœ‰å…ƒç´ ä¸ï¼é‚£æ˜¯ç³Ÿç³•çš„å¼€å‘è€…ï¼è¯·æ³¨æ„ä½¿ç”¨ç”¨æˆ·çš„ CPU å‘¨æœŸã€‚è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æ— é™æ»šåŠ¨çš„ä¾‹å­ï¼š åœ¨è„šæœ¬ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªå“¨å…µæ¥è§‚å¯Ÿå’Œå›žæ”¶æ˜¯æ˜Žæ™ºçš„é€‰æ‹©ã€‚ä½ åº”è¯¥åœ¨æ— é™æ»šåŠ¨çš„æœ€åŽä¸€ä¸ªå…ƒç´ æ·»åŠ å“¨å…µã€‚å½“å“¨å…µå¿«è¦è¿›å…¥ viewport çš„æ—¶å€™ï¼Œåœ¨å›žè°ƒå‡½æ•°ä¸­åŠ è½½æ•°æ®ï¼Œåˆ›å»ºæŽ¥ä¸‹æ¥çš„å…ƒç´ ï¼Œå¹¶æ·»åŠ åˆ°å“¨å…µä¹‹å‰çš„ DOM ç»“æž„ä¸­ã€‚å¦‚æžœé‡å¤åˆ©ç”¨å“¨å…µï¼Œä¸éœ€è¦å†è°ƒç”¨ observe()ï¼Œ IntersectionObserver ä»ç„¶ä¼šç»§ç»­å·¥ä½œã€‚ æ›´å¤šåœ°æ›´æ–°ä¸Žå›žè°ƒè°ƒç”¨å°±åƒå‰é¢æåˆ°çš„ï¼Œå½“è¢«ç›‘å¬å…ƒç´ è¿›å…¥æˆ–ç¦»å¼€ viewport çš„æ—¶å€™ï¼Œå›žè°ƒå‡½æ•°ä¼šåˆ†åˆ«å•æ¬¡è§¦å‘ã€‚ è¿™è®©IntersectionObserver å¯ä»¥ç»™ä½ è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œâ€œå…ƒç´  X æ˜¯å¦åœ¨è§†å›¾ä¸­ï¼Ÿâ€ã€‚ä½†åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œè¿™è¿˜ä¸å¤Ÿã€‚ theshold é€‰é¡¹ç™»åœºã€‚å®ƒå…è®¸ä½ å®šä¹‰ä¸€ä¸ª intersectionRatio é˜ˆå€¼æ•°ç»„ã€‚å½“è¾¾åˆ°æ¯ä¸€ä¸ª intersectionRatio å€¼æ—¶ï¼Œå›žè°ƒå‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ã€‚theshold é»˜è®¤å€¼æ˜¯ [0]ï¼Œå°±æ˜¯æˆ‘ä»¬è§£é‡Šçš„é»˜è®¤è¡¨çŽ°ã€‚å½“è®¾å®š theshold ä¸º [0, 0.25, 0.5, 0.75, 1], æˆ‘ä»¬ä¼šåœ¨å…ƒç´ æ¯å››åˆ†ä¹‹ä¸€çš„éƒ¨åˆ†è¿›å…¥ viewport æ—¶å¾—åˆ°é€šçŸ¥ã€‚ è¿˜æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿåˆ°çŽ°åœ¨ä¸ºæ­¢ï¼Œè¿˜æœ‰ä¸€ä¸ªé€‰é¡¹æ²¡æœ‰è¢«æåˆ°ã€‚rootMargin å…è®¸ä½ æŒ‡å®š root å…ƒç´ çš„ marginï¼Œæœ‰æ•ˆåœ°å…è®¸ä½ å¢žåŠ æˆ–ç¼©å‡å®žé™…çš„äº¤å‰åŒºåŸŸã€‚margin ä½¿ç”¨ css-style çš„è§„åˆ™ï¼Œ 10px 20px 30px 40px åˆ†åˆ«è¡¨ç¤ºä¸Šã€å³ã€ä¸‹ã€å·¦ã€‚æ€»çš„æ¥è¯´ï¼ŒIntersectionObserver çš„é€‰é¡¹æ€»ç»“å¦‚ä¸‹ï¼š new IntersectionObserver(entries => {/* â€¦ */}, { // The root to use for intersection. // If not provided, use the top-level documentâ€™s viewport. root: null, // Same as margin, can be 1, 2, 3 or 4 components, possibly negative lengths. // If an explicit root element is specified, components may be percentages of the // root element size. If no explicit root element is specified, using a percentage // is an error. rootMargin: "0px", // Threshold(s) at which to trigger callback, specified as a ratio, or list of // ratios, of (visible area / total area) of the observed element (hence all // entries must be in the range [0, 1]). Callback will be invoked when the visible // ratio of the observed element crosses a threshold in the list. threshold: [0], }); iframe é­”æ³•IntersectionObserver è¢«è®¾è®¡æ—¶æ˜Žç¡®è€ƒè™‘å¹¿å‘ŠæœåŠ¡å’Œç½‘ç»œç¤¾äº¤æœåŠ¡ï¼Œå¯èƒ½ç»å¸¸ä¼šç”¨åˆ° iframe å’Œæœ‰ç›ŠäºŽçŸ¥é“ä»–ä»¬æ˜¯å¦åœ¨çœ‹ã€‚å¦‚æžœè§‚å¯Ÿ iframe ä¸­çš„å…ƒç´ ï¼Œé‚£ä¹ˆæ»šåŠ¨ iframe å’Œæ»šåŠ¨çˆ¶é¡µé¢éƒ½å¯ä»¥åœ¨é€‚å½“çš„æ—¶å€™è§¦å‘å›žè°ƒå‡½æ•°ã€‚å¯¹äºŽåŽè€…ï¼Œ rootBounds å°†è¢«è®¾ç½®ä¸º null ä»¥é¿å…æ•°æ®æºæ³„æ¼ã€‚ IntersectionObserver ä¸æ˜¯ä»€ä¹ˆï¼Ÿéœ€è¦çŸ¥é“çš„æ˜¯ï¼Œ IntersectionObserver æ˜¯è¢«æ•…æ„è®¾ç½®æˆä¸å®Œç¾Žå’Œä½Žå»¶è¿Ÿçš„ã€‚ä½¿ç”¨å®ƒä»¬åŠªåŠ›å®žçŽ°åƒæ»šåŠ¨åŠ¨ç”»ä¹‹ç±»æ˜¯æ³¨å®šä¼šå¤±è´¥çš„ã€‚å› ä¸ºä¸¥æ ¼åœ°è¯´ï¼Œå½“ä½ èŽ·å¾—æ•°æ®æ—¶ï¼Œæ•°æ®å·²ç»è¿‡æ—¶äº†ã€‚è¿™é‡Œæœ‰æ›´å¤šçš„å…³äºŽ IntersectionObserver åŽŸå§‹ç”¨ä¾‹ã€‚ å¯ä»¥åœ¨ callback ä¸­åšå¤šå°‘äº‹æƒ…åœ¨å›žè°ƒä¸­èŠ±å¤ªå¤šæ—¶å€™ä¼šè®©ä½ çš„åº”ç”¨æ»žåŽï¼Œå’Œå¸¸è§çš„å®žè·µä¸€æ ·ã€‚ ä½¿ç”¨ IntersectionObserverå¯¹äºŽ IntersectionObserverï¼Œæµè§ˆå™¨çš„æ”¯æŒä»ç„¶å¾ˆå¼±ï¼Œæ‰€ä»¥å®ƒä¸ä¼šé©¬ä¸Šè¢«æ™®éåº”ç”¨ã€‚åŒæ—¶ï¼ŒWICG çš„ polyfill ä¹Ÿè¢«å»ºç«‹èµ·æ¥ã€‚æ˜¾ç„¶ï¼Œä½¿ç”¨ polyfill ä¸å¦‚åŽŸç”Ÿå®žçŽ°çš„æ•ˆçŽ‡å¥½ã€‚ Except as otherwise noted, the content of this page is licensed under the Creative Commons Attribution 3.0 License, and code samples are licensed under the Apache 2.0 License. For details, see our Site Policies. Java is a registered trademark of Oracle and/or its affiliates. ä¸Šæ¬¡æ›´æ–°æ—¥æœŸï¼šå…­æœˆ 5, 2017 ã€ç¿»è¯‘åŽŸæ–‡ã€‘ï¼š intersectionobserver]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>lazyload</tag>
        <tag>performance</tag>
        <tag>optimization</tag>
        <tag>IntersectionObserver</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ intersection observer å»¶è¿ŸåŠ è½½å›¾ç‰‡]]></title>
    <url>%2F2017%2F08%2F18%2Flazy-loading-images-using-intersection-observer.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨ intersection observer å»¶è¿ŸåŠ è½½å›¾ç‰‡å¦‚æžœæ‚¨è¿˜æ²¡æœ‰çœ‹è¿‡ï¼ŒPaul Lewis ç»„ç»‡äº†ä¸€ä¸ªä»¤äººæ•¬ç•çš„è§†é¢‘ç³»åˆ—ï¼Œæ¼”ç¤ºå¦‚ä½•æž„å»ºåª’ä½“æ’­æ”¾å™¨ä»¥åŠæ‹¥æœ‰éžå¸¸æ£’çš„ç‰¹æ€§çš„ Progressive Web Appsã€‚ä»–åœ¨YouTubeä¸Šå»ºç«‹äº†ä¸€ç³»åˆ—è§†é¢‘ï¼Œè¿™äº›è§†é¢‘æ˜¯åœ¨ä»–å»ºç«‹ç½‘ç«™çš„æ¯ä¸€éƒ¨åˆ†çš„è¿‡ç¨‹ä¸­å‘ç”Ÿçš„ã€‚è§‚çœ‹å¼€å‘è€…å±•ç¤ºä»–ä»¬å·¥ä½œçš„è§†é¢‘ç»å¯¹æ˜¯æˆ‘æœ€å–œæ¬¢å­¦ä¹ æ–°äº‹ç‰©çš„æ–¹æ³•ä¹‹ä¸€ï¼ å½“ä»–åœ¨æ¼”ç¤ºä»–çš„ä»£ç æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°ä»–åˆ›å»ºäº†ä¸€ä¸ªå‡ºè‰²çš„ helper åº“æ¥å»¶è¿ŸåŠ è½½å›¾åƒã€‚æˆ‘ä¸€ç›´åœ¨å¯»æ‰¾æ”¹å–„æˆ‘ç½‘ç«™æ€§èƒ½çš„æ–¹æ³•ï¼Œè¿™æ— ç–‘å¼•èµ·äº†æˆ‘çš„å…´è¶£ã€‚ ä¸Žæ‡’æƒ°åŠ è½½æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿå»¶è¿ŸåŠ è½½å›¾åƒèƒŒåŽçš„æƒ³æ³•æ˜¯ï¼Œæ‚¨ç­‰åˆ°ç”¨æˆ·å‘ä¸‹æ»šåŠ¨é¡µé¢ï¼Œå¹¶å›¾åƒè¿›å…¥è§†å›¾ä¹‹å‰ï¼Œå†ä¸ºè¿™ä¸ªå›¾ç‰‡å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚å¦‚æžœæ‚¨çš„ç½‘é¡µåŒ…å«å¤šä¸ªå›¾åƒï¼Œä½†æ˜¯åªæœ‰åœ¨å›¾åƒæ»šåŠ¨åˆ°è§†å›¾æ—¶æ‰åŠ è½½æ¯ä¸ªå›¾åƒï¼Œæ‚¨å°†æœ€ç»ˆèŠ‚çœå¸¦å®½ï¼Œå¹¶ç¡®ä¿æ‚¨çš„ç½‘é¡µåŠ è½½æ›´å¿«ã€‚ ä¸ºäº†ç»™ä½ ä¸€ä¸ªè¿™æ ·çš„æƒ³æ³•ï¼Œæˆ‘ä»¬æ¥æƒ³è±¡ä¸‹é¢æœ‰ä¸‰ä¸ªå›¾åƒçš„é¡µé¢ã€‚ å¦‚æžœç”¨æˆ·ç™»é™†é¡µé¢å¹¶ä¸”ä»…æŸ¥çœ‹ç¬¬ä¸€å¼ å›¾åƒï¼Œæˆ‘ä»¬ä¸æƒ³åŠ è½½é¡µé¢åº•éƒ¨æ¯”è¨çš„å›¾åƒï¼Œç›´åˆ°ç”¨æˆ·å‘ä¸‹æ»šåŠ¨ï¼Œå¹¶ä¸”ç­‰åˆ°å›¾åƒçœŸæ­£åœ¨è§†å›¾ä¸­ã€‚å¦‚æžœæˆ‘ä»¬æ‡’æƒ°åŠ è½½å›¾åƒï¼Œè¿™æ„å‘³ç€ç”¨æˆ·åªéœ€è¦ä¸‹è½½ä»–ä»¬éœ€è¦çš„ä¸œè¥¿ï¼Œè¿™ä½¿æ‚¨çš„ç½‘é¡µæ›´ç²¾ç®€ã€‚ å¯¹äºŽæ›´æœ‰ç»éªŒçš„å¼€å‘äººå‘˜ï¼Œæ‚¨å¯èƒ½ä¼šç†Ÿæ‚‰å»¶è¿ŸåŠ è½½å›¾åƒï¼Œæ¯•ç«Ÿè¿™ä¸ªæ¦‚å¿µå·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆæ–°æ¦‚å¿µå—ï¼Ÿï¼æœ‰å¾ˆå¤šæ‡’åŠ è½½åº“åšå¾—å¾ˆå¥½ã€‚æˆ‘ç”šè‡³ä»¥å‰åœ¨è¿™ä¸ªåšå®¢ä¸Šå†™äº†ä¸€ç¯‡ï¼ˆå¾ˆå¤šå¹´å‰ï¼‰ã€‚é—®é¢˜åœ¨äºŽï¼Œå‡ ä¹Žæ‰€æœ‰è¿™äº›åº“éƒ½ä¼šç»‘å®šæ»šåŠ¨äº‹ä»¶ï¼Œæˆ–è€…ä½¿ç”¨å®šæ—¶å™¨æ¥æ£€æŸ¥å…ƒç´ çš„è¾¹ç•Œï¼Œç„¶åŽå†ç¡®å®šæ˜¯å¦åœ¨è§†å›¾ä¸­ã€‚è¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯å®ƒå¼ºåˆ¶æµè§ˆå™¨é‡æ–°å¸ƒå±€ï¼ˆre-layoutï¼‰æ•´ä¸ªé¡µé¢ï¼Œå¹¶ä¸”åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨çš„ç½‘ç«™ä¼šå¼•èµ·ç›¸å½“å¤§çš„æ€§èƒ½æŸå¤±ã€‚æˆ‘ä»¬å¯ä»¥åšå¾—æ›´å¥½ï¼ INTERSECTION OBSERVER æ¥æŠ¢æ•‘ï¼è¿™æ˜¯å°±æ˜¯ Intersection Observer çš„ç”¨å¤„ã€‚Intersection Observer å†…ç½®äºŽå¤§å¤šæ•°çŽ°ä»£æµè§ˆå™¨ä¸­ï¼Œè®©æ‚¨çŸ¥é“è¢«è§‚å¯Ÿçš„å…ƒç´ ä½•æ—¶è¿›å…¥æˆ–é€€å‡ºæµè§ˆå™¨çš„è§†å£ã€‚è¿™ä½¿å¾—å®ƒéžå¸¸ç†æƒ³ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿå¼‚æ­¥ä¼ è¾“æ•°æ®ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“ä¸»çº¿ç¨‹ï¼Œä½¿å…¶æˆä¸ºæä¾›åé¦ˆçš„æœ‰æ•ˆæ‰‹æ®µã€‚ åœ¨ Paul çš„ä¾‹å­ä¸­ï¼Œä»–æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Intersection Observer æ¥å»¶è¿ŸåŠ è½½è¿›å…¥è§†å£å›¾åƒã€‚æˆ‘å·²ç»èŽ·å–äº†ä»–çš„åˆå§‹ä»£ç ï¼Œå¹¶ç¨å¾®è°ƒæ•´äº†ä¸€ç‚¹ï¼Œä½¿æˆ‘æ›´å®¹æ˜“ç†è§£ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é€šè¿‡äº†è§£ Intersection Observer çš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶å‘æ‚¨å±•ç¤ºå¦‚ä½•ä»¥è¶…çº§é«˜æ•ˆçš„æ–¹å¼åšåˆ°å»¶è¿ŸåŠ è½½å›¾åƒã€‚ å…¥é—¨æƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªåŸºæœ¬çš„HTMLé¡µé¢ï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªä¸Žä¸Šè¿°ç›¸ä¼¼çš„å›¾åƒã€‚åœ¨ç½‘é¡µä¸Šï¼Œæ‚¨å°†å…·æœ‰ä¸Žä»¥ä¸‹ç†Ÿæ‚‰çš„å›¾åƒå…ƒç´ ä»£ç ï¼š æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå›¾åƒæ–‡ä»¶æ²¡æœ‰ src å±žæ€§ã€‚è¿™æ˜¯å› ä¸ºå®ƒæ­£åœ¨ä½¿ç”¨ä¸€ä¸ªåä¸º data-src çš„æ•°æ®å±žæ€§æ¥æŒ‡å‘å›¾åƒæºã€‚å½“è¿›å…¥è§†å£æ—¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥åŠ è½½å›¾åƒã€‚æ‚¨è¿˜å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œå›¾åƒå…ƒç´ è¿˜å…·æœ‰ä¸€ä¸ªåä¸º â€œjs-lazy-imageâ€ çš„ç±» - æˆ‘ä»¬å°†åœ¨ JavaScript ä»£ç ä¸­å°½å¿«ä½¿ç”¨è¿™ä¸ªç±»ï¼Œä»¥ç¡®å®šè¦å»¶è¿ŸåŠ è½½çš„å…ƒç´ ã€‚ æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå°†åœ¨é¡µé¢ä¸ŠåŠ è½½å›¾åƒçš„ä»£ç ã€‚åœ¨æˆ‘ä»¬çš„ JavaScript æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ Intersection Observer ã€‚ ä¸Šé¢çš„ä¾‹å­çœ‹èµ·æ¥åƒå¾ˆå¤šä»£ç ï¼Œä½†æ˜¯è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°åˆ†è§£å®ƒã€‚é¦–å…ˆï¼Œæˆ‘æ­£åœ¨é€‰æ‹©é¡µé¢ä¸Šå…·æœ‰ç±»â€œjs-lazy-imageâ€çš„æ‰€æœ‰å›¾åƒã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘æ­£åœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„ IntersectionObserverï¼Œå¹¶ä½¿ç”¨å®ƒæ¥è§‚å¯Ÿæˆ‘ä»¬é€‰æ‹©çš„å…·æœ‰ç±»â€œjs-lazy-imageâ€çš„æ‰€æœ‰å›¾åƒã€‚ä½¿ç”¨ IntersectionObserver çš„é»˜è®¤é€‰é¡¹ï¼Œå½“å…ƒç´ éƒ¨åˆ†è¿›å…¥è§†å›¾æˆ–å®Œå…¨ç¦»å¼€è§†å£æ—¶ï¼Œæ‚¨çš„å›žè°ƒéƒ½å°†è¢«è°ƒç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘å°†å‡ ä¸ªé¢å¤–çš„é…ç½®é€‰é¡¹ä¼ é€’ç»™ IntersectionObserverã€‚ä½¿ç”¨ rootMargin å…è®¸æ‚¨æŒ‡å®šæ ¹çš„è¾¹è·ï¼Œæœ‰æ•ˆåœ°å…è®¸æ‚¨å¢žåŠ æˆ–ç¼©å°ç”¨äºŽè§‚å¯Ÿäº¤ç‚¹çš„åŒºåŸŸã€‚æˆ‘ä»¬æƒ³ç¡®ä¿å¦‚æžœå›¾åƒåœ¨Yè½´ä¸Šçš„50åƒç´ å†…ï¼Œæˆ‘ä»¬å°†å¼€å§‹ä¸‹è½½ã€‚ çŽ°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ª Intersection Observerï¼Œå¹¶ä¸”æ­£åœ¨è§‚å¯Ÿé¡µé¢ä¸Šçš„å›¾åƒï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥åˆ°è¯¥å…ƒç´ è¿›å…¥è§†å›¾æ—¶è¢«è§¦å‘çš„ intersection äº‹ä»¶ã€‚ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåªè¦æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„å…ƒç´ è¿›å…¥ç”¨æˆ·è§†å£ï¼ŒonIntersection åŠŸèƒ½å°†è¢«è§¦å‘ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ªçŽ¯æŸ¥çœ‹æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„å›¾åƒï¼Œå¹¶ç¡®å®šå“ªä¸ªå›¾åƒåœ¨è§†å£ä¸­ã€‚å¦‚æžœå½“å‰å…ƒç´ å¤„äºŽäº¤å‰æ¯”ä¾‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“å›¾åƒåœ¨ç”¨æˆ·è§†å£ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åŠ è½½å®ƒã€‚åŠ è½½å›¾åƒåŽï¼Œæˆ‘ä»¬ä¸éœ€è¦å†è§‚å¯Ÿå›¾åƒï¼Œå¹¶ä¸”ä½¿ç”¨ unobserve() å°†å…¶ä»Ž Intersection Observer ä¸­çš„æ¡ç›®åˆ—è¡¨ä¸­åˆ é™¤ã€‚ å°±æ˜¯è¿™æ ·ï¼ä¸€æ—¦ç”¨æˆ·æ»šåŠ¨å¹¶ä¸”å›¾åƒè¿›å…¥è§†å›¾ï¼Œåˆ™å°†åŠ è½½é€‚å½“çš„å›¾åƒã€‚è¿™ä¸ªä»£ç æœ€å¥½çš„åŠžæ³•æ˜¯ Intersection Observer æ¯”å·´é‡ŒÂ·æ€€ç‰¹ï¼ˆBarry Whiteï¼‰æ›´å¹³æ»‘ã€‚æˆ‘å°½é‡ä¿æŒå°½å¯èƒ½ç®€æ´çš„ä»£ç ï¼Œä½†å¦‚æžœæ‚¨æƒ³çœ‹åˆ°å®Œæ•´ç‰ˆæœ¬ï¼Œæˆ‘å·²ç»åˆ›å»ºäº†ä¸€ä¸ªGithub repoï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ªæœ‰æ•ˆçš„ä¾‹å­ã€‚ æµè§ˆå™¨æ”¯æŒåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæ‚¨å¯èƒ½ä¼šæƒ³çŸ¥é“æµè§ˆå™¨å¯¹æ­¤åŠŸèƒ½çš„æ”¯æŒã€‚Edgeï¼ŒFirefoxï¼ŒChromeå’ŒOperaç›®å‰æ”¯æŒ Intersection Observerï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½æ¶ˆæ¯ã€‚ ä½†æ˜¯ï¼Œä¸ºäº†ç¡®ä¿ä¸æ”¯æŒæ­¤åŠŸèƒ½çš„æµè§ˆå™¨çš„ä»£ç ä¸ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠŸèƒ½æ£€æµ‹æ¥ç¡®å®šæˆ‘ä»¬å¦‚ä½•åŠ è½½å›¾åƒã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨æ£€æŸ¥ IntersectionObserver æ˜¯å¦åœ¨å½“å‰æµè§ˆå™¨ä¸­å¯ç”¨ï¼Œå¦‚æžœä¸æ”¯æŒæˆ‘ä»¬åªæ˜¯ç®€å•åœ°ç«‹å³åŠ è½½å›¾åƒï¼Œå¦åˆ™æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„é»˜è®¤è¡Œä¸ºã€‚ å¦‚æžœæ‚¨çœŸçš„å–œæ¬¢ IntersectionObserver API çš„ç®€ä¾¿æ€§ï¼Œå¹¶ä¸”æƒ³è¦ä½¿ç”¨ polyfillï¼Œåˆ™ WICG å·²åˆ›å»ºä¸€ä¸ªå¯åœ¨ Github repository ä¸­ä½¿ç”¨çš„åŠŸèƒ½ã€‚å”¯ä¸€çš„ç¼ºç‚¹æ˜¯æ‚¨ä¸ä¼šèŽ·å¾—åŽŸç”Ÿå®žçŽ°ç»™æ‚¨çš„æ€§èƒ½ä¼˜åŠ¿ã€‚ æ‚¨ç”šè‡³å¯ä»¥é‡‡å–è¿›ä¸€æ­¥æŽªæ–½ï¼Œå¹¶ä¸º Robin Osborne å»ºè®®çš„æœªå¯ç”¨ JavaScript çš„ç”¨æˆ·æ·»åŠ æ”¯æŒã€‚ æ€»ç»“åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ IntersectionObserver æ¥å»¶è¿ŸåŠ è½½å›¾åƒï¼Œä½†æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿›è¡Œæ›´å¤šæ“ä½œã€‚å®ƒå¯ä»¥ç”¨äºŽç¡®å®šæŸäººæ˜¯å¦æ­£åœ¨æŸ¥çœ‹å¹¿å‘Šï¼Œæˆ–è€…å³ä½¿æ˜¯åœ¨iFrameä¸­çš„å…ƒç´ ã€‚æ˜“äºŽç†è§£çš„APIä½¿å…¶å¯ä»¥æ‰“å¼€è®¸å¤šé€‰é¡¹ã€‚ å¦‚æžœæ‚¨æƒ³äº†è§£æœ‰å…³äº¤å‰ç‚¹è§‚å¯Ÿè€…çš„æ›´å¤šä¿¡æ¯ï¼Œæˆ‘å»ºè®®æ‚¨åœ¨Google Developersç½‘ç«™ä¸Šé˜…è¯»è¿™ç¯‡æœ‰å…³ä¿¡æ¯çš„æ–‡ç« ã€‚æˆ‘è¿˜å¼ºçƒˆå»ºè®®åœ¨ Youtube ä¸Šè§‚çœ‹ä¿ç½—Â·åˆ˜æ˜“æ–¯çš„è§†é¢‘ç³»åˆ—ï¼Œå®ƒåŒ…å«äº†å¾ˆæ£’çš„æç¤ºï¼Œä½ ä¸€å®šä¼šå­¦åˆ°ä¸€äº›ä¸œè¥¿ã€‚ ã€ç¿»è¯‘åŽŸæ–‡ã€‘: LAZY LOADING IMAGES USING INTERSECTION OBSERVER]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>lazyload</tag>
        <tag>performance</tag>
        <tag>optimization</tag>
        <tag>IntersectionObserver</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ å¯èƒ½ä¸çŸ¥é“çš„JSONç”¨æ³•åŠè¯¯åŒº]]></title>
    <url>%2F2017%2F07%2F28%2Fyou-may-dont-know-JSON.html</url>
    <content type="text"><![CDATA[å†è°ˆ JSON, ä½ å¯èƒ½ä¸çŸ¥é“çš„ä¸€äº› JSON ç”¨æ³•åŠè¯¯åŒºæœ€è¿‘ä¹Ÿæ˜¯çœ‹åˆ°å¾ˆå¤šäººåœ¨è®¨è®º JSON, ä½†æœ‰äº›ç‚¹è¯´å¾—ä¸å¤ªå‡†ç¡®ï¼Œç¿»ç¿»çŠ€ç‰›ä¹¦ï¼Œå†æ¬¡å¤ä¹ ä¸€ä¸‹ã€‚ JSON.stringify(value [, replacer [, space]])ç¬¬ä¸€ä¸ªå‚æ•°ä¸€èˆ¬æ˜¯å¯¹è±¡ï¼ˆObjectï¼‰æˆ–æ•°ç»„ï¼ˆArrayï¼‰ï¼Œæˆ– javascript åŸºæœ¬å€¼ã€‚ è¯¯åŒºï¼šä¸æ”¯æŒçš„å€¼éƒ½ä¼šè¢«å¿½ç•¥é¦–å…ˆ JSON åªèƒ½åºåˆ—åŒ–å¯æžšä¸¾çš„å€¼ï¼Œå…¶æ¬¡ undefinedï¼ŒNaNï¼ŒInfinityï¼Œfunction, Date, RegExp, Error è¿™äº›å€¼æˆ–å¯¹è±¡éƒ½æ˜¯ä¸æ”¯æŒçš„ï¼Œä½†å¹¶ä¸æ˜¯è¿™äº›å€¼éƒ½ä¼šè¢«å¿½ç•¥ã€‚ var o = { a: Symbol(), // æ–°å¢žçš„ ES6 åŸºæœ¬å€¼ b: [1,2,3], c: undefined, d: NaN, e: Infinity, f: function (){ return 1;}, g: new Date(), h: /^\d$/gi, i: new Error('err'), j: {} } JSON.stringify(o); // output: '{"b":[1,2,3],"d":null,"e":null,"g":"2017-07-28T02:56:37.102Z","h":{},"i":{},"j":{}}' ç”±ä¸Šå¯ä»¥çœ‹å‡ºï¼š Symbol, undefined, function ä¼šç›´æŽ¥è¢«å¿½ç•¥ NaN, Infinity è¢«è½¬æ¢æˆäº† null RegExp, Error åˆ™è¢«è½¬æˆäº†ç©ºå¯¹è±¡ {} replacerå› ä¸º JSON.stringify() åºåˆ—åŒ–ä¸æ”¯æŒéƒ¨åˆ†å€¼ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•åœ°ä½¿ç”¨ JSON çš„ä¸¤ä¸ªæ–¹æ³•è¿›è¡Œæ·±æ‹·è´ã€‚ä½†å¯ä»¥åˆ©ç”¨ JSON.stringify() çš„ç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œæ­£ç¡®åºåˆ—åŒ–ã€‚ ä½†è¿™å¹¶ä¸æŽ¨èï¼Œå› ä¸º JSON.parse() ä»ç„¶æ— æ³•è¿˜åŽŸä¸è¢«æ”¯æŒçš„å€¼ã€‚åªæœ‰å¯¹è±¡å­—é¢é‡ Object å’Œ æ•°ç»„ Array å¯ä»¥è¢«æ­£ç¡®è¿˜åŽŸï¼Œå…¶ä»–éƒ½å˜æˆå­—ç¬¦ä¸² // æ²¿ç”¨ä¸Šä¸€ä¾‹å­çš„ä»£ç  var replacer = function(k ,v) { var type = typeof v; if(type === 'function') { return Function.prototype.toString.call(v) } if (type === 'undefined'){ return 'undefined' } if (type === 'number'){ if (v !== v){ return 'NaN' } if (v === Infinity){ return 'Infinity' } } if (type === 'symbol'){ return Symbol.prototype.toString.call(v) } if (v instanceof RegExp){ return RegExp.prototype.toString.call(v) } if (v instanceof Error &amp;&amp; v.name !== '' &amp;&amp; v.message !== ''){ return 'new ' + v.name + '('+ v.message +')' } return v } JSON.stringify(o, replacer); // output: '{"a":"Symbol()","b":[1,2,3],"c":"undefined","d":"NaN","e":"Infinity","f":"function (){ return 1;}","g":"2017-07-28T02:56:37.102Z","h":"/^\\d$/gi","i":"new Error(err)","j":{}}' å¦å¤–ä¸€ä¸ªç”¨æ³•å°±æ˜¯ä¼ å…¥æ•°ç»„ï¼ŒæŒ‡å®šéœ€è¦åºåˆ—åŒ–çš„key.è¿™ä¸ªåœ¨æå–éƒ¨åˆ†å±žæ€§çš„æ—¶å€™ä¹Ÿæ˜¯å¾ˆæœ‰ç”¨ã€‚ // æ²¿ç”¨ä¸Šé¢çš„ä»£ç  JSON.stringify(o, ["b", "c", "d"]); // output: '{"b":[1,2,3],"d":null}' spaceæ˜¯ä¸€ä¸ªå¯é€‰çš„ç¾ŽåŒ–å±žæ€§ï¼Œåºåˆ—åŒ–æ—¶æ˜¯æ²¡æœ‰æ¢è¡Œå’Œç©ºæ ¼çš„ï¼Œæ­¤å‚æ•°å¯æŒ‡å®šä¸€ä¸ªæ•°å€¼ï¼ˆå¤§äºŽ10åˆ™é™åˆ¶ä¸º10ï¼‰æˆ–ä¸€ç»„å­—ç¬¦ï¼ˆé•¿åº¦æœ€é•¿ä¸º10ä¸ªå­—ç¬¦), æ­¤å‚æ•°ä¸ä¸ºç©ºä¼šè‡ªåŠ¨æ’å…¥æ¢è¡Œã€‚ ä½†æ˜¯è®¾ç½®ä¸ºå­—ç¬¦æ—¶ï¼Œæ— æ³•ä½¿ç”¨ parse å¤åŽŸ JSON.stringify(o, null, '-'); // '{ // -"b": [ // --1, // --2, // --3 // -], // -"d": null, // -"e": null, // -"g": "2017-07-28T02:56:37.102Z", // -"h": {}, // -"i": {}, // -"j": {} // }' JSON.parse(value[, reviver])JSON.parse ä¸Ž JSON.stringify æ“ä½œæ­£å¥½ç›¸åï¼Œä½† value å¿…é¡»ä¸¥æ ¼ç¬¦åˆ JSON æ ¼å¼ï¼Œå¦åˆ™æŠ¥é”™ã€‚ ç¬¬äºŒä¸ªå‚æ•°å¯ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œç”¨ä»¥è½¬æ¢è§£æžå‡ºæ¥çš„å€¼ã€‚ æ¯”å¦‚ Date å¯¹è±¡åœ¨åºåˆ—åŒ–ä¹‹åŽæ— æ³•é€†è½¬æˆä¸€ä¸ª Date å¯¹è±¡ï¼Œæ­¤æ—¶å¯å†™ä¸€ä¸ªå‡½æ•°åŽ»è½¬æ¢ï¼š var reviver = function (name, value){ console.log(/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d.\d\d\dZ$/.test(value)); if (typeof value === 'string' &amp;&amp; /^\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d.\d\d\dZ$/.test(value)){ return new Date(value) } return value } // æ²¿ç”¨å‰ä¸ªä¾‹å­çš„ä»£ç  JSON.parse(JSON.stringify(o.g), reviver) // output: Fri Jul 28 2017 10:56:37 GMT+0800 (+08) toJSON()æœ‰äº›æ–‡ç« ä¼šè¯´ Object.toJSON() ï¼Œè¿™æ˜¯ä¸å¯¹çš„ï¼ŒObject åŽŸåž‹ä¸Šå¹¶æ²¡æœ‰å®šä¹‰ toJSON æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åªè¢«å®šä¹‰åœ¨ Date å¯¹è±¡ä¸Šã€‚JSON.stringify() åœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¼šé¦–å…ˆæŸ¥æ‰¾è¯¥æ–¹æ³•ï¼Œå¦‚æžœæœ‰åˆ™ç›´æŽ¥è¿”å›ž toJSON çš„è°ƒç”¨ç»“æžœã€‚è¿™ä¸ªä¸€å¼€å§‹æ˜¯è®© Date æ­£ç¡®åºåˆ—åŒ–æˆ JSON æ—¶è®¾è®¡çš„ã€‚ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨ toJSON çš„å±è”½åŠŸèƒ½ã€‚ Function.prototype.toJSON = function (){ return Function.prototype.toString.call(this) } // æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­ JSON.stringify(o); // {"b":[1,2,3],"d":null,"e":null,"f":"function (){ return 1;}","g":"2017-07-28T02:56:37.102Z","h":{},"i":{},"j":{}} ä¼šå‘çŽ°ï¼Œfunction æ²¡æœ‰è¢«å¿½ç•¥ï¼Œä½†æ­¤æ–¹æ³•è¦æ…Žç”¨ï¼Œåœ¨åŽŸåž‹ä¸Šæ·»åŠ æ–¹æ³•å¯èƒ½äº§ç”Ÿå‰¯ä½œç”¨ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>JSON</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åƒ google ä¸€æ ·é€šè¿‡ç¼©çŸ­ css ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥åŽ‹ç¼©ä¼˜åŒ– css åŒ…çš„å¤§å°]]></title>
    <url>%2F2017%2F07%2F24%2Freducing-css-bundle-size-by-cutting-the-class-names-and-using-scope-isolation.html</url>
    <content type="text"><![CDATA[åƒ google ä¸€æ ·é€šè¿‡ç¼©çŸ­ css ç±»åå’Œä½œç”¨åŸŸéš”ç¦»æ¥åŽ‹ç¼©ä¼˜åŒ– css åŒ…çš„å¤§å° å°±åƒ google çš„åšæ³•ä¸€æ · ä»Šå¹´å¹´åˆï¼Œæˆ‘å·²ç»é€€å‡ºå’¨è¯¢å…¬å¸å¹¶å¼€å§‹æž„å»º GO2CINEMA - ä¸€ä¸ª å¿«é€Ÿï¼Œç®€å•å’Œå®‰å…¨ çš„æ–¹å¼æ¥é¢„è®¢è‹±å›½çš„ç”µå½±ç¥¨çš„ç½‘ç«™ã€‚æˆ‘åšäº†ä¸€ä¸ªè¾‰ç…Œçš„å·¥ä½œï¼Œä½¿å…¶å¿«é€Ÿï¼Œç®€å•å’Œå®‰å…¨ã€‚åœ¨å…¶ä¸­æŸä¸ªé˜¶æ®µï¼Œæˆ‘ä¸€ç›´ç—´è¿·äºŽå…³é”®æ¸²æŸ“è·¯å¾„çš„ä¼˜åŒ–ã€‚âš¡ï¸ æˆ‘å·²ç»ä½¿ç”¨ Å«sus è§£å†³äº† HTML çš„é¢„æ¸²æŸ“ã€‚Å«sus æ¸²æŸ“å•é¡µåº”ç”¨ç¨‹åºï¼ˆSPAï¼‰çš„ HTMLï¼Œå¹¶å†…åµŒäº†ç”¨äºŽå‘ˆçŽ°é¡µé¢çš„ CSSã€‚ä½†æ˜¯ï¼Œæˆ‘å¹¶ä¸å–œæ¬¢åœ¨æ¯ä¸ª HTML æ–‡æ¡£å†…åµŒ 70 KB çš„ cssï¼Œç‰¹åˆ«æ˜¯å…¶ä¸­å¤§éƒ¨åˆ†æ˜¯ CSS ç±»åã€‚ å°±åƒGoogleä¸€æ ·ä½ æœ‰æ²¡æœ‰çœ‹è¿‡ https://www.google.com/ çš„æºä»£ç ï¼Ÿå¦‚æžœçœ‹è¿‡ï¼Œæ‚¨æ³¨æ„åˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ä¼šæ˜¯ï¼ŒCSS ç±»åç§°æ²¡æœ‰è¶…è¿‡å‡ ä¸ªå­—ç¬¦ã€‚ ä½†æ˜¯æ€Žä¹ˆæ ·åšåˆ°çš„å‘¢ï¼Ÿ CSS minifiers çš„ç¼ºç‚¹æœ‰ä¸€ä»¶äº‹ï¼Œminifier ä¸èƒ½åš - æ”¹å˜é€‰æ‹©å™¨åç§°ã€‚è¿™æ˜¯å› ä¸º CSS minifier ä¸èƒ½æŽ§åˆ¶ HTML è¾“å‡ºã€‚åŒæ—¶ï¼ŒCSS åç§°å¯ä»¥å¾ˆé•¿ã€‚ å¦‚æžœæ‚¨ä½¿ç”¨ CSS modulesï¼Œæ‚¨çš„ CSS modules å¯èƒ½ä¼šåŒ…å«æ ·å¼è¡¨æ–‡ä»¶åï¼Œæœ¬åœ°æ ‡è¯†åå’Œéšæœºå“ˆå¸Œã€‚ä½¿ç”¨ css-loader localIdentName é…ç½®æè¿°ç±»åæ¨¡æ¿ï¼Œä¾‹å¦‚[name]___[local]___[hash:base64:5]ã€‚å› æ­¤ï¼Œç”Ÿæˆçš„ç±»åç§°å°†å¦‚ä¸‹æ‰€ç¤º .MovieView___movie-title___yvKVV ; å¦‚æžœä½ å–œæ¬¢æè¿°æ€§çš„åå­—ï¼Œå®ƒå¯èƒ½æ›´é•¿ï¼Œä¾‹å¦‚ .MovieView___movie-description-with-summary-paragraph___yvKVV ã€‚ åœ¨ç¼–è¯‘æ—¶é‡å‘½å CSS ç±»åä½†æ˜¯ï¼Œå¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯ webpack å’Œ babel-plugin-react-css-modulesï¼Œé‚£ä¹ˆæ‚¨å¾ˆå¹¸è¿ ðŸ€ - æ‚¨å¯ä»¥ä½¿ç”¨ css-loader çš„ getLocalIdent é…ç½®é¡¹æˆ–è€…ç­‰æ•ˆçš„ babel-plugin-react-css-modules ä¸­çš„ generateScopedName é…ç½®é¡¹æ¥è¾¾åˆ°åœ¨ç¼–è¯‘æ—¶é‡å‘½åç±»åçš„ç›®çš„ã€‚ generateScopedName ä¸­å¾ˆé…·çš„æ˜¯ï¼ŒåŒæ ·çš„åŠŸèƒ½å®žä¾‹å¯ä»¥ç”¨äºŽ Babel å’Œ webpack çš„æž„å»ºè¿‡ç¨‹ï¼š è®©åå­—å˜çŸ­æ„Ÿè°¢ babel-plugin-react-css-modules å’Œ css-loader å…±äº«ç›¸åŒçš„é€»è¾‘æ¥ç”Ÿæˆ CSS ç±»åç§°ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç±»åæ”¹ä¸ºä»»ä½•æˆ‘ä»¬å–œæ¬¢çš„ï¼Œç”šè‡³æ˜¯éšæœºå“ˆå¸Œã€‚ç„¶è€Œï¼Œæˆ‘æƒ³è¦æœ€çŸ­çš„ç±»åï¼Œè€Œä¸æ˜¯éšæœºå“ˆå¸Œã€‚ ä¸ºäº†ç”Ÿæˆæœ€çŸ­çš„ç±»åï¼Œæˆ‘åˆ›å»ºäº†ç±»åç´¢å¼•ï¼Œå¹¶ä½¿ç”¨è¯¥ incstr æ¨¡å—ä¸ºç´¢å¼•ä¸­çš„æ¯ä¸ªæ¡ç›®ç”Ÿæˆå¢žé‡IDã€‚ è¿™ä¿è¯äº†ç±»åç®€çŸ­å¹¶ä¸”å”¯ä¸€ã€‚çŽ°åœ¨ï¼Œ.MovieView___movie-title___yvKVV å’Œ .MovieView___movie-description-with-summary-paragraph___yvKVV çš„ç±»åéƒ½æˆäº† .a_a, .b_aç­‰ã€‚ è¿™å°† GO2CINEMA CSS åŽ‹ç¼©åŒ…çš„å¤§å°ä»Ž 140 KB é™ä½Žåˆ° 53KBã€‚ ä½¿ç”¨ä½œç”¨åŸŸéš”ç¦»æ¥è¿›ä¸€æ­¥å‡å°‘åŒ…çš„å¤§å°åˆ†ç¦»ç»„ä»¶åç§°å’Œæœ¬åœ°æ ‡è¯†ç¬¦åç§°æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç†ç”±è®©æˆ‘æ·»åŠ  _ åˆ° CSS ç±»å - å¯¹äºŽç¼©å°æ–‡ä»¶å¤§å°ç‰¹åˆ«æœ‰ç”¨ã€‚ cssoï¼ˆCSS minifierï¼‰å…·æœ‰ä½œç”¨åŸŸé…ç½®ã€‚ä½œç”¨åŸŸå®šä¹‰äº†åœ¨æŸäº›æ ‡è®°ä¸Šä¸“é—¨ä½¿ç”¨çš„ç±»ååˆ—è¡¨ï¼Œå³æ¥è‡ªä¸åŒä½œç”¨åŸŸçš„é€‰æ‹©å™¨ä¸ä¼šåŒ¹é…åŒä¸€ä¸ªå…ƒç´ ã€‚è¿™ä¸€æ¡è®©ä¼˜åŒ–è§„åˆ™æ›´è¿›ä¸€æ­¥ã€‚ è¦åˆ©ç”¨æ­¤åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ csso-webpack-plugin æ¥åŽå¤„ç† CSS åŒ…ï¼š è¿™ä½¿ GO2CINEMA CSS æ†ç»‘åŒ…çš„å¤§å°ä»Ž 53 KB é™è‡³ 47 KBã€‚ è¿™å€¼å¾—ä¹ˆï¼Ÿè¿™ç§åŽ‹ç¼©çš„ç¬¬ä¸€ä¸ªäº‰è®®æ˜¯è§‰å¾—åŽ‹ç¼©ç®—æ³•æœ¬æ¥å°±å¯ä»¥åšåˆ°ã€‚ä½¿ç”¨ Brotli ç®—æ³•åŽ‹ç¼©çš„ GO2CINEMA CSS åŒ…ä¸Žé•¿ç±»åçš„åŽŸå§‹åŒ…ç›¸æ¯”åªåŽ‹ç¼©äº† 1 KBã€‚ å¦ä¸€æ–¹é¢ï¼Œè®¾ç½®è¿™ä¸ªç¼©å°æ˜¯ä¸€æ¬¡æ€§æŠ•å…¥ï¼Œå®ƒå‡å°‘äº†éœ€è¦è§£æžçš„æ–‡æ¡£çš„å¤§å°ã€‚å®ƒè¿˜å…·æœ‰å…¶ä»–å¥½å¤„ï¼Œä¾‹å¦‚é˜»æ­¢ä¾èµ– CSSç±»åç§°çš„æ‰«æä»ªå¯¼èˆªæˆ–æ„å¤–åŒ¹é…å¹¿å‘Šæ‹¦æˆªå™¨é»‘åå•çš„ CSSé€‰æ‹©å™¨ã€‚ åŒæ—¶ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°åœ¨ GO2CINEMA å’Œ venue é¡µé¢ä¸Šä½¿ç”¨çš„è¿™ç§åŽ‹ç¼©çš„æ¼”ç¤ºï¼Œä¾‹å¦‚ https://go2cinema.com/movies/wonder-woman-2017-1305237 https://go2cinema.com/venues/odeon-oxford-magdalen-st-1001053 ã€ç¿»è¯‘åŽŸæ–‡ã€‘ï¼šhttps://medium.freecodecamp.org/reducing-css-bundle-size-70-by-cutting-the-class-names-and-using-scope-isolation-625440de600b]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>webpack</tag>
        <tag>css</tag>
        <tag>minifier</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ¡‚æž—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿]]></title>
    <url>%2F2017%2F07%2F23%2FDaxu-village-Huixian-wetland-Putao-Xingping-of-Guilin.html</url>
    <content type="text"><![CDATA[æˆ‘å¯ä¸æ˜¯ä¸€ä¸ªé…’åº—äº«å—è€…ï¼Œæˆ‘çš„çŽ©æ³•æ˜¯ donâ€™t stop, keep your step. æ¡‚æž—å±±æ°´æœ€å¼ºå¾’æ­¥æ”»ç•¥-å¤§åœ©å¤é•‡-å¥‡å³°é•‡-ä¼šä»™é•‡-è‘¡è„é•‡è‡³å…´åªå¤é•‡20å…¬é‡Œç»å…¸å¾’æ­¥è·¯çº¿å¯¹äºŽæ¯ä¸ªåœ°æ–¹å¹¶ä¸æ‰“ç®—åŽ»ä¸¤æ¬¡çš„äººæ¥è¯´ï¼ˆé™¤äº†ä¸€äº›ä½“éªŒç‰¹åˆ«å¥½çš„åœ°æ–¹ï¼‰ï¼Œä¸€æ¬¡æ€§æ‰“åŒ…çœ‹å®Œä¸€ä¸ªåœ°æ–¹æ‰€æœ‰æ„Ÿå…´è¶£çš„åœ°ç‚¹æ˜¯æœ€åˆé€‚çš„ã€‚æ‰€ä»¥ï¼Œæ¯æ¬¡åŽ»å®Œï¼Œæ€»æ˜¯æŠŠä¸€ä¸ªå¸‚ï¼Œç”šè‡³ä¸€ä¸ªçœçš„æ”»ç•¥éƒ½åšå®Œäº†ã€‚æˆ–è®¸ä¹Ÿæ˜¯ä¸€ç§å¼ºè¿«ç—‡å§ã€‚ å…¶å®žå›½å†…å¾ˆå¤šæ™¯ç‚¹éƒ½æ˜¯å‘ï¼Œç½‘ä¸Šç…§ç‰‡åŸºæœ¬éƒ½ä¸æ˜¯åŽŸç‰‡ã€‚å†™æ”»ç•¥æ˜¯ä¸ºäº†æ–¹ä¾¿åˆ«äººï¼Œä¹Ÿæ˜¯ä¸ºå‘äº†åˆ«äººä¸€èµ·ï¼Œå“ˆå“ˆï¼Œé¡ºä¾¿è®°å½•ã€‚ è·¯çº¿è§„åˆ’ä¸‹é¢å…ˆç®€è¦çœ‹çœ‹æ€»ä½“è·¯çº¿è§„åˆ’ï¼š Day 1: ç«è½¦ â€”â€”> æ¡‚æž—å¸‚ â€”â€”> å¤§åœ©å¤é•‡ï¼ˆ+ç†Šæ‘ï¼‰ Day 2: å¤§åœ©å¤é•‡ â€”â€”> å¥‡å³°é•‡ï¼ˆé‡åˆ°ä¸å¯æŠ—å› ç´ ï¼‰â€”â€”> ä¼šä»™é•‡ Day 3: ä¼šä»™æ¹¿åœ° â€”â€”> çŽ»ç’ƒç”° â€”â€”> è‘¡è„é•‡ Day 4: è‘¡è„é•‡ è‡³ å…´åªå¤é•‡ ç»å…¸å¾’æ­¥è·¯çº¿ 20 å…¬é‡Œ â€”â€”> ç›¸å…¬å±±ï¼ˆæ—¥è½ï¼‰ Day 5: ç›¸å…¬å±±ï¼ˆæ—¥å‡ºï¼‰â€”â€”> ç›¸å…¬å±±è‡³å…´åªå¤é•‡ â€”â€”> è€å¯¨å±±ï¼ˆæ—¥è½ï¼‰â€”â€”> é˜³æœ”é«˜é“æœ€åŽä¸€ç­å›žï¼ˆ8pmï¼‰ è¡¥å……å‡ å¼ çº¿è·¯å›¾ï¼š è‘¡è„é•‡è‡³å…´åªå¤é•‡ å¾’æ­¥è·¯çº¿å›¾ ä¼šä»™çŽ»ç’ƒç”°è·¯çº¿å›¾ å¤§åœ©å¤é•‡ï¼ˆå¤§å¢Ÿï¼‰â€œæ˜Žæ¸…æ—¶æœŸç¹åŽä¸€æ—¶çš„å¤§åœ©å¤é•‡â€ã€‚ åœ¨æ¡‚æž—ç«è½¦ç«™æ—è¾¹çš„æ¡‚æž—é•¿é€”æ±½è½¦æ€»ç«™åå¼€å¾€å† å²©çš„ä¸“çº¿è½¦ï¼Œ40åˆ†é’Ÿå·¦å³å³å¯åˆ°è¾¾å¤§åœ©ï¼Œç¥¨ä»·5å…ƒå·¦å³ã€‚ å¤é•‡ä¸å¤§ï¼Œ1å°æ—¶è¶³ä»¥æ¸¸å®Œï¼Œè·å¤§åœ©é•‡8å…¬é‡Œï¼ˆåœ¨å¤§åœ©è·¯å£èƒ½çœ‹åˆ°æŒ‡è·¯ç‰Œï¼‰çš„ç†Šæ‘ï¼ˆå¤§åœ©åŽ¿åŸŽæ­å…¬äº¤è¿‡åŽ»3å…ƒï¼‰ã€‚ æ‘ä¸Šä¿ç•™ç€å®Œæ•´çš„æ—§æ—¶æ‘è½æ ¼å±€ï¼Œæœ‰ä¸Šç™¾æ ‹æ˜Žæ¸…å»ºç­‘ï¼ŒçŽ°å­˜æœ‰æ¹–å—ä¼šé¦†ã€æ±Ÿè¥¿ä¼šé¦†ã€è´¢ç¥žæ®¿ç­‰ï¼Œæ‘å­çš„è€å»ºç­‘ä¸Šä¿ç•™äº†è®¸å¤šæ–‡é©æ ‡è¯­ã€‚ å°åƒï¼šå§œæ±æ¡‚èŠ±å‡‰ç²‰ â€œå¤§åœ©æ±Ÿä¸ŠèŠ¦ç”°å¯ºï¼Œç™¾å°ºæ·±æ½­ä¸‡ç«¹å›´ã€‚æŸ³åº—ç§¯è–ªæ™¨çˆ¨åŽï¼Œåƒ®äººè·å¶è£¹ç›å½’â€ å¥‡å³°é•‡ï¼ˆæŽå®¶æ‘ï¼‰åœ¨æ¡‚æž—ç«è½¦ç«™å¯¹é¢æ­ä¹˜4è·¯è½¦ï¼Œå¼€å¾€å¥‡å³°é•‡æ–¹å‘ï¼Œåœ¨ ä¸œå±±æ‘ ä¸‹è½¦ã€‚æ¯è¶Ÿè¿è¡Œå•ç¨‹æ—¶é—´å¤§çº¦æ˜¯40åˆ†é’Ÿã€‚ï¼ˆæˆ‘æ˜¯å¤§åœ©ç›´æŽ¥åæ‘©çš„30å…ƒæŠ„å°è·¯åˆ°å¥‡å³°é•‡ï¼‰ å¥‡å³°é•‡å¤–çœ‹å¥‡å³°ï¼Œä¸‡ç‚¹å°–å³°é”ç¢§ç©ºã€‚ äº‹å®žä¸Šï¼Œé‡Œé¢æ˜¯å†›äº‹ç®¡åˆ¶åŒºï¼Œåªæœ‰æœ¬æ‘æ‘æ°‘æ‰èƒ½è¿›ã€‚å…¬äº¤è½¦åˆ°æ‘å£å°±è¢«å¼ºåˆ¶ä¸‹è½¦ã€‚è¯·ä¸è¦æ¥è¿™é‡Œï¼Œæ²¡æœ‰å¼€æ”¾ ä¼šä»™é•‡æ¡‚æž—æ±½è½¦ç«™ï¼Œä¹˜åæ¡‚æž—â€”ä¼šä»™çš„ç­è½¦ï¼Œæ¯éš”15åˆ†é’Ÿä¸€è¶Ÿï¼Œç¥¨ä»·8å…ƒï¼ˆç›´è¾¾ï¼‰ï¼Œä¹Ÿå¯åœ¨é›ä¸­è·¯å£ï¼Œå¸ˆå¤§ä¾§é—¨åè½¦ã€‚ ç§‹å¤©åŽ»çœ‹ä¸€ç‰‡é‡‘é»„ï¼Œæˆ–ç”°åœ°æ”¾æ°´æ—¶ï¼Œä¸€ç‰‡å¤©é•œã€‚ ä¼šä»™æ¹¿åœ°ï¼š æ­£åœ¨å¼€å‘ä¸­ï¼Œé…’åº—é£Ÿå®¿å…¨æ²¡æœ‰ï¼Œä¸€å¹´åŽåº”è¯¥ä¼šæœ‰ã€‚åˆ°ç¦æ´žæ‘å§”è·¯å£ï¼Œç„¶åŽä¹˜åå‰å¾€æ¯›å®¶æ‘çš„ä¸‰è½®è½¦æ¯äºº2å…ƒé’±ï¼ˆå®žé™…ä¸Šæœ‰æ—¶ä¼šå‘ä½ 10å…ƒï¼‰ã€‚ä¹Ÿå¯ä»Žè·¯å£æ­¥è¡Œè‡³æ¯›å®¶æ‘ï¼Œå¤§æ¦‚40åˆ†é’Ÿå·¦å³ï¼Œè·¯è¾¹ä¸€å¤§ç‰‡å†œç”°ï¼Œæ¹¿åœ°å…¬å›­æœ‰ä¸€å¤§ç‰‡è·èŠ±ã€‚ä¸€èˆ¬æ‘„å½±äººä¼šåŽ»é¾™å±±ï¼Œå”®ç¥¨å£çš„äººä¼šå»ºè®®ä½ åèˆ¹è¿‡åŽ»ä¸Šé¾™å±±ã€‚ç¥¨ä»·ä¸è²ã€‚è§‰å¾—å€¼å¯ä»¥åã€‚å¦‚æžœæ˜¯ç©·å­¦ç”Ÿï¼Œé‚£å°±ä¹°é—¨ç¥¨ï¼Œèµ°è¿‡åŽ»ï¼Œèˆ¹æ˜¯èµ°è¿‘è·¯ç›´æŽ¥åˆ°å±±è„šï¼Œèµ°è·¯å°±è¦åå…«å¼¯ï¼Œ40åˆ†é’Ÿå·¦å³ã€‚å†ä¸æµŽï¼Œå¾€å›žèµ°æœ‰æ¡å²”è·¯ï¼Œæ˜¯é€šå‘åˆšåˆšå…¥å£æ–¹å‘ï¼Œäººå°‘æ—¶æ²¡äººå®ˆï¼Œå…ç¥¨è¿›å…¥ï¼Œè¿™æ˜¯æˆ‘å‡ºæ¥çš„æ—¶å€™å‘çŽ°çš„ã€‚ çŽ»ç’ƒç”°ï¼š æ¹¿åœ°æ˜¯åŽå¼€å‘çš„ï¼Œæœ€å¼€å§‹å‡ºåçš„æ˜¯çŽ»ç’ƒç”°è¿™ä¸€å—ã€‚å±±ä¹Ÿä¸éš¾æ‰¾ï¼Œå°±æ˜¯ä¸‹å›¾çš„ D ç‚¹ï¼Œä¸Šå±±ç‚¹åœ¨æ‘å£åŒ»é™¢å‰ã€‚ è‘¡è„é•‡è¿™æ˜¯ä¸ªä¸­è½¬ä¼‘æ¯ç‚¹ï¼Œæ˜¯ç»å…¸å¾’æ­¥è·¯çº¿çš„èµ·ç‚¹ã€‚ä»Žä¼šä»™è¿‡æ¥çš„è¯ï¼Œå…ˆåè½¦åˆ° é›ä¸­è·¯å£ï¼Œå¸ˆå¤§ä¾§é—¨ï¼Œç„¶åŽåœ¨å—ä¸‹çš„å¤§è·¯ä¸Šæ‹¦åŽ»é˜³æœ”çš„è½¦ï¼Œåœ¨è‘¡è„é•‡ä¸‹è½¦ã€‚ ã€ŠçŸ³å¤´åŸŽåˆ°å…´åªå¾’æ­¥ - å±…é«˜ä¸´ä¸‹æ¬£èµå±±æ°´ç”»å·ã€‹ï¼ˆæ€»é•¿åº¦22.5å…¬é‡Œï¼‰: è¿™æ¡å¾’æ­¥çº¿è·¯æ¸…å¹½å¤æœ´ï¼Œæ¸¸äººç½•è‡³ï¼Œé€”ä¸­æ¯ä¸€æ¬¡ç™»é«˜ä¿¯è§†ï¼Œéƒ½å°†ä¸ºæ‚¨å±•å¼€ä¸€å¹…ä¸åŒçš„é˜³æœ”å±±æ°´ç”»å·ã€‚é˜³æœ”çš„ç»å…¸æ‘„å½±ä¸»é¢˜ï¼Œè‘¡è„ç”°å›­é£Žå…‰(åœ°å¤„é˜³æœ”è‘¡è„é•‡ä¹Œé¾™æ‘ï¼Œæ‹æ‘„è‘¡è„ç”°å›­é£Žå…‰å¤šä¸ºé€†å…‰æ‹æ‘„ï¼Œåº”é€‰æ‹©æœ‰å¤ªé˜³çš„å¤©æ°”ä¸‹åˆ4-5æ—¶åˆ°è¾¾å±±é¡¶ç­‰å€™æ‹æ‘„)ã€ç›¸å…¬å±±æ—¥å‡ºä»¥åŠè€å¯¨å±±æ—¥è½ï¼Œéƒ½åœ¨è¿™æ¡çº¿è·¯ä¸Šã€‚é€”å¾„å¤æœ´çš„çŸ³å¤´åŸŽä»¥åŠå…´åªè€è¡—ï¼Œåˆç»™è¿™æ¡çº¿è·¯å¢žåŠ äº†äººæ–‡é£Žæƒ…ã€‚çº¿è·¯æœ€å¥½åˆ†ä¸¤å¤©å®Œæˆï¼Œè¿™æ ·å¯ä»¥å¤œå®¿ç›¸å…¬å±±ä»¥ä¾¿ç¬¬äºŒå¤©è§‚çœ‹æ—¥å‡ºã€‚å…¨ç¨‹éš¾åº¦ä¸å¤§ï¼Œä¸¤ä¸‰äººè½»è£…ä¾¿å¯å‡ºå‘ï¼Œæ²¿é€”æ‘åº„å¯ä»¥è¡¥ç»™ï¼Œä¹Ÿå¯å¸¦å°‘é‡é£Ÿç‰©å’Œæ°´ä»¥é˜²ä¸‡ä¸€ å½“ç„¶ï¼Œè¿™æ¡è·¯çº¿å¯ä»¥åç€æ¥èµ°ï¼Œä½†æˆ‘æ˜¯ä»Žä¼šä»™è¿‡æ¥çš„ï¼Œè¿™æ ·èµ°æ›´é¡ºè·¯ï¼Œæœ€åŽé˜³æœ”é«˜é“å›žã€‚ ã€å¾’æ­¥çº¿è·¯Aï¼šå°è€€é—¨æ‘â€“çŸ³å¤´å¯¨â€“å¤§å²©å¤´æ‘â€“å°å†²å´´æ‘â€“å¤§åªæ‘â€“æ°´å²©é—¨æ‘â€“ç›¸å…¬å±±â€“é»„æ³¥ç”°æ‘â€“é•°åˆ€æ¹¾æ‘â€“å¤§æ²³èƒŒæ‘â€“æ¸”æ‘æ‘â€“å…´åªé•‡ã€‚ï¼ˆå…¨ç¨‹çº¦19å…¬é‡Œï¼‰ å¾’æ­¥çº¿è·¯Bï¼šå°è€€é—¨æ‘â€”çŸ³å¤´å¯¨â€”å¤§å²©å¤´æ‘â€”å°å†²å´´æ‘â€”å¤§åªæ‘â€“æ°´å²©é—¨æ‘â€“ç›¸å…¬å±±â€“è·è‹žå±±æ‘â€“å†·æ°´æ‘â€“ç”»å±±æ‘â€“å…´åªé•‡ã€‚ï¼ˆå…¨ç¨‹çº¦18å…¬é‡Œï¼‰ã€‘ (PS: å…¶å®žåº”è¯¥æœ‰25å…¬é‡Œï¼Œæˆ‘åœ¨çŸ³å¤´åŸŽè¿·è·¯ï¼Œèµ°å¾—å¤ªç´¯ï¼ŒåŽæ¥è¿˜æ­äº†ä¸€æ®µé¡ºé£Žè½¦åˆ°ç›¸å…¬å±±) å…´åªå¤é•‡ç›¸å…¬å±±åˆ°å†·æ°´æ‘è·¯ä¸å¤ªå¥½èµ°ï¼Œæ¯”æƒ³è±¡ä¸­è¿œï¼Œä½†å…¶å®žåº”è¯¥æœ‰è¿‘è·¯ï¼Œå› ä¸ºåœ¨è·¯ä¸Šæœ‰å²”è·¯ï¼Œä½†åœ°å›¾ä¸Šæ²¡æœ‰æ ‡ã€‚åŽ»å†·æ°´æ‘éœ€è¦æ¸¡æ²³ï¼Œ10å…ƒã€‚æœ¬åœ°äººå…è´¹ã€‚å†·æ°´æ‘åˆ°å…´åªå¤é•‡ä¸€è·¯æ˜¯é£Žæ™¯ï¼Œä¹Ÿå¯åä¸‰è½®è½¦è¿‡åŽ»ã€‚ä¸‹è½¦ç‚¹å°±æ˜¯20å…ƒäººæ°‘å¸ä¸Šçš„å›¾ã€‚ä¹‹åŽåœ¨è€å¯¨å±±çœ‹æ—¥è½ã€‚ä¸‹å±±åœ¨æ±½è½¦ç«™åå°é¢åŒ… 5å…ƒåˆ°é˜³æœ”é«˜é“ç«™å›žã€‚ è¯¦ç»†å½±æ‘„ä¸Šé¢éƒ½æ˜¯äº¤é€šç®€è¦ï¼Œä¸‹é¢æ˜¯å½±æ‘„ï¼š ï¼ˆå¾…æ›´ã€‚ã€‚ï¼‰]]></content>
      <categories>
        <category>travel</category>
      </categories>
      <tags>
        <tag>travel</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é©¬è¨è¨æµ·æ»©(masasa beach) æ—…è¡Œé¢„ç®—æŒ‡å—]]></title>
    <url>%2F2017%2F07%2F22%2Fmasasa-beach-travel-guide.html</url>
    <content type="text"><![CDATA[å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹äºŒ â€”â€” é©¬è¨è¨æµ·æ»©(masasa beach)é©¬è¨æ²™æ»©å¯ä»¥è¯´æ˜¯ Tingloy æœ€å¥½çš„æµ·æ»©ï¼Œè¿™æ˜¯ Batangas å”¯ä¸€ä¸åœ¨å¤§é™†å•å®‹å²›ä¸Šã€‚å®ƒçš„ä¸»è¦å²›å±¿æ˜¯é±¼å½¢é©¬é‡Œå¡ç­ï¼ˆMaricabanï¼‰ï¼Œä½äºŽ Calumpang åŠå²›çš„ä¸€è§’ï¼Œå°†å·´æ‹‰æ‰¬æ¹¾ï¼ˆBalayan Bayï¼‰ä¸Žå…«æ‰“é›æ¹¾ï¼ˆBatangas Bayï¼‰åˆ†å¼€ã€‚ äº‹å®žæ˜¯ï¼Œè¿™é‡Œçš„æ²™æ»©ä¸åƒä½ åœ¨é•¿æ»©å²›æˆ–å·´æ‹‰æœ›å²›æ‰€æœŸæœ›çš„é‚£æ ·åƒç™½è‰²çç ï¼Œä½†æ˜¯é©¬è¨æ²™æ»©åœ¨ç¼ºä¹äº®åº¦çš„æ²™æ»©ä¸­å±•çŽ°å‡ºæ³¢æµªçš„æ°”æ¯ã€‚å®ƒçš„æ°´æ™¶èˆ¬æ¸…æ¾ˆï¼Œæµ…æ°´æ•£å‘å‡ºç¾Žä¸½çš„ç»¿æ¾çŸ³é—ªå…‰ï¼Œå³ä½¿è¿œè·ç¦»ä¹Ÿèƒ½å¸å¼•æ‚¨çš„æ³¨æ„ã€‚ æ¥è¿™é‡Œä¸»è¦æ˜¯çŽ©æ°´ï¼Œå¦‚æžœä½ å–œæ¬¢æ¸¸æ³³ï¼Œæ¥è¿™é‡Œå§ã€‚æˆ‘æ˜¯åœ¨è¿™å­¦ä¼šç‹—çˆ¬å¼çš„ã€‚å“ˆå“ˆã€‚ã€‚ å…ˆæ¥çœ‹çœ‹ä¸€äº›ç…§ç‰‡ã€‚ å°å²›æ˜¯ä¸€ä¸ªå°é±¼å½¢çŠ¶ï¼Œå¾ˆå¯çˆ± åœ¨ Anilao Port åå…¬å…±èˆ¹åª åˆ°è¾¾ å°é±¼å²› ï¼Œå‡†å¤‡æµ®æ½œï¼Œå°å“¥å¾ˆå–åŠ›ï¼ æ²¡é”™ï¼ŒèžƒèŸ¹èˆ¹å¾ˆå¥½çœ‹ï¼Œä»–ä»¬å–œæ¬¢æ¶‚æˆå„ç§é¢œè‰²ï¼Œè‰ºæœ¯ç»†èƒžä¸é”™ã€‚ä»¥åŠã€‚ã€‚çœŸæ­£è“è‰²çš„å¤§æµ·ï¼Œè€Œä¸æ˜¯ç°è‰²çš„ã€‚ æµ®æ½œåªéœ€100p !!è¶…ä¾¿å®œï¼Œä¸€å®šè¦å°è¯•ä¸€ä¸‹ï¼Œè™½ç„¶åªæ˜¯å¸¦ç€ä½ è½¬ä¸€åœˆï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°å„ç§æµ·é¾Ÿï¼ŒçŠç‘šï¼Œé•¿å¸¦é±¼ç­‰ã€‚æ€ªä¸å¾—å¾ˆå¤šæœ¬åœ°å¤§å­¦ç”Ÿæ¥ï¼ç»æµŽæ¼‚äº®ï¼ä½†æ˜¯æˆ‘æ²¡æœ‰æ‹åˆ°å¥½çš„æµ·åº•ç…§ç‰‡ã€‚ã€‚ æ²™å­ç¡®å®žä¸æ€Žä¹ˆæ ·ï¼Œä½†æ˜¯æ°´è¿˜æ˜¯ä¸é”™ æ°´æ¸…è§åº• å…¨è²Œ å®¶åº­å‡ºè¡Œéžå¸¸å¤š é¦™è•‰èˆ¹ é™„è¿‘æ‘åº„çš„å°å–éƒ¨çš„è€äºº è¿™æ˜¯ä»€ä¹ˆï¼Œè°èƒ½å‘Šè¯‰æˆ‘ å…¶å®žæ¥åˆ°è¿™é‡Œå†æ‰¾ä½å®¿ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºå¾ˆå¤šï¼Œåˆ°å¤„éƒ½æ˜¯ è²è² äº¤é€š bus,åœ¨å…«æ‰“é›å¸‚åŒº Batangas Grand Terminalä¸‹è½¦ï¼ˆ3-4 å°æ—¶ï¼‰ï¼ˆåŒæ ·çš„ï¼ŒåŠå¤œå‡ºå‘ï¼Œæ—©ä¸Šåˆ°è¾¾ï¼Œä¸ç„¶ä¼šå¡žè½¦ï¼‰ åœ¨LRT- Gil Puyat è½¦ç«™æ—è¾¹æœ‰å…¬å…±æ±½è½¦ç«™ï¼ˆDLTB liner æˆ– JAM linerï¼‰ã€‚ï¼ˆæ³¨æ„ï¼Œè¶Šæ—©è¶Šå¥½ã€‚å¦‚æžœæ‚¨é€‰æ‹©ä¸€è¾†å¸¦æœ‰ CALABARZON æ ‡å¿—çš„å…¬å…±æ±½è½¦ï¼Œæ—…è¡Œæ—¶é—´å°†ä¼šæ›´çŸ­ï¼‰P120-P180ã€‚ è½¬å‰æ™®å°¼ï¼ˆ1å°æ—¶ï¼‰ 40 minutes. Fare: PhP 37. ç»ˆç‚¹ç«™æ˜¯ Mabini Multi-purpose port.ï¼ˆåˆå Anilao Portï¼‰(åœ¨habagat seasonå­£èŠ‚ï¼Œç»ˆç‚¹ç«™æ˜¯ Talaga Port ) a. åœ¨ Anilao Port åèˆ¹(æŽ¨è)ï¼ˆ45minï¼‰ å¦‚æžœè¦åœ¨å²›ä¸Šä½ä¸€æ™šï¼Œå°±é€‰æ‹©å…¬å…±èˆ¹åªï¼Œæœ€ä¾¿å®œï¼ŒP80ã€‚æ—…è¡Œæ—¶é—´ï¼š45åˆ†é’Ÿ - 1å°æ—¶ã€‚ ç›´æŽ¥åèˆ¹åˆ° masasa beachã€‚ä½†æ˜¯ç›´è¾¾çš„èˆ¹æ›´å°‘ï¼Œä¸å¯é¢„æµ‹ï¼ŒP100 ï¼ˆæ³¨æ„ï¼Œæœ€åŽä¸€è‰˜è¿”å›ž Anilaoçš„èˆ¹æ˜¯ä¸Šåˆä¹ç‚¹ï¼Œæ‰€ä»¥ä¸å¾—ä¸ä½ä¸€æ™š,æœ‰äº›èˆ¹åœ¨è¾ƒå°çš„ç å¤´åœ¨ä¸­åˆ12ç‚¹å¯ä»¥æŽ¥ä¹˜å®¢å›ž,å…·ä½“å¯ä»¥å’¨è¯¢å½“åœ°äººä¸Šèˆ¹åœ°ç‚¹ï¼‰ b. å¦‚æžœæ˜¯ä¸€æ—¥æ¸¸ï¼Œç§Ÿèˆ¹P4500ï¼Œå¯å10äººï¼Œå¯ä»¥è®²ä»·ã€‚å¦‚æžœç§Ÿèˆ¹ï¼Œå¯ä»¥è¦æ±‚ä¸­é€”ç™»é™† Sombreroå²›ï¼Œä¸Šå²›è´¹ P200ï¼Œæœ‰äº›è¦P500.ï¼ˆç®—æ˜¯è·³å²›æ¸¸ï¼Œæ¯”è¾ƒè´µï¼‰ ä½å®¿æˆ‘å½“æ—¶æ˜¯åœ¨ facebook ä¸Šæœç´¢ masasa ç„¶åŽè”ç³»çš„ä½å®¿ï¼ŒP300 æ¯äººï¼æ²¡æœ‰é…’åº—ã€‚å…¶å®žé‚£é‡Œæ—è¾¹æœ‰æ‘å­ï¼Œæœ‰å¾ˆå¤šè¿‡å¤œçš„åœ°æ–¹ã€‚ä»¥å‰å¯ä»¥åœ¨æ²™æ»©éœ²è¥è¿‡å¤œï¼Œä½†åŽæ¥ä¸å…è®¸äº†ã€‚ å…¶ä»–é¡¹ç›® çŽ¯å²›æ¸¸ï¼š æ ‡å‡†è´¹çŽ‡ï¼šP1500ï¼Œå²›ä¸Šå¯ä»¥è”ç³»å½“åœ°èˆ¹åªã€‚ æµ®æ½œï¼šP100 !!æˆ‘æ˜¯å½“æ—¶ä½å®¿çš„äººå¸®æˆ‘å®‰æŽ’è”ç³»çš„ï¼Œ30min,æ—¶é—´ä¸é•¿ è´¹ç”¨æ¸…å• åˆ°å…«æ‰“é›çš„ç¥¨ä»·è½¦ç¥¨ï¼šç¥¨ä»·ï¼šP157 ä»ŽLRT-Buendia å‡ºå‘ï¼ŒP127 ä»Žé˜¿æ‹‰é‚¦å‡ºå‘ã€‚ å‰éš†å°¼åˆ°é˜¿å°¼æ´›çš„å‰æ™®å°¼ç¥¨ä»·ï¼šP37 ä»ŽAnilaoå‡ºå‘çš„å°èˆ¹å‡ºç§Ÿï¼ˆå²›å±¿æ¸¸è§ˆï¼‰ï¼šæ¯èˆ¹P4500ï¼ˆæœ€å¤§10äººï¼‰Masasa æµ·æ»©çš„å°èˆ¹å‡ºç§Ÿï¼ˆå²›å±¿æ¸¸è§ˆï¼‰ï¼šæ¯èˆ¹P1500ï¼ˆ3paxæœ€å¤§ï¼‰ å…¬å…±å°èˆ¹åˆ° Tingloyï¼šP80ï¼ˆæŽ¨èï¼‰ ä¸‰è½®è½¦åˆ°é©¬è¨æ²™æ»©ï¼šP120/è¾† çŽ¯å¢ƒè´¹ï¼šP30 é©¬è¨æ²™æ»©ï¼šå…è´¹ Sombrero Island ä¸Šå²›è´¹ï¼šP200 ç§Ÿå¸ç¯· P200 æ³¨æ„äº‹é¡¹ masasa beachåªæœ‰ä¸€ä¸ªæ´—æ‰‹é—´ï¼Œæ”¶è´¹ï¼ŒP10 æ¯æ¬¡ï¼› è¿‡å¤œå¯èƒ½æ²¡æœ‰ç”µï¼Œå¸¦å¥½å……ç”µå®ï¼› çœ‹å¥½å¤©æ°”ï¼Œæ™´å¤©æ¯”é˜´å¤©æ›´æ¼‚äº®ï¼Œæ°´æ›´æ¸…ï¼›]]></content>
      <categories>
        <category>travel</category>
      </categories>
      <tags>
        <tag>travel</tag>
        <tag>philippine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Borawan islandã€Pagbilao Beach å’Œ Dampalitan islandæ—…è¡Œé¢„ç®—æŒ‡å—â€”â€”ä¸€ä¸ªå‘¨æœ«ä¸‰ä¸ªæ²™æ»©]]></title>
    <url>%2F2017%2F07%2F22%2Fborawan-island-Pagbilao-beach-and-Dampalitan-island.html</url>
    <content type="text"><![CDATA[ä¸€ä¸ªå­©å­çš„å†’é™©æ•…äº‹ â€”â€”â€”â€”è®²æ•…äº‹çš„äºº å‡æœŸæ—…è¡Œä¹‹è²å¾‹å®¾ç³»åˆ—ä¹‹ä¸€ â€”â€”â€”â€” Borawanå²›ã€Pagbilaoå²›ã€Dampalitanå²›åè½åœ¨å¥Žæ¾å—éƒ¨çš„è¾¹ç¼˜ï¼Œå¸ƒå°”æˆˆæ–¯ï¼ˆPadre Burgosï¼‰å’Œå¸•æ ¼æ¯”æ´›ï¼ˆPagbilaoï¼‰çš„åŸŽé•‡é¢å‘æ³°å·´å·´æ–¯æ¹¾ï¼ˆTayabas Bayï¼‰ï¼Œè¿™æ˜¯åˆ†ç¦»å¤§é™†å•å®‹å²›å’Œé©¬æž—æœå…‹å²›ï¼ˆMarinduqueï¼‰çš„é€šé“ã€‚é©¬å°¼æ‹‰å¸‚åŒºçš„è¿™ä¸€è¾¹åªæœ‰å››åˆ°äº”ä¸ªå°æ—¶çš„è·¯ç¨‹ï¼Œç”šè‡³è¿œè¿œè¿‘äºŽ Pangasinanå’Œç¢§ç‘¶ï¼ˆBaguioï¼‰ã€‚ è¿™æ˜¯Puting Buhanginï¼ŒPagbilaoï¼ˆä¹Ÿå«Kuwebang Lampasï¼‰æœ€æŽ¨èï¼Œè¯·åœ¨è¿™é‡Œè§„åˆ’æœ€é•¿çš„æ—¶é—´ Borawanï¼ŒèƒŒé å±±ï¼Œæ˜¯å¦ä¸€ç§é£Žæ™¯ï¼Œå’Œå²©çŸ³æ‹ç…§ç‰¹åˆ«å¥½çœ‹ã€‚è¿™æ˜¯ Borawan çš„æ—¥è½ã€‚ æ°´é¢å¾ˆå¹³é™ï¼Œæ²¡æœ‰æµªï¼Œå¾ˆé€‚åˆæ¸¸æ³³ Dampalitanï¼Œ æ°´å¾ˆæ¸…ï¼ å¤©æ°”å¾ˆå¥½ï¼ å…¬å…±äº¤é€šå¦‚ä½•åˆ°è¾¾ å…¬å…±æ±½è½¦ç«™ï¼šJAM liner, DLTB liner, JAC liner. ä½äºŽ Taft Ave. ä¹˜å…¬å…±æ±½è½¦åˆ°å¢å¡žçº³å¸‚ï¼ˆLucenaï¼‰ã€‚é©¬å°¼æ‹‰å¤§éƒ½ä¼šæœ‰è®¸å¤šç»ˆç‚¹ç«™åˆ°å¢å¡žçº³ã€‚ç¥¨ä»·ä»‹äºŽP250-260ä¹‹é—´ã€‚æ—…è¡Œæ—¶é—´ï¼š3-4å°æ—¶ã€‚ åœ¨å¢å¡žçº³ç«™ä¸‹è½¦ï¼ˆLucena Grand Terminalï¼‰ã€‚ a. ä»Žç»ˆç‚¹ç«™ä¹˜åå¦ä¸€è¾†å·´å£«åˆ° Unisanã€‚å…¬å…±æ±½è½¦æ²¡æœ‰ç©ºè°ƒï¼Œç¥¨ä»·åœ¨P35-40å·¦å³ã€‚æ—…è¡Œæ—¶é—´ï¼š1ä¸ªåŠå°æ—¶ã€‚ b. ä¹Ÿæœ‰å°é¢åŒ…è½¦ ï¼ˆVansï¼‰ï¼Œæœ‰æ‹›å®¢ç‰Œå†™ç€ Unisanï¼Œè¯´åŽ» QCRB Bank ä¸‹è½¦ï¼Œå¤§æ¦‚ 60p æ¯äºº åœ¨QCRBé“¶è¡Œï¼ˆPadre Burgosï¼‰ä¸‹è½¦ï¼Œæˆ–è€… æå‰å‘Šè¯‰å¸æœºè®©ä½ è¿™é‡Œä¸‹è½¦ã€‚ ä¹˜åä¸‰è½®è½¦åˆ° Aplayaã€‚å‘Šè¯‰å¸æœºä½ æ‰“ç®—åŽ»Borawanï¼Œ åªéœ€ 20pã€‚ åœ¨ Aplaya æœ‰å°èˆ¹å‡ºç§Ÿã€‚è¿™äº›èˆ¹åªå¯ä»¥å¸¦æ‚¨å‰å¾€ Puting Buhanginï¼ˆPagbilaoï¼‰ï¼ŒDampalitanå²›å’ŒBorawanå²›çš„ä¸€ä¸ªå²›å±¿æ¸¸è§ˆã€‚P1500 - P2000ï¼Œé€‚åˆ10äººä»¥ä¸‹ã€‚ è¡Œç¨‹å‚è€ƒæ—¶é—´è¡¨åŠå¤œå‡ºå‘æ˜¯æœ€åˆé€‚çš„ï¼Œæ—©ä¸Šå°±åˆ°ã€‚å¦‚æžœæ—©ä¸Šå‡ºå‘ï¼Œä½ ä¼šåœ¨è·¯ä¸Šå¡žè½¦å¹¶æµªè´¹ä¸€æ•´å¤©ã€‚ä¸è¦æŠŠç™½å¤©çŽ©çš„æ—¶é—´æµªè´¹åœ¨è½¦ä¸Šã€‚ 2:00 - Buendia Bus Terminal(DLTB liner or JAM liner)åè½¦ (P227-P250, 4h)ã€å‡Œæ™¨ä¸¤ç‚¹å‡ºå‘ï¼Œæ—©ä¸Šå…­ç‚¹åˆ°ã€‘ ç›®çš„åœ°ï¼šLucena Grand Terminal 6:00 - Lucena Grand Terminalæ¢ä¹˜åŽ» Unisan çš„å…¬äº¤busï¼ˆP35 - P40ï¼‰ã€1.5h, é¢„è®¡ä¸ƒç‚¹åŠåˆ°ã€‘ 7:00 - åœ¨ QCRB BANKä¸‹è½¦ã€‚æ¢tricycleä¸‰è½®è½¦ï¼ˆ10minï¼‰ï¼ŒåŽ»Aplaya (å’Œå¸æœºè¯´è¦åŽ» Borawan) åœ¨Aplayaç§Ÿèˆ¹ 8:00 å‡ºå‘ã€‚ æ³¨æ„äº‹é¡¹è¯¥åœ°åŒºæœ‰æ°´æ¯ï¼ˆjerryfishï¼‰ï¼Œè¯·ä¸€å®šæ³¨æ„ï¼ŒBorawanæ²™æ»©å°¤å…¶å¤šï¼Œæ‰€ä»¥å»ºäº†æ°´ç½‘åŒºåŸŸæ¸¸æ³³ï¼Œä¸è¦åœ¨éžå®‰å…¨åŒºåŸŸæ¸¸æ³³ã€‚è¢«æ°´æ¯è›°äº†ä¹Ÿä¸è¦æƒŠæ…Œï¼Œæå‰äº†è§£å¤„ç†æ–¹æ³•ï¼Œä½¿ç”¨ç¢±æ€§æº¶æ¶²ï¼ˆå¦‚è‚¥çš‚æ°´ç­‰ï¼‰æ¸…æ´—ã€‚Pagbilaoå²›ã€Dampalitanå²›æ¯”è¾ƒå®‰å…¨ï¼Œä¸‹æ°´å‰å¯ä»¥è¯¢é—®å²›ä¸Šå·¥ä½œäººå‘˜èƒ½å¦ä¸‹æ°´ï¼Œæˆ–ä¸Žå…¶ä»–äººä¸€åŒä¸‹æ°´ï¼Œå‹¿å•ç‹¬æ¸¸æ³³ã€‚ éœ²è¥æˆ–é…’åº—æˆ–ç§Ÿèˆ¹Borawan å’Œ Dampalitan Islands æ²¡æœ‰åº¦å‡æ‘æˆ–é…’åº—ï¼Œä½†å…è®¸éœ²è¥è¿‡å¤œã€‚å¦‚æžœä½ ä¸æ˜¯é‡Žè¥çš„ç±»åž‹ï¼Œé‚£ä¹ˆå¤§é™†æœ‰å‡ ä¸ªåº¦å‡æ‘ï¼Œä½ å¯ä»¥é€‰æ‹©ç•™ä¸‹æ¥ã€‚ä»¥ä¸‹æ˜¯æˆ‘æ”¶é›†çš„ç®€çŸ­åˆ—è¡¨ï¼š Silangang Nayoné¤åŽ…å’Œåº¦å‡æ‘ã€‚ä½äºŽPagbilaoï¼Œå®ƒæ˜¯Bicolç»‘å®šçš„è·¯é€”è·‹æ¶‰è€…ä¹‹é—´çš„å…±åŒç‚¹ï¼Œä»–ä»¬æ¸´æœ›å“å°åˆ°ä»–ä»¬ç¾Žå‘³çš„Pinoyæµ·é²œèœè‚´ã€‚ä»–ä»¬åªæœ‰å°‘é‡çš„æˆ¿é—´ï¼Œæ‰€ä»¥å¦‚æžœä½ è¦åœ¨æ—ºå­£ï¼Œæå‰é¢„è®¢ã€‚è”ç³»ç”µè¯ï¼šï¼ˆ042ï¼‰7160077ï¼Œ0922 8867677 ä½†ï¼Œå¦‚æžœä½ è®¤ä¸ºä½ æ˜¯ä¸€ä¸ªé‡Žè¥æ—…è¡Œï¼Œä¸ºä»€ä¹ˆä¸éœ²è¥å‘¢ï¼Ÿéœ²è¥ä¸ä»…é™ä½Žäº†æˆæœ¬ï¼Œè¿˜ä½¿æ‚¨æ›´å¥½åœ°æ¬£èµå²›å±¿ï¼Œä»Žè€Œä½¿æ‚¨æ›´æŽ¥è¿‘è‡ªç„¶ã€‚æ‰€æœ‰ä½ éœ€è¦çš„æ˜¯ä¸€ä¸ªå¸ç¯·å’Œä¸€äº›æ˜“äºŽå‡†å¤‡çš„é£Ÿå“ã€‚å¦‚æžœæœ‰å†²æ³¡é£Ÿå“ï¼Œæ²™æ»©å°å–éƒ¨æœ‰çƒ­æ°´å‡ºå”®ï¼Œ20pã€‚ ç§Ÿèˆ¹ï¼ˆå®Œå…¨å¯ä»¥åŽ»åˆ°å†ç§Ÿï¼Œå¦‚æžœä¸æ”¾å¿ƒï¼Œå¯ä»¥æå‰è¯¢é—®ï¼‰ï¼š 09501928546ï¼Œ09094819703 å¤§éƒ¨åˆ†äººä¼šåœ¨ Borawan æ²™æ»© å’Œ Pagbilao æ²™æ»©è¿‡å¤œï¼Œè¿™ä¸¤ä¸ªåœ°æ–¹æœ‰å†²å‡‰æˆ¿å’Œå…¬åŽ•ï¼Œå…è´¹ä½¿ç”¨ã€‚æˆ‘å»ºè®®åœ¨ Puthang Buhangin, Pagbilao è¿‡å¤œï¼Œé‚£é‡Œæ°´æœ€æ¸…ã€‚ å¤‡ç”¨ç‰©å“æç¤º åŒ–å¦†å“å’Œé˜²æ™’éœœ - é€šå¸¸ã€‚åœ¨å²›ä¸Šæœ‰å•†åº—ï¼Œä½†é¢„è®¡ä»·æ ¼æœ‰ç‚¹è¿‡é«˜ï¼Œæ‰€ä»¥æ›´å¥½åœ°å¸¦ä¸Šæ´—å‘æ°´ï¼Œè‚¥çš‚ï¼Œç‰™è†ï¼Œå«ç”Ÿçº¸å’Œæ¹¿å·¾ã€‚Dampalitan å²›ä¸Šæœ‰å…¬åŽ•ï¼Œä½†æ°´æœ‰ç‚¹ç¨€å°‘ã€‚ é˜²èšŠæ´—å‰‚ - å¾ˆå¤šäººä¼šå¿˜è®°å¸¦æ¥ã€‚å²›ä¸Šæœ‰èšŠå­ã€‚ æ‰‹ç”µç­’ - é‚£é‡Œå¶å°”ä¼šåœç”µ æ‰“ç«æœºå’Œå¾ˆå¤šæ•…äº‹ - ä½ ä¼šè¢«è¯±æƒ‘å¼€å§‹ç¯ç«ï¼Œä½ å°†éœ€è¦æ‰“ç«æœºç‚¹ç«å’Œå¯¹è¯ï¼Œä»¥ä¿æŒç‡ƒçƒ§ã€‚ æ€¥æ•‘åŒ… - ä½ æ°¸è¿œä¸ä¼šçŸ¥é“æ„å¤–ä»€ä¹ˆæ—¶å€™å‘ç”Ÿã€‚ æµ®æ½œè£…ç½® - æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°æ´»çŠç‘šï¼Œä½†æœ‰å¾ˆå¤šé±¼ã€‚ç‰¹åˆ«æ˜¯åœ¨ Dampalitanå’ŒPagbilaoï¼Œè¿™ä¸¤ä¸ªæ²™æ»©æ°´æ›´æ¸…ã€‚ é˜²æ°´ç›¸æœº - Kuwebang Lampasï¼ˆåœ¨Puthang Buhangin, Pagbilaoï¼‰æ˜¯éžå¸¸æ£’çš„ï¼Œä½†åŽ»é‚£é‡Œçš„æ°´å¾ˆæ·±ã€‚å¦‚æžœæ‚¨æƒ³è¦åœ¨æ´žç©´å†…çš„å›¾ç‰‡ï¼Œé˜²æ°´ç›¸æœºéžå¸¸æœ‰ç”¨ã€‚ é¢„ç®—è¯¦ç»†æ¡ç›®ä»¥ä¸‹æ˜¯æ‚¨æœŸæœ›çš„è´¹ç”¨å’Œå…¶ä»–è´¹ç”¨æ¸…å•ã€‚ ä¹˜èˆ¹æ¸¸è§ˆè´¹ï¼ˆ8äººä¹˜è½¦ï¼‰ï¼š P800 - Borawanæµ·æ»©ï¼ˆå¾€è¿”ï¼‰ P1800 - Borawan + Dampalitan + Puting Buhanginï¼ˆä¸‰å²›ä¸¤å¤©ä¸€å¤œï¼Œè¿™æ˜¯æ€»èˆ¹è´¹ï¼Œä¸æ˜¯æ¯æ¬¡ï¼‰ Borawanæµ·æ»© ä¸Šå²›è´¹ï¼šP80 å¸ç¯·ç§Ÿé‡‘ï¼šP500(ä¹°ä¸€ä¸ªå¸ç¯·åŽ»æœ€å¥½ï¼Œä¾¿å®œçš„æ‰1000på·¦å³ï¼Œè¿˜èƒ½å¸¦å›žåŽ») å°å±‹å‡ºç§Ÿï¼šP700-P850 è¿‡å¤œè´¹ï¼š P220æ¯äºº å¸ç¯·å åœ°è´¹ç”¨ï¼šP200-P250(åˆ†å åœ°å¤§å°) Puting Buhanginï¼ŒPagbilao ä¸Šå²›è´¹ï¼šP80 å¸ç¯·å‡ºç§Ÿï¼šP300-400 Dampalitan å²› ä¸Šå²›è´¹ï¼šP80 å¸ç¯·å åœ°è´¹ï¼šP100 å°å±‹å‡ºç§Ÿï¼šP850-P1000 æ°´ï¼šP40/5Lï¼ŒP400/å¤§æ¡¶ ä»¥ä¸Šè´¹ç”¨å¯èƒ½ä¼šæ¶¨ä»·ï¼Œä½†ä¸ä¼šåç¦»å¤ªå¤šã€‚æœ€é‡è¦æ˜¯å¸¦å¥½é£Ÿç‰©å’Œé¥®ç”¨æ°´ã€‚è¿‡å¤œè¯·æ‹¿å¥½ç¥¨æ®ï¼Œä»¥å…å…¶ä»–å‘˜å·¥å†æ¬¡æ¥æ”¶é’±ã€‚ ä¸€èˆ¬é¡ºåºï¼š æŽ¨èï¼šBorawanï¼ˆ9ï¼š00-åˆé¤ï¼‰ ==> Puting buhanginï¼ˆ14ï¼š00-è¿‡å¤œï¼‰ ===> Dampalitan (10ï¼š00 - 14:00å›žç¨‹) Puting buhanginï¼ˆ9ï¼š00ï¼‰ ==> Dampalitanï¼ˆ11ï¼š30-åˆé¤ï¼‰ ===> Borawan (14ï¼š00 - è¿‡å¤œ) Puting buhanginï¼ˆ9ï¼š00-åˆé¤ï¼‰===> Borawanï¼ˆ14ï¼š00-è¿‡å¤œï¼‰===> Dampalitan(10:00- 14:00å›žç¨‹)]]></content>
      <categories>
        <category>travel</category>
      </categories>
      <tags>
        <tag>travel</tag>
        <tag>philippine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é«˜æ€§èƒ½ reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·]]></title>
    <url>%2F2017%2F07%2F18%2Fmake-react-fast-again-tools-and-techniques-for-speeding-up-your-react-app.html</url>
    <content type="text"><![CDATA[é«˜æ€§èƒ½ reactï¼š3ç§åŠ å¿«åº”ç”¨ç¨‹åºçš„æ–°å·¥å…·react é€šå¸¸å¾ˆå¿«ï¼Œä½†å¾ˆå®¹æ˜“é€ æˆå¯¼è‡´æ€§èƒ½é—®é¢˜çš„å°é”™è¯¯ã€‚ç¼“æ…¢çš„ç»„ä»¶å®‰è£…ï¼Œæ·±å±‚ç»„ä»¶æ ‘å’Œä¸å¿…è¦çš„æ¸²æŸ“å¾ªçŽ¯å¯ä»¥å¿«é€Ÿæ·»åŠ åˆ°ä¸€ä¸ªæ„Ÿè§‰ç¼“æ…¢çš„åº”ç”¨ç¨‹åºã€‚ å¹¸è¿çš„æ˜¯ï¼Œæœ‰å¾ˆå¤šå·¥å…·ï¼Œæœ‰äº›ç”šè‡³å†…ç½®äºŽ Reactï¼Œè¿™æœ‰åŠ©äºŽè¯Šæ–­æ€§èƒ½é—®é¢˜ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å¼ºè°ƒä½¿ React åº”ç”¨ç¨‹åºæ›´å¿«é€Ÿçš„å·¥å…·å’ŒæŠ€æœ¯ã€‚æ¯ä¸ªéƒ¨åˆ†è¿˜æœ‰ä¸€ä¸ªäº’åŠ¨ï¼Œï¼ˆå¸Œæœ›ï¼‰æœ‰è¶£çš„æ¼”ç¤ºï¼ å·¥å…·ï¼ƒ1ï¼šæ€§èƒ½æ—¶é—´è¡¨React 15.4.0å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ€§èƒ½æ—¶é—´è½´åŠŸèƒ½ï¼Œå¯è®©æ‚¨å‡†ç¡®äº†è§£ç»„ä»¶çš„æŒ‚è½½ï¼Œæ›´æ–°å’Œå¸è½½ã€‚å®ƒè¿˜å¯ä»¥è®©æ‚¨å¯è§†åŒ–ç›¸å…³çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€‚ æ³¨æ„ï¼šçŽ°åœ¨ï¼Œæ­¤åŠŸèƒ½ä»…é€‚ç”¨äºŽChromeï¼ŒEdgeå’ŒIEï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†å°šæœªåœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­å®žçŽ°çš„ç”¨æˆ·æ—¶é—´è½´APIï¼ˆUser Timing APIï¼‰ã€‚ æ€Žä¹ˆè¿è¡Œçš„ æ‰“å¼€ä½ çš„åº”ç”¨ç¨‹åºå¹¶é™„åŠ æŸ¥è¯¢å‚æ•°ï¼šreact_perfã€‚ä¾‹å¦‚ï¼Œhttp://localhost:3000?react_perf æ‰“å¼€Chrome DevTools æ€§èƒ½é€‰é¡¹å¡ï¼Œç„¶åŽæŒ‰ è®°å½•ï¼ˆRecordï¼‰ã€‚ æ‰§è¡Œæ‚¨è¦åˆ†æžçš„æ“ä½œã€‚ åœæ­¢è®°å½• åœ¨ User Timing ä¸‹æ£€æŸ¥å¯è§†åŒ–ã€‚ äº†è§£è¾“å‡ºæ¯ä¸ªå½©è‰²æ¡æ˜¾ç¤ºç»„ä»¶æ­£åœ¨åšâ€œå·¥ä½œâ€çš„æ—¶é—´ã€‚ç”±äºŽJavaScriptæ˜¯å•çº¿ç¨‹çš„ï¼Œæ¯å½“ç»„ä»¶æ­£åœ¨åŠ è½½æˆ–å‘ˆçŽ°æ—¶ï¼Œå®ƒä¼šé˜»æ­¢ä¸»çº¿ç¨‹ï¼Œå¹¶é˜»æ­¢å…¶ä»–ä»£ç è¿è¡Œã€‚ æ–¹æ‹¬å·ä¸­çš„æ–‡å­—[update]æè¿°äº†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„å“ªä¸ªéƒ¨åˆ†æ­£åœ¨å‘ç”Ÿã€‚æ—¶é—´è½´ä¼šåˆ†è§£æ¯ä¸ªæ­¥éª¤ï¼Œå› æ­¤æ‚¨å¯ä»¥åœ¨[componentDidMount] [componentWillReceiveProps] [ctor]ï¼ˆæž„é€ å‡½æ•°ï¼‰å’Œ [render] æ–¹æ³•ä¸Šçœ‹åˆ°ç»†ç²’åº¦çš„æ—¶åº. å †å çš„æ¡è¡¨ç¤ºç»„ä»¶æ ‘ã€‚è™½ç„¶åœ¨Reactä¸­å…·æœ‰ç›¸å½“æ·±çš„ç»„ä»¶æ ‘æ˜¯å…¸åž‹çš„ï¼Œä½†å¦‚æžœè¦ä¼˜åŒ–ç»å¸¸å®‰è£…çš„ç»„ä»¶ï¼Œåˆ™å¯ä»¥å¸®åŠ©å‡å°‘å°è£…ç»„ä»¶çš„æ•°é‡ï¼Œå› ä¸ºæ¯ä¸ªç»„ä»¶éƒ½ä¼šå¢žåŠ å°çš„æ€§èƒ½å’Œå†…å­˜æŸå¤±ã€‚ è¿™é‡Œæœ‰ä¸€ç‚¹å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ—¶é—´è¡¨ä¸­çš„æ—¶é—´åºåˆ—æ˜¯ç”¨äºŽå¼€å‘æž„å»ºReactçš„ï¼Œå®ƒæ¯”ç”Ÿäº§çŽ¯å¢ƒæ›´æ…¢ã€‚äº‹å®žä¸Šï¼Œç”šè‡³æ€§èƒ½æ—¶é—´è¡¨æœ¬èº«ä¼šå‡æ…¢æ‚¨çš„åº”ç”¨ç¨‹åºã€‚è™½ç„¶è¿™äº›æ•°å­—ä¸åº”è¯¥è¢«è®¤ä¸ºæ˜¯çœŸå®žè¡¨çŽ°çš„æ€§èƒ½ï¼Œä½†æ˜¯ä¸åŒç»„ä»¶ä¹‹é—´çš„ç›¸å¯¹å®šæ—¶æ˜¯å‡†ç¡®çš„ã€‚æ­¤å¤–ï¼Œç»„ä»¶æ˜¯å¦æ›´æ–°å®Œå…¨ä¸ä¾èµ–äºŽç”Ÿäº§çŽ¯å¢ƒä¸Šçš„æž„å»ºã€‚ æ¼”ç¤ºï¼ƒ1ä¸ºäº†ä¹è¶£ï¼Œæˆ‘æ“çºµäº†TodoMVCåº”ç”¨ç¨‹åºï¼Œå‡ºçŽ°ä¸€äº›ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œè¯•è¯•çœ‹ã€‚ è¦æŸ¥çœ‹æ—¶é—´è½´ï¼Œè¯·æ‰“å¼€Chromeå¼€å‘å·¥å…·ï¼Œè½¬åˆ°â€œæ€§èƒ½â€é€‰é¡¹å¡ï¼Œç„¶åŽå•å‡»è®°å½•ã€‚ç„¶åŽåœ¨åº”ç”¨ç¨‹åºä¸­æ·»åŠ ä¸€äº›TODOï¼Œåœæ­¢å½•åˆ¶å¹¶æ£€æŸ¥æ—¶é—´è½´ã€‚çœ‹çœ‹æ˜¯å¦å¯ä»¥å‘çŽ°å“ªäº›ç»„ä»¶å¯¼è‡´æ€§èƒ½é—®é¢˜:) å·¥å…·ï¼ƒ2ï¼šä¸ºä»€ä¹ˆæ›´æ–°å½±å“ React ä¸­æ€§èƒ½çš„æœ€å¸¸è§é—®é¢˜ä¹‹ä¸€æ˜¯ä¸å¿…è¦çš„æ¸²æŸ“å¾ªçŽ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå³ä½¿ä»–ä»¬çš„ props æ²¡æœ‰æ”¹å˜ï¼ŒReact ç»„ä»¶å°†åœ¨çˆ¶çº§ render æ—¶é‡æ–° renderã€‚ ä¾‹å¦‚ï¼Œå¦‚æžœæˆ‘æœ‰ä¸€ä¸ªè¿™æ ·çš„ç®€å•ç»„ä»¶ï¼š class DumbComponent extends Component { render() { return &lt;div> {this.props.value} &lt;/div>; } } åŠ ä¸Šçˆ¶ç»„ä»¶: class Parent extends Component { render() { return &lt;div> &lt;DumbComponent value={3} /> &lt;/div>; } } æ— è®ºä½•æ—¶çˆ¶ç»„ä»¶ renderï¼ŒDumbComponent éƒ½ä¼šé‡æ–° renderï¼Œå°½ç®¡å…¶ props æ²¡æœ‰æ”¹å˜ã€‚ é€šå¸¸ï¼Œå¦‚æžœ render è¿è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰å¯¹è™šæ‹ŸDOMè¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªæµªè´¹çš„æ¸²æŸ“å¾ªçŽ¯ï¼Œå› ä¸ºè¯¥ render æ–¹æ³•åº”è¯¥æ˜¯çº¯çš„ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚åœ¨å¤§è§„æ¨¡çš„ React åº”ç”¨ç¨‹åºä¸­ï¼Œæ£€æµ‹å‘ç”Ÿè¿™ç§æƒ…å†µçš„åœ°æ–¹å¯èƒ½å¾ˆæ£˜æ‰‹ï¼Œä½†å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªå¯ä»¥å¸®åŠ©çš„å·¥å…·ï¼ ä½¿ç”¨ why-did-you-update why-did-you-update æ˜¯ä¸€ä¸ªæŒ‚æŽ¥åˆ° React çš„åº“ï¼Œå¹¶æ£€æµ‹æ½œåœ¨çš„ä¸å¿…è¦çš„ç»„ä»¶æ¸²æŸ“ã€‚å®ƒæ£€æµ‹ç»„ä»¶çš„renderæ–¹æ³•ä½•æ—¶è¢«è°ƒç”¨ï¼Œå°½ç®¡å®ƒçš„ props æ²¡æœ‰æ”¹å˜ã€‚ å»ºç«‹å®‰è£… npmï¼š npm i --save-dev why-did-you-update åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹æ·»åŠ æ­¤ä»£ç æ®µï¼š import React from 'react' if (process.env.NODE_ENV !== 'production') { const {whyDidYouUpdate} = require('why-did-you-update') whyDidYouUpdate(React) } è¯·æ³¨æ„ï¼Œæ­¤å·¥å…·åœ¨æœ¬åœ°å¼€å‘ä¸­éžå¸¸å‡ºè‰²ï¼Œä½†ç¡®ä¿åœ¨ç”Ÿäº§ä¸­å·²è¢«ç¦ç”¨ï¼Œå› ä¸ºå®ƒä¼šå‡æ…¢æ‚¨çš„åº”ç”¨ç¨‹åºã€‚ äº†è§£è¾“å‡ºwhy-did-you-update ç›‘è§†æ‚¨çš„åº”ç”¨ç¨‹åºè¿è¡Œå¹¶è®°å½•å¯èƒ½ä¼šä¸å¿…è¦åœ°æ›´æ”¹çš„ç»„ä»¶ã€‚å®ƒå…è®¸æ‚¨åœ¨æ¸²æŸ“å¾ªçŽ¯ä¹‹å‰å’Œä¹‹åŽçœ‹åˆ° propsï¼Œç¡®å®šå®ƒå¯èƒ½æ˜¯ä¸å¿…è¦çš„ã€‚ æ¼”ç¤ºï¼ƒ2ä¸ºäº†æ¼”ç¤ºwhy-did-you-updateï¼Œæˆ‘å°†åº“å®‰è£…åœ¨ TodoMVC åº”ç”¨ç¨‹åºçš„ Code Sandbox ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨çº¿ React æ¸¸æˆåœºã€‚æ‰“å¼€æµè§ˆå™¨æŽ§åˆ¶å°å¹¶æ·»åŠ ä¸€äº› TODO ä»¥æŸ¥çœ‹è¾“å‡ºã€‚ è¿™æ˜¯æ¼”ç¤º è¯·æ³¨æ„ï¼Œåº”ç”¨ç¨‹åºä¸­çš„å‡ ä¸ªç»„ä»¶ä¸å¿…è¦åœ° renderã€‚å°è¯•å®žçŽ°ä¸Šè¿°æŠ€æœ¯æ¥é˜²æ­¢ä¸å¿…è¦çš„æ¸²æŸ“ã€‚å¦‚æžœæ­£ç¡®å®Œæˆï¼Œåˆ™why-did-you-updateæŽ§åˆ¶å°ä¸­ä¸åº”æœ‰è¾“å‡ºã€‚ å·¥å…·ï¼ƒ3ï¼šååº”å¼€å‘å·¥å…· React å¼€å‘è€…å·¥å…· Chrome æ‰©å±•ç¨‹åºå…·æœ‰å¯è§†åŒ–ç»„ä»¶æ›´æ–°çš„å†…ç½®åŠŸèƒ½ã€‚è¿™æœ‰åŠ©äºŽæ£€æµ‹ä¸å¿…è¦çš„æ¸²æŸ“å¾ªçŽ¯ã€‚è¦ä½¿ç”¨å®ƒï¼Œé¦–å…ˆè¯·ç¡®ä¿åœ¨æ­¤å¤„å®‰è£…æ‰©å±•ã€‚ ç„¶åŽï¼Œç‚¹å‡»Chrome DevToolsä¸­çš„â€œReactâ€æ ‡ç­¾æ‰“å¼€æ‰©å±•ç¨‹åºï¼Œç„¶åŽé€‰ä¸­â€œHighlight Updatesâ€ã€‚ ç„¶åŽï¼Œåªéœ€ä½¿ç”¨ä½ çš„åº”ç”¨ç¨‹åºã€‚ä¸Žå„ç§ç»„ä»¶äº¤äº’ï¼Œå¹¶è§‚çœ‹ DevTools å·¥ä½œçš„é­”åŠ›ã€‚ äº†è§£è¾“å‡ºâ€œreact å¼€å‘äººå‘˜å·¥å…·â€çªå‡ºæ˜¾ç¤ºåœ¨ç»™å®šæ—¶é—´ç‚¹é‡æ–°å‘ˆçŽ°çš„ç»„ä»¶ã€‚æ ¹æ®æ›´æ–°çš„é¢‘çŽ‡ï¼Œä½¿ç”¨ä¸åŒçš„é¢œè‰²ã€‚å¯¹äºŽé¢‘ç¹æ›´æ–°çš„ç»„ä»¶ï¼Œè“è‰²æ˜¾ç¤ºä¸é¢‘ç¹æ›´æ–°ï¼ŒæŒ‰æ›´æ–°é¢‘çŽ‡ä¾æ¬¡ä¸ºç»¿è‰²ï¼Œé»„è‰²å’Œçº¢è‰²ã€‚ çœ‹åˆ°é»„è‰²æˆ–çº¢è‰²ä¸ä¸€å®šæ˜¯åäº‹ã€‚å½“è°ƒæ•´æ»‘å—æˆ–è§¦å‘é¢‘ç¹æ›´æ–°çš„å…¶ä»–UIå…ƒç´ æ—¶ï¼Œå¯ä»¥é¢„æœŸã€‚ä½†æ˜¯ï¼Œå¦‚æžœæ‚¨ç‚¹å‡»ä¸€ä¸ªç®€å•çš„æŒ‰é’®å¹¶çœ‹åˆ°çº¢è‰²ï¼Œè¿™å¯èƒ½æ„å‘³ç€æŸäº›ä¸œè¥¿æ˜¯é”™è¯¯çš„ã€‚è¯¥å·¥å…·çš„ç›®çš„æ˜¯å‘çŽ°ä¸å¿…è¦çš„æ›´æ–°çš„ç»„ä»¶ã€‚ä½œä¸ºåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªä¸€èˆ¬çš„æƒ³æ³•ï¼Œå“ªäº›ç»„ä»¶åº”è¯¥åœ¨ç»™å®šçš„æ—¶é—´æ›´æ–°ã€‚ æ¼”ç¤ºï¼ƒ3ä¸ºäº†æ¼”ç¤ºç»„ä»¶çªå‡ºæ˜¾ç¤ºï¼Œæˆ‘å®‰è£…äº† TodoMVC åº”ç”¨ç¨‹åºæ¥ä¸å¿…è¦åœ°æ›´æ–°æŸäº›ç»„ä»¶ã€‚ è¿™æ˜¯æ¼”ç¤º æ‰“å¼€ä¸Šé¢çš„é“¾æŽ¥ï¼Œç„¶åŽæ‰“å¼€ React Developer Tools å¹¶å¯ç”¨æ›´æ–°çªå‡ºæ˜¾ç¤ºã€‚å½“æ‚¨è¾“å…¥é¡¶éƒ¨æ–‡æœ¬è¾“å…¥æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°æ‰€æœ‰ TODO éƒ½ä¸å¿…è¦åœ°çªå‡ºæ˜¾ç¤ºã€‚å½“æ‚¨è¾“å…¥æ›´å¿«æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°é¢œè‰²æ›´æ”¹ä»¥æŒ‡ç¤ºæ›´é¢‘ç¹çš„æ›´æ–°ã€‚ ä¿®å¤ä¸å¿…è¦çš„æ¸²æŸ“ä¸€æ—¦è¯†åˆ«å‡ºåº”ç”¨ç¨‹åºä¸­ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“çš„ç»„ä»¶ï¼Œå°±ä¼šæœ‰ä¸€äº›ç®€å•çš„ä¿®å¤ã€‚ ä½¿ç”¨PureComponentåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒDumbComponent æ˜¯å®ƒ props çš„çº¯å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥ç»„ä»¶åªæœ‰åœ¨å…¶ props æ›´æ”¹æ—¶æ‰éœ€è¦é‡æ–° renderã€‚React æœ‰ä¸€ç§å†…ç½®çš„ç‰¹æ®Šç±»åž‹çš„ç»„ä»¶ï¼ŒPureComponent è¿™ä¸ªç±»åž‹æ˜¯ä¸ºè¿™ä¸ªç”¨ä¾‹å‡†å¤‡çš„ã€‚ è€Œä¸æ˜¯ç»§æ‰¿è‡ª React.Componentï¼Œè¯·ä½¿ç”¨ React.PureComponentï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š class DumbComponent extends PureComponent { render() { return &lt;div> {this.props.value} &lt;/div>; } } ç„¶åŽï¼Œè¯¥ç»„ä»¶åªæœ‰åœ¨å…¶ props å®žé™…æ›´æ”¹æ—¶æ‰ä¼šé‡æ–° renderã€‚è€Œå·²ï¼ è¯·æ³¨æ„ï¼ŒPureComponentåšä¸€ä¸ª props çš„æµ…æ¯”è¾ƒï¼Œæ‰€ä»¥å¦‚æžœä½ ä½¿ç”¨å¤æ‚çš„æ•°æ®ç»“æž„ï¼Œå®ƒå¯èƒ½ä¼šé”™è¿‡ä¸€äº› props æ›´æ”¹ï¼Œè€Œä¸æ˜¯æ›´æ–°æ‚¨çš„ç»„ä»¶ã€‚ å®žçŽ° shouldComponentUpdateshouldComponentUpdate æ˜¯ render ä»»ä½•ä¸€ä¸ª props æˆ– state æ›´æ”¹ä¹‹å‰è°ƒç”¨çš„ç»„ä»¶æ–¹æ³•ã€‚å¦‚æžœ shouldComponentUpdate è¿”å›ž trueï¼Œrender å°†è¢«è°ƒç”¨ï¼Œå¦‚æžœå®ƒè¿”å›ž falseï¼Œæ²¡æœ‰ä»»ä½•ååº”ã€‚ é€šè¿‡å®žçŽ°æ­¤æ–¹æ³•ï¼Œæ‚¨å¯ä»¥æŒ‡ç¤º React é¿å…é‡æ–°æ¸²æŸ“ç»™å®šçš„ç»„ä»¶ï¼Œå½“å…¶ props ä¸æ›´æ”¹çš„æ—¶å€™ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼Œåœ¨ä¸€ä¸ªç»„ä»¶ä¸­å®žçŽ°ä¸€ä¸ª shouldComponentUpdate ï¼š class DumbComponent extends Component { shouldComponentUpdate(nextProps) { if (this.props.value !== nextProps.value) { return true; } else { return false; } } render() { return &lt;div>foo&lt;/div>; } } è°ƒè¯•ç”Ÿäº§ä¸­çš„æ€§èƒ½é—®é¢˜å¦‚æžœæ‚¨åœ¨è‡ªå·±çš„æœºå™¨ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºï¼Œâ€œReact Developer Toolsâ€æ‰èƒ½èµ·ä½œç”¨ã€‚å¦‚æžœæ‚¨æœ‰å…´è¶£äº†è§£ç”¨æˆ·åœ¨ç”Ÿäº§ä¸­çœ‹åˆ°çš„æ€§èƒ½é—®é¢˜ï¼Œè¯·å°è¯•ä½¿ç”¨LogRocketã€‚ LogRocket å°±åƒæ˜¯ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œè®°å½• DVR å­—é¢ä¸Š çš„ä¸€åˆ‡ï¼Œæ‚¨ç½‘ç«™ä¸Šå‘ç”Ÿçš„ã€‚æ‚¨å¯ä»¥ä½¿ç”¨é”™è¯¯æˆ–æ€§èƒ½é—®é¢˜é‡æ’­ä¼šè¯ï¼Œè€Œä¸æ˜¯çŒœæµ‹ä¸ºä»€ä¹ˆä¼šå‡ºçŽ°é—®é¢˜ï¼Œä»¥å¿«é€Ÿäº†è§£æ ¹æœ¬åŽŸå› ã€‚ LogRocket ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºè®°å½•æ€§èƒ½æ•°æ®ï¼ŒRedux actions/stateï¼Œæ—¥å¿—ï¼Œé”™è¯¯ï¼Œç½‘ç»œè¯·æ±‚/å“åº”ä¸Žæ ‡é¢˜+ä¸»ä½“å’Œæµè§ˆå™¨å…ƒæ•°æ®ã€‚å®ƒè¿˜åœ¨é¡µé¢ä¸Šè®°å½•HTMLå’ŒCSSï¼Œé‡æ–°åˆ›å»ºå³ä½¿æ˜¯æœ€å¤æ‚çš„å•é¡µåº”ç”¨ç¨‹åºçš„åƒç´ è§†é¢‘ã€‚ ã€ç¿»è¯‘åŽŸæ–‡é“¾æŽ¥ã€‘ï¼šhttps://medium.freecodecamp.org/make-react-fast-again-tools-and-techniques-for-speeding-up-your-react-app-7ad39d3c1b82]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Redux å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹ â€”â€” ä¸€ä»½ä¼˜åŒ–æŒ‡å—]]></title>
    <url>%2F2017%2F07%2F17%2Freact-redux-optimization.html</url>
    <content type="text"><![CDATA[Redux å¹¶ä¸æ…¢ï¼Œåªæ˜¯ä½ ä½¿ç”¨å§¿åŠ¿ä¸å¯¹ â€”â€” ä¸€ä»½ä¼˜åŒ–æŒ‡å—å¦‚ä½•ä¼˜åŒ–ä½¿ç”¨äº† Redux çš„ react åº”ç”¨ç¨‹åºå¹¶ä¸æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä½†å®žé™…ä¸Šç›¸å½“ç®€å•ã€‚è¿™æ˜¯ä¸€ä¸ªç®€çŸ­çš„æŒ‡å—ï¼Œä»¥åŠä¸€äº›ä¾‹å­ã€‚ å½“ä¼˜åŒ–ä½¿ç”¨ Redux çš„ react åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ç»å¸¸å¬åˆ°æœ‰äººè¯´ Redux ç¼“æ…¢ã€‚åœ¨99ï¼…çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½ä¸ä½³çš„åŽŸå› ï¼ˆé€‚ç”¨äºŽä»»ä½•å…¶ä»–æ¡†æž¶ï¼‰ä¸Žä¸å¿…è¦çš„æ¸²æŸ“ç›¸å…³è”ï¼Œå› ä¸º DOM æ›´æ–°æ˜¯æ˜‚è´µçš„ï¼åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•åœ¨ä½¿ç”¨ Redux ç»‘å®š react æ—¶é¿å…ä¸å¿…è¦çš„ renderã€‚ é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨å®˜æ–¹ react ç»‘å®šçš„ Redux çš„ connect é«˜é˜¶ç»„ä»¶ï¼Œ å½“æ‚¨çš„ Redux store æ›´æ–°æ—¶ï¼Œreact ç»„ä»¶å°±ä¼šæ›´æ–°ã€‚è¿™æ˜¯ä¸€ä¸ªå°†ç»„ä»¶åŒ…è£…åœ¨å¦ä¸€ä¸ªç»„ä»¶ä¸­çš„å‡½æ•°ï¼Œè¯¥ç»„ä»¶è®¢é˜…äº† Redux store ä¸­çš„æ›´æ”¹ï¼Œå¹¶æ¸²æŸ“ storeï¼Œè¿™å°±æ˜¯å®ƒçš„å­èŠ‚ç‚¹æ›´æ–°çš„åŽŸå› ã€‚ å¿«é€Ÿå…¥å‘ react-reduxï¼Œå®˜æ–¹ react ç»‘å®š Reduxè¯¥ connect é«˜é˜¶ç»„ä»¶å®žé™…ä¸Šæ˜¯å·²ç»è¿‡ä¼˜åŒ–ã€‚è¦äº†è§£å¦‚ä½•æœ€å¥½åœ°ä½¿ç”¨å®ƒï¼Œæœ€å¥½äº†è§£å…ˆå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ Redux ä»¥åŠ react-redux å®žé™…ä¸Šæ˜¯ç›¸å½“å°çš„åº“ï¼Œæ‰€ä»¥æºä»£ç å¹¶ä¸è´¹è§£ã€‚æˆ‘é¼“åŠ±å¤§å®¶é˜…è¯»æºä»£ç ï¼Œæˆ–è‡³å°‘å…¶ä¸­çš„ä¸€äº›ã€‚å¦‚æžœä½ æƒ³è¿›ä¸€æ­¥ï¼Œç¼–å†™è‡ªå·±çš„å®žçŽ°ï¼Œå®ƒå°†è®©ä½ æ·±å…¥äº†è§£ä¸ºä»€ä¹ˆåº“çš„è®¾è®¡æ–¹å¼æ˜¯è¿™æ ·çš„ã€‚ ä¸ç”¨å¤šè¯´ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ react ç»‘å®šçš„å·¥ä½œåŽŸç†ã€‚æ­£å¦‚æˆ‘ä»¬å…¬è®¤çš„é‚£æ ·ï¼Œreact ç»‘å®šçš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯ connect é«˜é˜¶ç»„ä»¶ï¼Œè¿™æ˜¯å®ƒçš„å†™æ³•ï¼š return function connect( mapStateToProps, mapDispatchToProps, mergeProps, { pure = true, areStatesEqual = strictEqual, areOwnPropsEqual = shallowEqual, areStatePropsEqual = shallowEqual, areMergedPropsEqual = shallowEqual, ...extraOptions } = {} ) { ... } ä½œä¸ºé™„æ³¨ - å”¯ä¸€çš„å¼ºåˆ¶æ€§å‚æ•°æ˜¯ mapStateToPropsï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨åªéœ€è¦å‰ä¸¤ä¸ªå‚æ•°ã€‚ä½†æ˜¯ï¼Œæˆ‘åœ¨è¿™é‡Œä½¿ç”¨å®Œæ•´çš„å†™æ³•æ¥è¯´æ˜Ž react bindings æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ ä¼ é€’ç»™ connect å‡½æ•°çš„æ‰€æœ‰å‚æ•°éƒ½ç”¨äºŽç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä½œä¸º props ä¼ é€’åˆ°å°è£…çš„ç»„ä»¶ä¸Šã€‚mapStateToProps ç”¨äºŽå°†çŠ¶æ€ä»Ž Redux store æ˜ å°„åˆ°ä¸€ä¸ªå¯¹è±¡ï¼ŒmapDispatchToProps ç”¨äºŽç”ŸæˆåŒ…å«å‡½æ•°çš„å¯¹è±¡ - é€šå¸¸è¿™äº›å‡½æ•°æ˜¯ actions åˆ›å»ºè€…ã€‚æœ€åŽï¼ŒmergeProps æœ‰ä¸‰ä¸ªå‚æ•° statePropsï¼ŒdispatchProps å’Œ ownPropsã€‚ç¬¬ä¸€ä¸ªæ˜¯ mapStateToProps çš„ç»“æžœï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ mapDispatchToProps çš„ç»“æžœï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä»Žç»„ä»¶æœ¬èº«ç»§æ‰¿çš„ props å¯¹è±¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒmergeProps å°†è¿™äº›å‚æ•°ç®€å•åœ°ç»„åˆåˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯å¦‚æžœæ‚¨ä¼ é€’ä¸€ä¸ªå‡½æ•°ä½œä¸º mergeProps å‚æ•°ï¼Œconnect åˆ™å°†ä½¿ç”¨è¯¥å‡½æ•°ç”Ÿæˆå°è£…ç»„ä»¶çš„ propsã€‚ connect å‡½æ•°çš„ç¬¬å››ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª options å¯¹è±¡ã€‚è¿™åŒ…å«5ä¸ªé€‰é¡¹ï¼špure å¯ä»¥æ˜¯ true æˆ– falseï¼Œä»¥åŠç¡®å®šæ˜¯å¦é‡æ–°æ¸²æŸ“ç»„ä»¶çš„4ä¸ªå‡½æ•°ï¼ˆåº”è¯¥è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ï¼‰ã€‚pure é»˜è®¤è®¾ç½®ä¸ºtrueã€‚å¦‚æžœè®¾ç½®ä¸ºfalseï¼Œåˆ™connect å°†è·³è¿‡ä»»ä½•ä¼˜åŒ–ï¼Œå¹¶ä¸”optionså¯¹è±¡ä¸­çš„4ä¸ªå‡½æ•°å°†ä¸ç”Ÿæ•ˆã€‚æˆ‘ä¸ªäººä¸èƒ½æƒ³åˆ°ä¸€ä¸ªç”¨ä¾‹ï¼Œä½†æ˜¯å¦‚æžœæ‚¨å¸Œæœ›å…³é—­ä¼˜åŒ–ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸ºfalseã€‚ æˆ‘ä»¬çš„ mergeProps å‡½æ•°äº§ç”Ÿçš„å¯¹è±¡ä¸Žæœ€åŽä¸€ä¸ª props å¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æžœæˆ‘ä»¬çš„ connect è®¤ä¸º props å¯¹è±¡å·²ç»æ”¹å˜äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªç»„ä»¶å°±ä¼šé‡æ–°æ¸²æŸ“ã€‚è¦äº†è§£åº“å¦‚ä½•å†³å®šæ˜¯å¦æœ‰å˜æ›´ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹è¯¥ shallowEqual åŠŸèƒ½ã€‚å¦‚æžœå‡½æ•°è¿”å›ž trueï¼Œç»„ä»¶å°†ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œå¦‚æžœè¿”å›ž falseï¼Œå®ƒå°†é‡æ–°æ¸²æŸ“ã€‚shallowEqual æ‰§è¡Œæ­¤æ¯”è¾ƒã€‚ä¸‹é¢ä½ ä¼šçœ‹åˆ° shallowEqual æ–¹æ³•çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå‘Šè¯‰ä½ æ‰€æœ‰ä½ éœ€è¦çŸ¥é“çš„ï¼š for (let i = 0; i &lt; keysA.length; i++) { if (!hasOwn.call(objB, keysA[i]) || !is(objA[keysA[i]], objB[keysA[i]])) { return false } } æ€»è€Œè¨€ä¹‹ï¼Œè¿™æ˜¯ä¸Šé¢çš„ä»£ç ï¼š å®ƒåœ¨ object a ä¸­çš„ key ä¸Šå¾ªçŽ¯ï¼Œå¹¶æ£€æŸ¥ object B æ˜¯å¦æ‹¥æœ‰ç›¸åŒçš„å±žæ€§ã€‚ç„¶åŽå®ƒæ£€æŸ¥ object Aä¸­çš„å±žæ€§ï¼ˆå…·æœ‰ç›¸åŒåç§°ï¼‰æ˜¯å¦ç­‰äºŽå¯¹è±¡Bçš„å±žæ€§ã€‚å¦‚æžœåªæœ‰ä¸€ä¸ªæ¯”è¾ƒè¿”å›žfalseï¼Œé‚£ä¹ˆå¯¹è±¡å°†è¢«è§†ä¸ºä¸ç›¸ç­‰ï¼Œå¹¶ä¸”ä¼šå‘ç”Ÿé‡æ–°æ¸²æŸ“ã€‚ è¿™å¯¼è‡´æˆ‘ä»¬ä¸€ä¸ªé»„é‡‘æ³•åˆ™ï¼š åªç»™æ‚¨çš„ç»„ä»¶å®ƒéœ€è¦å‘ˆçŽ°çš„æ•°æ®è¿™è¯´å¾—å¾ˆå«ç³Šï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç”¨ä¸€äº›å®žé™…çš„ä¾‹å­æ¥é˜è¿°ã€‚ æ‹†åˆ†è¿žæŽ¥çš„ç»„ä»¶æˆ‘çœ‹åˆ°äººä»¬è¿™æ ·åš è®¢é˜…å®¹å™¨ç»„ä»¶ä¸€ç³»åˆ—çŠ¶æ€ï¼Œå¹¶é€šè¿‡ props ä¼ é€’æ‰€æœ‰ä¸œè¥¿ã€‚ const BigComponent = ({ a, b, c, d }) => ( &lt;div> &lt;CompA a={a} /> &lt;CompB b={b} /> &lt;CompC c={c} /> &lt;/div> ); const ConnectedBigComponent = connect( ({ a, b, c }) => ({ a, b, c }) ); çŽ°åœ¨ï¼Œæ¯æ¬¡è¦ä¹ˆaï¼Œbæˆ–cå˜åŒ–ï¼ŒBigComponentåŒ…æ‹¬CompAï¼ŒCompBå¹¶ä¸”CompCå°†é‡æ–°å‘ˆçŽ°ã€‚ ç›¸åï¼Œæ‹†åˆ†æ‚¨çš„ç»„ä»¶ï¼Œä¸è¦å®³æ€•æ›´å¤šåœ°ä½¿ç”¨ connectï¼š const ConnectedA = connect(CompA, ({ a }) => ({ a })); const ConnectedB = connect(CompB, ({ b }) => ({ b })); const ConnectedC = connect(CompC, ({ c }) => ({ c })); const BigComponent = () => ( &lt;div> &lt;ConnectedA a={a} /> &lt;ConnectedB b={b} /> &lt;ConnectedC c={c} /> &lt;/div> ); é€šè¿‡æ­¤æ¬¡æ›´æ–°ï¼ŒCompA å°†åªæœ‰å½“aå·²ç»æ”¹å˜æ‰ä¼šé‡æ–°æ¸²æŸ“ï¼ŒCompBå½“bæ”¹å˜ç­‰ã€‚è€ƒè™‘è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œæ¯ä¸€ä¸ªå€¼aï¼Œbå¹¶cåˆ†åˆ«ç»å¸¸æ›´æ–°ã€‚å¯¹äºŽæ¯æ¬¡æ›´æ–°ï¼Œæˆ‘ä»¬çŽ°åœ¨é‡æ–°æ¸²æŸ“ä¸€ä¸ªï¼Œè€Œä¸æ˜¯æ‰€æœ‰ç»„ä»¶ã€‚è¿™å‡ ä¹Žæ²¡æœ‰ä»€ä¹ˆæ˜Žæ˜¾çš„ä¸‰ä¸ªç»„ä»¶ï¼Œä½†å¦‚æžœä½ æœ‰æ›´å¤šï¼ æ”¹å˜ä½ çš„çŠ¶æ€ï¼Œä½¿å…¶å°½å¯èƒ½çš„æœ€å°è¿™æ˜¯ä¸€ä¸ªå‡è®¾ï¼ˆç¨å¾®è®¾è®¡è¿‡ï¼‰çš„ä¾‹å­ï¼š ä½ æœ‰ä¸€ä¸ªå¤§çš„é¡¹ç›®åˆ—è¡¨ï¼Œæˆ‘ä»¬å‡è®¾æœ‰300æˆ–æ›´å¤šã€‚ &lt;List> {this.props.items.map(({ content, itemId }) => ( &lt;ListItem onClick={selectItem} content={content} itemId={itemId} key={itemId} /> ))} &lt;/List> å½“æˆ‘ä»¬ç‚¹å‡»ä¸€â€‹â€‹ä¸ªåˆ—è¡¨é¡¹æ—¶ï¼Œä¸€ä¸ªåŠ¨ä½œè¢«è§¦å‘ï¼Œæ›´æ–°ä¸€ä¸ªå­˜å‚¨å€¼ - selectedItemã€‚æ¯ä¸ªåˆ—è¡¨é¡¹è¿žæŽ¥åˆ° Redux å¹¶èŽ·å–selectedItemï¼š const ListItem = connect( ({ selectedItem }) => ({ selectedItem }) )(SimpleListItem); æˆ‘ä»¬æ­£åœ¨åšæ­£ç¡®çš„äº‹æƒ…ï¼Œæˆ‘ä»¬ä»…å°†ç»„ä»¶è¿žæŽ¥åˆ°æ‰€éœ€çš„çŠ¶æ€ã€‚ä½†æ˜¯ï¼Œå½“selectedItemæ›´æ–°æ—¶ï¼Œæ‰€æœ‰ListItemç»„ä»¶éƒ½å°†é‡æ–°æ¸²æŸ“ï¼Œå› ä¸ºæˆ‘ä»¬è¿”å›žçš„å¯¹è±¡selectedItemå·²ç»æ›´æ”¹ã€‚åœ¨æ­¤ä¹‹å‰ { selectedItem: 123 }ï¼ŒçŽ°åœ¨æ˜¯ { selectedItem: 120 }ã€‚ è¯·è®°ä½ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨è¯¥ selectedItem å€¼æ¥æ£€æŸ¥å½“å‰é¡¹ç›®æ˜¯å¦è¢«é€‰ä¸­ã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç»„ä»¶çœŸæ­£éœ€è¦çŸ¥é“çš„æ˜¯å®ƒæ˜¯å¦è¢«é€‰æ‹© - å®žè´¨ä¸Šæ˜¯ä¸€ä¸ªBooleanã€‚Boolean æ˜¯ä¼Ÿå¤§çš„ï¼Œå› ä¸ºåªæœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼Œtrue æˆ–è€… falseã€‚æ‰€ä»¥å¦‚æžœæˆ‘ä»¬è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè€Œä¸æ˜¯ selectedItem ï¼Œä»… Boolean æ›´æ”¹çš„ä¸¤ä¸ªé¡¹ç›®å°†ä¼šé‡æ–°æ¸²æŸ“ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚mapStateToProps å®žé™…ä¸Š props å®ƒæ˜¯ç»„ä»¶çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æ£€æŸ¥è¿™æ˜¯å¦å®žé™…ä¸Šæ˜¯é€‰å®šçš„é¡¹ç›®ã€‚ä»¥ä¸‹æ˜¯è¿™æ ·çš„ï¼š const ListItem = connect( ({ selectedItem }, { itemId }) => ({ isSelected: selectedItem === itemId }) )(SimpleListItem); çŽ°åœ¨ï¼Œåªè¦æˆ‘ä»¬çš„ selectedItem å€¼å‘ç”Ÿå˜åŒ–ï¼Œåªæœ‰ä¸¤ä¸ªç»„ä»¶é‡æ–°å‘ˆçŽ° - ListItem çŽ°åœ¨å·²ç»è¢«é€‰æ‹©äº†ï¼Œè€Œä¸”åŽŸæ¥é‚£ä¸ªå·²ç»è¢«å–æ¶ˆé€‰æ‹©äº†ã€‚ ä¿æŒæ•°æ®æ‰å¹³åŒ–åœ¨ Reduxæ–‡æ¡£æåˆ° è¿™æ˜¯ä¸€ç§æœ€ä½³å®žè·µã€‚ä¿æŒæ‚¨çš„store æ‰å¹³åŒ–æ˜¯æœ‰ç›Šçš„ä¸€äº›åŽŸå› ã€‚ä½†æ˜¯å¯¹äºŽæœ¬æ–‡çš„ä¸»æ—¨ï¼ŒåµŒå¥—ä¼šé€ æˆé—®é¢˜ï¼Œå› ä¸ºä¸ºäº†è®©æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°½å¯èƒ½çš„å¿«ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ›´æ–°å°½å¯èƒ½çš„ç»†å¾®ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿™æ ·çš„åµŒå¥—å½¢çŠ¶ï¼š { articles: [{ comments: [{ users: [{ }] }] }], ... } ä¸ºäº†ä¼˜åŒ–æˆ‘ä»¬çš„ Articleï¼ŒComment å’Œ User ç»„ä»¶ï¼Œæˆ‘ä»¬çŽ°åœ¨éœ€è¦æ‰€æœ‰çš„äººè®¢é˜… articlesï¼Œç„¶åŽæ·±æ·±ä¼¸å…¥è¿™ç§ç»“æž„åªè¿”å›žä»–ä»¬æ‰€éœ€è¦çš„çŠ¶æ€ã€‚ç›¸ååœ°â€‹â€‹ï¼Œå¦‚æ­¤è®¾è®¡ä½ çš„å½¢çŠ¶æ›´æœ‰æ„ä¹‰ï¼š { articles: [{ ... }], comments: [{ articleId: .., userId: ..., ... }], users: [{ ... }] } ç„¶åŽä½¿ç”¨æ˜ å°„å‡½æ•°é€‰æ‹©æ³¨é‡Šå’Œç”¨æˆ·ä¿¡æ¯ã€‚å…³äºŽè¿™ä¸€ç‚¹çš„æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨ Reduxæ–‡æ¡£ä¸­é˜…è¯»å…³äºŽè§„èŒƒåŒ–çŠ¶æ€çš„ä¿¡æ¯ã€‚ å½©è›‹ï¼šç”¨äºŽé€‰æ‹© Redux state çš„åº“è¿™æ˜¯å®Œå…¨å¯é€‰çš„ï¼Œå–å†³äºŽæ‚¨ã€‚é€šå¸¸æ‰€æœ‰ä»¥ä¸Šçš„å»ºè®®éƒ½è¶³å¤Ÿæ·±å…¥åœ°è®©ä½ å†™å‡ºå¿«é€Ÿçš„ react å’Œ Redux åº”ç”¨ç¨‹åºã€‚ä½†æ˜¯æœ‰ä¸¤ä¸ªä¼˜ç§€çš„åº“ä½¿å¾—é€‰æ‹©çŠ¶æ€æ›´å®¹æ˜“ä¸€äº›ï¼š Reselect æ˜¯ selectors ä¸ºæ‚¨çš„ Redux åº”ç”¨ç¨‹åºç¼–å†™çš„å¼•äººæ³¨ç›®çš„å·¥å…·ã€‚ä»Žé‡æ–°é€‰æ‹©æ–‡æ¡£ï¼š é€‰æ‹©å™¨å¯ä»¥è®¡ç®—æ´¾ç”Ÿæ•°æ®ï¼Œå…è®¸ Redux å­˜å‚¨å°½å¯èƒ½å°çš„çŠ¶æ€ã€‚ é€‰æ‹©å™¨æ•ˆçŽ‡é«˜ã€‚é™¤éžå…¶ä¸­ä¸€ä¸ªå‚æ•°å‘ç”Ÿå˜åŒ–ï¼Œå¦åˆ™ä¸ä¼šé‡æ–°è®¡ç®—é€‰æ‹©å™¨ã€‚ é€‰æ‹©å™¨æ˜¯å¯ç»„åˆçš„ã€‚å®ƒä»¬å¯ä»¥ç”¨ä½œå…¶ä»–é€‰æ‹©å™¨çš„è¾“å…¥ã€‚ å¯¹äºŽå…·æœ‰å¤æ‚æŽ¥å£ï¼Œå¤æ‚çŠ¶æ€ å’Œ/æˆ– é¢‘ç¹æ›´æ–°çš„åº”ç”¨ç¨‹åºï¼Œé‡æ–°é€‰æ‹©å¯ä»¥å¸®åŠ©æ‚¨è½»æ¾ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºæ›´å¿«ï¼ Ramda æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åº“ï¼Œå…·æœ‰æ›´é«˜é˜¶çš„å‡½æ•°ã€‚æ¢å¥è¯è¯´ - ç”¨å‡½æ•°åˆ›å»ºå‡½æ•°ã€‚ç”±äºŽæˆ‘ä»¬çš„æ˜ å°„å‡½æ•°åªæ˜¯è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä½¿ç”¨ Ramda åˆ›å»ºæˆ‘ä»¬çš„é€‰æ‹©å™¨ã€‚Ramda å¯ä»¥æœ‰é€‰æ‹©å™¨çš„æ‰€æœ‰åŠŸèƒ½å¹¶åšçš„æ›´å¤šã€‚æŸ¥çœ‹ Ramda é£Ÿè°±çš„ä¸€äº›ä¾‹å­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Ramda åšä»€ä¹ˆã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>redux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¼˜åŒ– react è®©å®ƒå¿«å¦‚é—ªç”µâ€”â€”ä½ æ˜¯ç”µï¼Œä½ æ˜¯å…‰ï¼Œä½ æ˜¯å”¯ä¸€çš„ç¥žè¯]]></title>
    <url>%2F2017%2F07%2F17%2Freact-at-light-speed.html</url>
    <content type="text"><![CDATA[å…‰é€Ÿ ReactVixlet å›¢é˜Ÿä¼˜åŒ–æ€§èƒ½çš„ç»éªŒæ•™è®­åœ¨è¿‡åŽ»ä¸€å¹´å¤šï¼Œæˆ‘ä»¬ Vixlet çš„ web å›¢é˜Ÿå·²ç»ç€æ‰‹äºŽä¸€ä¸ªæ¿€åŠ¨äººå¿ƒçš„é¡¹ç›®ï¼šå°†æˆ‘ä»¬çš„æ•´ä¸ª web åº”ç”¨è¿ç§»åˆ° React + Redux æž¶æž„ã€‚å¯¹äºŽæ•´ä¸ªå›¢é˜Ÿæ¥è¯´ï¼Œè¿™æ˜¯ä¸æ–­æˆé•¿ä¸­çš„æœºä¼šï¼Œåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åœ¨è¿™æ–¹é¢é¢ä¸´ä¸€äº›æŒ‘æˆ˜ã€‚ å› ä¸ºæˆ‘ä»¬çš„ web-app å¯èƒ½æœ‰éžå¸¸å¤§çš„ feed è§†å›¾ï¼ŒåŒ…æ‹¬æˆç™¾ä¸Šåƒçš„åª’ä½“ã€æ–‡æœ¬ã€è§†é¢‘ã€é“¾æŽ¥å…ƒç´ ï¼Œæˆ‘ä»¬èŠ±äº†ç›¸å½“å¤šçš„æ—¶é—´å¯»æ‰¾èƒ½å……åˆ†åˆ©ç”¨ React æ€§èƒ½çš„æ–¹æ³•ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†åˆ†äº«æˆ‘ä»¬è¿™ä¸€è·¯å­¦åˆ°çš„ä¸€äº›ç»éªŒæ•™è®­ã€‚ å£°æ˜Žï¼šä¸‹é¢è®²çš„åšæ³•å’Œæ–¹æ³•æ›´é€‚ç”¨äºŽæˆ‘ä»¬å…·ä½“åº”ç”¨çš„æ€§èƒ½éœ€æ±‚ã€‚ç„¶è€Œï¼Œåƒæ‰€æœ‰çš„å¼€å‘è€…å»ºè®®çš„é‚£æ ·ï¼Œæœ€é‡è¦çš„æ˜¯è¦è€ƒè™‘åˆ°ä½ çš„åº”ç”¨ç¨‹åºå’Œå›¢é˜Ÿçš„å®žé™…éœ€æ±‚ã€‚React æ˜¯ä¸€ä¸ªå¼€ç®±å³ç”¨çš„æ¡†æž¶ï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¸éœ€è¦åƒæˆ‘ä»¬ä¸€æ ·ç»†è‡´åœ°ä¼˜åŒ–æ€§èƒ½ã€‚è¯è™½å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›ä½ èƒ½åœ¨è¿™ç¯‡æ–‡ç« é‡Œæ‰¾åˆ°ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ã€‚ åŸºæœ¬ä¼˜åŒ– å‘æ›´å¤§çš„ä¸–ç•Œè¿ˆå‡ºç¬¬ä¸€æ­¥ã€‚ render() å‡½æ•°ä¸€èˆ¬æ¥è¯´ï¼Œè¦å°½å¯èƒ½å°‘åœ°åœ¨ render å‡½æ•°ä¸­åšæ“ä½œã€‚å¦‚æžœéžè¦åšä¸€äº›å¤æ‚æ“ä½œæˆ–è€…è®¡ç®—ï¼Œä¹Ÿè®¸ä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€ä¸ª memoized å‡½æ•°ä»¥ä¾¿äºŽç¼“å­˜é‚£äº›é‡å¤çš„ç»“æžœã€‚å¯ä»¥çœ‹çœ‹ Lodash.memoizeï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€ç®±å³ç”¨çš„è®°å¿†å‡½æ•°ã€‚ åè¿‡æ¥è®²ï¼Œé¿å…åœ¨ç»„ä»¶çš„ state ä¸Šå­˜å‚¨ä¸€äº›å®¹æ˜“è®¡ç®—çš„å€¼ä¹Ÿå¾ˆé‡è¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æžœ props åŒæ—¶åŒ…å« firstName å’Œ lastNameï¼Œæ²¡å¿…è¦åœ¨ state ä¸Šå­˜ä¸€ä¸ª fullNameï¼Œå› ä¸ºå®ƒå¯ä»¥å¾ˆå®¹æ˜“é€šè¿‡æä¾›çš„ props æ¥èŽ·å–ã€‚å¦‚æžœä¸€ä¸ªå€¼å¯ä»¥é€šè¿‡ç®€å•çš„å­—ç¬¦ä¸²æ‹¼æŽ¥æˆ–åŸºæœ¬çš„ç®—æ•°è¿ç®—ä»Ž props æ´¾ç”Ÿå‡ºæ¥ï¼Œé‚£ä¹ˆæ²¡ç†ç”±å°†è¿™äº›å€¼åŒ…å«åœ¨ç»„ä»¶çš„ state ä¸Šã€‚ Prop å’Œ Reconciliationé‡è¦çš„æ˜¯è¦è®°ä½ï¼Œåªè¦ propsï¼ˆæˆ– stateï¼‰çš„å€¼ä¸ç­‰äºŽä¹‹å‰çš„å€¼ï¼ŒReact å°±ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚å¦‚æžœ props æˆ–è€… state åŒ…å«ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ•°ç»„ï¼ŒåµŒå¥—å€¼ä¸­çš„ä»»ä½•æ”¹å˜ä¹Ÿä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä½ éœ€è¦æ³¨æ„åœ¨æ¯æ¬¡æ¸²æŸ“çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ props æˆ–è€… state éƒ½å¯èƒ½æ— æ„ä¸­å¯¼è‡´äº†æ€§èƒ½ä¸‹é™ã€‚ ä¾‹å­: å‡½æ•°ç»‘å®šçš„é—®é¢˜ ä¾‹å­: å¯¹è±¡æˆ–æ•°ç»„å­—é¢é‡ ä¾‹å­ : æ³¨æ„å­—é¢é‡çš„å›žé€€å€¼ å°½å¯èƒ½çš„ä¿æŒ Propsï¼ˆå’Œ Stateï¼‰ç®€å•å’Œç²¾ç®€ç†æƒ³æƒ…å†µä¸‹ï¼Œä¼ é€’ç»™ç»„ä»¶çš„ props åº”è¯¥æ˜¯å®ƒç›´æŽ¥éœ€è¦çš„ã€‚ä¸ºäº†å°†å€¼ä¼ ç»™å­ç»„ä»¶è€Œå°†ä¸€ä¸ªå¤§çš„ã€å¤æ‚çš„å¯¹è±¡æˆ–è€…å¾ˆå¤šç‹¬ç«‹çš„ props ä¼ é€’ç»™ä¸€ä¸ªç»„ä»¶ä¼šå¯¼è‡´å¾ˆå¤šä¸å¿…è¦çš„ç»„ä»¶æ¸²æŸ“ï¼ˆå¹¶ä¸”ä¼šå¢žåŠ å¼€å‘å¤æ‚æ€§ï¼‰ã€‚ åœ¨ Vixletï¼Œæˆ‘ä»¬ä½¿ç”¨ Redux ä½œä¸ºçŠ¶æ€å®¹å™¨ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬çœ‹æ¥ï¼Œæœ€ç†æƒ³çš„æ˜¯æ–¹æ¡ˆåœ¨ç»„ä»¶å±‚æ¬¡ç»“æž„çš„æ¯ä¸€ä¸ªå±‚çº§ä¸­ä½¿ç”¨ react-redux çš„ connect() å‡½æ•°ç›´æŽ¥ä»Ž store ä¸ŠèŽ·å–æ•°æ®ã€‚connect å‡½æ•°çš„æ€§èƒ½å¾ˆå¥½ï¼Œå¹¶ä¸”ä½¿ç”¨å®ƒçš„å¼€é”€ä¹Ÿéžå¸¸å°ã€‚ ç»„ä»¶æ–¹æ³•ç”±äºŽç»„ä»¶æ–¹æ³•æ˜¯ä¸ºç»„ä»¶çš„æ¯ä¸ªå®žä¾‹åˆ›å»ºçš„ï¼Œå¦‚æžœå¯èƒ½çš„è¯ï¼Œä½¿ç”¨ helper/util æ¨¡å—çš„çº¯å‡½æ•°æˆ–è€…é™æ€ç±»æ–¹æ³•ã€‚å°¤å…¶åœ¨æ¸²æŸ“å¤§é‡ç»„ä»¶çš„åº”ç”¨ä¸­ä¼šæœ‰æ˜Žæ˜¾çš„åŒºåˆ«ã€‚ è¿›é˜¶ åœ¨æˆ‘çœ‹æ¥è§†å›¾çš„å˜åŒ–æ˜¯é‚ªæ¶çš„ï¼ shouldComponentUpdate()React æœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•° shouldComponentUpdate()ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥æ ¹æ®å½“å‰çš„å’Œä¸‹ä¸€æ¬¡çš„ props å’Œ state æ¥é€šçŸ¥è¿™ä¸ª React ç»„ä»¶æ˜¯å¦åº”è¯¥è¢«é‡æ–°æ¸²æŸ“ã€‚ ç„¶è€Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¼€å‘è€…å¿…é¡»è€ƒè™‘åˆ°éœ€è¦è§¦å‘é‡æ–°æ¸²æŸ“çš„æ¯ä¸€ç§æƒ…å†µã€‚è¿™ä¼šå¯¼è‡´é€»è¾‘å¤æ‚ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¼šéžå¸¸ç—›è‹¦ã€‚å¦‚æžœéžå¸¸éœ€è¦ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ shouldComponentUpdate() æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆå¤šæƒ…å†µä¸‹æœ‰æ›´å¥½çš„é€‰æ‹©ã€‚ React.PureComponentReact ä»Ž v15 å¼€å§‹ä¼šåŒ…å«ä¸€ä¸ª PureComponent ç±»ï¼Œå®ƒå¯ä»¥è¢«ç”¨æ¥æž„å»ºç»„ä»¶ã€‚React.PureComponent å£°æ˜Žäº†å®ƒè‡ªå·±çš„ shouldComponentUpdate() æ–¹æ³•ï¼Œå®ƒè‡ªåŠ¨å¯¹å½“å‰çš„å’Œä¸‹ä¸€æ¬¡çš„ props å’Œ state åšä¸€æ¬¡æµ…å¯¹æ¯”ã€‚æœ‰å…³æµ…å¯¹æ¯”çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒè¿™ä¸ª Stack Overflowï¼š http://stackoverflow.com/questions/36084515/how-does-shallow-compare-work-in-react åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒReact.PureComponent æ˜¯æ¯” React.Component æ›´å¥½çš„é€‰æ‹©ã€‚åœ¨åˆ›å»ºæ–°ç»„ä»¶æ—¶ï¼Œé¦–å…ˆå°è¯•å°†å…¶æž„å»ºä¸ºçº¯ç»„ä»¶ï¼Œåªæœ‰ç»„ä»¶éœ€è¦æ›´å¤šåŠŸèƒ½æ—¶æ‰ä½¿ç”¨ React.Componentã€‚ æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥é˜…ç›¸å…³æ–‡æ¡£ React.PureComponentã€‚ ç»„ä»¶æ€§èƒ½åˆ†æžï¼ˆåœ¨ Chrome é‡Œï¼‰åœ¨æ–°ç‰ˆæœ¬çš„ Chrome é‡Œï¼Œtimeline å·¥å…·é‡Œæœ‰ä¸€ä¸ªé¢å¤–çš„å†…ç½®åŠŸèƒ½å¯ä»¥æ˜¾ç¤ºå“ªäº› React ç»„ä»¶æ­£åœ¨æ¸²æŸ“ä»¥åŠä»–ä»¬èŠ±è´¹çš„æ—¶é—´ã€‚è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œå°† ?react_perf ä½œä¸ºè¦æµ‹è¯•çš„ URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚React æ¸²æŸ“æ—¶é—´è½´æ•°æ®å°†ä½äºŽ User Timing éƒ¨åˆ†ã€‚ æ›´å¤šç›¸å…³ä¿¡æ¯ï¼Œè¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼šProfiling Components with Chrome Timeline ã€‚ æœ‰ç”¨çš„å·¥å…·: why-did-you-updateè¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ NPM åŒ…ï¼Œä»–ä»¬ç»™ React æ·»åŠ è¡¥ä¸ï¼Œå½“ä¸€ä¸ªç»„ä»¶è§¦å‘äº†ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“æ—¶ï¼Œå®ƒä¼šåœ¨æŽ§åˆ¶å°è¾“å‡ºä¸€ä¸ª console æç¤ºã€‚ æ³¨æ„: è¿™ä¸ªæ¨¡å—åœ¨åˆå§‹åŒ–æ—¶å¯ä»¥é€šè¿‡ä¸€ä¸ªè¿‡æ»¤å™¨åŒ¹é…ç‰¹å®šçš„æƒ³è¦ä¼˜åŒ–çš„ç»„ä»¶ï¼Œå¦åˆ™ä½ çš„å‘½ä»¤è¡Œå¯èƒ½ä¼šè¢«åžƒåœ¾ä¿¡æ¯å¡«æ»¡ï¼Œå¹¶ä¸”å¯èƒ½ä½ çš„æµè§ˆå™¨ä¼šå› æ­¤è€ŒæŒ‚èµ·æˆ–è€…å´©æºƒï¼ŒæŸ¥é˜… why-did-you-update æ–‡æ¡£ èŽ·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚ å¸¸è§æ€§èƒ½é™·é˜± setTimeout() å’Œ setInterval()åœ¨ React ç»„ä»¶ä¸­ä½¿ç”¨ setTimeout() æˆ–è€… setInterval() è¦ååˆ†å°å¿ƒã€‚å‡ ä¹Žæ€»æ˜¯æœ‰æ›´å¥½çš„é€‰æ‹©ï¼Œä¾‹å¦‚ â€˜resizeâ€™ å’Œ â€˜scrollâ€™ äº‹ä»¶ï¼ˆæ³¨æ„ï¼šæœ‰å…³æ³¨æ„äº‹é¡¹è¯·å‚é˜…ä¸‹ä¸€èŠ‚ï¼‰ã€‚ å¦‚æžœä½ éœ€è¦ä½¿ç”¨ setTimeout() å’Œ setInterval()ï¼Œä½ å¿…é¡» éµå®ˆä¸‹é¢ä¸¤æ¡å»ºè®® ä¸è¦è®¾ç½®è¿‡çŸ­çš„æ—¶é—´é—´éš”ã€‚ å½“å¿ƒé‚£äº›å°äºŽ 100 ms çš„å®šæ—¶å™¨ï¼Œä»–ä»¬å¾ˆå¯èƒ½æ˜¯æ²¡æ„ä¹‰çš„ã€‚å¦‚æžœç¡®å®žéœ€è¦ä¸€ä¸ªæ›´çŸ­çš„æ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨ window.requestAnimationFrame() æ›¿ä»£ã€‚ ä¿ç•™å¯¹è¿™äº›å‡½æ•°çš„å¼•ç”¨ï¼Œå¹¶ä¸”åœ¨ unmount æ—¶å–æ¶ˆæˆ–è€…é”€æ¯ä»–ä»¬ã€‚ setTimeout() å’Œ setInterval() éƒ½è¿”å›žä¸€ä¸ªå»¶è¿Ÿå‡½æ•°çš„å¼•ç”¨ï¼Œå¹¶ä¸”éœ€è¦çš„æ—¶å€™å¯ä»¥å–æ¶ˆå®ƒä»¬ã€‚ç”±äºŽè¿™äº›å‡½æ•°æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸæ‰§è¡Œçš„ï¼Œä»–ä»¬ä¸åœ¨ä¹Žä½ çš„ç»„ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè¿™ä¼šå¯¼è‡´æŠ¥é”™ç”šè‡³ç¨‹åºå¡æ­»ã€‚ æ³¨æ„: å¯¹ window.requestAnimationFrame() æ¥è¯´ä¹Ÿæ˜¯å¦‚æ­¤ è§£å†³è¿™ä¸ªé—®é¢˜æœ€ç®€ç­”çš„æ–¹æ³•æ˜¯ä½¿ç”¨ react-timeout è¿™ä¸ª NPM åŒ…ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå¯ä»¥è‡ªåŠ¨å¤„ç†ä¸Šè¿°å†…å®¹çš„é«˜é˜¶ç»„ä»¶ã€‚å®ƒå°† setTimeout/setInterval ç­‰åŠŸèƒ½æ·»åŠ åˆ°åŒ…è£…ç»„å»ºçš„ props ä¸Šã€‚(ç‰¹åˆ«æ„Ÿè°¢ Vixlet çš„å¼€å‘äººå‘˜ Carl Pillot æä¾›è¿™ä¸ªæ–¹æ³•) å¦‚æžœä½ ä¸æƒ³å¼•å…¥è¿™ä¸ªä¾èµ–ï¼Œå¹¶ä¸”å¸Œæœ›è‡ªè¡Œè§£å†³æ­¤é—®é¢˜ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„æ–¹æ³•ï¼š å¦‚æžœä½ ä½¿ç”¨ requestAnimationFrame() æ‰§è¡Œçš„ä¸€ä¸ªåŠ¨ç”»å¾ªçŽ¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªéžå¸¸ç›¸ä¼¼çš„è§£å†³æ–¹æ¡ˆï¼Œå½“å‰ä»£ç è¦æœ‰ä¸€ç‚¹å°çš„ä¿®æ”¹ï¼š æœª åŽ»æŠ– é¢‘ç¹è§¦å‘çš„äº‹ä»¶æŸäº›å¸¸è§çš„äº‹ä»¶å¯èƒ½ä¼šéžå¸¸é¢‘ç¹çš„è§¦å‘ï¼Œä¾‹å¦‚ scrollï¼Œresizeã€‚åŽ»æŠ–è¿™äº›äº‹ä»¶æ˜¯æ˜Žæ™ºçš„ï¼Œç‰¹åˆ«æ˜¯å¦‚æžœäº‹ä»¶å¤„ç†ç¨‹åºæ‰§è¡Œçš„ä¸ä»…ä»…æ˜¯åŸºæœ¬åŠŸèƒ½ã€‚ Lodash æœ‰ _.debounce æ–¹æ³•ã€‚åœ¨ NPM ä¸Šè¿˜æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ debounce åŒ…. â€œä½†æ˜¯æˆ‘çœŸçš„éœ€è¦ç«‹å³åé¦ˆ scroll/resize æˆ–è€…åˆ«çš„äº‹ä»¶â€ æˆ‘å‘çŽ°ä¸€ç§å¯ä»¥å¤„ç†è¿™äº›äº‹ä»¶å¹¶ä¸”ä»¥é«˜æ€§èƒ½çš„æ–¹å¼è¿›è¡Œå“åº”çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯åœ¨ç¬¬ä¸€æ¬¡äº‹ä»¶è§¦å‘æ—¶å¯åŠ¨ requestAnimationFrame() å¾ªçŽ¯ã€‚ç„¶åŽå¯ä»¥ä½¿ç”¨ [debounce()](https://lodash.com/docs#debounce) æ–¹æ³•å¹¶ä¸”å°† trailing è¿™ä¸ªé…ç½®é¡¹è®¾ä¸º trueï¼ˆè¿™æ„å‘³ç€è¯¥åŠŸèƒ½åªåœ¨é¢‘ç¹è§¦å‘çš„äº‹ä»¶æµç»“æŸåŽè§¦å‘ï¼‰æ¥å–æ¶ˆå¯¹å€¼çš„ç›‘å¬ï¼Œçœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚ å¯†é›†CPUä»»åŠ¡çº¿ç¨‹é˜»å¡žæŸäº›ä»»åŠ¡ä¸€ç›´æ˜¯ CPU å¯†é›†åž‹çš„ï¼Œå› æ­¤å¯èƒ½ä¼šå¯¼è‡´ä¸»æ¸²æŸ“çº¿ç¨‹çš„é˜»å¡žã€‚ä¸¾å‡ ä¸ªä¾‹å­ï¼Œæ¯”å¦‚éžå¸¸å¤æ‚çš„æ•°å­¦è®¡ç®—ï¼Œè¿­ä»£éžå¸¸å¤§çš„æ•°ç»„ï¼Œä½¿ç”¨ File api è¿›è¡Œæ–‡ä»¶è¯»å†™ï¼Œåˆ©ç”¨ å¯¹å›¾ç‰‡è¿›è¡Œç¼–ç è§£ç ã€‚ åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¦‚æžœæœ‰å¯èƒ½æœ€å¥½ä½¿ç”¨ Web Worker å°†è¿™äº›åŠŸèƒ½ç§»åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬çš„ä¸»æ¸²æŸ“çº¿ç¨‹å¯ä»¥ä¿æŒé¡ºæ»‘ã€‚ ç›¸å…³é˜…è¯» MDN æ–‡ç« : Using Web Workers MDN æ–‡æ¡£: Worker API ç»“è¯­æˆ‘ä»¬å¸Œæœ›ä¸Šè¿°å»ºè®®å¯¹æ‚¨èƒ½æœ‰æ‰€å¸®åŠ©ã€‚å¦‚æžœæ²¡æœ‰ Vixlet å›¢é˜Ÿçš„ä¼Ÿå¤§å·¥ä½œå’Œç ”ç©¶ï¼Œä¸Šè¿°çš„æç¤ºå’Œç¼–ç¨‹æŠ€å·§æ˜¯ä¸å¯èƒ½äº§å‡ºçš„ã€‚ä»–ä»¬çœŸçš„æ˜¯æˆ‘æ›¾ç»åˆä½œè¿‡çš„æœ€æ£’çš„å›¢é˜Ÿä¹‹ä¸€ã€‚ åœ¨ä½ çš„ React çš„å¾é€”ä¸­ä¿æŒå­¦ä¹ å’Œç»ƒä¹ ï¼Œæ„¿åŽŸåŠ›ä¸Žä½ åŒåœ¨ï¼ åŽŸæ–‡åœ°å€ï¼šReact at Light Speed @Jacob Beltran]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[npxæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆéœ€è¦npx?]]></title>
    <url>%2F2017%2F07%2F14%2Fintroducing-npx-an-npm-package-runner.html</url>
    <content type="text"><![CDATA[ä»‹ç»npxï¼šä¸€ä¸ªnpmåŒ…è¿è¡ŒNPMå‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œnpm@5.2.0ï¼Œä½ å¯èƒ½ä¼šå‘çŽ°ï¼Œå®ƒä¼šå®‰è£…ä¸€ä¸ªæ–°çš„äºŒè¿›åˆ¶åŒ…è·Ÿç€ npmï¼šnpxã€‚ npx æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©æ•´ç†ä»Žnpmæ³¨å†Œè½¯ä»¶åŒ…çš„ä½“éªŒ - å’Œ ä½¿å¾—npméžå¸¸å®¹æ˜“åœ°å®‰è£…å’Œç®¡ç†æ‰˜ç®¡åœ¨æ³¨å†Œè¡¨ä¸Šçš„ä¾èµ–å…³ç³»æ˜¯ åŒæ ·çš„æ–¹å¼ï¼Œnpxä½¿ npm å¾ˆæ–¹ä¾¿ä½¿ç”¨CLIå·¥å…·å’Œå…¶ä»–è¢«æ‰˜ç®¡çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®ƒå¤§å¤§ç®€åŒ–äº†ä¸€äº›äº‹æƒ…ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œéœ€è¦ä¸€äº›ä¸Žæ™®é€šçš„npmæœ‰å…³çš„æ­¥éª¤ï¼š ä½¿ç”¨æœ¬åœ°åŒ–çš„å®‰è£…å·¥å…·è€Œä¸ç”¨ npm run-script å°†cowsayä½œä¸ºæœ¬åœ°devDependencyè¿›è¡Œå®‰è£…ï¼Œå¹¶ä»¥â€œ$ npx cowsayâ€è¿è¡Œ åœ¨è¿‡åŽ»å‡ å¹´ä¸­ï¼Œnpmç”Ÿæ€ç³»ç»Ÿè¶Šæ¥è¶Šå¤šåœ°å°†å®‰è£…å·¥å…·ä½œä¸ºé¡¹ç›®æœ¬åœ°åŒ–devDependenciesï¼Œè€Œä¸æ˜¯è¦æ±‚ç”¨æˆ·åœ¨å…¨å±€å®‰è£…ã€‚è¿™æ„å‘³ç€ï¼Œåƒå·¥å…·mochaï¼Œgruntå’Œbowerï¼Œæ›¾ç»è¢«è¦æ±‚å®‰è£…åœ¨ç³»ç»Ÿçš„å…¨å±€ç›®å½•ä¸Šï¼ŒçŽ°åœ¨å¯ä»¥åœ¨æ¯ä¸ªé¡¹ç›®çš„åŸºç¡€ä¸Šç®¡ç†è‡ªå·±çš„ç‰ˆæœ¬ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œæ‰€æœ‰ä½ éœ€è¦åšçš„å°±æ˜¯åŸºäºŽNPMçš„é¡¹ç›®è¿è¡Œèµ·æ¥ï¼Œä»¥ç¡®ä¿æ‚¨æœ‰node + NPMæ‚¨çš„ç³»ç»Ÿä¸Šï¼Œå…‹éš†githubé¡¹ç›®ï¼Œå¹¶è¿è¡Œnpm itåŽ»è¿è¡Œinstallå’Œtestã€‚ç”±äºŽnpm run-scriptæ·»åŠ æœ¬åœ°äºŒè¿›åˆ¶æ–‡ä»¶åˆ°è·¯å¾„ï¼Œè¿™ä¸ªå·¥ä½œå¾ˆå¥½ï¼ ä¸åˆ©ä¹‹å¤„åœ¨äºŽï¼Œå®ƒä¸ä¼šå¿«é€Ÿ/æ–¹ä¾¿åœ°ä»¥äº¤äº’æ–¹å¼è°ƒç”¨æœ¬åœ°äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä»–ä»¬éƒ½å¯¹ä»–ä»¬æœ‰ä¸€äº›çƒ¦æ¼ï¼šä½ å¯ä»¥æ·»åŠ è¿™äº›å·¥å…·åˆ°ä½ scriptsï¼Œä½†æ˜¯ä½ éœ€è¦è®°ä½é€šè¿‡ä½¿ç”¨ä¼ é€’å‚æ•°--ï¼Œä½ å¯ä»¥é€šè¿‡shellæŠ€å·§alias npmx=PATH=$(npm bin):$PATH åšåˆ°ï¼Œæˆ–è€…ä½ å¯ä»¥æ‰‹åŠ¨è·¯å¾„ä»–ä»¬ï¼Œä½¿ç”¨ ./node_modules/.bin/mochaã€‚è¿™äº›éƒ½æ˜¯å·¥ä½œï¼Œä½†æ²¡æœ‰ä¸€ä¸ªæ˜¯éžå¸¸ç†æƒ³çš„ã€‚ npxç»™ä½ æˆ‘è®¤ä¸ºæ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆï¼šæ‚¨éœ€è¦åšçš„æ˜¯ä½¿ç”¨$ npx mochaè¿›è¡Œæœ¬åœ°å®‰è£…ã€‚å¦‚æžœä½ å†è¿›è¡Œä¸€ä¸ªé¢å¤–çš„æ­¥éª¤å¹¶é…ç½®shellè‡ªåŠ¨å›žé€€ï¼ˆæ›´å¤šå†…å®¹åœ¨ä¸‹é¢ä¼šæåˆ°ï¼‰ï¼Œé‚£ä¹ˆåœ¨ä¸€ä¸ªé¡¹ç›®ç›®å½•ä¸­è¿è¡Œ$ mochaå°†ä¼šæˆä¸ºä½ çš„æŠ€å·§ï¼ ä½œä¸ºå½©è›‹ï¼Œå¦‚æžœè°ƒç”¨å·²ç»å®‰è£…çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒnpxåŸºæœ¬ä¸Šæ²¡æœ‰å¼€é”€ - è¿™è¶³ä»¥å°†è¯¥å·¥å…·çš„ä»£ç ç›´æŽ¥åŠ è½½åˆ°å½“å‰è¿è¡Œçš„nodeè¿›ç¨‹ä¸­ï¼è¿™ç§äº‹æƒ…å°±åƒè¯»å–æ–‡ä»¶ä¸€æ ·å¿«ï¼Œå¹¶ä¸”ä½¿å®ƒæˆä¸ºä¸€ä¸ªå®Œå…¨å¯ä»¥æŽ¥å—çš„è„šæœ¬ç¼–å†™å·¥å…·ã€‚ æ‰§è¡Œä¸€æ¬¡æ€§å‘½ä»¤ $ npx create-react-app my-cool-new-appå®‰è£…ä¸€ä¸ªä¸´æ—¶çš„åˆ›å»ºåº”ç­”ç¨‹åºå¹¶è°ƒç”¨å®ƒï¼Œè€Œä¸ä¼šæ±¡æŸ“å…¨å±€å®‰è£…æˆ–éœ€è¦å¤šä¸ªæ­¥éª¤ï¼ ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡ æƒ³è¦å°è¯•ä¸€äº›CLIå·¥å…·çš„æƒ…å†µï¼Œä½†æ˜¯è¦å®‰è£…ä¸€ä¸ªå…¨å±€åªæ˜¯ä¸ºäº†è¿è¡Œä¸€æ¬¡ï¼Œè¿™å¾ˆçƒ¦äººï¼Ÿnpxå¯¹è¿™ç§æƒ…å†µä¹Ÿæ˜¯å¾ˆæœ‰ç”¨ã€‚è°ƒç”¨çš„npx å½“ä¸åœ¨ä½ çš„$PATHæ„æ„¿åˆ—è¡¨ä¸­ï¼Œä¼šè‡ªåŠ¨ä»Žä½ çš„npmæ³¨å†Œè¡¨ä¸­å®‰è£…ä¸€ä¸ªåŒ…å«è¯¥åç§°çš„åŒ…ï¼Œç„¶åŽè°ƒç”¨å®ƒã€‚å®ŒæˆåŽï¼Œå®‰è£…çš„è½¯ä»¶åŒ…å°†ä¸ä¼šå‚¨å­˜åœ¨å…¨çƒèŒƒå›´å†…ä»»ä½•åœ°æ–¹ï¼Œæ‰€ä»¥æ‚¨ä¸ç”¨æ‹…å¿ƒé•¿æœŸçš„æ±¡æŸ“ã€‚ æ­¤åŠŸèƒ½ä¹Ÿé€‚ç”¨äºŽgeneratorsç­‰ã€‚åƒyeomanæˆ–create-react-appè¿™æ ·çš„å·¥å…·åªè¢«è°ƒç”¨ä¸€æ¬¡ã€‚å½“ä½ å†æ¬¡è¿è¡Œå®ƒä»¬æ—¶ï¼Œä»–ä»¬å·²ç»è¿‡æ—¶äº†ï¼Œæ‰€ä»¥ä½ æœ€ç»ˆä¸å¾—ä¸åœ¨æ¯æ¬¡æƒ³è¦ä½¿ç”¨å®ƒä»¬æ—¶å†æ¬¡å®‰è£…æ›´æ–°ã€‚ ä½œä¸ºä¸€ç§å·¥å…·çš„ç»´æŠ¤è€…ï¼Œæˆ‘å¾ˆå–œæ¬¢è¿™ä¸ªåŠŸèƒ½ï¼Œå› ä¸ºè¿™æ„å‘³ç€æˆ‘å¯ä»¥æŠŠ$ npx my-toolå†™è¿›README.mdçš„æŒ‡ä»¤ï¼Œè€Œä¸æ˜¯è¯•å›¾è®©äººä»¬åœ¨å®žé™…å®‰è£…å®ƒçš„éšœç¢ã€‚å¦ç™½è¯´ï¼Œè¯´â€œå“¦ï¼Œåªéœ€å¤åˆ¶ç²˜è´´è¿™ä¸€ä¸ªå‘½ä»¤ï¼Œè¿™æ˜¯é›¶æˆæœ¬çš„â€æ›´è´´åˆ‡ï¼Œå¯¹äºŽä¸ç¡®å®šæ˜¯å¦ä½¿ç”¨è¿™ä¸ªå·¥å…·çš„ç”¨æˆ·æ¥è¯´ã€‚ è¿™é‡Œï¼Œä½ å¯èƒ½æƒ³ç”¨å°è¯•ä¸€äº›å…¶ä»–æœ‰è¶£çš„åŒ…npxï¼šhappy-birthdayï¼Œbenny-hillï¼Œworkin-hardï¼Œcowsayï¼Œyoï¼Œcreate-react-appï¼Œnpm-checkã€‚ç”šè‡³æœ‰ä¸€ä¸ªå®Œæ•´çš„awesome-npxå…¥é—¨é¡¹ç›®ï¼æ¥å§ï¼èŽ·å–ä¸€ä¸ªè¶³å¤Ÿå°çš„å®Œæ•´çš„æœ¬åœ°RESTæœåŠ¡å™¨è¿è¡Œçš„å‘½ä»¤ä»¥é€‚åº”ä¸€ä¸ªæŽ¨æ–‡ã€‚ ä½¿ç”¨ä¸åŒNode.jsç‰ˆæœ¬è¿è¡Œå‘½ä»¤ npx -p node-bin @ node -vå¯ç”¨äºŽæ‰§è¡ŒèŠ‚ç‚¹ç‰ˆæœ¬çš„ä¸€æ¬¡æ€§è¿è¡Œã€‚ äº‹å®žè¯æ˜Žï¼Œåœ¨npmæ³¨å†Œè¡¨ä¸­æœ‰ä¸€ä¸ªå¾ˆé…·çš„åŒ…å« node-binã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ä¸åŒçš„nodeç‰ˆæœ¬ï¼Œè€Œä¸å¿…ä½¿ç”¨nodeç‰ˆæœ¬ç®¡ç†å™¨,åƒnvmï¼Œnaveæˆ–nã€‚æ‰€æœ‰ä½ éœ€è¦çš„åªæ˜¯å®‰è£…`npm@5.2.0`ï¼ -pnpx é€‰é¡¹å…è®¸æ‚¨æŒ‡å®šè¦å®‰è£…å¹¶æ·»åŠ åˆ°æ­£åœ¨è¿è¡Œçš„è½¯ä»¶åŒ…$PATHï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥è¿›è¡Œæœ‰è¶£çš„æ“ä½œï¼Œä¾‹å¦‚ï¼š$ npx -p node-bin@6 npm itå®‰è£…å¹¶æµ‹è¯•å½“å‰çš„npmè½¯ä»¶åŒ…ï¼Œå°±åƒåœ¨node@6å…¨å±€è¿è¡Œä¸€æ ·ã€‚æˆ‘ä¸€ç›´ä½¿ç”¨è¿™ä¸ª - æˆ‘ç”šè‡³æœ€è¿‘ä¸å¾—ä¸åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ç»å¸¸ä½¿ç”¨å®ƒï¼Œç”±äºŽæˆ‘çš„ä¸€ä¸ªæµ‹è¯•åº“åœ¨node@8çŽ¯å¢ƒä¸‹æ— æ³•è¿è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•‘ä¸–ä¸»ï¼Œæˆ‘å‘çŽ°ä½¿ç”¨è¿™ç§ç±»åž‹çš„ç”¨ä¾‹æ¯”ç‰ˆæœ¬ç®¡ç†å™¨æ›´å®¹æ˜“ï¼Œæˆ‘æ€»æ˜¯ä»¥æŸç§æ–¹å¼æ‰¾åˆ°breakæˆ–é”™è¯¯é…ç½®çš„æ–¹æ³•ã€‚ æ³¨æ„ï¼šnode-binä»…é€‚ç”¨äºŽ* nixå¹³å°ã€‚è¿™æ˜¯Aria Stewartçš„å‡ºè‰²å·¥ä½œã€‚åœ¨å°†æ¥ï¼ŒåŒæ ·çš„è½¯ä»¶åŒ…å°†å¯ä»¥ç®€å•åœ°ä½¿ç”¨nodeï¼Œæ‰€ä»¥æ‚¨å¯ä»¥$ npx node@6 ...ç›´æŽ¥æ‰§è¡Œï¼ŒåŒ…æ‹¬åœ¨Windowsä¸Šã€‚ ä¸Ž npm run-script äº’åŠ¨å‘å±• $ npx -p cowsay -p lolcatjs -c'echoâ€œ$ npm_package_name @ $ npm_package_versionâ€| cowsay | lolcatjs'så°†å®‰è£…cowsayå’Œlolcatjsï¼Œå¹¶ä½¿è„šæœ¬ä»Žè¿è¡Œè„šæœ¬è®¿é—®ä¸€å †â€œ$ npm_â€å˜é‡ã€‚ å¾ˆå¤šnpmçš„ç”¨æˆ·çŽ°åœ¨å¯ä»¥åˆ©ç”¨è¿™ä¸ªéžå¸¸é…·çš„run-scriptåŠŸèƒ½ã€‚ä»–ä»¬ä¸ä»…è®©æ‚¨çš„$PATHæœ¬åœ°äºŒè¿›åˆ¶æ–‡ä»¶å¯è®¿é—®ï¼Œè€Œä¸”è¿˜æ·»åŠ äº†ä¸€å¤§å †çŽ¯å¢ƒå˜é‡ï¼Œæ‚¨å¯ä»¥åœ¨è¿™äº›è„šæœ¬ä¸­è®¿é—®ã€‚ä½ å¯ä»¥çœ‹åˆ°è¿™äº›é¢å¤–çš„å˜é‡æ˜¯ä»€ä¹ˆ$ npm run env | grep npm_ã€‚ è¿™å¯ä»¥ä½¿å¼€å‘å’Œæµ‹è¯•è¿è¡Œè„šæœ¬å˜å¾—æ£˜æ‰‹ - è¿™æ„å‘³ç€å³ä½¿ä½¿ç”¨è¯¸å¦‚æ­¤ç±»çš„æŠ€å·§$(npm bin)/some-binï¼Œåœ¨äº¤äº’å¼å·¥ä½œçš„åŒæ—¶ä»ç„¶æ— æ³•è®¿é—®è¿™äº›ç¥žå¥‡çš„env varã€‚ å¯æ˜¯ç­‰ç­‰ï¼npxè¿˜æœ‰ä¸€ä¸ªæŠ€å·§ï¼šå½“ä½ ä½¿ç”¨è¿™ä¸ª-cé€‰é¡¹æ—¶ï¼Œå†™å…¥stringå‚æ•°å†…çš„è„šæœ¬å°†èƒ½å¤Ÿåƒæ™®é€šçš„è¿è¡Œè„šæœ¬ä¸€æ ·å®Œå…¨è®¿é—®ç›¸åŒçš„envå˜é‡ï¼æ‚¨ç”šè‡³å¯ä»¥ä½¿ç”¨ç®¡é“å’Œå¤šä¸ªå‘½ä»¤è¿›è¡Œå•æ¬¡npxè°ƒç”¨ï¼ ä¸Žæœ‹å‹ä»¥åŠä½ æƒ³è¦çš„ä»»ä½•äººåˆ†äº«åŸºäºŽgistçš„è„šæœ¬ï¼ ä½¿ç”¨gist.github.comåˆ†äº«å„ç§å®žç”¨ç¨‹åºè„šæœ¬å˜å¾—å¾ˆå¸¸è§ï¼Œè€Œä¸æ˜¯è®¾ç½®æ•´ä¸ªgit reposï¼Œå‘å¸ƒæ–°å·¥å…·ç­‰ã€‚ ä½¿ç”¨npxï¼Œæ‚¨å¯ä»¥è¿›ä¸€æ­¥ï¼šå› ä¸ºnpxæŽ¥å—npmæœ¬èº«æ‰€åšçš„ä»»ä½•è¯´æ˜Žç¬¦ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªäººä»¬å¯ä»¥ç›´æŽ¥ä½¿ç”¨å•ä¸ªå‘½ä»¤è°ƒç”¨çš„è¦ç‚¹ï¼ å°è¯•ä½¿ç”¨https://gist.github.com/zkat/4bc19503fe9e9309e2bfaa2c58074d32ï¼ æ³¨æ„ï¼šä¿æŒå®‰å…¨ï¼åœ¨æ‰§è¡Œè¿™äº›æ—¶ï¼Œå§‹ç»ˆç¡®ä¿é€šè¿‡ gists ç½‘ç«™è¯»å–å’Œæ‰§è¡Œä»£ç ï¼Œå°±åƒè¿è¡Œ .sh è„šæœ¬æ—¶ä¸€æ ·è°¨æ…Žï¼ å½©è›‹ï¼šshellè‡ªåŠ¨å›žé€€ å°†.zshrcä¸­çš„npxè‡ªåŠ¨å›žé€€æ„å‘³ç€ä½ å¯ä»¥åœ¨æ²¡æœ‰å¼•ç”¨npxçš„æƒ…å†µä¸‹æ‰§è¡Œ$ ember-cli @ latest ... FÃ©lixSaparelliè¡¥å……è¯´ï¼Œè¿™ä¸ªä»¤äººæ•¬ç•çš„åŠŸèƒ½æ„å‘³ç€å¯¹äºŽè®¸å¤šè¿™äº›ç”¨ä¾‹ï¼Œæ‚¨ç”šè‡³ä¸éœ€è¦ç›´æŽ¥è°ƒç”¨npxï¼å¸¸è§„çš„npxä½¿ç”¨å’Œå›žé€€ä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œå›žé€€ä¸ä¼šå®‰è£…æ–°è½¯ä»¶åŒ…ï¼Œé™¤éžæ‚¨ä½¿ç”¨pkg@versionè¯­æ³•ï¼šå®‰å…¨ç½‘æ¥é˜²æ­¢æ½œåœ¨çš„å±é™©æŽ’åºã€‚ è®¾ç½®è‡ªåŠ¨å›žé€€æ˜¯å¾ˆç®€å•çš„ï¼šåœ¨npxæ–‡æ¡£ä¸­æŸ¥çœ‹ç”¨äºŽå½“å‰shellçš„å‘½ä»¤ï¼Œå°†å…¶æ·»åŠ åˆ° .bashrc / .zshrc / .fishrcï¼Œç„¶åŽé‡æ–°å¯åŠ¨shellï¼ˆæˆ–ä½¿ç”¨sourceæˆ–å…¶ä»–æœºåˆ¶æ¥åˆ·æ–°shellï¼‰ã€‚ çŽ°åœ¨ï¼Œæ‚¨å¯ä»¥åšä¸€äº›$ standard@8 --versionå°è¯•ä¸åŒç‰ˆæœ¬çš„ä¸œè¥¿ï¼Œå¦‚æžœæ‚¨åœ¨ä¸€ä¸ªnpmé¡¹ç›®ä¸­ï¼Œ$ mochaåˆ™ä¼šè‡ªåŠ¨å›žåˆ°æœ¬åœ°å®‰è£…çš„mochaç‰ˆæœ¬ï¼Œå‰ææ˜¯å®ƒå°šæœªåœ¨å…¨å±€å®‰è£…ã€‚ çŽ°åœ¨å°±è¯•è¯•å§ä½ çŽ°åœ¨å¯ä»¥é€šè¿‡å®‰è£…`npm@5.2.0æˆ–æ›´æ–°æ¥èŽ·å¾—npxï¼Œæˆ–è€…å¦‚æžœä½ ä¸æƒ³ä½¿ç”¨npmï¼Œä½ å¯ä»¥å®‰è£…ç‹¬ç«‹ç‰ˆæœ¬çš„npxï¼å®ƒä¸Žå…¶ä»–è½¯ä»¶åŒ…ç®¡ç†å™¨å®Œå…¨å…¼å®¹ï¼Œå› ä¸ºä»»ä½•npmä½¿ç”¨ä»…é€‚ç”¨äºŽå†…éƒ¨æ“ä½œã€‚å“¦ï¼Œå®ƒæœ‰10ç§ä¸åŒçš„è¯­è¨€ï¼Œæ„Ÿè°¢æ¥è‡ªä¸–ç•Œå„åœ°çš„ä¸€å¤§æ‰¹æ—©æœŸé‡‡ç”¨è€…çš„è´¡çŒ®ï¼Œâ€“helpä»¥åŠæ‰€æœ‰çš„ç³»ç»Ÿæ¶ˆæ¯ç¿»è¯‘ï¼Œå¹¶å¯ä»¥æ ¹æ®ç³»ç»ŸåŒºåŸŸè®¾ç½®è‡ªåŠ¨æä¾›ï¼è¿˜æœ‰ä¸€ä¸ªawesome-npx[repo](https://github.com/js-n/awesome-npx)ä¸Žnpx`å·¥ä½œåœ°å¾ˆå¥½çš„ä¾‹å­ï¼ ä½ æœ‰æœ€å–œæ¬¢çš„åŠŸèƒ½å—ï¼Ÿä½ æœ‰æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Ÿå¦‚æžœä½ æœ‰ä¸€äº›å¾ˆé…·ç‚«çš„äº‹ï¼Œæˆ‘æ²¡æœ‰åœ¨è¿™é‡Œåˆ—å‡ºï¼Œè¯·åœ¨è¯„è®ºä¸­åˆ†äº«ï¼æˆ‘å¾ˆæƒ³å¬å¬åˆ«äººçš„æ„è§ï¼ PSäººä»¬ä¸æ–­åœ°é—®è¿™ä¸ªï¼Œæ‰€ä»¥æˆ‘åªæ˜¯ä¼šå¼¹å‡ºå®ƒåœ¨è¿™é‡Œï¼šåœ¨è¿™äº›GIFæ–‡ä»¶ï¼Œæˆ‘ä½¿ç”¨monokaiä¸»é¢˜çš„Hyperè¿è¡Œ oh-my-zshä¸­çš„spaceshipä¸»é¢˜ï¼Œå†åŠ ä¸ŠFiraCodeå­—ä½“ã€‚ ã€ç¿»è¯‘åŽŸæ–‡ã€‘: https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>npm</tag>
        <tag>npx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘åœæ­¢ä½¿ç”¨å¤šä¸ªæ˜¾ç¤ºå™¨]]></title>
    <url>%2F2017%2F07%2F11%2Fwhy-should-stopped-using-multiple-monitors.html</url>
    <content type="text"><![CDATA[è®¸å¤šå¼€å‘äººå‘˜è®¤ä¸ºå¤šä¸ªæ˜¾ç¤ºå™¨å¯ä»¥æé«˜ç”Ÿäº§åŠ›ã€‚ç ”ç©¶è¯æ˜Žæ˜¯è¿™æ ·ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆï¼Œè¯·è®°ä½ï¼Œè®¸å¤šè¿™äº›ç ”ç©¶æ˜¯ç”±æˆ´å°”å’ŒNECç­‰ç›‘æŽ§åˆ¶é€ å•†å§”æ‰˜è¿›è¡Œçš„ã€‚ðŸ¤” å°½ç®¡å¤šä¸ªæ˜¾ç¤ºå™¨ä½¿æ‚¨çœ‹èµ·æ¥åƒä¸€ä¸ªé‡åº¦çš„è®¡ç®—æœºä½¿ç”¨è€…ï¼Œä½†æˆ‘åœ¨å‡ å¹´å‰å–äº†æˆ‘çš„å¤šæ˜¾ç¤ºå™¨ï¼Œå¹¶åˆ‡æ¢åˆ°ä¸€ä¸ªç›‘è§†å™¨ã€‚è€Œä¸”æˆ‘å¹¶ä¸æ˜¯ä¸€ä¸ªäººã€‚ ä¸‹é¢å°±æ˜¯ä¸ºä»€ä¹ˆã€‚ ä¸“æ³¨äººç±»ä¸€æ¬¡åªèƒ½å…³æ³¨ä¸€ä»¶äº‹æƒ…ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬èŠ±é’±æ¥åŒæ—¶æ˜¾ç¤ºå¤šä¸ªä¸œè¥¿å‘¢ï¼Ÿå¦‚æžœæˆ‘çš„ç”µå­é‚®ä»¶æˆ–ç¤¾äº¤åª’ä½“èµ„è®¯æä¾›ä¸€ç›®äº†ç„¶ï¼Œæˆ‘ä¼šç»å¸¸æ£€æŸ¥ã€‚è¿™ä¸ä»…ä¸æ˜¯ä¸å¿…è¦çš„ï¼Œåè€Œæ˜¯æœ‰æ•ˆçš„ã€‚åœ¨ä¸€ä¸ªæ— ä¼‘æ­¢çš„åˆ†å¿ƒçš„ä¸–ç•Œä¸­ï¼Œèƒ½å¤Ÿé•¿æœŸä¸“æ³¨äºŽå•ä¸€ä»»åŠ¡æ˜¯ä¸€é¡¹éžå¸¸æœ‰ä»·å€¼çš„æŠ€èƒ½ã€‚ æ·±åˆ»çš„å·¥ä½œåœ¨æˆ‘ä»¬åˆ†å¿ƒå……å®žçš„ç»æµŽä¸­å˜å¾—è¶Šæ¥è¶Šå›°éš¾ï¼Œä½†ä¹Ÿå˜å¾—è¶Šæ¥è¶Šé‡è¦å’Œç½•è§ã€‚å°‘æ•°èƒ½å¤Ÿåœ¨æ·±åº¦å·¥ä½œä¸Šåº¦è¿‡çš„æ—¥å­å°†å˜å¾—éžå¸¸å¸‚åœºåŒ–å’ŒæˆåŠŸã€‚ Cal Newportåœ¨â€œ æ·±åŠ å·¥ â€ ä¸€ä¸ªç›‘è§†å™¨æ„å‘³ç€æˆ‘çš„å·¥ä½œ - åªæœ‰æˆ‘çš„å·¥ä½œ - æ˜¾ç¤ºåœ¨å‰é¢å’Œä¸­å¤®ã€‚åˆ†å¿ƒåœç•™åœ¨è§†çº¿ä¹‹å¤–ï¼Œæ‰€ä»¥çœ¼ä¸è§ï¼Œå¿ƒä¸çƒ¦ã€‚ è¿™çœ‹èµ·æ¥åƒæ˜¯ä¸“æ³¨ä¸€é¡¹ä»»åŠ¡å— æˆ‘ä»¬æ¯å¤©åšçš„æœ€æœ‰ä»·å€¼çš„å·¥ä½œä¹‹ä¸€å°±æ˜¯è¦é•¿æœŸä¸“æ³¨äºŽä¸€ä¸ªå•ä¸€çš„åº”ç”¨ç¨‹åºï¼šé˜…è¯»å’Œå†™ä½œã€‚é˜…è¯»å’Œå†™ä½œéƒ½å—ç›ŠäºŽæ¥è‡ªäºŽå±å¹•ä¸Šå”¯ä¸€çš„é‡ç‚¹ã€‚ä¸€æœ¬å¸¦æœ‰ç§»åŠ¨å¾®åšçš„å°æœ¬æœ¬åœ¨æ—è¾¹å°†æ˜¯ä¸€åœºç¾éš¾ã€‚ä½†æ˜¯å¾ˆå¤šäººéƒ½æ„¿æ„åšè¿™ä¸ªã€‚é¢å¤–çš„æ˜¾ç¤ºç»å¸¸å¯¼è‡´æ½œåœ¨çš„æŒç»­åˆ†å¿ƒã€‚å¦‚æžœæ‚¨çš„ç”µå­é‚®ä»¶ï¼Œç¤¾äº¤åª’ä½“ç­‰ä¸å¯è§ï¼Œæ‚¨æ›´æœ‰å¯èƒ½ç»§ç»­å·¥ä½œã€‚ ä½œä¸ºå¼€å‘äººå‘˜ï¼Œæˆ‘æ¯å¤©éƒ½åœ¨ç¼–å†™ä»£ç ã€‚æ‰€ä»¥æˆ‘ç»å¸¸é˜…è¯»æ–‡æ¡£ã€‚ä½†æ˜¯æˆ‘å¾ˆå°‘éœ€è¦åœ¨è¯»æ–‡æ¡£çš„ åŒæ—¶ ç¼–å†™ä»£ç ã€‚æˆ‘è¯»å®Œç›¸å…³çš„æ–‡æ¡£ï¼Œç„¶åŽå†ç¼–ç ã€‚æˆ‘çš„å·¥ä½œæµæ˜¯æ¨¡æ€çš„ã€‚ å‡å°‘çª—å£ç®¡ç†æˆ‘ä½¿ç”¨ä¸€ä¸ªæœˆçš„ 34â€œLGè¶…å®½å±æ˜¾ç¤ºå™¨ï¼Œèµ·åˆï¼Œæˆ‘å–œæ¬¢å®ƒã€‚ ä¸è¿‡ï¼Œè¿‡äº†å‡ å¤©ï¼Œæˆ‘å¾ˆæƒŠè®¶åœ°å‘çŽ°æˆ‘å‡ºäº†ä¸ªé¦Šä¸»æ„ã€‚æˆ‘çš„æ¡Œé¢æœ€å¤§åŒ–ï¼Œå¤ªå®½äº†ï¼Œæ‰€ä»¥æˆ‘å‘çŽ°è‡ªå·±èŠ±äº†å¤ªå¤šçš„æ—¶é—´æ‘†å¼„æ¡Œé¢ã€‚â€œä»Šå¤©åº”è¯¥æ”¾åœ¨å·¦è¾¹å‘¢ï¼Ÿâ€â€œçŽ°åœ¨æœ‰ä»€ä¹ˆé‡è¦çš„äº‹æƒ…å‘¢ï¼Ÿâ€ å½“ç„¶ï¼Œå±å¹•è¶³å¤Ÿå®½ï¼Œå¯ä»¥å¹¶æŽ’æ˜¾ç¤ºå¤šä¸ªçª—å£ï¼Œä½†æ˜¯å®ƒéžå¸¸å®½ï¼Œè¾¹ç¼˜æ„Ÿåˆ°ä¸èˆ’æœã€‚æ‰€ä»¥ï¼Œæˆ‘å‘çŽ°è‡ªå·±ä¸æ–­æŠŠæˆ‘çš„å·¥ä½œè½¬ç§»åˆ°å±å¹•çš„ä¸­å¿ƒï¼Œä»Žè€Œè¿èƒŒäº†ä¹°ä¸€ä¸ªå·¨å¤§çš„æ˜¾ç¤ºå™¨çš„æ•´ä¸ªç›®çš„ï¼Jeff Atwoodå¾ˆä¹…ä»¥å‰åœ¨â€œå¤§åž‹æ˜¾ç¤ºæ‚–è®ºâ€ä¸­è®¨è®ºäº†è¿™ä¸ªé—®é¢˜ã€‚ä»–çš„è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨è½¯ä»¶ç§»åŠ¨å’Œè°ƒæ•´å¤§å°çš„çª—å£æ›´å®¹æ˜“ã€‚æˆ‘çš„è§£å†³æ–¹æ¡ˆï¼Œåªéœ€ä½¿ç”¨ä¸€ä¸ªåˆç†å°ºå¯¸çš„æ˜¾ç¤ºå™¨ã€‚ å³ä½¿ä½¿ç”¨æ–¹ä¾¿çš„çª—å£ç®¡ç†è½¯ä»¶ï¼Œå¤šä¸ªæ˜¾ç¤ºå™¨ä¹Ÿä¼šå‡ºçŽ°é—®é¢˜ï¼šå¦‚æžœæˆ‘æœ‰ä¸¤ä¸ªæ˜¾ç¤ºå™¨ï¼Œå†…å®¹ä¸ä¼šç›´æŽ¥åœ¨æˆ‘çš„å‰é¢ã€‚æˆ‘å¿…é¡»å‘å³æˆ–å‘å·¦è½¬åŠ¨æˆ‘çš„å¤´ï¼ˆç‰¹åˆ«çƒ¦åœ¨è·‘æ­¥æœºä¸Šè¡Œèµ°çš„äººï¼Œå°±åƒæˆ‘ç»å¸¸çœ‹åˆ°çš„é‚£æ ·ï¼‰ã€‚æˆ‘å¯ä»¥æŠŠä¸€ä¸ªç›‘è§†å™¨ç›´æŽ¥æ”¾åœ¨æˆ‘é¢å‰ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªç›‘è§†å™¨ç”šè‡³æ›´è¿œä¸€äº›ï¼Œè¿™ä½¿å¾—å®ƒæ˜¾ç„¶æ˜¯ä¸€ä¸ªäºŒç­‰å…¬æ°‘ã€‚è¿™å†æ¬¡å¯¼è‡´æˆ‘ä»Žæ­£åœ¨å·¥ä½œçš„ä¸­é—´å±å¹•ç§»åŠ¨ã€‚ æ­£å¦‚å·´é‡ŒÂ·æ–½ç“¦èŒ¨ï¼ˆBarry Schwartzï¼‰åœ¨â€œé€‰æ‹©çš„æ‚–è®ºâ€ä¸­æ‰€æŽ¢è®¨çš„é‚£æ ·ï¼Œå†³ç­–ç–²åŠ³æ˜¯ä¸€ä¸ªçœŸæ­£çš„é—®é¢˜ã€‚æœ‰æ—¶å€™ï¼Œå°‘å³æ˜¯å¤šã€‚ â€œé€‰æ‹©ä½¿æˆ‘ä»¬ä¸æ˜¯æ›´è‡ªç”±ï¼Œæ›´ç˜«ç—ªï¼Œä¸å¿«ä¹ï¼Œä½†æ›´ä¸æ»¡æ„ã€‚â€ åªé€šè¿‡ä¸€ä¸ªå±å¹•ï¼Œæˆ‘å†³å®šã€‚æˆ‘ä¸ä¼šæµªè´¹æ—¶é—´å†³å®šåœ¨å“ªé‡Œæ‹–æ›³çª—å£æˆ–æ‘†æ”¾åœ¨ç»™å®šçª—å£çš„ä½ç½®ã€‚æˆ‘æœ€å¤§åŒ–æˆ‘æ­£åœ¨ä½¿ç”¨çš„åº”ç”¨ç¨‹åºï¼Œä»¥é˜»æ­¢æ‰€æœ‰å…¶ä»–åˆ†å¿ƒâ€¦åœ¨ä¸Šç­çš„æ—¶å€™ã€‚ è™šæ‹Ÿæ¡Œé¢ä¸ºèµ¢Macå’ŒWindowsçŽ°åœ¨éƒ½æ”¯æŒè™šæ‹Ÿæ¡Œé¢ã€‚åœ¨æˆ‘çš„Macä¸Šï¼Œæˆ‘å¯ä»¥é€šè¿‡3ä¸ªæ‰‹æŒ‡å¿«é€Ÿåˆ‡æ¢å¤šä¸ªè™šæ‹Ÿæ¡Œé¢ã€‚è¿™éœ€è¦ä¸åˆ°ä¸€ç§’é’Ÿçš„æ—¶é—´ï¼Œå®ƒä¸éœ€è¦æˆ‘è½¬è¿‡å¤´æ¥é‡æ–°èšç„¦æˆ‘çš„çœ¼ç›åœ¨ä¸åŒçš„åœ°æ–¹çš„å†…å®¹ã€‚æˆ‘ä¹Ÿä¸ç”¨æµªè´¹æ—¶é—´å®‰æŽ’ã€‚æœ€å·¦è¾¹çš„è™šæ‹Ÿæ¡Œé¢æ€»æ˜¯æˆ‘çš„æµè§ˆå™¨ï¼Œå³è¾¹æ˜¯æˆ‘çš„ç¼–è¾‘å™¨ã€‚æ‰€ä»¥æˆ‘å°†è™šæ‹Ÿæ¡Œé¢è§†ä¸ºå¯é å‘ˆçŽ°ç›¸åŒå†…å®¹çš„ç‰©ç†å±å¹•ã€‚ é¡¶éƒ¨çš„ä¸‰ä¸ªæ¡†æž¶è¡¨ç¤ºä¸‰ä¸ªè™šæ‹Ÿæ¡Œé¢ã€‚ä¸‰æ‰‹æŒ‡æ»‘åŠ¨å¯ç«‹å³åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ - æ— éœ€å†èŠ±æ—¶é—´æ—‹è½¬æˆ‘çš„å¤´ï¼Œçœ‹ä¸€ä¸ªå•ç‹¬çš„æ˜¾ç¤ºå™¨ã€‚ æˆ‘ç”¨äºŽå®Œæˆå·¥ä½œçš„é¦–é€‰ç›‘è§†å™¨æˆ‘æ›´å–œæ¬¢ä½¿ç”¨ä¸€ä¸ª24â€œ4Kï¼Œä¸ºä»€ä¹ˆ24â€ï¼Ÿå› ä¸ºå¦‚æžœä½ æƒ³å®Œæˆå®žé™…çš„å·¥ä½œï¼Œæ›´å¤§çš„ä¸ä¸€å®šæ›´å¥½ã€‚24â€œè¶³å¤Ÿå¤§ï¼Œå¯ä»¥å…¨å±æ˜¾ç¤ºå•ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒè¶³å¤Ÿå¤§ï¼Œå¯ä»¥åœ¨ç½•è§çš„æƒ…å†µä¸‹å¹¶æŽ’æ˜¾ç¤ºä¸¤ä¸ªåº”ç”¨ç¨‹åºï¼Œæˆ‘çœŸçš„éœ€è¦åŒæ—¶çœ‹åˆ°ä¸¤ä»¶äº‹æƒ…ï¼ˆæˆ‘åœ¨Macä¸Šä½¿ç”¨BetterTouchToolï¼Œåªéœ€å‡»ä¸­Win +ç®­å¤´åœ¨Windowsï¼‰ï¼Œä½†æ˜¯24â€œè¶³å¤Ÿå°ï¼Œæ‚¨å¯ä»¥æœ€å¤§é™åº¦åœ°åˆ©ç”¨æ‰€æœ‰åº”ç”¨ç¨‹åºï¼Œè€Œæ— éœ€ç§»åŠ¨æ‚¨çš„å¤´éƒ¨æˆ–çœ¼ç›å¾ˆå¤šçœ‹åˆ°å±å¹•è¾¹ç¼˜ã€‚è®°ä½ï¼Œæœ€å¤§åŒ–æ‰€æœ‰çš„äº‹æƒ…ã€‚æœ€å¤§åŒ–=é›†ä¸­ã€‚ ä¸ºä»€ä¹ˆæ˜¯4Kï¼Ÿé«˜DPIé™ä½Žç–²åŠ³ã€‚æ–‡å­—æ›´åŠ æ¸…æ™°ã€‚ä»·æ ¼ä¹Ÿæ…¢æ…¢åˆç†äº†ï¼Œæ‰€ä»¥å¦‚æžœä½ è¿˜æ²¡æœ‰é«˜DPIæ˜¾ç¤ºå™¨ï¼Œä¹°ä¸€ä¸ªã€‚è€Œ24â€œ4Kæ¯4Kè‹±å¯¸çš„ç‚¹æ•°è¦å¤§äºŽ4Kå±å¹•ï¼Œæ‰€ä»¥å®ƒæ›´åŠ æ¸…æ™°ã€‚è¿‡åŽ»å‡ å¹´å†…å»ºæˆçš„ä»»ä½•MacBook Proéƒ½å¯ä»¥åœ¨DisplayPortä¸Šä»¥60hzçš„é€Ÿåº¦æŽ¨å‡º4Kæ˜¾ç¤ºå™¨ï¼Œè®¸å¤šæœ€è¿‘çš„Windowsç¬”è®°æœ¬ç”µè„‘ä¹Ÿå¯ä»¥è¿™æ ·åšã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¹ˆå¤šå·¥ä½œè€…éœ€è¦å¤šå°æ˜¾ç¤ºå™¨å‘¢ï¼Ÿæˆ‘ç›¸ä¿¡è¿™æ˜¯æžç«¯ä¸åˆé€»è¾‘çš„è¯±æƒ‘ã€‚ å¤ªå¤šçš„ä¸œè¥¿å˜å¾—ç›¸åã€‚ - è’‚å§†Â·å¼—é‡Œæ–¯ æ˜¾ç¤ºå™¨å¤ªå¤šä¼šå˜å¾—åˆ†å¿ƒã€‚æ‰€ä»¥è¯´åˆ°ç›‘è§†å™¨ï¼Œæˆ‘æ‹¥æŠ±è¿™äº›æƒ³æ³•ï¼š å°‘å³æ˜¯å¤š è´¨é‡è€Œä¸æ˜¯æ•°é‡ å®šåŠ›ï¼Œå®šåŠ›ï¼Œå®šåŠ›ï¼ˆLocation, Location, Locationï¼‰ ã€ç¿»è¯‘åŽŸæ–‡ã€‘:ï¼ˆæœ‰åˆ å‡ï¼‰ https://hackernoon.com/why-i-stopped-using-multiple-monitors-bfd87efa2e5b]]></content>
      <categories>
        <category>workflow</category>
      </categories>
      <tags>
        <tag>performance</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸è¦æ··ç”¨ import å’Œ require]]></title>
    <url>%2F2017%2F07%2F10%2Fdont-mixin-import-and-require.html</url>
    <content type="text"><![CDATA[import æ˜¯ ES6 è§„èŒƒè¯­æ³•ä¹‹ä¸€ã€‚è€Œ require å±žäºŽCommonJSè§„èŒƒçš„ä¸€éƒ¨åˆ†ã€‚ ç›®å‰æ¥è¯´ï¼Œä½¿ç”¨çŽ°ä»£æµè§ˆå™¨è¿˜æ— æ³•æ”¯æŒ importï¼Œä¸€èˆ¬éƒ½ä¼šæ­é… babel ä½¿ç”¨ï¼Œè€Œ babel ä¼šæŠŠ import è½¬æ¢æˆ CommonJS çš„ require. ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½æ··ç”¨ import å’Œ requireã€‚æœ‰æ—¶å€™ä¼šçœ‹ä¸‹å¦‚ä¸‹ä»£ç ï¼š ä½†å®žé™…æ‰§è¡Œé¡ºåºå¹¶ä¸æ˜¯ä½ æƒ³è±¡æˆ–çœ‹åˆ°çš„é‚£æ ·ã€‚import å…·æœ‰å£°æ˜Žæå‡æ•ˆæžœï¼Œä¼šé¦–å…ˆæ‰§è¡Œã€‚æ‰€ä»¥æœ€å¥½ ä¸è¦æ··ç”¨ã€‚ import æ˜¯ ES6 æ ‡å‡†ï¼Œå¦‚æžœå¯èƒ½ï¼Œé¦–å…ˆä½¿ç”¨ import, å¦‚æžœä¸è¡Œï¼Œå°±ç”¨ requireã€‚ ES6 import å…·æœ‰å£°æ˜Žæå‡æ•ˆæžœ æ‚¨å¯ä»¥ä½¿ç”¨å‘½åå¯¼å…¥æ¥é€‰æ‹©æ€§åœ°åŠ è½½æ‰€éœ€çš„éƒ¨åˆ†ã€‚è¿™æ ·å¯ä»¥èŠ‚çœå†…å­˜ï¼Œ å¦‚ï¼šimport { render } from react å¯¼å…¥å¯ä»¥æ˜¯å¼‚æ­¥çš„ ES6 æ ‡å‡† require æ‚¨å¯ä»¥åœ¨åŠ è½½çš„æ¨¡å—åç§°ä¸æ˜¯é¢„å®šä¹‰/é™æ€çš„æƒ…å†µä¸‹è¿›è¡ŒåŠ¨æ€åŠ è½½ï¼Œæˆ–è€…åªæœ‰åœ¨çœŸæ­£éœ€è¦çš„æƒ…å†µä¸‹æ‰æœ‰æ¡ä»¶åœ°åŠ è½½æ¨¡å—ï¼ˆå–å†³äºŽæŸäº›ä»£ç æµï¼‰ CommonJS è§„èŒƒåŠ è½½æ˜¯åŒæ­¥çš„ã€‚è¿™æ„å‘³ç€å¦‚æžœä½ æœ‰å¤šä¸ªrequireï¼Œå®ƒä»¬å°†é€ä¸ªåŠ è½½å’Œå¤„ç†ï¼ˆAMDè§„èŒƒæ˜¯å¯ä»¥å¼‚æ­¥çš„ï¼‰ åªæ˜¯çº¦å®šçš„è§„èŒƒ å‚è€ƒï¼šhttps://twitter.com/dan_abramov/status/883375646357041152]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>import</tag>
        <tag>require</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[reactæ€§èƒ½ä¼˜åŒ–ï¼šæå–å­ç»„ä»¶ä¸­é¢å¤–çš„äº‹ä»¶ç»‘å®š]]></title>
    <url>%2F2017%2F07%2F06%2Freact-pattern-extract-child-components-to-avoid-binding.html</url>
    <content type="text"><![CDATA[reactæ€§èƒ½ä¼˜åŒ–ï¼šæå–å­ç»„ä»¶ä¸­é¢å¤–çš„äº‹ä»¶ç»‘å®šæˆ‘ä»¬ç»å¸¸åœ¨å¿«è¦å®Œæˆä¸€ä¸ªreactä¸­åž‹åº”ç”¨æ—¶ï¼Œå‘çŽ°é¡µé¢å¹¶æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆæµç•…ã€‚ react ç†è®ºæ€§èƒ½æ˜¯ä¸é”™çš„ï¼Œä½†æ˜¯å¯¹å¼€å‘è€…è¦æ±‚ä¹Ÿå¾ˆé«˜ï¼Œä¸€äº›ä¸æ˜“æ³¨æ„çš„ç‚¹å¾ˆå®¹æ˜“é€ æˆæ€§èƒ½é—®é¢˜ã€‚æ­£æ‰€è°“â€œçƒ‚æ³¥æ‰¶ä¸ä¸Šå¢™â€ã€‚ ä¸‹é¢çœ‹çœ‹å­ç»„ä»¶çš„äº‹ä»¶ç»‘å®šå†™æ³•å¯¹æ€§èƒ½çš„å½±å“ã€‚ è¿™æ˜¯Reactä¸­çš„å¸¸è§æƒ…å†µï¼šæ‚¨æ­£åœ¨æ˜ å°„æ•°ç»„ï¼Œæ‚¨éœ€è¦æ¯ä¸ªé¡¹ç›®è°ƒç”¨ç‚¹å‡»å¤„ç†ç¨‹åºå’Œä¸€äº›ç›¸å…³æ•°æ®ã€‚ è¿™æ˜¯ä¸€ä¸ªä¾‹å­ã€‚æˆ‘æ­£åœ¨è¿­ä»£ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ï¼Œå¹¶å°†userIdä¼ é€’ç»™ç¬¬29è¡Œçš„deleteUserå‡½æ•°ã€‚ è¿™æ˜¯Codeandboxä¸Šçš„ä¸€ä¸ªå·¥ä½œç¤ºä¾‹ã€‚ï¼ˆçœŸæ£’ï¼‰ æ‰€ä»¥, æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿæˆ‘åœ¨ç‚¹å‡»å¤„ç†ç¨‹åºä¸­ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚è¿™æ„å‘³ç€æ¯æ¬¡æ¸²æŸ“è¿è¡Œæ—¶ï¼Œéƒ½ä¼šåˆ†é…ä¸€ä¸ªæ–°å‡½æ•°ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™ä¸æ˜¯ä¸€ä»¶å¤šå¤§çš„äº‹ã€‚ä½†æ˜¯ï¼Œå¦‚æžœæ‚¨æœ‰å­ç»„ä»¶ï¼Œå³ä½¿æ•°æ®æ²¡æœ‰æ›´æ”¹ï¼Œå®ƒä»¬ä¹Ÿå°†é‡æ–°æ¸²æŸ“ï¼Œå› ä¸ºæ¯ä¸ªæ¸²æŸ“åˆ†é…ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚ åº•çº¿ï¼šé¿å…åœ¨æ¸²æŸ“ä¸­å£°æ˜Žç®­å¤´å‡½æ•°æˆ–ç»‘å®šä»¥èŽ·å¾—æœ€ä½³æ€§èƒ½ã€‚æˆ‘çš„å›¢é˜Ÿä½¿ç”¨è¿™ä¸ªESLintè§„åˆ™å¸®åŠ©æé†’æˆ‘ä»¬è¿™ä¸ªé—®é¢˜ã€‚ è§£å†³æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿé‚£ä¹ˆä½ å¦‚ä½•åœ¨æ¸²æŸ“ä¸­é¿å…ç»‘å®šå’Œç®­å¤´å‡½æ•°å‘¢ï¼Ÿä¸€ä¸ªé€‰é¡¹æ˜¯æå–ä¸€ä¸ªå­ç»„ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†åˆ—è¡¨é¡¹æå–åˆ°UserListItem.jsï¼š ç„¶åŽï¼Œçˆ¶ç»„ä»¶çš„æ¸²æŸ“å˜å¾—æ›´ç®€å•ï¼Œä¸å†éœ€è¦åŒ…å«ç®­å¤´å‡½æ•°ã€‚å®ƒåªæ˜¯é€šè¿‡propsä¼ é€’æ¯ä¸ªåˆ—è¡¨é¡¹çš„ç›¸å…³ä¸Šä¸‹æ–‡ï¼š è¿™æ˜¯ä¸€ä¸ªé‡æž„çš„å·¥ä½œå®žä¾‹ã€‚ Yay or Yuck?æ­¤æ¨¡å¼é€šè¿‡æ¶ˆé™¤å†—ä½™çš„å‡½æ•°åˆ†é…æ¥æé«˜æ€§èƒ½ã€‚æ‰€ä»¥å½“è¿™ç§æƒ…å†µé€‚ç”¨äºŽæ‚¨çš„ç»„ä»¶æ—¶ï¼Œå®ƒæ˜¯æœ€æœ‰ç”¨çš„ï¼š æ¸²æŸ“é¢‘ç¹è¢«è°ƒç”¨ æ¸²æŸ“å­ç»„ä»¶éžå¸¸è€—æ—¶ è¯šç„¶ï¼Œæˆ‘æå–å­ç»„ä»¶ä¹Ÿæ˜¯æˆ‘æåˆ°çš„ä¸€ä¸ªé¢å¤–çš„å·¥ä½œã€‚å®ƒéœ€è¦æ›´å¤šçš„ç§»åŠ¨éƒ¨ä»¶å’Œæ›´å¤šçš„ä»£ç ã€‚æ‰€ä»¥å¦‚æžœä½ æ²¡æœ‰å‡ºçŽ°æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥è¯´è¿™æ˜¯ä¸€ä¸ªè¿‡æ—©çš„ä¼˜åŒ–ã€‚ æ‰€ä»¥ä½ æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šå…è®¸ç®­å¤´å’Œç»‘å®šåˆ°ä»»ä½•åœ°æ–¹ï¼ˆå¦‚æžœæœ‰æ€§èƒ½é—®é¢˜å†å¤„ç†ï¼‰ï¼Œæˆ–ç¦æ­¢ä»–ä»¬èŽ·å¾—æœ€ä½³æ€§èƒ½å’Œä¸€è‡´æ€§ã€‚ åº•çº¿ï¼šæˆ‘å»ºè®®ç¦æ­¢ç®­å¤´å‡½æ•°å¹¶åœ¨renderä¸­ç»‘å®šã€‚ä¸‹é¢å°±æ˜¯ä¸ºä»€ä¹ˆï¼š ä½ å¿…é¡»ç¦ç”¨æˆ‘ä¸Šé¢å»ºè®®çš„æœ‰ç”¨çš„ESLintè§„åˆ™æ¥å…è®¸å®ƒã€‚ ç¦ç”¨lintingè§„åˆ™åŽï¼Œäººä»¬å¯èƒ½ä¼šå¤åˆ¶æ­¤æ¨¡å¼ï¼Œå¹¶å¼€å§‹ç¦ç”¨å…¶ä»–lintingè§„åˆ™ã€‚ä¸€ä¸ªå¤„ä¾‹å¤–å¯ä»¥å¾ˆå¿«æˆä¸ºè§„èŒƒâ€¦ General rule for code reviews:Each line of code should be worthy of copying. Because people will.#cleancodeâ€” Cory House ðŸ  (@housecor) March 8, 2017 æ‰€ä»¥æˆ‘å‘çŽ°æå–å­ç»„ä»¶æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„æ¨¡å¼ï¼Œä»¥é¿å…åœ¨æ¸²æŸ“ä¸­ç»‘å®šã€‚ å…¶ä»–çš„åä¾‹è¿˜æœ‰äº›äººä¼šæƒ³è¦è¿™æ ·å†™ï¼š deleteUser = id=() => { this.setState(prevState => { return { users: prevState.users.filter( user => user.id !== id)} }) } // â€¦ onClick={this.deleteUser(user.id)} ä»–ä»¬è®¤ä¸ºä¼ é€’å‚æ•°ä¼šæ¯”å…¶ä»–æ–¹å¼æ›´åŠ æ–¹ä¾¿ã€‚ä½†è¿™å’Œç¬¬ä¸€ä¸ªç³Ÿç³•çš„ä¾‹å­å¹¶æ— å¤ªå¤§åŒºåˆ«ï¼Œå­ç»„ä»¶åŒæ ·ä¼šå†æ¬¡æ¸²æŸ“ã€‚ å¦‚æžœæœ‰ç›¸å½“å¤šç±»ä¼¼çš„è¾“å…¥æ¡†ï¼Œåƒè¿™æ ·ï¼š &lt;form> Render = () => Input1 value=this.state.input1 onChange= update state for field1 Input2â€¦. Input3â€¦. å®˜æ–¹ç»™å‡ºçš„æ–¹æ³•æ˜¯ç»™æ¯ä¸ª input æ·»åŠ  name å±žæ€§ï¼Œè¿›è€ŒèŽ·å–å‚æ•°ã€‚ å½“ç„¶ä¹Ÿæœ‰äººä¼šæƒ³è¦åœ¨ html ä¸ŠåŠ¨æ–‡ç« ï¼Œæ¯”å¦‚æ·»åŠ è‡ªå®šä¹‰å±žæ€§ data-id=${userId}ã€‚è¿™å½“ç„¶ä¹Ÿèƒ½å®žçŽ°ï¼Œä½†æ˜¯ htmlä¸åº”è¯¥æ˜¯æ•°æ®æºï¼Œè¿™åº”è¯¥é¿å…ã€‚ ã€ç¿»è¯‘åŽŸæ–‡ã€‘:(æœ‰æ”¹åŠ¨)https://medium.freecodecamp.org/react-pattern-extract-child-components-to-avoid-binding-e3ad8310725e]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•ä½¿ç”¨Memoizeæ¥ç¼“å­˜JavaScriptå‡½æ•°ç»“æžœå¹¶åŠ å¿«ä»£ç çš„é€Ÿåº¦]]></title>
    <url>%2F2017%2F07%2F04%2Funderstanding-memoize-in-javascript.html</url>
    <content type="text"><![CDATA[Function æ˜¯ç¼–ç¨‹çš„ç»„æˆéƒ¨åˆ†ã€‚å®ƒä»¬æœ‰åŠ©äºŽä¸ºæˆ‘ä»¬çš„ä»£ç å¢žåŠ æ¨¡å—åŒ–å’Œå¯é‡ç”¨æ€§ã€‚ å°†ç¨‹åºåˆ’åˆ†ä¸ºå¤§å—æ˜¯å¾ˆå¸¸è§çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ç¨åŽå¯ä»¥ä½¿ç”¨è¿™äº›åŠŸèƒ½æ¥æ‰§è¡Œä¸€äº›æœ‰ç”¨çš„æ“ä½œã€‚ æœ‰æ—¶ï¼Œå¤šæ¬¡è°ƒç”¨åŠŸèƒ½å¯èƒ½ä¼šå˜å¾—æ˜‚è´µï¼ˆæ¯”å¦‚ï¼Œè®¡ç®—ä¸€ä¸ªæ•°å­—çš„é˜¶ä¹˜çš„å‡½æ•°ï¼‰ã€‚ä½†æ˜¯æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥ä¼˜åŒ–è¿™äº›åŠŸèƒ½ï¼Œä½¿å®ƒä»¬æ‰§è¡Œå¾—æ›´å¿«ï¼šç¼“å­˜ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬functionè¦è¿”å›žä¸€ä¸ªæ•°å­—çš„é˜¶ä¹˜ï¼š function factorial(n) { // Calculations: n * (n-1) * (n-2) * ... (2) * (1) return factorial } éžå¸¸å¥½ï¼ŒçŽ°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹factorial(50)ã€‚è®¡ç®—æœºä¼šæ‰§è¡Œè®¡ç®—ï¼Œå¹¶è¿”å›žç»™æˆ‘ä»¬æœ€åŽçš„ç­”æ¡ˆï¼Œä¸é”™ï¼ å®ŒæˆåŽï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹factorial(51)ã€‚è®¡ç®—æœºå†æ¬¡æ‰§è¡Œä¸€äº›è®¡ç®—å¹¶èŽ·å¾—ç»“æžœï¼Œä½†æ˜¯æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°æˆ‘ä»¬å·²ç»é‡å¤äº†å¯ä»¥é¿å…çš„ä¸€äº›æ­¥éª¤ã€‚ä¼˜åŒ–çš„æ–¹å¼æ˜¯ï¼š factorial(51) = factorial(50) * 51; ä½†æ˜¯æˆ‘ä»¬functionæ¯æ¬¡è°ƒç”¨æ—¶éƒ½ä¼šä»Žå¤´å¼€å§‹æ‰§è¡Œè®¡ç®—ï¼š factorial(51) = 51 * 50 * 49 * ... * 2 * 1 å¦‚æžœæˆ‘ä»¬çš„å‡½æ•°factorialèƒ½è®°ä½å®ƒä¹‹å‰è¿ç®—çš„ç»“æžœå¹¶ç”¨å®ƒæ¥æäº¤è¿è¡Œæ•ˆçŽ‡ï¼Œé‚£ä¸æ˜¯å¾ˆé…·å—ï¼Ÿ è°ˆåˆ°Memoizationï¼Œä¸€ç§è®©æˆ‘ä»¬çš„functionè®°ä½ï¼ˆç¼“å­˜ï¼‰ç»“æžœçš„æ–¹å¼ã€‚æ—¢ç„¶æ‚¨å¯¹æˆ‘ä»¬è¦å®žçŽ°çš„ç›®æ ‡æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªæ­£å¼çš„å®šä¹‰ï¼š Memoizationæ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºŽé€šè¿‡ å­˜å‚¨æ˜‚è´µçš„å‡½æ•°è°ƒç”¨çš„ç»“æžœ æ¥åŠ é€Ÿè®¡ç®—æœºç¨‹åºï¼Œå¹¶åœ¨ç›¸åŒçš„è¾“å…¥å†æ¬¡å‘ç”Ÿæ—¶è¿”å›žç¼“å­˜çš„ç»“æžœ. è®°ä½ç®€å•çš„ä¸œè¥¿æ„å‘³ç€è®°å¿†æˆ–å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚è®°å¿†å‡½æ•°é€šå¸¸æ›´å¿«ï¼Œå› ä¸ºå¦‚æžœéšåŽä½¿ç”¨å…ˆå‰çš„å€¼è°ƒç”¨è¯¥å‡½æ•°ï¼Œæˆ‘ä»¬å°†ä»Žç¼“å­˜ä¸­èŽ·å–ç»“æžœæ¥ä»£æ›¿æ‰§è¡Œè¯¥å‡½æ•°ï¼Œã€‚ è¿™çœ‹èµ·æ¥åƒä¸€ä¸ªç®€å•çš„è®°å¿†å‡½æ•°ï¼ˆå¦‚æžœä½ æƒ³è¿›è¡Œæµ‹è¯•å®ƒï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªCodePenï¼‰ï¼š // a simple function to add something const add = (n) => (n + 10); add(9); // a simple memoized function to add something const memoizedAdd = () => { let cache = {}; return (n) => { if (n in cache) { console.log('Fetching from cache'); return cache[n]; } else { console.log('Calculating result'); let result = n + 10; cache[n] = result; return result; } } } // returned function from memoizedAdd const newAdd = memoizedAdd(); console.log(newAdd(9)); // calculated console.log(newAdd(9)); // cached Memoization è¦ç‚¹ä»¥ä¸Šä»£ç çš„ä¸€äº›è¦ç‚¹æ˜¯ï¼š memoizedAddè¿”å›žä¸€ä¸ªfunctionä»¥ä¾¿ç¨åŽè°ƒç”¨çš„ã€‚è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºåœ¨JavaScriptä¸­ï¼Œå‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå®ƒä»¬å¯ä»¥å°†å®ƒä»¬ç”¨ä½œé«˜é˜¶çš„å‡½æ•°å¹¶è¿”å›žå¦ä¸€ä¸ªå‡½æ•°ã€‚ cacheå¯ä»¥è®°ä½å®ƒçš„å€¼ï¼Œå› ä¸ºè¿”å›žçš„å‡½æ•°è¢«é—­åŒ…å°è£…äº†ã€‚ memoizedåŠŸèƒ½çº¯ç²¹(Pure)æ˜¯è‡³å…³é‡è¦çš„ã€‚çº¯å‡½æ•°å°†ä¸ºç‰¹å®šè¾“å…¥è¿”å›žç›¸åŒçš„è¾“å‡ºï¼Œè€Œä¸éœ€è¦è°ƒç”¨å¤šå°‘æ¬¡ï¼Œè¿™ä½¿å¾—cacheæŒ‰é¢„æœŸçš„å·¥ä½œã€‚ ç¼–å†™è‡ªå·±çš„ memoize åŠŸèƒ½ä»¥å‰çš„ä»£ç å·¥ä½œæ­£å¸¸ï¼Œä½†å¦‚æžœæˆ‘ä»¬æƒ³å°†ä»»ä½•å‡½æ•°è½¬æ¢ä¸ºè®°å¿†å‡½æ•°å‘¢ï¼Ÿ ä»¥ä¸‹æ˜¯å¦‚ä½•ç¼–å†™è‡ªå·±çš„memoizeå‡½æ•°ï¼ˆcodepenï¼‰ï¼š // a simple pure function to get a value adding 10 const add = (n) => (n + 10); console.log('Simple call', add(3)); // a simple memoize function that takes in a function // and returns a memoized function const memoize = (fn) => { let cache = {}; return (...args) => { let n = args[0]; // just taking one argument here if (n in cache) { console.log('Fetching from cache'); return cache[n]; } else { console.log('Calculating result'); let result = fn(n); cache[n] = result; return result; } } } // creating a memoized function for the 'add' pure function const memoizedAdd = memoize(add); console.log(memoizedAdd(3)); // calculated console.log(memoizedAdd(3)); // cached console.log(memoizedAdd(4)); // calculated console.log(memoizedAdd(4)); // cached è¿™å¾ˆæ£’ï¼è¿™ä¸ªç®€å•çš„memoizeåŠŸèƒ½å°†ä»»ä½•ç®€å•çš„functionå°è£…æˆä¸€ä¸ªæœ‰è®°å¿†æ€§çš„ç­‰ä»·ç‰©ã€‚è¯¥ä»£ç é€‚ç”¨äºŽç®€å•çš„åŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®æ‚¨çš„éœ€è¦è½»æ¾è°ƒæ•´å¤„ç†ä»»æ„æ•°é‡çš„argumentsä»£ç ã€‚å¦ä¸€ä¸ªé€‰æ‹©æ˜¯åˆ©ç”¨ä¸€äº›çš„ç±»åº“ï¼Œå¦‚ï¼š Lodashçš„_.memoize(func, [resolver]) æ¥è‡ªdeckoçš„ ES7 @memoize è£…é¥°å™¨ è®°å¿†é€’å½’å‡½æ•°å¦‚æžœæ‚¨å°è¯•å°†é€’å½’å‡½æ•°ä¼ é€’åˆ°memoizeä¸Šé¢çš„å‡½æ•°æˆ–Lodashçš„_.memoizeå‡½æ•°ï¼Œç»“æžœå°†ä¸ä¼šå¦‚é¢„æœŸçš„é‚£æ ·ï¼Œå› ä¸ºå…¶åŽç»­è°ƒç”¨çš„é€’å½’å‡½æ•°å°†æœ€ç»ˆè°ƒç”¨è‡ªèº«è€Œä¸æ˜¯è®°å¿†å‡½æ•°ï¼Œä»Žè€Œä¸å†ä½¿ç”¨cacheã€‚ åªéœ€ç¡®ä¿é€’å½’å‡½æ•°è°ƒç”¨è®°å¿†å‡½æ•°ã€‚è¿™é‡Œæ˜¯ä½ å¦‚ä½•è°ƒæ•´æ•™ç§‘ä¹¦é˜¶ä¹˜ä¾‹å­ï¼ˆcodepenï¼‰ï¼š // same memoize function from before const memoize = (fn) => { let cache = {}; return (...args) => { let n = args[0]; if (n in cache) { console.log('Fetching from cache', n); return cache[n]; } else { console.log('Calculating result', n); let result = fn(n); cache[n] = result; return result; } } } const factorial = memoize( (x) => { if (x === 0) { return 1; } else { return x * factorial(x - 1); } } ); console.log(factorial(5)); // calculated console.log(factorial(6)); // calculated for 6 and cached for 5 ä»Žè¿™æ®µä»£ç æ³¨æ„å‡ ç‚¹ï¼š è¯¥factorialå‡½æ•°é€’å½’åœ°è°ƒç”¨è‡ªå·±çš„è®°å¿†ç‰ˆæœ¬ã€‚ è®°å¿†åŠŸèƒ½æ˜¯ç¼“å­˜å…ˆå‰é˜¶ä¹˜çš„å€¼ï¼Œä»Žè€Œå¯ä»¥é‡å¤ä½¿ç”¨ï¼Œä»Žè€Œæ˜¾ç€æ”¹å–„äº†è®¡ç®— factorial(6) = 6 * factorial(5) memoization æ˜¯å¦ä¸Ž caching ç›¸åŒï¼Ÿæ˜¯çš„ï¼Œæœ‰ç‚¹ã€‚Memoizationå®žé™…ä¸Šæ˜¯ä¸€ç§ç‰¹å®šç±»åž‹çš„ç¼“å­˜ã€‚è™½ç„¶ç¼“å­˜é€šå¸¸å¯ä»¥å¼•ç”¨ä»»ä½•å­˜å‚¨æŠ€æœ¯ï¼ˆå¦‚HTTPç¼“å­˜ï¼‰ä»¥ä¾›å°†æ¥ä½¿ç”¨ï¼Œä½†æ˜¯memoizingç‰¹æŒ‡è°ƒç”¨ç¼“å­˜çš„functionè¿”å›žå€¼ã€‚ ä»€ä¹ˆæ—¶å€™è®°å½•ä½ çš„ functionsè™½ç„¶å¯èƒ½çœ‹èµ·æ¥ memoize å¯ä»¥ä¸Žæ‰€æœ‰å‡½æ•°ä¸€èµ·ä½¿ç”¨ï¼Œä½†å®ƒå®žé™…ä¸Šæœ‰é™åˆ¶çš„ç”¨ä¾‹ï¼š ä¸ºäº†è®°å¿†ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒåº”è¯¥æ˜¯çº¯ç²¹çš„ï¼ˆpureï¼‰ï¼Œæ‰€ä»¥æ¯æ¬¡è¿”å›žå€¼å¯¹äºŽç›¸åŒçš„è¾“å…¥æ˜¯ç›¸åŒçš„ è®°å¿†æ˜¯å¢žåŠ çš„ç©ºé—´å’Œå¢žåŠ çš„é€Ÿåº¦ä¹‹é—´çš„æƒè¡¡ï¼Œå› æ­¤å¯¹äºŽå…·æœ‰æœ‰é™çš„è¾“å…¥èŒƒå›´çš„åŠŸèƒ½è€Œè¨€æ˜¯é‡è¦çš„ï¼Œä»¥ä¾¿å¯ä»¥æ›´é¢‘ç¹åœ°ä½¿ç”¨ç¼“å­˜çš„å€¼ å®ƒå¯èƒ½çœ‹èµ·æ¥åƒæ‚¨è®°ä½æ‚¨çš„APIè°ƒç”¨ï¼Œä½†è¿™å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šä¸ºæ‚¨è‡ªåŠ¨ç¼“å­˜å®ƒä»¬ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…HTTPç¼“å­˜ æˆ‘å‘çŽ°ç”¨äºŽè®°å¿†åŠŸèƒ½çš„æœ€ä½³ç”¨ä¾‹æ˜¯ é‡åº¦è®¡ç®—åŠŸèƒ½ï¼Œå¯ä»¥æ˜¾ç€æé«˜æ€§èƒ½ï¼ˆé˜¶ä¹˜å’Œæ–æ³¢é‚£å¥‘ä¸æ˜¯çœŸæ­£çŽ°å®žä¸–ç•Œçš„ä¾‹å­ï¼‰ å¦‚æžœæ‚¨è¿›å…¥React / Reduxï¼Œæ‚¨å¯ä»¥æ£€æŸ¥é‡æ–°é€‰æ‹©å“ªä¸ªä½¿ç”¨è®°å¿†é€‰æ‹©å™¨ï¼Œä»¥ç¡®ä¿ä»…åœ¨çŠ¶æ€æ ‘çš„ç›¸å…³éƒ¨åˆ†å‘ç”Ÿæ›´æ”¹æ—¶è¿›è¡Œè®¡ç®—ã€‚ è¿›ä¸€æ­¥é˜…è¯»å¦‚æžœæ‚¨æƒ³æ›´è¯¦ç»†åœ°äº†è§£æœ¬æ–‡ä¸­çš„ä¸€äº›ä¸»é¢˜ï¼Œä»¥ä¸‹é“¾æŽ¥å¯èƒ½å¾ˆæœ‰ç”¨ï¼š JavaScriptä¸­çš„é«˜é˜¶å‡½æ•° JavaScripté—­åŒ… çº¯å‡½æ•° Lodashçš„_.memoize æ–‡æ¡£å’Œæºä»£ç  æ›´å¤šçš„memoizationä¾‹å­åœ¨è¿™é‡Œå’Œè¿™é‡Œ reactjs/reSelect ã€ç¿»è¯‘åŽŸæ–‡ã€‘: https://medium.freecodecamp.org/understanding-memoize-in-javascript-51d07d19430e]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Memoize</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[css3ä¸­background-position çš„å››å€¼è¯­æ³•]]></title>
    <url>%2F2017%2F07%2F04%2Fbackground-position-of-css3-about-four-value-syntax.html</url>
    <content type="text"><![CDATA[css3ä¸­background-positionçš„å››å€¼è¯­æ³•åˆ¨æ ¹é—®åº•ï¼Œæ¯ä¸ªcsså±žæ€§éƒ½è¦çŸ¥é“å®ƒçš„æ‰€æœ‰å€¼å®žåœ¨ä¸å®¹æ˜“ã€‚ä»Šå¤©çœ‹çœ‹ background-position. background-positionCSSä¸­çš„å±žæ€§å…è®¸æ‚¨åœ¨å…¶å®¹å™¨å†…ç§»åŠ¨èƒŒæ™¯å›¾åƒï¼ˆæˆ–æ¸å˜ï¼‰ã€‚ ç®€ä»‹html { background-position: 100px 5px; } å®ƒæœ‰ä¸‰ç§ä¸åŒçš„å–å€¼ï¼š é•¿åº¦å€¼ï¼ˆä¾‹å¦‚100px 5pxï¼‰ ç™¾åˆ†æ¯”ï¼ˆä¾‹å¦‚100% 5%ï¼‰ å…³é”®å­—ï¼ˆä¾‹å¦‚top rightï¼‰ é»˜è®¤å€¼ä¸º0 0ã€‚è¿™ä¼šå°†æ‚¨çš„èƒŒæ™¯å›¾åƒæ”¾åœ¨å®¹å™¨çš„å·¦ä¸Šè§’ã€‚ é•¿åº¦å€¼å¾ˆç®€å•ï¼šç¬¬ä¸€ä¸ªå€¼æ˜¯æ°´å¹³ä½ç½®ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯åž‚ç›´ä½ç½®ã€‚å› æ­¤ï¼Œ100px 5pxå°†å›¾åƒå‘å³ç§»åŠ¨100åƒç´ ï¼Œå‘ä¸‹ç§»åŠ¨äº”ä¸ªåƒç´ ã€‚æ‚¨å¯ä»¥è®¾å®šé•¿åº¦å€¼å•ä½ä¸ºpxï¼Œemæˆ–ä»»ä½•å…¶ä»–çš„CSSé•¿åº¦å€¼ã€‚ ç™¾åˆ†æ¯”æœ‰æ‰€ä¸åŒã€‚æˆ´ä¸Šä½ çš„æ•°å­¦å¸½å­ï¼šç”¨xï¼…ç§»åŠ¨èƒŒæ™¯å›¾åƒæ„å‘³ç€ å°†å›¾åƒä¸­çš„Xï¼…ç‚¹ ä¸Ž å®¹å™¨ä¸­çš„Xï¼…ç‚¹ å¯¹é½(PSï¼šå¾ˆå¤šäººè§£é‡Šçš„æ—¶å€™åªä¼šè¯´å‘å·¦å‘ä¸‹ç§»åŠ¨äº†x%,è¿™å°±æ— æ³•è§£é‡Š50%)ã€‚ä¾‹å¦‚ï¼Œ50%æ„å‘³ç€å®ƒä¼šå°†å›¾åƒçš„ä¸­é—´ä¸Žå®¹å™¨çš„ä¸­é—´å¯¹é½ã€‚100%æ„å‘³ç€å®ƒä¼šå°†å›¾åƒçš„æœ€åŽä¸€ä¸ªåƒç´ ä¸Žå®¹å™¨çš„æœ€åŽä¸€ä¸ªåƒç´ å¯¹é½ï¼Œä¾æ­¤ç±»æŽ¨ã€‚ å…³é”®å­—åªæ˜¯ç™¾åˆ†æ¯”çš„æ·å¾„ã€‚è¿™top rightæ¯”è®°ä½å’Œå†™ä½œè¦å®¹æ˜“å¾—å¤š0 100%ï¼Œè¿™å°±æ˜¯å…³é”®å­—çš„æ„ä¹‰ã€‚ä»¥ä¸‹æ˜¯æ‰€æœ‰äº”ä¸ªå…³é”®å­—åŠå…¶ç­‰ä»·å–å€¼çš„åˆ—è¡¨ï¼š topï¼šåž‚ç›´0ï¼… rightï¼šæ°´å¹³100ï¼… bottomï¼šåž‚ç›´100ï¼… leftï¼šæ°´å¹³0ï¼… centerï¼šå¦‚æžœæ°´å¹³å°šæœªå®šä¹‰ï¼Œåˆ™æ°´å¹³ä¸º50ï¼…ã€‚å¦‚æžœå®šä¹‰äº†åˆ™åº”ç”¨åˆ°åž‚ç›´ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œæ‚¨å…³é”®å­—ä½¿ç”¨çš„é¡ºåºå¹¶ä¸é‡è¦ï¼šä¸Žä¹‹top centerç›¸åŒcenter topã€‚åªæœ‰å½“æ‚¨ä½¿ç”¨å•ä¸€å…³é”®å­—æ—¶ï¼Œæ‚¨æ‰èƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚center 10%æ˜¯ä¸ä¸€æ ·çš„10% centerã€‚ æ¼”ç¤ºæ­¤æ¼”ç¤ºæ¼”ç¤ºäº†background-positionå…·æœ‰é•¿åº¦å•ä½ï¼Œç™¾åˆ†æ¯”å’Œå…³é”®å­—å–å€¼çš„é›†åˆç¤ºä¾‹ã€‚ See the Pen background-position values by CSS-Tricks (@css-tricks) on CodePen. å£°æ˜Žå€¼(Declaring Values)background-positionçŽ°ä»£æµè§ˆå™¨ä¸­æœ€å¤šå¯ä»¥æ”¾ç½®å››ä¸ªå€¼ï¼ˆæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æµè§ˆå™¨æ”¯æŒåˆ—è¡¨ï¼‰ã€‚ å¦‚æžœæ‚¨åªå£°æ˜Ž ä¸€ä¸ªå€¼ï¼Œåˆ™è¯¥å€¼æ˜¯æ°´å¹³åç§»é‡ã€‚æµè§ˆå™¨å°†åž‚ç›´åç§»è®¾ç½®ä¸ºcenterã€‚ å½“æ‚¨å£°æ˜Ž ä¸¤ä¸ªå€¼ æ—¶ï¼Œç¬¬ä¸€ä¸ªå€¼æ˜¯æ°´å¹³åç§»é‡ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯åž‚ç›´åç§»é‡ã€‚ å½“æ‚¨å¼€å§‹ä½¿ç”¨ä¸‰ä¸ªæˆ–å››ä¸ªå€¼æ—¶ï¼Œäº‹æƒ…ä¼šå˜å¾—æ›´åŠ æ£˜æ‰‹ï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥æ›´å¥½åœ°æŽ§åˆ¶æ‚¨çš„èƒŒæ™¯ä½ç½®ã€‚ ä¸‰æˆ–å››å€¼è¯­æ³•åœ¨å…³é”®å­—å’Œé•¿åº¦æˆ–ç™¾åˆ†æ¯”å•ä½ä¹‹é—´è¿›è¡Œäº¤æ›¿ã€‚æ‚¨å¯ä»¥åœ¨background-positionçš„ä¸‰å€¼æˆ–å››å€¼ä¸­ä½¿ç”¨ä»»ä½•å…³é”®å­—å€¼ï¼Œ _é™¤_ centerä¹‹å¤–ã€‚ å½“æ‚¨æŒ‡å®š ä¸‰ä¸ªå€¼ æ—¶ï¼Œæµè§ˆå™¨å°†â€œä¸¢å¤±â€ç¬¬å››ä¸ªå€¼æ’å…¥ä¸º0.ä»¥ä¸‹æ˜¯ä¸‰å€¼çš„ç¤ºä¾‹background-positionï¼š #threevalues { background-position: right 45px bottom; } è¿™æ ·å°±å¯ä»¥å°†èƒŒæ™¯å›¾åƒå®šä½åœ¨å³ä¾§çš„45pxå’Œå®¹å™¨åº•éƒ¨çš„0pxã€‚ è¿™æ˜¯ä¸€ä¸ªbackground-position å››å€¼ çš„ä¾‹å­ï¼š #fourvalues { background-position: right 45px bottom 20px; } è¿™å°†èƒŒæ™¯å›¾ç‰‡å®šä½åœ¨å³ä¾§çš„45pxå’Œå®¹å™¨åº•éƒ¨çš„20pxã€‚ æ³¨æ„ä¸Šé¢ç¤ºä¾‹ä¸­å€¼çš„é¡ºåºï¼šå…³é”®å­—åŽè·Ÿé•¿åº¦å•ä½ã€‚ä¸‰æˆ–å››ä¸ªå€¼background-positionå¿…é¡»éµå¾ªè¯¥æ ¼å¼ï¼Œå…³é”®å­—åœ¨é•¿åº¦æˆ–ç™¾åˆ†æ¯”å•ä½ä¹‹å‰ã€‚ æ¼”ç¤ºæ­¤æ¼”ç¤ºåŒ…æ‹¬ä¸€ä¸ªå€¼ï¼Œä¸¤ä¸ªå€¼ï¼Œä¸‰ä¸ªå€¼å’Œå››ä¸ªå€¼çš„ç¤ºä¾‹background-positionã€‚ See the Pen background-position 1, 2, 3, and 4 value syntax by CSS-Tricks (@css-tricks) on CodePen. æ›´å¤šå‚è€ƒ background-position åœ¨CSS3è§„èŒƒ background-position åœ¨MDN åç§»èƒŒæ™¯å›¾åƒ browser-supportåŸºæœ¬ä»·å€¼å¾—åˆ°æ”¯æŒã€‚å››å€¼è¯­æ³•å…·æœ‰æ­¤æ”¯æŒï¼š Chrome Safari Firefox Opera IE Android iOS 25+ 7+ 13+ 10.5+ 9+ 4+ 7.1+ ã€ç¿»è¯‘åŽŸæ–‡ï¼šã€‘https://css-tricks.com/almanac/properties/b/background-position/]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>background</tag>
        <tag>css3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Arrayæ•°ç»„çš„indexOfã€includes vs for-loopæ€§èƒ½æ¯”è¾ƒ]]></title>
    <url>%2F2017%2F07%2F03%2Farr-of-indexOf-vs-includes-and-for-loop.html</url>
    <content type="text"><![CDATA[Arrayæ•°ç»„çš„indexOfã€includes vs for-loopæ€§èƒ½æ¯”è¾ƒæœ€è¿‘é‡åˆ°ä¸€é“ç®—æ³•é¢˜ï¼Œç„¶åŽæœ‰äº›äººä¼šä½¿ç”¨ includesã€indexOf åŽ»åˆ¤æ–­æ˜¯å¦å­˜åœ¨å¦ä¸€ä¸ªæ•°ã€‚è¿™è®©æˆ‘ä¸ç¦æ€è€ƒï¼Œè¿™å’Œ for loopæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œèƒ½å‡å°‘æ—¶é—´å¤æ‚åº¦å—ï¼Ÿæˆ‘ä¸€å¼€å§‹ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œä½†æˆ‘å¯ä»¥æ‰¾æ–‡æ¡£ï¼Œæ‰¾æ ‡å‡†ã€‚æˆ‘çš„ç¬¬ä¸€åˆ¤æ–­æ˜¯ includes å®Œå…¨å’Œ for loopæ²¡æœ‰åŒºåˆ«çš„ï¼Œåªæ˜¯es6 æ ‡å‡†è§„èŒƒæä¾›çš„è¯­æ³•ç³–ï¼Œè€Œ indexOf è¿˜æ˜¯æœ‰ä¸€å®šæ•ˆçŽ‡çš„ã€‚å¸¦ç€ç–‘æƒ‘ï¼ŒæŸ¥çœ‹ MDN å’Œ ecma-262 includesincludes æ˜¯ ES6 æ–°å¢žè¯­æ³•ï¼Œè¿”å›ž å¸ƒå°”å€¼ã€‚æœ€å®¹æ˜“æ‹¿ indexOf æ¥æ¯”è¾ƒï¼Œ indexOf ä¸èƒ½åˆ¤æ–­ NaN, è€Œä¸”ä¸å¤Ÿè¯­ä¹‰ï¼Œè¿”å›žçš„æ˜¯ åŒ¹é…å€¼çš„ä½ç½® æˆ– -1ã€‚ includes å†…éƒ¨å®žçŽ°æ˜¯è¿™æ ·çš„ï¼š Let O be ? ToObject(this value). Let len be ? ToLength(? Get(O, â€œlengthâ€)). If len is 0, return false. Let n be ? ToInteger(fromIndex). (If fromIndex is undefined, this step produces the value 0.) If n â‰¥ 0, then Let k be n. Else n < 0, Let k be len + n. If k < 0, let k be 0. Repeat, while k < len Let elementK be the result of ? Get(O, ! ToString(k)). If SameValueZero(searchElement, elementK) is true, return true. Increase k by 1. Return false. å…¶ä¸­çš„ SameValueZero å†…éƒ¨å®žçŽ°æ˜¯è¿™æ ·çš„ï¼š If Type(x) is different from Type(y), return false. If Type(x) is Number, then If x is NaN and y is NaN, return true. If x is +0 and y is -0, return true. If x is -0 and y is +0, return true. If x is the same Number value as y, return true. Return false. Return SameValueNonNumber(x, y). ä»Žä¸Šé¢å¯ä»¥çœ‹å‡º includes å†…éƒ¨æ˜¯ä½¿ç”¨ while å¾ªçŽ¯ï¼Œå¹¶ä¸èƒ½å¤Ÿé™ä½Žæ—¶é—´å¤æ‚åº¦ã€‚å®ƒèƒ½åˆ¤æ–­å‡º NaN ä»¥åŠ +0ç­‰äºŽ-0ã€‚ æ‰€ä»¥ï¼Œè¿”å›žå€¼çš„è¯­ä¹‰åŒ–å’Œ NaNçš„åˆ¤æ–­å°±æ˜¯ includes çš„åœºæ™¯ã€‚ indexOfå¥½ï¼Œincludes ç”¨æ¥æå‡æ•ˆçŽ‡çš„å¹»æƒ³ç ´ç­äº†ï¼Œé‚£ indexOf å‘¢ï¼Œè§„èŒƒæ˜¯è¿™ä¹ˆå†™çš„ï¼š Let O be ? ToObject(this value). Let len be ? ToLength(? Get(O, â€œlengthâ€)). If len is 0, return -1. Let n be ? ToInteger(fromIndex). (If fromIndex is undefined, this step produces the value 0.) If n â‰¥ len, return -1. If n â‰¥ 0, then If n is -0, let k be +0; else let k be n. Else n < 0, Let k be len + n. If k < 0, let k be 0. Repeat, while k < len Let kPresent be ? HasProperty(O, ! ToString(k)). If kPresent is true, then Let elementK be ? Get(O, ! ToString(k)). Let same be the result of performing Strict Equality Comparison searchElement === elementK. If same is true, return k. Increase k by 1. Return -1. Arrayçš„ indexOf ä¹Ÿä½¿ç”¨äº† while å¾ªçŽ¯ï¼Œå¹¶ä½¿ç”¨ === å…¨ç­‰æ¯”è¾ƒã€‚ï¼ˆæ³¨ï¼š ä¸Ž String.prototype.indexOf å¹¶ä¸åŒï¼‰ indexOf ä½¿ç”¨åœºæ™¯æ˜¯éœ€è¦çŸ¥é“ åŒ¹é…å€¼çš„ä½ç½®ã€‚ ç»“è®ºè¿™æ˜¯ä¸€ä¸ªæ€§èƒ½æµ‹è¯•æ¯”è¾ƒ so? å¦‚æžœå•çº¯åªæ˜¯æƒ³æ¯”è¾ƒï¼Œç®€å•çš„æ‰æ˜¯æœ€å¿«çš„ã€‚ includesä¸ŽindexOfæ•ˆçŽ‡ç›¸å½“ï¼Œè€Œfor Loopæœ€å¿«ï¼Œå› ä¸ºæ²¡æœ‰å…¶ä»–çš„å‰ç½®åˆ¤æ–­å’Œæµè§ˆå™¨å¯¹å®ƒçš„ä¼˜åŒ–ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Array</tag>
        <tag>indexOf</tag>
        <tag>includes</tag>
        <tag>loop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹æ€»ç»“å›žé¡¾]]></title>
    <url>%2F2017%2F06%2F28%2FWeb-Animations-API-Tutorial-Conclusion.html</url>
    <content type="text"><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹æ€»ç»“å›žé¡¾è¿™æ˜¯ Web Animations API å…¥é—¨æ•™ç¨‹ç³»åˆ—çš„æ€»ç»“éƒ¨åˆ†ã€‚æˆ‘åœ¨2016å¹´6æœˆæ›´æ–°äº†ç³»åˆ—å†…å®¹ï¼Œå› ä¸ºChromeå’ŒFirefoxéƒ½æŽ¨å‡ºäº†ä¸»è¦æ›´æ–°ï¼ˆä»¥åŠä¸€äº›å°è§„æ ¼æ›´æ”¹ï¼‰ã€‚å¦‚æžœæ‚¨æœ‰æƒ³æ³•æˆ–é—®é¢˜ï¼Œæˆ–çœ‹åˆ°æˆ‘å·²ç»è¯¯è§£äº†è¯¥è§„èŒƒï¼Œè¯·åœ¨Twitterä¸Šä¸Ž@dancwilsonè”ç³»ã€‚ æˆ‘ä»¬å·²ç»æ¶µç›–äº†ç›¸å½“å¤šçš„çŸ¥è¯†é¢ï¼Œå¸Œæœ›èƒ½å¤Ÿè§£å†³æœ‰å…³Web Animations APIæ˜¯ä»€ä¹ˆï¼ˆè€Œä¸æ˜¯ä»€ä¹ˆï¼‰çš„é—®é¢˜ã€‚è¦æ€»ç»“è¿™ä¸ªç³»åˆ—ï¼Œæˆ‘ä»¬å°†å›žé¡¾ä¸€ä¸‹æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡çš„å†…å®¹ï¼Œå¹¶çœ‹çœ‹å°šæœªå®žçŽ°çš„å†…å®¹ã€‚ ä¸ºä»€ä¹ˆè¦ç”¨APIï¼Ÿåœ¨ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†APIæ˜¯å¦‚ä½•å°†CSSï¼ŒJSå’ŒSVGä¸­çš„å„ç§æ–¹æ³•ç»“åˆèµ·æ¥è¿›è¡ŒåŠ¨ç”»å¤„ç†ï¼Œæ—¨åœ¨å……åˆ†åˆ©ç”¨å®ƒä»¬ã€‚è¿™æ„å‘³ç€ï¼Œä¾‹å¦‚ï¼ŒJavaScriptå¯ä»¥é”å®šCSSå¤šå¹´æ¥çš„ç¡¬ä»¶åŠ é€Ÿï¼Œå¹¶ä¸é™äºŽCSSçš„å£°æ˜Žæ€§ã€‚APIå¹¶ä¸æ„å‘³ç€æ›¿æ¢åƒGSAPè¿™æ ·çš„åº“ï¼Œè€Œåªæ˜¯ä¸ºäº†åœ¨æµè§ˆå™¨çº§åˆ«æä¾›æ›´å¤šçš„é€‰é¡¹ã€‚ Firefoxå’ŒChromeéƒ½å·²ç»å¼€å§‹å®žæ–½ï¼Œè€ŒEdgeå·²ç»ç§¯åŽ‹äº†å¾ˆå¤šäº‹æ²¡æœ‰åšã€‚éšç€å›¢é˜Ÿå®Œæˆè§„èŒƒï¼Œpolyfillå¯ä»¥è®©æˆ‘ä»¬å¼€å§‹çŽ©è½¬å®ƒã€‚ åŠ¨ç”»åŸºç¡€è¦åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„åŠ¨ç”»ï¼Œæˆ‘ä»¬é€šè¿‡æä¾›å…³é”®å¸§å’Œæ—¶åºå±žæ€§æ¥è·Ÿè¸ªç±»ä¼¼äºŽCSSçš„ç»“æž„ã€‚ var player = document.getElementById('toAnimate').animate([ { transform: 'scale(1)', opacity: 1, offset: 0 }, { transform: 'scale(.6)', opacity: .6, offset: 1 } ], { duration: 700, }); æ—¶é—´è½´æŽ§åˆ¶æ˜¯å½“å‰CSSä¸­æ˜Žæ˜¾ä¸å­˜åœ¨çš„éƒ¨åˆ†ã€‚é€šè¿‡playStateå±žæ€§è¯»å–åŠ¨ç”»çš„çŠ¶æ€ï¼Œå¹¶æ”¹å˜çŠ¶æ€ï¼Œä¾‹å¦‚play()ï¼Œpause()ï¼Œå’Œfinish()ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¯»/å†™playbackRateå±žæ€§å°†æ’­æ”¾é€Ÿåº¦æ›´æ”¹æˆ–æ›´å¿«ã€‚currentTimeå¯è¯»å†™ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å½“åŠ¨ç”»ä¸Žå®Œæˆå›žè°ƒonfinishã€‚ å¤šä¸ªåŠ¨ç”»å’Œåˆ†ç»„Web Animations APIå…è®¸å¯¹å…ƒç´ è®¾ç½®å¤šä¸ªåŠ¨ç”»ï¼Œåˆ›å»ºå•ç‹¬çš„åŠ¨ç”»å¯¹è±¡ã€‚documentä¸Šé»˜è®¤çš„timelineå¯ä»¥ä½¿ç”¨getAnimations()æ–¹æ³•è®©æˆ‘ä»¬è®¿é—®åˆ›å»ºçš„æ‰€æœ‰åŠ¨ç”»ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨GroupEffects å’Œ SequenceEffectsï¼ˆåœ¨polyfillä¸­æä¾›ä½†ä¸åœ¨Level 1è§„èŒƒä¸­ï¼‰å°†åŠ¨ç”»ç»„åˆåœ¨ä¸€èµ·æˆ–ä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°è¿›è¡Œæ’­æ”¾ã€‚ è¿åŠ¨è·¯å¾„ä¸Žæœªæ¥åœ¨è¿™ä¸ªç³»åˆ—ä¸­ï¼Œæ²¿ç€ä¸€æ¡è·¯å¾„è¿åŠ¨è®©æˆ‘ä»¬çœ‹åˆ°äº†å®ƒåœ¨CSSä¸­çš„ç¬¬ä¸€ä¸ªå®žçŽ°ï¼Œä½†è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ¨¡å—å°šæœªå®žçŽ°ã€‚ é—´è·(Spacing)å¦‚æžœåœ¨å…³é”®å¸§ä¸­æ²¡æœ‰è®¾ç½®offsetï¼Œåˆ™å½“å‰çš„å®žçŽ°ä½¿ç”¨é»˜è®¤çš„é—´éš”ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼ˆä¾‹å¦‚ï¼Œä¸‰ä¸ªå¸§å°†å…·æœ‰0,1,5å’Œ1çš„åç§»é‡ï¼‰ã€‚è¯¥è§„èŒƒè¿˜å®šä¹‰äº†ä¸€ç§åŸºäºŽå±žæ€§æ¥è°ƒæ•´åŠ¨ç”»çš„æ–¹æ³•ï¼Œä»¥ä½¿å…¶å…·æœ‰æ’å®šçš„å˜åŒ–çŽ‡ã€‚å½“è®¨è®ºSpacing keyframesæ—¶ï¼Œè¯¥è§„èŒƒæè¿°äº†è¿™ä¸€ç‚¹ã€‚ Promisesè¯¥è§„èŒƒå·²ç»æ¼”å˜æˆâ€“åŒ…æ‹¬readyåœ¨å†…çš„ï¼Œæ¯æ¬¡åŠ¨ç”»å–æ¶ˆæˆ–è¿›å…¥æŒ‚èµ·çŠ¶æ€ï¼ˆé€šå¸¸åœ¨æ›´æ”¹ä¸ºâ€œè¿è¡Œâ€æˆ–â€œå·²æš‚åœâ€ï¼‰ä¹‹å‰å°†ä¼šè¢«æ–°çš„Promiseæ›¿æ¢ã€‚é™¤äº†onfinish, æˆ‘ä»¬åœ¨æœ¬ç³»åˆ—ä¸­è®¨è®ºçš„ä½¿ç”¨å›žè°ƒä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä½¿ç”¨finishedè¿”å›žçš„Promiseåœ¨åŠ¨ç”»å®ŒæˆåŽè¿è¡Œå…¶ä»–åŠŸèƒ½ã€‚ è®©æˆ‘ä»¬ç»§ç»­è°ˆè®ºWebåŠ¨ç”»APIäººä»¬å¼€å§‹æ›´å¤šåœ°è°ˆè®ºè¿™ä¸ªAPIï¼Œæˆ‘å¸Œæœ›è¿™ä¸ªè®¨è®ºç»§ç»­ä¸‹åŽ»ã€‚è§„æ ¼ï¼Œæµè§ˆå™¨å®žçŽ°å’Œpolyfillå·²ç»æŒç»­äº†ä¸€æ®µæ—¶é—´ï¼Œä»–ä»¬å‡†å¤‡å¥½ä»”ç»†æ£€æŸ¥ã€‚ æœ‰æ—¶CSSä¼šæœ‰æ›´å¤šåœºæ™¯ï¼Œæœ‰æ—¶å€™æ˜¯requestAnimationFrameï¼Œæœ‰æ—¶ä½¿ç”¨ç±»åº“ä¼šæ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚çŸ¥é“ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä»€ä¹ˆæ˜¯å¥½çš„ï¼Œè¿™ä¸ªAPIæä¾›äº†ä¸å°‘ä»¥å‰æˆ‘ä»¬ä»¥å‰æ²¡æœ‰çš„å¯ç”¨çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å¾ˆæœ‰è¶£ã€‚ æŸ¥çœ‹æœ¬ç³»åˆ—çš„å…¶ä½™éƒ¨åˆ†ï¼š ä»‹ç» ç¬¬1éƒ¨åˆ†ï¼šåˆ›å»ºåŸºæœ¬åŠ¨ç”» ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶ ç¬¬3éƒ¨åˆ†ï¼šå¤šä¸ªåŠ¨ç”» ç¬¬4éƒ¨åˆ†ï¼šGroupEffectså’ŒSequenceEffects ç¬¬5éƒ¨åˆ†ï¼šè¿åŠ¨è·¯å¾„ æ€»ç»“ä¸Žå›žé¡¾ ã€ç¿»è¯‘åŽŸæ–‡ã€‘ï¼š http://danielcwilson.com/blog/2015/09/animations-conclusion/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Web Animations</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹ç¬¬5éƒ¨åˆ†: å¯çˆ±çš„è¿åŠ¨è·¯å¾„]]></title>
    <url>%2F2017%2F06%2F28%2FWeb-Animations-API-Tutorial-Part-5-The-Loveable-Motion-Path.html</url>
    <content type="text"><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹ç¬¬5éƒ¨åˆ†: å¯çˆ±çš„è¿åŠ¨è·¯å¾„è¿™æ˜¯ Web Animations API å…¥é—¨æ•™ç¨‹ç³»åˆ—çš„ç¬¬5éƒ¨åˆ†ã€‚ é‡è¦ä¿¡æ¯ï¼šè‡ªæ’°å†™æœ¬æ–‡ä»¥æ¥ï¼Œè¿åŠ¨è·¯å¾„çš„è§„èŒƒï¼ˆå’ŒChromiumå®žçŽ°ï¼‰å·²ç»å‘ç”Ÿäº†é‡å¤§å˜åŒ–ã€‚ä»¥ä¸‹åœ¨æ¦‚å¿µä¸Šä»ç„¶æœ‰æ•ˆï¼Œä½†æ˜¯å±žæ€§åç§°å’Œæ›´å¤šå†…å®¹å·²ç»æ”¹å˜ã€‚æˆªè‡³2016å¹´10æœˆï¼Œè¯·æŸ¥çœ‹CSSè¿åŠ¨è·¯å¾„ã€‚ æœ€åŽï¼Œæ²¿ç€è·¯å¾„åŠ¨ç”»â€¦ä¸å†ä»…ä»…æ˜¯SVGçš„é¢†åŸŸã€‚ è¿åŠ¨è·¯å¾„ï¼šå½“å‰æ–¹å‘ï¼ˆSpecï¼‰See the Pen Motion Path Infinity by Dan Wilson (@danwilson) on CodePen. éšç€APIè§„èŒƒçš„è¿ç”¨ï¼Œè¿åŠ¨è·¯å¾„å‡ºçŽ°äº†ä¸åŒçš„å½¢å¼ã€‚æœ€åˆæœ‰å¯èƒ½çš„ä¸€ä¸ªæ–¹å‘æ˜¯ä¸€ä¸ªå½¢å¼çš„ç‰¹æ•ˆï¼ˆå¦‚å‰é¢æ‰€è®¨è®ºçš„GroupEffectï¼‰ï¼Œä½†éšåŽå€ŸåŠ©CSSæ¨¡å—çš„è¿åŠ¨è·¯å¾„çš„æ°”åŠ¿ä¸€ç‚¹ç‚¹ä¸Šå‡ï¼ˆæ‹¥æœ‰å®ƒè‡ªå·±çš„è§„èŒƒï¼‰ã€‚ å› æ­¤ï¼Œæ²¿ç€è·¯å¾„åŠ¨ç”»å°†åªæ˜¯å¦ä¸€ç»„CSSå±žæ€§ï¼Œå¯ä»¥åŠ¨ç”»åŒ–ï¼Œæ­£å¦‚opacityå’Œtranformä¹Ÿå¯ä»¥ã€‚è¿™æ ·ï¼ŒCSSè¿‡æ¸¡å’Œå…³é”®å¸§å¯ä»¥ä½¿ç”¨å®ƒ,Web Animations APIä¹Ÿæ˜¯â€¦è¿™æ˜¯ä¼Ÿå¤§çš„ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦å°½å¯èƒ½å¤šçš„è¿™äº›æ–¹æ³•ä¹‹é—´å…±äº«ç»™æˆ‘ä»¬æ›´å¤šçš„çµæ´»æ€§ã€‚Chromeå’ŒOperaå·²ç»å‘å¸ƒäº†ä¸€ä¸ªåˆæ­¥çš„å®žçŽ°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ä»Šå¤©å¼€å§‹çŽ©å®ƒï¼Œå°½ç®¡è¿˜æ²¡æœ‰åœ¨polyfillæ‰¾åˆ°å®ƒçš„ä»»ä½•ä½¿ç”¨æ–¹å¼ã€‚ è®©æˆ‘ä»¬åˆ†è§£è¿™äº›å±žæ€§ï¼Œæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒä»¬ï¼ŒçŽ°åœ¨è¿˜æœ‰ä»€ä¹ˆäº‹æƒ…å¯ä»¥é˜»ç¢æˆ‘ä»¬ã€‚ è¿åŠ¨è·¯å¾„å±žæ€§æˆ‘ä»¬å°†è®¨è®ºmotionçš„ä¸‰ä¸ªå±žæ€§ã€‚çŽ°åœ¨ï¼Œè¦æŸ¥çœ‹ç¤ºä¾‹ï¼Œæ‚¨å°†éœ€è¦è¿è¡ŒChrome 46æˆ–Opera 33ã€‚ motion-pathèµ·å§‹ç‚¹æ˜¯motion-pathå®šä¹‰å…ƒç´ å¯ä»¥ç§»åŠ¨çš„è·¯å¾„ï¼Œéµå¾ªSVG 1.1ä¸­çš„è·¯å¾„å·¥ä½œæ–¹å¼ï¼š #motioner { motion-path: path("M200 200 S 200.5 200.1 348.7 184.4z"); } è¿™ä¹Ÿå¯ä»¥fill-ruleåœ¨è·¯å¾„è°ƒç”¨ä¸­ä½œä¸ºå¯é€‰çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚æˆ‘å»ºè®®æ‚¨é˜…è¯»Joni Trythallçš„â€œä¼˜ç§€å£è¢‹æŒ‡å—â€ï¼Œå°±SVGè¿›è¡Œè®¨è®ºã€‚ æ ¹æ®è§„èŒƒï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨åŸºæœ¬å½¢çŠ¶ï¼Œä¾‹å¦‚circleï¼Œpolygonï¼Œellipseï¼Œå’Œinsetã€‚å¦‚æžœæ‚¨å°è¯•è¿‡ä½¿ç”¨CSS shapeï¼Œè¿™äº›åº”è¯¥çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰ã€‚ æ ¹æ®Blinkçš„åˆå§‹å®žçŽ°ï¼Œæˆ‘åªçœ‹è¿‡è¿™ä¸ªpath()æ–¹æ³•å¯ä»¥å·¥ä½œï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´æ²¡æœ‰æ­£ç¡®ä½¿ç”¨å½¢çŠ¶æˆ–è€…è¿˜æ²¡åˆ°æ—¶å€™ã€‚ motion-offseté©±åŠ¨è¿åŠ¨ï¼Œå¹¶å°†å…ƒç´ æ”¾åœ¨æˆ‘ä»¬ä½¿ç”¨çš„è·¯å¾„ä¸Šçš„æŸä¸ªä½ç½®motion-offsetã€‚è¿™å¯ä»¥æ˜¯åŒå€é•¿åº¦å€¼æˆ–ç™¾åˆ†æ¯”ã€‚å› æ­¤ï¼Œä»Žè·¯å¾„çš„èµ·ç‚¹åˆ°æœ€åŽï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªä»Ž0åˆ°100ï¼…çš„åŠ¨ç”»ã€‚ä½¿ç”¨æˆ‘ä»¬æ‹¥æœ‰çš„Web Animations API var m = document.getElementById('motioner'); m.animate([ { motionOffset: 0 }, { motionOffset: '100%' } ], 1000); ä»¥åŠCSSçš„å†™æ³• #motioner { animation: path-animation 1s; } @keyframes path-animation { 0% { motion-offset: 0; } 100% { motion-offset: '100%'; } } See the Pen CSS Motion Path Spiral by Dan Wilson (@danwilson) on CodePen. è¯¥CodePenæ¼”ç¤ºæ˜¾ç¤ºäº†ä»Žå¤–éƒ¨åˆ°å†…éƒ¨æ²¿ç€èžºæ—‹è·¯å¾„ç§»åŠ¨çš„å‡ ä¸ªç‚¹ã€‚éšç€æ¯ä¸ªç‚¹æŽ¥è¿‘ä¸­å¿ƒï¼Œå®ƒå˜å¾—è¶Šæ¥è¶Šå¿«ï¼Œå˜å¾—è¶Šæ¥è¶Šé€æ˜Žã€‚ .animate()åœ¨æ¯ä¸ªç‚¹è¢«ç§°ä¸ºä¸¤æ¬¡æ— é™è¿­ä»£å’Œä¸€ä¸ªå»¶è¿Ÿï¼Œå…¶ä¸­ä¸€ä¸ªè°ƒç”¨é›†ä¸­åœ¨è¿åŠ¨åç§»ï¼Œå¦ä¸€ä¸ªç„¦ç‚¹åœ¨ç¼©æ”¾å’Œä¸é€æ˜Žåº¦ä¸Šã€‚æˆ‘åˆ†è§£äº†ä»–ä»¬ï¼ŒæŒ‡å‡ºäº†ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼Œå½“ç„¶ï¼Œä»–ä»¬ä¹Ÿå¯ä»¥ç»“åˆåœ¨ä¸€èµ·ã€‚ è¿™ç§æ–¹æ³•è¿˜ä½¿ç”¨åŠŸèƒ½æ£€æµ‹ï¼Œæ‚¨å°†ä¼šæ³¨æ„åˆ°ï¼Œå¦‚æžœæ‚¨åœ¨Safariï¼ŒFirefoxï¼ŒEdgeæˆ–æ—§ç‰ˆChrome / Operaä¸­æŸ¥çœ‹ï¼Œå› ä¸ºæ‚¨å°†çœ‹åˆ°ä¸€æ¡æ¶ˆæ¯è€Œä¸æ˜¯åŠ¨ç”»ã€‚æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ¯”å¦‚ var m = document.getElementById('motioner'); if (m.style.motionOffset !== undefined) { ... } å½“ç„¶ï¼Œæˆ‘ä»¬ä¸æƒ³åœ¨çœŸæ­£çš„ç½‘é¡µä¸­å®Œå…¨é˜»æ­¢ç”¨æˆ·ï¼Œæ‰€ä»¥å¦‚æžœæ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥æœ‰å¦ä¸€ä¸ªåŠ¨ç”»ï¼ˆæˆ–è€…æ²¡æœ‰åŠ¨ç”»ï¼‰åˆ‡æ¢åˆ°Motion PathåŠ¨ç”»ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œæ¸è¿›å¢žå¼º(Progressive Enhancement)æ˜¯æˆ‘ä»¬çš„æœ‹å‹ã€‚ motion-rotationæœ€åŽçš„å±žæ€§æ˜¯motion-rotationï¼Œå®ƒå¤„ç†å…ƒç´ æ²¿ç€è·¯å¾„ç§»åŠ¨æ—¶é¢å‘å“ªä¸ªæ–¹å‘ã€‚æœ‰å››ç§ä¸»è¦æ–¹æ³•å¯ä»¥æŒ‡å®šè¿™ä¸€ç‚¹ã€‚ auto è¡¨ç¤ºå…ƒç´ å°†éšè·¯å¾„æ—‹è½¬ã€‚ reverse å…ƒç´ ä¹Ÿå°†éšç€è·¯å¾„æ—‹è½¬ï¼Œä½†ä¼šå¢žåŠ 180åº¦ï¼Œå› æ­¤å°†å‘åŽã€‚ auto Xdeg / reverse Xdeg é™¤äº†æ·»åŠ Xåº¦ä¹Ÿä¼šä¸€æ · Xdeg å°†ä¸å†ä¸Žè·¯å¾„ä¸€èµ·æ—‹è½¬ï¼Œå…ƒç´ å°†ä¿æŒå›ºå®šæœå‘ç›¸åŒçš„æ–¹å‘ã€‚ See the Pen CSS MotionPath by Dan Wilson (@danwilson) on CodePen. å°‘äº†ç‚¹ä»€ä¹ˆä¸œè¥¿ï¼Ÿè¿™æ˜¯ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œå½“ç„¶ï¼Œæµè§ˆå™¨åˆ¶é€ å•†å’Œè§„èŒƒä½œè€…ä»åœ¨è®¨è®ºè¿™ä¸€åˆ‡ã€‚åœ¨å°è¯•è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ³¨æ„åˆ°çš„æœ€å¤§çš„ä¸€ä»¶äº‹å°±æ˜¯ç¼ºå°‘é€‚åº”ä¸åŒå±å¹•/å®¹å™¨å°ºå¯¸çš„è·¯å¾„ã€‚ è·¯å¾„åªæ˜¯æŒ‰ç…§å®ƒä»¬çš„å®šä¹‰å‡ºçŽ°ã€‚å½“ä½¿ç”¨SVGæ—¶ï¼Œæˆ‘ä»¬èŽ·å¾—çµæ´»æ€§ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å®¹å™¨ä¸Šå…·æœ‰ä¸åŒçš„åæ ‡ç³»å’Œå±žæ€§ï¼Œå¦‚ viewBoxã€‚ä½¿ç”¨CSSä¸­å®šä¹‰çš„è¿åŠ¨è·¯å¾„ï¼Œè·¯å¾„çš„å¤§å°ä¸èƒ½è¢«å…¶ä»–å±žæ€§å¦å¤–ä¿®æ”¹æˆ–çº¦æŸã€‚å…ƒç´ ä¸Šå®šä¹‰çš„å®½åº¦å’Œé«˜åº¦ä»…é€‚ç”¨äºŽå…ƒç´ ï¼Œè€Œä¸æ˜¯å…¶è¿åŠ¨è·¯å¾„ã€‚æ‚¨å¯ä»¥ä½¿ç”¨åª’ä½“æŸ¥è¯¢æˆ–JavaScriptæ¥å®šä¹‰ä¸åŒæ¡ä»¶çš„ä¸åŒè·¯å¾„ï¼Œä½†æ˜¯æƒ³é€šè¿‡motionå±žæ€§çµæ´»åœ°è®¾ç½®å®ƒä»¬æ˜¯ä¸å¯èƒ½çš„äº‹ã€‚ å›žé¡¾å’Œä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†çœ‹åˆ°è§„èŒƒçš„æ–¹å‘ï¼Œä½†çŽ°åœ¨å°è¯•è¿™æ ·åšæ˜¯å¾ˆæœ‰è¶£çš„ï¼Œçœ‹çœ‹å®ƒå¯èƒ½æä¾›ä»€ä¹ˆï¼ˆå’Œä¸æä¾›ä»€ä¹ˆï¼‰ã€‚æˆ‘æ­£åœ¨æ”¶é›†æˆ‘åœ¨CodePenä¸Šæ‰¾åˆ°çš„CSS Motion Pathæ¼”ç¤ºæ–‡ç¨¿ï¼Œè€ŒEric Willigersï¼ˆChromeå¼€å‘å›¢é˜Ÿçš„ç›¸å…³å®žçŽ°ä»»åŠ¡çš„æ‰€æœ‰è€…ï¼‰æ‹¥æœ‰ä¸€ä¸ªGoogle Docçš„ä¾‹å­ã€‚ æˆ‘ä»¬å°†åœ¨ä¸‹æ¬¡å†æ¬¡ä»‹ç»æˆ‘ä»¬æ‰€è®¨è®ºçš„å†…å®¹ï¼Œå¹¶ä¸”å†çœ‹å‡ ä¸ªç›®å‰å”¯ä¸€çš„è§„èŒƒä¸»é¢˜ã€‚ æŸ¥çœ‹æœ¬ç³»åˆ—çš„å…¶ä½™éƒ¨åˆ†ï¼š ä»‹ç» ç¬¬1éƒ¨åˆ†ï¼šåˆ›å»ºåŸºæœ¬åŠ¨ç”» ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶ ç¬¬3éƒ¨åˆ†ï¼šå¤šä¸ªåŠ¨ç”» ç¬¬4éƒ¨åˆ†ï¼šGroupEffectså’ŒSequenceEffects ç¬¬5éƒ¨åˆ†ï¼šè¿åŠ¨è·¯å¾„ æ€»ç»“ä¸Žå›žé¡¾ ã€ç¿»è¯‘åŽŸæ–‡ã€‘ï¼š http://danielcwilson.com/blog/2015/09/animations-part-5/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Web Animations</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹ç¬¬4éƒ¨åˆ†: GroupEffects & SequenceEffects]]></title>
    <url>%2F2017%2F06%2F27%2FWeb-Animations-API-Tutorial-Part-4-GroupEffects-and-SequenceEffects.html</url>
    <content type="text"><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹ç¬¬4éƒ¨åˆ†: GroupEffects & SequenceEffectsè¿™æ˜¯ Web Animations API å…¥é—¨æ•™ç¨‹ç³»åˆ—çš„ç¬¬4éƒ¨åˆ†ã€‚æˆ‘åœ¨2016å¹´6æœˆæ›´æ–°äº†ç³»åˆ—å†…å®¹ï¼Œå› ä¸ºChromeå’ŒFirefoxéƒ½æŽ¨å‡ºäº†ä¸»è¦æ›´æ–°ï¼ˆä»¥åŠä¸€äº›å°è§„æ ¼æ›´æ”¹ï¼‰ã€‚å¦‚æžœæ‚¨æœ‰æƒ³æ³•æˆ–é—®é¢˜ï¼Œæˆ–çœ‹åˆ°æˆ‘å·²ç»è¯¯è§£äº†è¯¥è§„èŒƒï¼Œè¯·åœ¨Twitterä¸Šä¸Ž@dancwilsonè”ç³»ã€‚ è®©æˆ‘ä»¬ç»§ç»­è®¨è®ºWebåŠ¨ç”»APIä¸­çš„å¤šä¸ªåŠ¨ç”»ï¼Œé€šè¿‡è®¨è®ºä»Šå¤©åœ¨polyfillä¸­æä¾›çš„å‡ ä¸ªéƒ¨åˆ†æ¥æä¾›åˆ†ç»„å’ŒæŽ’åºã€‚ KeyframeEffectsA KeyframeEffectéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼šåŠ¨ç”»å…ƒç´ (element)ï¼Œå…³é”®å¸§æ•°ç»„(keyframes)å’Œæ—¶é—´é€‰é¡¹(timing options)ã€‚è¿™äº›éƒ½æ˜¯æˆ‘ä»¬ä»¥å‰ä½¿ç”¨è¿‡çš„å‚æ•°element.animate()ã€‚è¿™ä¸ªæ–°å¯¹è±¡æœ¬è´¨ä¸Šæ˜¯å•ä¸ªåŠ¨ç”»çš„è“å›¾ï¼Œå½“æˆ‘ä»¬è®¨è®ºåˆ†ç»„(group)å’Œé˜Ÿåˆ—(sequence)åŠ¨ç”»çš„æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®ƒã€‚å®ƒä¸å¯åŠ¨åŠ¨ç”»ï¼Œå®ƒåªæ˜¯å®šä¹‰åŠ¨ç”»ã€‚ var elem = document.getElementById('toAnimate'); var timings = { duration: 1000, fill: 'both' } var keyframes = [ { opacity: 1 }. { opacity: 0 } ]; var effect = new KeyframeEffect(elem, keyframes, timings); GroupEffectsè™½ç„¶åœ¨ä»»ä½•æµè§ˆå™¨ä¸­éƒ½æ²¡æœ‰å®žçŽ°æ­¤åŠŸèƒ½ï¼Œç”šè‡³åœ¨Level 2è§„èŒƒä¸­æ‰¾ä¸åˆ°ï¼Œä½†æ˜¯polyfillæä¾›äº†ä¸€ç§ç»„åˆåŠ¨ç”»å¹¶å°†å…¶ä¸€èµ·æ’­æ”¾çš„æ–¹æ³•ã€‚ GroupEffectï¼ˆæ˜¯çš„ï¼Œå®ƒæ˜¯æœªæ¥å°†é›†æˆåœ¨Level 2è§„èŒƒï¼‰ç»„åˆä¸€ä¸ªæˆ–å¤šä¸ªKeyframeEffectsåŒæ—¶æ’­æ”¾ã€‚ See the Pen Group Effects with WAAPI by Dan Wilson (@danwilson) on CodePen. ä¸€ä¸ªGroupEffectä»»åŠ¡éœ€è¦ä¸€ä¸ªEffectså‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’ä»£è¡¨æˆ‘ä»¬å¤šä¸ªåŠ¨ç”»çš„KeyframeEffectæ•°ç»„ã€‚ä¸€æ—¦å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‡†å¤‡å¥½çš„æ—¶å€™åœ¨é»˜è®¤æ—¶é—´è½´ä¸Šæ’­æ”¾åŠ¨ç”»ç»„ã€‚ var elem = document.getElementById('toAnimate'); var elem2 = document.getElementById('toAnimate2'); var timings = { duration: 1000 } var keyframes = [ { opacity: 1 }. { opacity: 0 } ]; var kEffects = [ new KeyframeEffect(elem, keyframes, timings), new KeyframeEffect(elem2, keyframes, timings) ]; var group = new GroupEffect(kEffects); document.timeline.play(group); SequenceEffectsç±»ä¼¼äºŽGroupEffectï¼ŒSequenceEffectå…è®¸æˆ‘ä»¬å°†å¤šä¸ªåŠ¨ç”»ï¼ˆç”±KeyframeEffects æŒ‡å®šï¼‰ç»„åˆåœ¨ä¸€èµ·â€¦ä¸æ˜¯å¹¶è¡Œæ’­æ”¾å®ƒä»¬ï¼Œè€Œæ˜¯ä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°æ’­æ”¾å®ƒä»¬ã€‚æ‚¨ä¹Ÿå¯ä»¥æŒ‰ç…§polyfillä¸­çš„å®šä¹‰å°†GroupEffectå’ŒSequenceEffectä¸€èµ·ä½¿ç”¨ï¼ˆä¾‹å¦‚å…·æœ‰å¤šä¸ªåºåˆ—çš„åˆ†ç»„ï¼‰ã€‚ See the Pen SequenceEffect with WAAPI by Dan Wilson (@danwilson) on CodePen. é˜Ÿåˆ—æä¾›ç»™ä½ ä¸€äº›æˆ‘ä»¬å¿…é¡»ç”¨CSSæˆ–è€…æˆ‘ä»¬åœ¨ animations APIä¸­çœ‹åˆ°çš„ä¸œè¥¿ã€‚æˆ‘ä»¬å¿…é¡»æ ¹æ®æ—©æœŸåŠ¨ç”»çš„æŒç»­æ—¶é—´æˆ–ä½¿ç”¨ finish å›žè°ƒæ¥ç»´æŒå»¶è¿Ÿã€‚è¿™äº›æ–¹æ³•å¯èƒ½éš¾ä»¥ç»´æŠ¤ï¼Œæˆ–è€…ä¸ä¼šå¦‚æ­¤ç²¾ç¡®ã€‚ ä½¿ç”¨å…ˆå‰åœ¨GroupEffectä»£ç æ®µä¸­çš„å˜é‡ï¼š var sequence = new SequenceEffect(kEffects); document.timeline.play(sequence); åˆ›å»ºåŠ¨ç”»çš„å¤‡ç”¨æ–¹æ³•æˆ‘ä»¬ä»¥å‰çœ‹è¿‡element.animate()åˆ›å»ºåŠ¨ç”»çš„æ–¹å¼ã€‚è¿™æ˜¯åˆ›å»ºåŠ¨ç”»çš„å¿«æ·æ–¹å¼ï¼Œç«‹å³æ’­æ”¾ï¼Œå¹¶èŽ·å–Animationå¯¹è±¡çš„å¼•ç”¨ã€‚æˆ‘ä»¬ä¸“æ³¨äºŽè¿™ä¸€ç‚¹ï¼Œå› ä¸ºChromeæ”¯æŒäº†ä¸€æ®µæ—¶é—´äº†ï¼Œpolyfillä¹Ÿæ˜¯ã€‚Firefoxæ˜¯ç¬¬ä¸€ä¸ªæ”¯æŒæ›¿ä»£æ–¹å¼çš„ï¼šÂ·æž„é€ å‡½æ•°ã€‚å®ƒå‘æˆ‘ä»¬å±•ç¤ºäº†å¦ä¸€ç§ä½¿ç”¨æ–¹æ³•KeyframeEffectï¼Œè€Œä¸”å®ƒåœ¨Level 1è§„èŒƒä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å¾ˆå¿«ä¼šçœ‹åˆ°å®ƒçš„æ›´å¤šåº”ç”¨ã€‚ é¦–å…ˆæé†’ä¸€ä¸‹å¦‚ä½•element.animate()å·¥ä½œï¼š var elem = document.getElementById('toAnimate'); var timings = { duration: 1000, fill: 'both' } var keyframes = [ { opacity: 1 }. { opacity: 0 } ]; elem.animate(keyframes, timings); ä½¿ç”¨ä¸Žä¸Šè¿°ç›¸åŒçš„å˜é‡ï¼Œä»¥ä¸‹æ˜¯ä½¿ç”¨Animationæž„é€ å‡½æ•°çš„ç­‰ä»·å†™æ³•ï¼š var kEffect = new KeyframeEffect(elem, keyframes, timings); var player = new Animation(kEffect, elem.ownerDocument.timeline); player.play(); è¿™é‡Œçš„ä¸»è¦åŒºåˆ«åœ¨äºŽï¼ŒåŠ¨ç”»ä¸ä¼šç«‹å³å¼€å§‹æ’­æ”¾ï¼Œæ‰€ä»¥åœ¨æå‰åˆ›å»ºåŠ¨ç”»ä»¥ä¾¿ç¨åŽæ’­æ”¾æ—¶ï¼Œè¿™å°†éžå¸¸æœ‰ç”¨ã€‚ å›žé¡¾å’Œä¸‹ä¸€èŠ‚å½“Level 2è§„èŒƒé€šè¿‡å·¥ä½œè‰æ¡ˆæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°æ›´å¤šå…³äºŽè¿™äº›ä¸åŒæ•ˆæžœçš„å®šä¹‰ã€‚æœ¬ç³»åˆ—ä¸­è¿˜æœ‰ä¸¤ä¸ªè®¡åˆ’çš„ç« èŠ‚ã€‚ä¸‹ä¸€æ¬¡æˆ‘ä»¬å°†å†æ¬¡çœ‹çœ‹æœªæ¥ï¼Œè¿˜æœ‰ä»€ä¹ˆæˆ‘ä»¬å¯ä»¥æœŸå¾…çœ‹åˆ°ã€‚ æŸ¥çœ‹æœ¬ç³»åˆ—çš„å…¶ä½™éƒ¨åˆ†ï¼š ä»‹ç» ç¬¬1éƒ¨åˆ†ï¼šåˆ›å»ºåŸºæœ¬åŠ¨ç”» ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶ ç¬¬3éƒ¨åˆ†ï¼šå¤šä¸ªåŠ¨ç”» ç¬¬4éƒ¨åˆ†ï¼šGroupEffectså’ŒSequenceEffects ç¬¬5éƒ¨åˆ†ï¼šè¿åŠ¨è·¯å¾„ æ€»ç»“ä¸Žå›žé¡¾ ã€ç¿»è¯‘åŽŸæ–‡ã€‘ï¼šhttp://danielcwilson.com/blog/2015/09/animations-part-4/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Web Animations</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹ç¬¬3éƒ¨åˆ†: å¤šä¸ªAnimationså¯¹è±¡]]></title>
    <url>%2F2017%2F06%2F27%2FWeb-Animations-API-Tutorial-Part-3-Multiple-Animations.html</url>
    <content type="text"><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹ç¬¬3éƒ¨åˆ†: å¤šä¸ªAnimationså¯¹è±¡è¿™æ˜¯ Web Animations API å…¥é—¨æ•™ç¨‹ç³»åˆ—çš„ç¬¬3éƒ¨åˆ†ã€‚æˆ‘åœ¨2016å¹´6æœˆæ›´æ–°äº†ç³»åˆ—å†…å®¹ï¼Œå› ä¸ºChromeå’ŒFirefoxéƒ½æŽ¨å‡ºäº†ä¸»è¦æ›´æ–°ï¼ˆä»¥åŠä¸€äº›å°è§„æ ¼æ›´æ”¹ï¼‰ã€‚å¦‚æžœæ‚¨æœ‰æƒ³æ³•æˆ–é—®é¢˜ï¼Œæˆ–çœ‹åˆ°æˆ‘å·²ç»è¯¯è§£äº†è¯¥è§„èŒƒï¼Œè¯·åœ¨Twitterä¸Šä¸Ž@dancwilsonè”ç³»ã€‚ åœ¨æˆ‘ä»¬è®¨è®ºåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶ä¹‹åŽï¼Œè®©æˆ‘ä»¬æ¥è®¨è®ºå¤šä¸ªåŠ¨ç”»ã€‚ æ¯ä¸ªå…ƒç´ çš„å¤šä¸ªåŠ¨ç”»See the Pen Multiple animate calls by Dan Wilson (@danwilson) on CodePen. åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯ä¸ªçŸ©å½¢éƒ½æœ‰ä¸‰ä¸ªåŠ¨ç”»åº”ç”¨ï¼ˆæ¶‰åŠåˆ°transformï¼Œopacityå’Œcolorï¼‰ã€‚æ‚¨å¯ä»¥å¤šæ¬¡è°ƒç”¨å…ƒç´ çš„animate()æ–¹æ³•ï¼Œç±»ä¼¼äºŽå…è®¸å¤šä¸ªåŠ¨ç”»çš„CSSã€‚ ä½¿ç”¨CSSï¼š #toAnimate { animation: pulse 1s, activate 3000ms, have-fun-with-it 2.5s; } @keyframes pulse { /* ... */ } @keyframes activate { /* ... */ } @keyframes have-fun-with-it { /* ... */ } ä½¿ç”¨Web Animations APIï¼š var animated = document.getElementById('toAnimate'); var pulseKeyframes, //åœ¨è¿™é‡Œå®šä¹‰ keyframes. activateKeyframes, haveFunKeyframes; var pulse = animated.animate(pulseKeyframes, 1000); // ç¬¬äºŒä¸ªæ•°å€¼å‚æ•°ä½œä¸ºæŒç»­æ—¶é—´çš„ç¼©å†™ var activate = animated.animate(activateKeyframes, 3000); var haveFunWithIt = animated.animate(haveFunKeyframes, 2500); ä½¿ç”¨Web Animations APIï¼Œè¿™å°†åˆ›å»ºä¸‰ä¸ªAnimationå¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡å¯ä»¥é€šè¿‡æ—¶é—´è½´(timeline)æˆ–æ’­æ”¾é€ŸçŽ‡(playback rate)è¿›è¡Œæš‚åœï¼Œæ’­æ”¾ï¼Œå®Œæˆï¼Œå–æ¶ˆçš„æ“ä½œã€‚ èŽ·å– Animationsï¼Œå…¨éƒ¨åŠ¨ç”»å¯¹è±¡æ‰€ä»¥ä½ å¯ä»¥çŸ¥é“ä¸€ä¸ªåŠ¨ç”»å¼€å§‹æ’­æ”¾äº†ï¼Œä½†æ˜¯å½“ä½ æƒ³åœ¨å…ƒç´ ä¸Šè°ƒç”¨animate()æ—¶ä½ å´è¿˜æ²¡æœ‰æ•èŽ·åˆ°Animationçš„å¼•ç”¨ã€‚é‚£è¦æ€Žä¹ˆåšï¼Ÿ See the Pen Pause All those Random Dots! by Dan Wilson (@danwilson) on CodePen. è¯¥è§„èŒƒå…è®¸getAnimations()åœ¨æ–‡æ¡£ä¸Šçš„æ–¹æ³•ã€‚åœ¨æœ€æ–°ç‰ˆæœ¬çš„è§„èŒƒä¸­ï¼Œå®ƒç›´æŽ¥åœ¨documentï¼ˆdocument.getAnimations()ï¼‰ä¸Šï¼Œåœ¨Firefox 48+ä¸Šå®ƒæ˜¯è¿™æ ·å®žçŽ°çš„ã€‚ç„¶è€Œï¼Œå¯¹äºŽChrome 52 å’Œpolyfillï¼ˆå¦‚V2.2.0çš„ï¼‰ï¼Œåˆ™æ ¹æ®è¯¥æ—§è§„èŒƒå°†å…¶ç½®äºŽæ–°çš„timelineå¯¹è±¡ä¸Šã€‚ // å¦‚æžœå¼•ç”¨äº† polyfill ï¼Œä½ å¯ä»¥è¿™æ ·å†™ var animations = document.getAnimations ? document.getAnimations() : document.timeline.getAnimations(); // è¿”å›žä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰æ­£åœ¨è¿›è¡Œçš„ï¼ˆé™¤äº†å·²å®Œæˆçš„å’Œè¢«å–æ¶ˆçš„ï¼‰åŠ¨ç”» åœ¨CodePenç¤ºä¾‹ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°éšæœºçš„æŒç»­æ—¶é—´ï¼Œå»¶è¿Ÿå’Œæ— é™æŒç»­æ—¶é—´çš„å˜æ¢ç§»åŠ¨çš„å‡ ä¸ªç‚¹ã€‚â€œæš‚åœå…¨éƒ¨â€æŒ‰é’®è°ƒç”¨getAnimations()å¹¶éåŽ†æ‰€æœ‰, è¿”å›žçš„çŽ©å®¶ï¼ˆæ¯ä¸ªåŠ¨ç”»å¯¹è±¡ï¼‰å¹¶æš‚åœæ¯ä¸€ä¸ªã€‚ ä¸‹ä¸€èŠ‚â€¦åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹WAAPIåŠ¨ç”»å¯ä»¥åˆ›å»ºçš„ä¸åŒæ–¹å¼ï¼ˆå› ä¸ºå®ƒä¸ä»…ä»…æ˜¯element.animateï¼‰ã€‚æç¤ºï¼šdocument.timelineä¼šå‡ºçŽ°æ›´å¤šçš„ä½“çŽ°ã€‚ æŸ¥çœ‹æœ¬ç³»åˆ—çš„å…¶ä½™éƒ¨åˆ†ï¼š ä»‹ç» ç¬¬1éƒ¨åˆ†ï¼šåˆ›å»ºåŸºæœ¬åŠ¨ç”» ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶ ç¬¬3éƒ¨åˆ†ï¼šå¤šä¸ªåŠ¨ç”» ç¬¬4éƒ¨åˆ†ï¼šGroupEffectså’ŒSequenceEffects ç¬¬5éƒ¨åˆ†ï¼šè¿åŠ¨è·¯å¾„ æ€»ç»“ä¸Žå›žé¡¾ ã€ç¿»è¯‘åŽŸæ–‡ã€‘: http://danielcwilson.com/blog/2015/08/animations-part-3/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Web Animations</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Web Animations APIå…¥é—¨æ•™ç¨‹ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶]]></title>
    <url>%2F2017%2F06%2F26%2FWeb-Animations-API-Tutorial-Part-2-The-Animation.html</url>
    <content type="text"><![CDATA[Web Animations APIå…¥é—¨æ•™ç¨‹ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶è¿™æ˜¯ Web Animations API å…¥é—¨æ•™ç¨‹ç³»åˆ—çš„ç¬¬2éƒ¨åˆ†ã€‚æˆ‘åœ¨2016å¹´6æœˆæ›´æ–°äº†ç³»åˆ—å†…å®¹ï¼Œå› ä¸ºChromeå’ŒFirefoxéƒ½æŽ¨å‡ºäº†ä¸»è¦æ›´æ–°ï¼ˆä»¥åŠä¸€äº›å°è§„æ ¼æ›´æ”¹ï¼‰ã€‚å¦‚æžœæ‚¨æœ‰æƒ³æ³•æˆ–é—®é¢˜ï¼Œæˆ–çœ‹åˆ°æˆ‘å·²ç»è¯¯è§£äº†è¯¥è§„èŒƒï¼Œè¯·åœ¨Twitterä¸Šä¸Ž@dancwilsonè”ç³»ã€‚ çŽ°åœ¨æˆ‘ä»¬äº†è§£å¦‚ä½•ä½¿ç”¨Web Animations API åˆ›å»ºåŸºæœ¬åŠ¨ç”»ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆçŠ¶æ€ï¼ˆstatesï¼‰ï¼ŒæŽ§åˆ¶(controls)ï¼Œå›žè°ƒ(callback)å’Œæ—¶é—´è½´(timelines)ã€‚ Animations æ’­æ”¾çŠ¶æ€å’ŒæŽ§åˆ¶å½“ä½ è°ƒç”¨æ—¶element.animate()ï¼Œè¿”å›žä¸€ä¸ªAnimationå¯¹è±¡ï¼ˆä»¥å‰ç§°ä¸ºAnimationPlayerspecï¼‰ï¼ŒåŠ¨ç”»å¼€å§‹æ’­æ”¾ã€‚è¦æŸ¥çœ‹åŠ¨ç”»çš„å½“å‰çŠ¶æ€ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥readonlyå±žæ€§playStateï¼Œè¯¥å±žæ€§å°†è¿”å›žäº”ä¸ªå­—ç¬¦ä¸²ä¹‹ä¸€ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨å››ç§æ–¹æ³•ä¹‹ä¸€ä¿®æ”¹åŠ¨ç”»çš„å½“å‰çŠ¶æ€ï¼š var player = element.animate(/* ... */); console.log(player.playState); //"running" player.pause(); //"paused" player.play(); //"running" player.cancel(); //"idle"... è·³åˆ°åŽŸå§‹çŠ¶æ€ player.finish(); //"finished"...è·³åˆ°ç»“æŸçŠ¶æ€ æ­¤å¤–runningï¼Œpausedï¼Œidleï¼Œå’Œfinishedæ’­æ”¾çŠ¶æ€æœ‰ä¸€ä¸ªpendingçŠ¶æ€å®šä¹‰å½“æ’­æ”¾æˆ–æš‚åœä»»åŠ¡æ­£åœ¨ç­‰å¾…æ‰¹å‡†å³å°†å‘ç”Ÿã€‚ è¿™ä¸ªâ€œæ­¥è¡Œåœ†åœˆâ€ç¤ºä¾‹æ˜¾ç¤ºå…­ä¸ªåœ†ç¼©æ”¾ã€‚æ‚¨å¯ä»¥æš‚åœæˆ–æ’­æ”¾æ¯ä¸ªåœˆå­ï¼Œä»¥æŸ¥çœ‹ä¸Šè¿°æ’­æ”¾çŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚ See the Pen Blob That Walks by Dan Wilson (@danwilson) on CodePen. æ’­æ”¾é€ŸçŽ‡åœ¨ä¹‹å‰çš„CodePenç¤ºä¾‹ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªâ€œ2xâ€æŒ‰é’®ï¼Œæ‚¨å¯ä»¥æŒ‰æ›´æ”¹åŠ¨ç”»çš„æ’­æ”¾é€Ÿåº¦ï¼Œå°†å…¶åˆ‡æ¢åˆ°åŒå€é€Ÿåº¦ã€‚è¿™æ˜¯é€šè¿‡è¯»/å†™playbackRateå±žæ€§ã€‚ var player = element.animate(/* ... */); console.log(player.playbackRate); //1 player.playbackRate = 2; //åŒå€é€Ÿåº¦, ä¹Ÿå¯ä»¥ä½¿ç”¨åè¿›åˆ¶æ•°å­—æŽ§åˆ¶å®ƒé™ä½Žé€Ÿåº¦. åŠ¨ç”»å®ŒæˆåŽçš„å›žè°ƒä½¿ç”¨CSS transitionsï¼Œå½“è½¬æ¢ç»“æŸæ—¶ï¼Œé€šå¸¸ä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚ç±»ä¼¼åœ°ï¼ŒAnimationå…è®¸æ‚¨æŒ‡å®šä¸€ä¸ªonfinishå‡½æ•°ï¼Œåœ¨åŠ¨ç”»å®Œæˆæˆ–è°ƒç”¨ä¹‹å‰è®¨è®ºè¿‡çš„finish()æ–¹æ³•æ—¶è°ƒç”¨å®ƒã€‚è¯·æ³¨æ„ï¼Œæ ¹æ®è§„èŒƒï¼Œæ— æ³•å®Œæˆæ— é™æ¬¡è¿­ä»£çš„åŠ¨ç”»é›†ï¼Œä¹Ÿä¸èƒ½å®Œæˆä¸€ä¸ªå…·æœ‰playbackRate = 0 çš„åŠ¨ç”»é›†ã€‚è¿˜æœ‰ä¸€ä¸ªoncancelå¤„ç†ç¨‹åºï¼Œä»¥åŠåœ¨Animationå®Œæˆæ—¶ä½¿ç”¨Promisesçš„å†™æ³•ã€‚ ä»¥ä¸‹ç¤ºä¾‹ç”¨äºŽonfinishåœ¨åŠ¨ç”»å®ŒæˆåŽæ˜¾ç¤ºä¸€äº›ç»Ÿè®¡ä¿¡æ¯ï¼ˆå¹¶ä¸”å®ƒä¹Ÿå¾ˆå¥½åœ°åˆ‡æ¢åˆ°ä¸‹ä¸€æ¬¡å…³äºŽæ—¶é—´è½´çš„è®¨è®ºï¼‰ã€‚ See the Pen Timer Countdown by Dan Wilson (@danwilson) on CodePen. æ—¶é—´è½´æ¯ä¸ªAnimationéƒ½å…¬å¼€ä¸¤ä¸ªè¯»/å†™æ—¶é—´ç›¸å…³å±žæ€§ - currentTimeå’ŒstartTimeã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨å‰è€…ã€‚ currentTimeè¿”å›žåŠ¨ç”»å½“å‰çš„æ¯«ç§’æ•°ã€‚æœ€å¤§å€¼å°†ä¸ºå»¶è¿Ÿæ—¶é—´ +ï¼ˆæŒç»­æ—¶é—´è¿­ä»£æ¬¡æ•°ï¼‰ï¼ˆ`delay + (duration iterations)`ï¼‰ï¼Œå› æ­¤æ— é™æ¬¡è¿­ä»£å°†ä¸å…·æœ‰æœ€å¤§å€¼ã€‚ var player = element.animate([ {opacity: 1}, {opacity: 0} ], { duration: 1000, delay: 500, iterations: 3 }); player.onfinish = function() { console.log(player.currentTime); // 3500 }; æ’­æ”¾é€ŸçŽ‡å°†å½±å“æ—¶é—´è½´çš„æŒç»­æ—¶é—´ã€‚å¦‚æžœæ‚¨å°†æ’­æ”¾é€Ÿåº¦è®¾ç½®ä¸º10ï¼Œåˆ™æ‚¨çš„æœ€å¤§æ—¶é—´ä¿æŒä¸å˜ï¼Œä½†æ‚¨çš„æ—¶é—´è½´ä¼šå¿«10å€ã€‚è¿™ä¸ªæ¦‚å¿µä¹Ÿåœ¨ä¹‹å‰çš„â€œè®¡æ—¶å™¨å€’è®¡æ—¶â€ç¤ºä¾‹ä¸­æ˜¾ç¤ºã€‚ ç”±äºŽcurrentTimeæ˜¯å¯ è¯»/å†™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥è·³è½¬åˆ°æ—¶é—´è½´ä¸­çš„æŸä¸€ç‚¹ã€‚å®ƒä¹Ÿå¯ä»¥è®©æˆ‘ä»¬åŒæ­¥ä¸¤ä¸ªåŠ¨ç”»ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚ See the Pen Syncing Timelines - WAAPI by Dan Wilson (@danwilson) on CodePen. è¿˜æœ‰ä¸€ä¸ªé€‰é¡¹ï¼š reverse()ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨reverse()åè½¬ä¸€ä¸ªä¸Žä¹‹éžå¸¸ç›¸ä¼¼çš„åŠ¨ç”»play()ï¼ˆæ¯”å¦‚å®ƒä¼šæœ‰ç›¸åŒçš„playStateï¼‰ï¼Œé™¤äº†å®ƒå°†ä»¥ç›¸åçš„æ–¹å¼éåŽ†æ—¶é—´è½´ã€‚å½“åŠ¨ç”»å®Œæˆæ—¶ï¼ŒcurrentTimeå°†ä¸º0ã€‚ See the Pen waRKOm by Dan Wilson (@danwilson) on CodePen. ä¸‹ä¸€èŠ‚â€¦è¿™åŒ…å«äº†å¾ˆå¤šçš„ä¿¡æ¯ï¼Œä½†ä»ç„¶åªæ˜¯ç†Ÿæ‚‰ä¸€ä¸‹WAAPIæœ‰å“ªäº›å¯ç”¨çš„ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€äº›æ›´é«˜çº§çš„ç”¨æ³•ã€‚ æŸ¥çœ‹æœ¬ç³»åˆ—çš„å…¶ä½™éƒ¨åˆ†ï¼š ä»‹ç» ç¬¬1éƒ¨åˆ†ï¼šåˆ›å»ºåŸºæœ¬åŠ¨ç”» ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶ ç¬¬3éƒ¨åˆ†ï¼šå¤šä¸ªåŠ¨ç”» ç¬¬4éƒ¨åˆ†ï¼šGroupEffectså’ŒSequenceEffects ç¬¬5éƒ¨åˆ†ï¼šè¿åŠ¨è·¯å¾„ æ€»ç»“ä¸Žå›žé¡¾ ã€ç¿»è¯‘åŽŸæ–‡ã€‘: http://danielcwilson.com/blog/2015/07/animations-part-2/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Web Animations</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹ç¬¬1éƒ¨åˆ†:åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„åŠ¨ç”»]]></title>
    <url>%2F2017%2F06%2F26%2FWeb-Animations-API-Tutorial-Part-1-Creating-a-Basic-Animation.html</url>
    <content type="text"><![CDATA[Web Animations API å…¥é—¨æ•™ç¨‹ç¬¬1éƒ¨åˆ†:åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„åŠ¨ç”»è¿™æ˜¯ Web Animations API å…¥é—¨æ•™ç¨‹ç³»åˆ—çš„ç¬¬1éƒ¨åˆ†ã€‚æˆ‘åœ¨2016å¹´6æœˆæ›´æ–°äº†ç³»åˆ—å†…å®¹ï¼Œå› ä¸ºChromeå’ŒFirefoxéƒ½æŽ¨å‡ºäº†ä¸»è¦æ›´æ–°ï¼ˆä»¥åŠä¸€äº›å°è§„æ ¼æ›´æ”¹ï¼‰ã€‚å¦‚æžœæ‚¨æœ‰æƒ³æ³•æˆ–é—®é¢˜ï¼Œæˆ–çœ‹åˆ°æˆ‘å·²ç»è¯¯è§£äº†è¯¥è§„èŒƒï¼Œè¯·åœ¨Twitterä¸Šä¸Ž@dancwilsonè”ç³»ã€‚ æˆ‘ä»¬ä¹‹å‰åˆæ­¥çœ‹äº†ä¸‹ Web Animations APIï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å¾—åˆ°ä»»ä½•çœŸæ­£çš„ç»†èŠ‚ï¼Œæ‰€ä»¥çŽ°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ã€‚ WAAPIï¼ˆWeb Animations API, ä»¥ä¸‹å‡ç®€ç§°WAAPIï¼‰ä¸ºæ‚¨æä¾›æ›´å¤šçš„æŽ§åˆ¶æ¯”æ‚¨å¯èƒ½å·²ç»ä¹ æƒ¯ä½¿ç”¨çš„CSSåŠ¨ç”»ï¼Œä½†åœ¨æˆ‘ä»¬è¿›å…¥è¿™äº›æ¼”ç¤ºä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®åŸºæœ¬ç›®æ ‡ï¼šå¦‚ä½•é€šè¿‡æ­¤APIåˆ›å»ºåŸºæœ¬åŠ¨ç”»ï¼Ÿ åˆ›å»ºå…³é”®å¸§åŠ¨ç”»å¦‚æžœæ‚¨ç†Ÿæ‚‰CSS Transitions/ Animationsï¼Œè¿™å°†éžå¸¸ç†Ÿæ‚‰ã€‚ var player = document.getElementById('toAnimate').animate([ { transform: 'scale(1)', opacity: 1, offset: 0 }, { transform: 'scale(.5)', opacity: .5, offset: .3 }, { transform: 'scale(.667)', opacity: .667, offset: .7875 }, { transform: 'scale(.6)', opacity: .6, offset: 1 } ], { duration: 700, //æ¯«ç§’ easing: 'ease-in-out', //'linear', a bezier curveç­‰. delay: 10, //æ¯«ç§’ iterations: Infinity, //æˆ–å…¶ä»–æ•°å€¼ direction: 'alternate', //'normal', 'reverse', ç­‰. fill: 'forwards' //'backwards', 'both', 'none', 'auto' }); ä¸ºäº†å¯¹ç…§ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªç­‰æ•ˆçš„CSSå…³é”®å¸§åŠ¨ç”» @keyframes emphasis { 0% { transform: scale(1); opacity: 1; } 30% { transform: scale(.5); opacity: .5; } 78.75% { transform: scale(.667); opacity: .667; } 100% { transform: scale(.6); opacity: .6; } } #toAnimate { animation: emphasis 700ms ease-in-out 10ms infinite alternate forwards; } æˆ‘ä»¬å°†åˆ†è§£è¿™ä¸€åˆ‡ï¼Œè§£é‡Šæ¯ä¸€éƒ¨ä¼šã€‚ var player = document.getElementById('toAnimate').animate() åŠ¨ç”»å°†è¿”å›žä¸€ä¸ª Animationï¼ˆä»¥å‰åœ¨è§„èŒƒä¸­ç§°ä¸º AnimationPlayerï¼‰å¯¹è±¡ï¼Œè¿™å°†ç»™æˆ‘ä»¬åšäº›æœ‰è¶£çš„äº‹æƒ…ï¼Œæ‰€ä»¥ä½ å¯èƒ½æƒ³è¦è®¾ç½®ä¸€ä¸ªå˜é‡æ¥æ•èŽ·è¿™ä¸ªå¼•ç”¨ã€‚æˆ‘ä»¬æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„åŠ¨ç”»å…ƒç´ ï¼ˆè¿™é‡Œç®€å•åœ°ä½¿ç”¨document.getElementByIdï¼‰å¹¶è°ƒç”¨è¯¥animateå‡½æ•°ã€‚æ­¤åŠŸèƒ½æ˜¯æ–°æ·»åŠ çš„ç‰¹æ€§ï¼Œæ‰€ä»¥å¦‚æžœæ‚¨å¿…é¡»è¦æµ‹è¯•å®ƒçš„æ”¯æŒæ€§/å­˜åœ¨æ€§ï¼Œåœ¨ä½¿ç”¨å®ƒä¹‹å‰æˆ–è€…å¼•ç”¨ polyfillã€‚ è¯¥animateå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªKeyframeEffectså’Œä¸€ä¸ªAnimationEffectTimingPropertiesé€‰é¡¹çš„æ•°ç»„ã€‚æœ¬è´¨ä¸Šï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜ å°„åˆ°CSSä¸­çš„å†…å®¹@keyframesï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‚¨åœ¨CSSè§„åˆ™ä¸­ä½¿ç”¨çš„animation-*å±žæ€§ï¼ˆæˆ–animationç®€å†™ï¼Œå¦‚æˆ‘ä¹‹å‰çš„ç¤ºä¾‹ï¼‰æ‰€æŒ‡å®šçš„é‚£æ ·ã€‚è¿™é‡Œçš„ä¸»è¦ä¼˜ç‚¹æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å˜é‡æˆ–é‡ç”¨ä»¥å‰å®šä¹‰çš„KeyframeEffectsï¼Œè€Œä½¿ç”¨CSSæˆ‘ä»¬ä»…é™äºŽæˆ‘ä»¬åœ¨å‰é¢å£°æ˜Žçš„å€¼ã€‚ var player = document.getElementById('toAnimate').animate([ { transform: 'scale(1)', opacity: 1 }, { transform: 'scale(.5)', opacity: .5 }, { transform: 'scale(.667)', opacity: .667 }, { transform: 'scale(.6)', opacity: .6 } ]); å¯¹äºŽæ¯ä¸€ä¸ªKeyframeEffectï¼Œæˆ‘ä»¬å°†CSSä¸­çš„ç™¾åˆ†æ¯”åç§»é‡æ”¹ä¸ºoffsetä»Ž0åˆ°1 çš„åè¿›åˆ¶å€¼ã€‚å®ƒæ˜¯å¯é€‰çš„ï¼Œå¦‚æžœæ²¡æœ‰æŒ‡å®šï¼Œå®ƒä»¬å°†å‡åŒ€åˆ†å¸ƒï¼ˆå› æ­¤ï¼Œå¦‚æžœæ‚¨æœ‰ä¸‰ä¸ªï¼Œåˆ™ç¬¬ä¸€ä¸ªå…·æœ‰åç§»ä¸º0ï¼Œç¬¬äºŒä¸ªåç§»é‡ä¸º.5ï¼Œç¬¬ä¸‰ä¸ªåç§»é‡ä¸º1ï¼‰ã€‚æ‚¨è¿˜å¯ä»¥æŒ‡å®šeasingä¸Žanimation-timing-functionCSSä¸­ç›¸åŒçš„å±žæ€§ã€‚æ¯ä¸ªçš„å…¶ä»–å±žæ€§KeyframeEffectéƒ½æ˜¯åŠ¨ç”»çš„å±žæ€§ã€‚æ¯ä¸ªå±žæ€§çš„å€¼åº”è¯¥ç¬¦åˆåœ¨JavaScriptçš„element.styleä¸­çš„ç”¨æ³•ï¼Œå› æ­¤opacityå°†æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä½†transformä¼šæœŸæœ›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ var player = document.getElementById('toAnimate').animate([], { duration: 700, //milliseconds easing: 'ease-in-out', //'linear', a bezier curve, etc. delay: 10, //milliseconds iterations: Infinity, //or a number direction: 'alternate', //'normal', 'reverse', etc. fill: 'forwards' //'backwards', 'both', 'none', 'auto' }); æ—¶é—´å±žæ€§å°†æ˜ å°„åˆ°CSSåŠ¨ç”»å±žæ€§ï¼Œå°½ç®¡æœ‰æ—¶ä¼šä½¿ç”¨ä¸åŒçš„åç§°ã€‚è¾ƒæ—©çš„ä»£ç ç¤ºä¾‹è®¨è®ºäº†ä¸»è¦é€‰é¡¹ã€‚ ä»¥ä¸‹æ˜¯ä½¿ç”¨polyfillçš„ç¤ºä¾‹ï¼ˆä½†å¦‚æžœæ‚¨æ­£åœ¨Chrome 36+ï¼ŒOpera 23+æˆ–Firefox 48+ä¸­æŸ¥çœ‹ï¼Œåˆ™åº”ä½¿ç”¨å®žé™…çš„æµè§ˆå™¨å®žçŽ°ï¼‰ã€‚ç¬¬ä¸€åˆ—ç°è‰²å—ä½¿ç”¨WAAPIåŠ¨ç”»ï¼Œç¬¬äºŒåˆ—çº¢è‰²å—ä½¿ç”¨CSSå…³é”®å¸§è¿›è¡ŒåŠ¨ç”»ã€‚ See the Pen CSS Keyframes v. WAAPI by Dan Wilson (@danwilson) on CodePen. ä¸‹ä¸€èŠ‚â€¦çŽ°åœ¨æˆ‘ä»¬çŸ¥é“å¦‚ä½•åˆ›å»ºåœ¨CSSä¸­ç†ŸçŸ¥çš„ç­‰æ•ˆåŠ¨ç”»ï¼Œæˆ‘ä»¬å°†å¼€å§‹æŸ¥çœ‹Animation çš„ animate å‡½æ•°è¿”å›žçš„å¯¹è±¡ã€‚è¿™æ˜¯æˆ‘ä»¬çœ‹åˆ°çœŸæ­£çš„åŠŸèƒ½å’Œæ”¹è¿›çš„åœ°æ–¹ã€‚ æŸ¥çœ‹æœ¬ç³»åˆ—çš„å…¶ä½™éƒ¨åˆ†ï¼š ä»‹ç» ç¬¬1éƒ¨åˆ†ï¼šåˆ›å»ºåŸºæœ¬åŠ¨ç”» ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶ ç¬¬3éƒ¨åˆ†ï¼šå¤šä¸ªåŠ¨ç”» ç¬¬4éƒ¨åˆ†ï¼šGroupEffectså’ŒSequenceEffects ç¬¬5éƒ¨åˆ†ï¼šè¿åŠ¨è·¯å¾„ æ€»ç»“ä¸Žå›žé¡¾ ã€ç¿»è¯‘åŽŸæ–‡ã€‘ï¼š http://danielcwilson.com/blog/2015/07/animations-part-1/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Web Animations</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®©æˆ‘ä»¬è°ˆè°ˆ Web Animations API]]></title>
    <url>%2F2017%2F06%2F25%2Fanimations-intro.html</url>
    <content type="text"><![CDATA[è¿™æ˜¯ Web Animations API å…¥é—¨æ•™ç¨‹ç³»åˆ—çš„æ€»ç»“éƒ¨åˆ†ã€‚æˆ‘åœ¨2016å¹´6æœˆæ›´æ–°äº†ç³»åˆ—å†…å®¹ï¼Œå› ä¸ºChromeå’ŒFirefoxéƒ½æŽ¨å‡ºäº†ä¸»è¦æ›´æ–°ï¼ˆä»¥åŠä¸€äº›å°è§„æ ¼æ›´æ”¹ï¼‰ã€‚å¦‚æžœæ‚¨æœ‰æƒ³æ³•æˆ–é—®é¢˜ï¼Œæˆ–çœ‹åˆ°æˆ‘å·²ç»è¯¯è§£äº†è¯¥è§„èŒƒï¼Œè¯·åœ¨Twitterä¸Šä¸Ž@dancwilsonè”ç³»ã€‚ 2014å¹´å¤å¤©ï¼ŒGoogleå®£å¸ƒé€šè¿‡Polymeråœ¨ç½‘é¡µä¸­å±•ç¤ºMaterialè®¾è®¡â€¦ä½¿ç”¨polyfillæŠ€æœ¯æ”¯æŒå³å°†æŽ¨å‡ºçš„æ ‡å‡†Web Animations APIã€‚ æˆ‘æ²¡æœ‰å¬è¯´è¿‡è¿™ä¸ªAPIï¼Œä½†æ˜¯æˆ‘å¾ˆæ„Ÿå…´è¶£ï¼Œç‰¹åˆ«æ˜¯å› ä¸ºå®ƒè°ˆåˆ°äº†MotionPath(è¿åŠ¨è·¯å¾„)æ•ˆæžœã€‚è¿™è¿˜æ²¡æœ‰å®žçŽ°ï¼ˆä½ ä¼šåœ¨ç¬¬5éƒ¨åˆ†å‘çŽ°è¿™æ˜¯ä»€ä¹ˆï¼‰ï¼Œä½†æ˜¯å®ƒçš„ç›®æ ‡æ˜¯æä¾›ä¸€ç§ç»„åˆCSSï¼ŒJSå’ŒSVGçš„åŠ¨ç”»æ–¹å¼ï¼Œè®©æˆ‘æ„Ÿå…´è¶£ã€‚ä¸€å¹´ä»¥åŽï¼ŒChromeå’ŒFirefoxå¼€å§‹å®žæ–½ï¼Œpolyfillçš„è¿›æ­¥æ˜¯ç¨³å®šçš„ï¼ŒçŽ°åœ¨æ˜¯è®¤çœŸçœ‹å¾…å®ƒçš„æ—¶å€™äº†ã€‚ ä½†æ˜¯å¾ˆå°‘æœ‰äººåœ¨è°ˆè®ºWAAPIï¼æˆ‘å¸Œæœ›å¼€å§‹ä¸€ç³»åˆ—çªå‡ºæµè§ˆå™¨ï¼ˆå’Œpolyfillï¼‰åŠŸèƒ½çš„å¸–å­ï¼ŒæŽ¢ç´¢ä¸ºä»€ä¹ˆæˆ‘ä»¬æƒ³è¦è¿™ä¸ªAPIï¼Œå¹¶æ‰¾å‡ºç»†å¾®å·®åˆ«ã€‚å¸Œæœ›æˆ‘ä»¬ä¹Ÿèƒ½è®©æ›´å¤šçš„äººè®¨è®ºå’Œä½¿ç”¨è¿™ä¸ªAPIã€‚ ä»€ä¹ˆæ˜¯WebåŠ¨ç”»APIï¼Ÿæˆ‘ä»¬å°†é€šè¿‡å¼„æ¸…æ¥šå®ƒæ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒæ­£åœ¨åŠªåŠ›å®Œæˆçš„äº‹æƒ…æ¥å¼€å§‹è¿™ä¸ªæŽ¢ç´¢ã€‚ åŠ¨ç”»åœ¨è¿‡åŽ»çš„åå¹´ä¸­å·²ç»å–å¾—äº†å¾ˆå¥½çš„è¿›å±•ï¼Œå¹¶æä¾›äº†å¾ˆå¥½çš„CSSæ”¯æŒå’Œæ–°å¢žåŠŸèƒ½æ¥æ”¹è¿›JavaScriptã€‚ä½†æ˜¯ï¼Œæ¯ç§åŠ¨ç”»æ–¹æ³•ä»ç„¶å¯¹ä»–ä»¬æ‰€æä¾›çš„æ‰€æœ‰ä¼˜ç‚¹éƒ½æœ‰ä¸€äº›ç¼ºé™·ã€‚ CSSå…·æœ‰ç”¨äºŽå¹³æ»‘è¿‡æ¸¡çš„ç¡¬ä»¶åŠ é€Ÿï¼Œå¹¶ä¸”æµè§ˆå™¨å†…ç½®äº†æ”¯æŒï¼Œä½†è§„åˆ™åœ¨CSSä¸­å£°æ˜Žï¼Œå¹¶ä¸”éœ€è¦è·³è¿‡JavaScriptçŽ¯èŠ‚ä»¥èŽ·å¾—åŠ¨æ€æ›´æ”¹çš„å€¼ã€‚ requestAnimationFrameæœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œè®©æµè§ˆå™¨åœ¨åŠ¨ç”»æ—¶è¿›è¡Œä¼˜åŒ–ï¼Œä½†å¦‚æžœè¿˜æœ‰å¾ˆå¤šå…¶ä»–JavaScriptè¿è¡Œï¼Œå®ƒä»ç„¶å¯ä»¥æŒ‚èµ·ã€‚å®ƒä¹Ÿç»å¸¸éœ€è¦æ›´å¤šçš„æ•°å­¦çŸ¥è¯†æ¥èŽ·å¾—å®šæ—¶ã€‚ setIntervalè¢«å¾ˆå¤šå¼€å‘äººå‘˜ç”¨æ¥åšåŠ¨ç”»ï¼Œä½†å®ƒæ˜¯ä¸ç²¾ç¡®çš„ï¼Œå¯ä»¥å¯¼è‡´åŠ¨ç”»å¡é¡¿ã€‚ jQuery.animate() è¢«å…¶ä»–ä¸€äº›å¼€å‘äººå‘˜æŽ¨èåˆ¶ä½œåŠ¨ç”»ï¼Œä½†å¾€å¾€æœ‰æ€§èƒ½é—®é¢˜ã€‚ è¯¸å¦‚Velocityå’ŒGreenSockï¼ˆGSAPï¼‰è¿™æ ·çš„ç±»åº“å¯ä»¥æé«˜JavaScriptçš„æ€§èƒ½ï¼Œå¹¶ä¸”åœ¨è®¸å¤šæƒ…å†µä¸‹å·²ç»è¢«æµ‹è¯•æˆä¸ºæœ€å¥½çš„ã€‚ç„¶è€Œï¼Œä»–ä»¬ä»ç„¶éœ€è¦ç»´æŠ¤å’ŒåŠ è½½é¢å¤–çš„åº“ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å–œæ¬¢æµè§ˆå™¨çš„æ”¯æŒå°½å¯èƒ½å¤šï¼Œç›´æŽ¥è¢«ä¼˜åŒ–è¿‡çš„æ–¹å¼ã€‚çŽ°åœ¨æµè§ˆå™¨æœ‰document.querySelectorï¼Œå› ä¸ºæˆ‘ä»¬çœ‹åˆ°jQueryæä¾›é€‰æ‹©DOMå…ƒç´ çš„å€¼ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨çº§åˆ«åŒ…è£…å°½å¯èƒ½å¤šçš„åŠ¨ç”»æŽ§ä»¶ã€‚è¿™äº›åº“å¯ä»¥ä¸“æ³¨äºŽæä¾›æ›´æ–°çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æŒç»­è¿­ä»£ã€‚ Web Animations APIå°è¯•è¿™æ ·åšã€‚å®ƒæ—¨åœ¨å¸¦æ¥CSSæ€§èƒ½çš„å¼ºå¤§ï¼Œå¢žåŠ äº†JavaScriptçš„å¥½å¤„å’Œçµæ´»æ€§ï¼ˆä»¥åŠSVGåŠ¨ç”»ï¼Œæˆ‘ä»¬å°†åœ¨ä»¥åŽçš„ä¸€ç¯‡æ–‡ç« ä¸­è®¨è®ºï¼‰ï¼Œå¹¶å°†å…¶ç•™ç»™æµè§ˆå™¨ä½¿å…¶è¿è¡Œè‰¯å¥½ã€‚ è®©æˆ‘ä»¬é€šè¿‡æ·»åŠ æ–°çš„ä¸œè¥¿æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼åœ¨ä»¥å‰çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ”¶åˆ°ä¸€å°ç”µå­é‚®ä»¶ï¼Œè¡¨ç¤ºä»–ä»¬çŸ¥é“æˆ‘ä»¬æœ‰å¤ªå¤šçš„åœ°æ–¹å¯ä»¥æŸ¥çœ‹å…¬å¸å…¬å‘Š - ç”µå­é‚®ä»¶ï¼ŒåŠžå…¬å®¤çš„ç›‘è§†å™¨ï¼ŒYammerï¼ŒGoogle Chatå’ŒIntranet / wikiã€‚æ‰€ä»¥è¦è§£å†³ä»–ä»¬å®£å¸ƒçš„é—®é¢˜ï¼Œä»–ä»¬æ­£åœ¨æ·»åŠ ä¸€ä¸ªåšå®¢ã€‚ æˆ‘ç¬¬ä¸€æ¬¡å¬åˆ°æœ‰å…³Web Animations API å’Œæˆ‘å¬åˆ°æˆ‘å…¬å¸æ–°å¢žåšå®¢çš„æƒ³æ³•ä¸€æ · - è¿™åªä¼šä½¿äº‹æƒ…å˜å¾—æ›´ç³Ÿã€‚æžœç„¶ï¼Œåšå®¢æ²¡æœ‰é›†ä¸­ä»»ä½•ä¸œè¥¿ï¼Œå®ƒåªæ˜¯æ·»åŠ äº†ä¸€ä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬å¿…é¡»æŸ¥çœ‹æ–°é—»ï¼Œç„¶åŽä¸äº†äº†ä¹‹äº†ã€‚ è¿™æ„Ÿè§‰ä¸ä¸€æ ·ã€‚ å®¡æŸ¥è§„èŒƒï¼ˆç¬¬ä¸€æ¬¡æˆ‘åœ¨è¿™ä¸ªç¨‹åº¦ä¸ŠçœŸçš„åšåˆ°è¿™ä¸€ç‚¹ï¼‰æ˜¾ç¤ºäº†å¯¹æ­¤çš„å…³æ³¨ã€‚è¿™å¹¶ä¸æ„å‘³ç€å–ä»£çŽ°æœ‰çš„è¡Œä¸ºï¼ˆå°½ç®¡æœ‰äº›æµè§ˆå™¨ä¼¼ä¹Žå·²ç»ä¸èµžæˆæŸäº›è¡Œä¸ºï¼‰ï¼Œè€Œæ˜¯å°†å„ç§æ–¹å¼è”åˆèµ·æ¥ï¼Œå¹¶å…è®¸ä»–ä»¬è¿›è¡Œäº¤äº’ã€‚è¯­æ³•ç±»ä¼¼äºŽCSSï¼Œä½†æ·»åŠ äº†å˜é‡ï¼ŒæŽ§åˆ¶å’Œå®Œæˆå›žè°ƒçš„é€‰é¡¹ã€‚ ä¸‹ä¸€èŠ‚â€¦å› æ­¤ï¼ŒWeb Animations APIæ˜¯æ–°çš„ï¼Œå¹¶ä¸”å¼€å§‹å®žçŽ°ï¼ˆç›®å‰åœ¨Chromeå’ŒFirefoxä¸­ï¼‰ï¼Œé™¤äº†æ‹¥æœ‰ä¸€ä¸ªpolyfillã€‚ä¸‹æ¬¡æˆ‘ä»¬å®žé™…ä¸Šä¼šå¼€å§‹çœ‹çœ‹å®ƒä¸ºå¼€å‘è€…æä¾›äº†ä»€ä¹ˆâ€¦æœ‰ä¾‹å­ï¼ æŸ¥çœ‹æœ¬ç³»åˆ—çš„å…¶ä½™éƒ¨åˆ†ï¼š ä»‹ç» ç¬¬1éƒ¨åˆ†ï¼šåˆ›å»ºåŸºæœ¬åŠ¨ç”» ç¬¬2éƒ¨åˆ†ï¼šåŠ¨ç”»å’Œæ—¶é—´çº¿æŽ§åˆ¶ ç¬¬3éƒ¨åˆ†ï¼šå¤šä¸ªåŠ¨ç”» ç¬¬4éƒ¨åˆ†ï¼šGroupEffectså’ŒSequenceEffects ç¬¬5éƒ¨åˆ†ï¼šè¿åŠ¨è·¯å¾„ æ€»ç»“ä¸Žå›žé¡¾ ã€ç¿»è¯‘åŽŸæ–‡ã€‘ï¼šhttp://danielcwilson.com/blog/2015/07/animations-intro/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Web Animations</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[css åŠ¨ç”»å’Œ Web Animation API(WAAPI)å¯¹æ¯”]]></title>
    <url>%2F2017%2F06%2F22%2Fcss-animations-vs-web-animations-api.html</url>
    <content type="text"><![CDATA[css åŠ¨ç”»å’Œ Web Animation API(WAAPI)å¯¹æ¯”æœ‰ä¸€ä¸ªJavaScriptçš„åŠ¨ç”»åŽŸç”ŸAPIï¼Œç§°ä¸ºWeb Animation APIã€‚æˆ‘ä»¬åœ¨è¿™ç¯‡æ–‡ç« ä¸­ç§°ä¹‹ä¸ºWAAPIã€‚MDNæœ‰å¾ˆå¥½çš„æ–‡æ¡£ï¼ŒDan Wilson æœ‰ä¸€ä¸ªä¼Ÿå¤§çš„ç³»åˆ—æ–‡ç« ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒWAAPIå’ŒCSSä¸­å®Œæˆçš„åŠ¨ç”»ã€‚ å…³äºŽæµè§ˆå™¨æ”¯æŒçš„æç¤ºå°½ç®¡çŽ°åœ¨æµè§ˆå™¨çš„æ”¯æŒå¾ˆæœ‰é™ï¼Œä½†WAAPIæœ‰ä¸€ä¸ªå…¨é¢è€Œå¼ºå¤§çš„polyfillå·¥å…·ï¼Œè®©å®ƒå¯ä»¥åœ¨å½“å‰çš„ç”Ÿäº§çŽ¯å¢ƒä¸­ä½¿ç”¨ã€‚ ä¸€å¦‚æ—¢å¾€ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥Can I Use çš„æµè§ˆå™¨æ”¯æŒæ•°æ®ã€‚ç„¶è€Œï¼Œè¿™å¹¶æ²¡æœ‰æä¾›éžå¸¸å¥½çš„ä¿¡æ¯æ¥æ”¯æŒWAAPIçš„æ‰€æœ‰å­åŠŸèƒ½ã€‚è¿™æ˜¯ä¸€ä¸ªæ£€æŸ¥å™¨ï¼š See the Pen WAAPI Browser Support Test by Dan Wilson (@danwilson) on CodePen. æƒ³è¦ä¸ä½¿ç”¨polyfillè€Œä½“éªŒæ‰€æœ‰åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨Firefox Nightlyã€‚ WAAPIçš„åŸºç¡€çŸ¥è¯†å¦‚æžœæ‚¨æ›¾ç»ä½¿ç”¨jQuery.animate()ï¼ŒWAAPIçš„åŸºæœ¬è¯­æ³•åº”è¯¥çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰ã€‚ var element = document.querySelector('.animate-me'); element.animate(keyframes, 1000); è¯¥animateæ–¹æ³•æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼šå…³é”®å¸§å’ŒæŒç»­æ—¶é—´ã€‚ä¸ŽjQueryä¸åŒçš„æ˜¯ï¼Œå®ƒä¸ä»…å…·æœ‰å†…ç½®åœ¨æµè§ˆå™¨ä¸­çš„ä¼˜ç‚¹ï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿæ›´é«˜ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå…³é”®å¸§åº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡æ•°ç»„ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯æˆ‘ä»¬åŠ¨ç”»ä¸­çš„ä¸€ä¸ªå…³é”®å¸§ã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š var keyframes = [ { opacity: 0 }, { opacity: 1 } ]; ç¬¬äºŒä¸ªå‚æ•°ï¼ŒæŒç»­æ—¶é—´ï¼Œæ˜¯æˆ‘ä»¬æƒ³è¦åŠ¨ç”»æŒç»­å¤šä¹…ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æ˜¯1000æ¯«ç§’ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ›´ä»¤äººå…´å¥‹çš„ä¾‹å­ã€‚ ç”¨WAAPIé‡æ–°åˆ›å»ºanimista CSSåŠ¨ç”»è¿™é‡Œæœ‰ä¸€äº›CSSä»£ç ï¼Œä»Žéžå¸¸æ£’çš„animistaä¸­å¸å–äº†ä¸€äº›ç§°ä¸ºâ€œå¹»ç¯ç‰‡æ¨¡ç³Šçš„â€å…¥åœºåŠ¨ç”»çš„ä¸œè¥¿ã€‚çœ‹èµ·æ¥å¾ˆå¯çˆ±ã€‚ ä»¥ä¸‹æ˜¯CSSä¸­çš„å…³é”®å¸§ï¼š 0% { transform: translateY(-1000px) scaleY(2.5) scaleX(.2); transform-origin: 50% 0; filter: blur(40px); opacity: 0; } 100% { transform: translateY(0) scaleY(1) scaleX(1); transform-origin: 50% 50%; filter: blur(0); opacity: 1; } WAAPIä¸­çš„ä»£ç ç›¸åŒï¼š var keyframes = [ { transform: 'translateY(-1000px) scaleY(2.5) scaleX(.2)', transformOrigin: '50% 0', filter: 'blur(40px)', opacity: 0 }, { transform: 'translateY(0) scaleY(1) scaleX(1)', transformOrigin: '50% 50%', filter: 'blur(0)', opacity: 1 } ]; æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå°†å…³é”®å¸§åº”ç”¨åˆ°è¦è¿åŠ¨çš„ä»»ä½•å…ƒç´ æ˜¯å¤šä¹ˆå®¹æ˜“çš„äº‹ï¼š element.animate(keyframes, 700); ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘åªæŒ‡å®šäº†æŒç»­æ—¶é—´ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç¬¬äºŒä¸ªå‚æ•°æ¥ä¼ é€’æ›´å¤šçš„é€‰é¡¹ã€‚è‡³å°‘æˆ‘ä»¬ä¹Ÿåº”è¯¥æŒ‡å®šä¸€ä¸ªç¼“åŠ¨å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯å¯ç”¨é€‰é¡¹çš„å®Œæ•´åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›ç¤ºä¾‹å€¼ï¼š var options = { iterations: Infinity, iterationStart: 0, delay: 0, endDelay: 0, direction: 'alternate', duration: 700, fill: 'forwards', easing: 'ease-out', } element.animate(keyframes, options); æœ‰äº†è¿™äº›é€‰é¡¹ï¼Œæˆ‘ä»¬çš„åŠ¨ç”»å°†ä»Žå¤´å¼€å§‹ï¼Œæ²¡æœ‰ä»»ä½•å»¶è¿Ÿï¼Œæ°¸è¿œå¾ªçŽ¯åœ¨å‘å‰å’Œå‘åŽæ’­æ”¾ã€‚ See the Pen motion blur waapi circle by CSS GRID (@cssgrid) on CodePen. ä»¤äººçƒ¦æ¼çš„æ˜¯ï¼Œå¯¹äºŽæˆ‘ä»¬ç†Ÿæ‚‰CSSåŠ¨ç”»çš„äººæ¥è¯´ï¼Œä¸€äº›æœ¯è¯­ä¸Žæˆ‘ä»¬ä¹ æƒ¯çš„ä¸åŒã€‚è™½ç„¶åœ¨ç§¯æžçš„ä¸€é¢çœ‹ï¼Œæœ‰äº›äº‹æƒ…å†™èµ·æ¥æ›´å¿«ä¸€ç‚¹ï¼ è¿™é‡Œç”¨easingè€Œä¸æ˜¯animation-timing-function ä½¿ç”¨iterationsè€Œä¸æ˜¯animation-iteration-countã€‚å¦‚æžœæˆ‘ä»¬å¸Œæœ›åŠ¨ç”»æ°¸è¿œé‡å¤ï¼Œç”¨Infinityè€Œä¸æ˜¯infiniteã€‚æœ‰ç‚¹æ··ä¹±ï¼ŒInfinityä¸æ˜¯å¼•ç”¨ã€‚Infinityæ˜¯ä¸€ä¸ªJavaScriptå…³é”®å­—ï¼Œè€Œå…¶ä»–å€¼æ˜¯å­—ç¬¦ä¸²ã€‚ æˆ‘ä»¬ä½¿ç”¨æ¯«ç§’è€Œä¸æ˜¯ç§’ï¼Œå¯¹äºŽä¹‹å‰ç¼–å†™è¿‡è®¸å¤šJavaScriptçš„äººæ¥è¯´ï¼Œè¿™åº”è¯¥æ˜¯ç†Ÿæ‚‰çš„ã€‚ï¼ˆæ‚¨å¯ä»¥åœ¨CSSåŠ¨ç”»ä¸­ä½¿ç”¨æ¯«ç§’æ•°ï¼Œä½†å¾ˆå°‘æœ‰äººä½¿ç”¨ã€‚ï¼‰ æˆ‘ä»¬æ¥ä»”ç»†çœ‹çœ‹ä¸€ä¸ªé€‰é¡¹ï¼šiterationStartã€‚ å½“æˆ‘ç¬¬ä¸€æ¬¡ç¢°åˆ°iterationStart, æˆ‘è¢«éš¾ä½äº†ã€‚ä½ ä¸ºä»€ä¹ˆè¦æŒ‡å®šè¿­ä»£çš„å¼€å§‹ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡å°‘è¿­ä»£æ¬¡æ•°ï¼Ÿå½“æ‚¨ä½¿ç”¨åè¿›åˆ¶æ•°æ—¶ï¼Œæ­¤é€‰é¡¹éžå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å°†å…¶è®¾ç½®ä¸º .5ï¼ŒåŠ¨ç”»å°†å¼€å§‹ä¸€åŠã€‚è¦åšä¸€æ•´ä¸ªåŠ¨ç”»éœ€è¦ä¸¤åŠï¼Œæ‰€ä»¥å¦‚æžœä½ çš„è¿­ä»£æ¬¡æ•°è®¾ç½®ä¸º1ï¼Œå¹¶ä¸”ä½ çš„iterationStartè®¾ç½®ä¸º .5ï¼ŒåŠ¨ç”»å°†ä»Žä¸€åŠåˆ°åŠ¨ç”»ç»“æŸæ’­æ”¾ï¼Œç„¶åŽä»ŽåŠ¨ç”»å¼€å¤´å¼€å§‹ï¼Œç»“æŸäºŽä¸­é—´ï¼ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥å°†è¿­ä»£æ¬¡æ•°è®¾ç½®ä¸ºå°äºŽ1ã€‚ä¾‹å¦‚ï¼š var option = { iterations: .5, iterationStart: .5 } è¿™å°†ä»Žä¸­é—´åˆ°æœ€åŽæ’­æ”¾åŠ¨ç”»ã€‚ endDelayï¼šendDelayå¦‚æžœè¦å°†å¤šä¸ªåŠ¨ç”»ä¸²åœ¨ä¸€èµ·ï¼Œä½†æ˜¯å¸Œæœ›åœ¨ä¸€ä¸ªåŠ¨ç”»çš„ç»“å°¾å’Œä»»ä½•åŽç»­åŠ¨ç”»çš„å¼€å§‹ä¹‹é—´å­˜åœ¨å·®è·ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„è§†é¢‘ï¼ŒPatrick Brosset çš„è§£é‡Šã€‚ ç¼“åŠ¨ç¼“åŠ¨æ˜¯ä»»ä½•åŠ¨ç”»ä¸­æœ€é‡è¦çš„å…ƒç´ ä¹‹ä¸€ã€‚WAAPIä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§ä¸åŒçš„æ–¹å¼è®¾ç½®ç¼“åŠ¨å‡½æ•° - åœ¨æˆ‘ä»¬çš„å…³é”®å¸§é˜µåˆ—æˆ–æˆ‘ä»¬çš„é€‰é¡¹å¯¹è±¡å†…ã€‚ åœ¨CSSä¸­ï¼Œå¦‚æžœä½ åº”ç”¨äº†ï¼Œanimation-timing-function: ease-in-outä½ å¯èƒ½ä¼šå‡è®¾ä½ çš„åŠ¨ç”»çš„å¼€å§‹ä¼šease inï¼ŒåŠ¨ç”»çš„ç»“æŸå°†ä¼šease outã€‚å®žé™…ä¸Šï¼Œè¿™äº›ç¼“åŠ¨å‡½æ•°åº”ç”¨åœ¨å…³é”®å¸§ä¹‹é—´ï¼Œè€Œä¸æ˜¯æ•´ä¸ªåŠ¨ç”»ã€‚è¿™å¯ä»¥å¯¹åŠ¨ç”»çš„æ„Ÿè§‰è¿›è¡Œç»†ç²’åº¦çš„æŽ§åˆ¶ã€‚WAAPIè¿˜æä¾›è¿™ç§èƒ½åŠ›ã€‚ var keyframes = [ { opacity: 0, easing: 'ease-in' }, { opacity: 0.5, easing: 'ease-out' }, { opacity: 1 } ] å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨CSSå’ŒWAAPIä¸­ï¼Œæ‚¨ä¸åº”è¯¥ä¼ å…¥æœ€åŽä¸€å¸§çš„ç¼“åŠ¨å€¼ï¼Œå› ä¸ºè¿™å°†ä¸èµ·ä½œç”¨ã€‚è¿™æ˜¯å¾ˆå¤šäººçŠ¯çš„é”™è¯¯ã€‚ æœ‰æ—¶å€™ï¼Œåœ¨æ•´ä¸ªåŠ¨ç”»ä¸­æ·»åŠ ç¼“åŠ¨æ•ˆæžœæ›´ä¸ºç›´è§‚ã€‚è¿™åœ¨CSSæ˜¯ä¸å¯èƒ½çš„ï¼Œä½†çŽ°åœ¨å¯ä»¥å®žçŽ°ä¸ŽWAAPIã€‚ var options = { duration: 1000, easing: 'ease-in-out', } ä½ å¯ä»¥çœ‹åˆ°è¿™ä¸¤ç§ç¼“åŠ¨åœ¨CodePenä¸Šçš„åŒºåˆ«ï¼š See the Pen Same animation, different easing by CSS GRID (@cssgrid) on CodePen. ease vs linearå€¼å¾—æ³¨æ„çš„æ˜¯CSSåŠ¨ç”»å’ŒWAAPIä¹‹é—´çš„å¦ä¸€ä¸ªåŒºåˆ«ï¼šCSS easeçš„é»˜è®¤å€¼æ˜¯ease,WAAPIçš„é»˜è®¤å€¼linearã€‚ Easeå®žé™…ä¸Šæ˜¯ä¸€ä¸ªç‰ˆæœ¬ï¼Œease-in-outæ˜¯ä¸€ä¸ªéžå¸¸å¥½çš„é€‰æ‹©ï¼Œå¦‚æžœä½ æ„Ÿåˆ°æ‡’æƒ°ã€‚åŒæ—¶ï¼Œlinear æ˜¯æ²‰é—·çš„å’Œæ— ç”Ÿæœºçš„ - ä¸€è‡´çš„é€Ÿåº¦çœ‹èµ·æ¥æœºæ¢°å’Œä¸è‡ªç„¶ã€‚å®ƒè¢«é€‰ä¸ºé»˜è®¤å€¼ï¼Œå¯èƒ½å› ä¸ºå®ƒæ˜¯æœ€ä¸­ç«‹çš„é€‰é¡¹ã€‚ç„¶è€Œï¼Œåœ¨WAAPIä¸­ä½¿ç”¨æ—¶ï¼Œä½¿ç”¨ç¼“åŠ¨æ¯”åœ¨CSSæ›´é‡è¦ï¼Œä»¥å…æ‚¨çš„åŠ¨ç”»çœ‹èµ·æ¥å¾ˆä¹å‘³å’Œæœºæ¢°åœ°ã€‚ æ€§èƒ½WAAPIæä¾›ä¸ŽCSSåŠ¨ç”»ç›¸åŒçš„æ€§èƒ½æ”¹è¿›ï¼Œå°½ç®¡è¿™å¹¶ä¸æ„å‘³ç€å¹³æ»‘çš„åŠ¨ç”»æ˜¯ä¸å¯é¿å…çš„ã€‚ æˆ‘å¸Œæœ›è¿™ä¸ªAPIçš„æ€§èƒ½ä¼˜åŒ–æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é¿å…ä½¿ç”¨will-changeå’Œå®Œå…¨hack translateZ - æœ€ç»ˆå¯èƒ½ã€‚ä½†æ˜¯ï¼Œè‡³å°‘åœ¨ç›®å‰çš„æµè§ˆå™¨å®žçŽ°ä¸­ï¼Œè¿™äº›å±žæ€§åœ¨å¤„ç†é—ªçƒé—®é¢˜ï¼ˆjank issueï¼‰æ–¹é¢ä»ç„¶æ˜¯æœ‰å¸®åŠ©å’Œå¿…è¦çš„ã€‚ ä½†æ˜¯ï¼Œè‡³å°‘å¦‚æžœæ‚¨çš„åŠ¨ç”»æœ‰å»¶è¿Ÿï¼Œåˆ™æ— éœ€æ‹…å¿ƒä½¿ç”¨will-changeã€‚ç½‘ç»œåŠ¨ç”»è§„èŒƒçš„ä¸»è¦ä½œè€…å¯¹â€œAnimation for Work Slack communityâ€æå‡ºäº†ä¸€äº›æœ‰è¶£çš„å»ºè®®ï¼Œå¸Œæœ›ä»–ä¸ä»‹æ„æˆ‘åœ¨è¿™é‡Œé‡å¤ï¼š å¦‚æžœæ‚¨æœ‰ä¸€ä¸ªç§¯æžçš„å»¶è¿Ÿï¼Œæ‚¨ä¸éœ€è¦will-changeå› ä¸ºæµè§ˆå™¨å°†åœ¨å»¶è¿Ÿå¼€å§‹æ—¶è¿›è¡Œåˆ†å±‚ï¼Œå½“åŠ¨ç”»å¯åŠ¨æ—¶ï¼Œå®ƒå°†å‡†å¤‡å°±ç»ªã€‚ WAAPIå¯¹æˆ˜CSSåŠ¨ç”»ï¼ŸWAAPIä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåœ¨JavaScriptä¸­å®žçŽ°cssä¸­çš„è¯­æ³•ã€‚ç„¶è€Œï¼Œä»–ä»¬ä¸åº”è¯¥è¢«è§†ä¸ºå¯¹æ‰‹ã€‚å¦‚æžœæˆ‘ä»¬å†³å®šåšæŒä½¿ç”¨CSSè¿›è¡Œanimationså’Œtransitionsï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¸ŽWAAPIè¿›è¡ŒåŠ¨ç”»äº¤äº’ã€‚ Animation å¯¹è±¡è¯¥.animate()æ–¹æ³•ä¸ä»…ä»…æ˜¯åŠ¨ç”»æˆ‘ä»¬çš„å…ƒç´ ï¼Œå®ƒä¹Ÿè¿”å›žä¸€äº›ä¸œè¥¿ã€‚ å¦‚æžœæˆ‘ä»¬çœ‹çœ‹æŽ§åˆ¶å°ä¸­çš„è¿”å›žå€¼ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å®ƒçš„ä¸€ä¸ªåŠ¨ç”»å¯¹è±¡ã€‚è¿™ä¸ºæˆ‘ä»¬æä¾›äº†å„ç§å„æ ·çš„åŠŸèƒ½ï¼Œå…¶ä¸­ä¸€äº›æ˜¯éžå¸¸ä¸è¨€è‡ªæ˜Žçš„myAnimation.pause()ã€‚é€šè¿‡æ›´æ”¹animation-play-stateå±žæ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡CSSåŠ¨ç”»å®žçŽ°ç±»ä¼¼çš„ç»“æžœï¼Œä½†WAAPIè¯­æ³•æ¯”ç¨å¾®ç®€å•element.style.animationPlayState = "paused"ã€‚æˆ‘ä»¬ä¹Ÿæœ‰æƒåŠ›è½»æ¾åœ°æ‰­è½¬æˆ‘ä»¬çš„åŠ¨ç”»myAnimation.reverse()ï¼Œå†æ¬¡ï¼Œanimation-directionä¸Žä½¿ç”¨æˆ‘ä»¬çš„è„šæœ¬æ›´æ”¹CSSå±žæ€§ç›¸æ¯”ï¼Œç¨å¾®æœ‰ç‚¹æ”¹è¿›ã€‚ ç„¶è€Œï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œ@keyframeç”¨JavaScriptè¿›è¡Œæ“ä½œå¹¶ä¸æ˜¯ä¸–ç•Œä¸Šæœ€ç®€å•çš„äº‹æƒ…ã€‚å³ä½¿åƒé‡æ–°å¯åŠ¨åŠ¨ç”»ä¸€æ ·ç®€å•ï¼Œå°±åƒChris Coyier å…ˆå‰å†™è¿‡çš„é‚£æ ·ï¼Œè¿™ä¸ªæŠ€å·§ä¹Ÿæœ‰ä¸€äº›æŠ€å·§ã€‚ä½¿ç”¨WAAPIï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨myAnimation.play()ï¼Œå®ƒä»Žä¸€å¼€å§‹å°±é‡æ’­åŠ¨ç”»ï¼Œå¦‚æžœå®ƒå·²ç»å®Œæˆï¼Œæˆ–è€…å¦‚æžœæˆ‘ä»¬æš‚åœæ’­æ”¾ï¼Œåˆ™ä»Žä¸­é—´è¿­ä»£ç»§ç»­æ’­æ”¾åŠ¨ç”»ã€‚ æˆ‘ä»¬ç”šè‡³å¯ä»¥è½»æ¾åœ°æ”¹å˜åŠ¨ç”»çš„é€Ÿåº¦ã€‚ myAnimation.playbackRate = 2; // speed it up myAnimation.playbackRate = .4; // use a number less than one to slow it down getAnimationsï¼ˆï¼‰æ­¤æ–¹æ³•å°†è¿”å›žä»»ä½•åŠ¨ç”»å¯¹è±¡çš„æ•°ç»„ï¼Œä»¥ä¾¿æˆ‘ä»¬ä½¿ç”¨WAAPIå®šä¹‰çš„ä»»ä½•åŠ¨ç”»ä»¥åŠ ä»»ä½•CSS transitionsæˆ–animationsã€‚ element.getAnimations() // returns any animations or transitions applied to our element using CSS or WAAPI å¦‚æžœæ‚¨æ„Ÿè§‰ä½¿ç”¨CSSæ¥å®šä¹‰å’Œåº”ç”¨æ‚¨çš„åŠ¨ç”»æ¯”è¾ƒé¡ºæ‰‹ï¼ŒgetAnimations()å¯ä»¥ä½¿ç”¨APIâ€‹â€‹ä¸Ž@keyframes ç»“åˆä½¿ç”¨ã€‚æ‚¨å¯ä»¥ç»§ç»­ä½¿ç”¨CSSè¿›è¡Œå¤§éƒ¨åˆ†åŠ¨ç”»å·¥ä½œï¼Œå¹¶åœ¨éœ€è¦APIæ—¶èŽ·å¾—APIçš„ä¼˜åŠ¿ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯å¤šä¹ˆç®€å•ã€‚ å³ä½¿ä¸€ä¸ªDOMå…ƒç´ åªæœ‰ä¸€ä¸ªåŠ¨ç”»åº”ç”¨åˆ°å®ƒï¼ŒgetAnimations()ä¹Ÿå°†å§‹ç»ˆè¿”å›žä¸€ä¸ªæ•°ç»„ã€‚æˆ‘ä»¬æ¥æŠ“ä½é‚£ä¸ªå•ä¸€çš„åŠ¨ç”»å¯¹è±¡æ¥å¤„ç†ã€‚ var h2 = document.querySelector("h2"); var myCSSAnimation = h2.getAnimations()[0]; çŽ°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„CSSåŠ¨ç”»ä¸­ä½¿ç”¨web animation API :) myCSSAnimation.playbackRate = 4; myCSSAnimation.reverse(); Promiseå’Œäº‹ä»¶æˆ‘ä»¬å·²ç»æœ‰å¤šç§é€šè¿‡CSSè§¦å‘çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„JavaScriptä»£ç åˆ©ç”¨çš„æœ‰ï¼šanimationstartï¼Œanimationendï¼Œanimationiterationå’Œtransitionendã€‚æˆ‘ç»å¸¸éœ€è¦æ”¶å¬animationsæˆ–transitionsçš„ç»“æŸï¼Œä»¥ä¾¿ä»ŽDOMä¸­åˆ é™¤åº”ç”¨äºŽå®ƒçš„å…ƒç´ ã€‚ åœ¨WAAPI ä¸­ä½¿ç”¨animationendæˆ–transitionendä¸ºæ­¤ç›®çš„ç›¸å½“äºŽå†æ¬¡ä½¿ç”¨åŠ¨ç”»å¯¹è±¡ï¼š myAnimation.onfinish = function() { element.remove(); } WAAPIä¸ºæˆ‘ä»¬æä¾›äº†äº‹ä»¶å’ŒPromiseçš„é€‰æ‹©ã€‚æˆ‘ä»¬çš„åŠ¨ç”»çš„.finishedå±žæ€§å¯¹è±¡å°†åœ¨åŠ¨ç”»ç»“æŸæ—¶è¿”å›žä¸€ä¸ªresolve çš„ Promiseã€‚ä»¥ä¸‹æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œå°±åƒä½¿ç”¨Promiseä¸€æ ·ï¼š myAnimation.finished.then(() => element.remove()) æˆ‘ä»¬æ¥çœ‹çœ‹Mozillaå¼€å‘äººå‘˜ç½‘ç»œä¸­çš„ä¸€ä¸ªç¨å¾®æœ‰ç‚¹çœç•¥çš„ä¾‹å­ã€‚Promise.allæŽ¥æ”¶ä¸€ä¸ªPromiseæ•°ç»„ï¼Œä¸€æ—¦æ‰€æœ‰è¿™äº›Promiseå¾—åˆ°è§£å†³ï¼Œæ‰ä¼šè¿è¡Œæˆ‘ä»¬çš„å›žè°ƒå‡½æ•°ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œelement.getAnimations()è¿”å›žä¸€ä¸ªåŠ¨ç”»å¯¹è±¡æ•°ç»„ã€‚æˆ‘ä»¬å¯ä»¥å°†æ•°ç»„ä¸­çš„æ‰€æœ‰åŠ¨ç”»å¯¹è±¡æ˜ å°„åˆ°æ¯ä¸ªåŠ¨ç”»å¯¹è±¡.finishedä¸Šï¼Œä¸ºæˆ‘ä»¬æä¾›æ‰€éœ€çš„Promiseæ•°ç»„ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåªæœ‰åœ¨é¡µé¢ä¸Šçš„æ‰€æœ‰åŠ¨ç”»å®ŒæˆåŽï¼Œæˆ‘ä»¬çš„å‡½æ•°æ‰èƒ½è¿è¡Œã€‚ Promise.all(document.getAnimations().map(animation => animation.finished)).then(function() { // do something cool }); æœªæ¥æœ¬æ–‡ä¸­æåˆ°çš„åŠŸèƒ½åªæ˜¯å¼€å§‹ã€‚ç›®å‰çš„è§„èŒƒå’Œå®žè·µçœ‹èµ·æ¥æ˜¯ä¸€ä»¶ä¼Ÿå¤§çš„äº‹æƒ…çš„å¼€å§‹ã€‚ ã€Œç¿»è­¯åŽŸæ–‡ã€ï¼šhttps://css-tricks.com/css-animations-vs-web-animations-api/?utm_source=frontendfocus]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>Web Animations</tag>
        <tag>css3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack3å®˜æ–¹æ­£å¼å‘å¸ƒ,äº®ç‚¹:ä½œç”¨åŸŸæå‡ï¼Œâ€œé­”æ³•æ³¨é‡Šâ€ï¼Œä»¥åŠæ›´å¤šæ–°ç‰¹æ€§ï¼]]></title>
    <url>%2F2017%2F06%2F21%2Fwebpack3-publish-scope-hoisting-magic-comments-and-more.html</url>
    <content type="text"><![CDATA[ä½œç”¨åŸŸæå‡ï¼Œâ€œé­”æ³•æ³¨é‡Šâ€ï¼Œä»¥åŠæ›´å¤šæ–°ç‰¹æ€§ï¼åŽŸæ–‡ åœ¨æˆ‘ä»¬å‘å¸ƒäº† webpack v2 ä¹‹åŽï¼Œæˆ‘ä»¬æ›¾å‘ç¤¾åŒºåšäº†ä¸€äº›æ‰¿è¯ºã€‚ æˆ‘ä»¬æ‰¿è¯ºï¼Œæˆ‘ä»¬å°†æä¾›ç”¨æˆ·æŠ•ç¥¨çš„åŠŸèƒ½ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬æ‰¿è¯ºæˆ‘ä»¬çš„å‘å¸ƒå‘¨æœŸä¼š æ›´å¿«ï¼Œæ›´ç¨³å®šã€‚ è¿™æ¬¡æ²¡æœ‰ beta ç‰ˆæœ¬ï¼Œå®Œå…¨å‘ä¸‹å…¼å®¹ã€‚æˆ‘ä»¬æ‰¿è¯ºè®©ä½ ä»¬ã€è®© webpack æˆé•¿çš„ç¤¾åŒºæ›´è½»æ¾çš„ä½¿ç”¨ã€‚webpack å›¢é˜Ÿè‡ªè±ªåœ°å®£å¸ƒï¼Œä»Šå¤©æˆ‘ä»¬å·²ç»å‘å¸ƒäº† webpack 3.0.0ï¼ çŽ°åœ¨å°±å¯ä»¥ä¸‹è½½æˆ–å‡çº§ï¼ npm install webpack@3.0.0 --save-dev æˆ–è€…ä½¿ç”¨ yarn add webpack@3.0.0 --dev ä»Ž webpack 2 è¿ç§»åˆ° 3ï¼Œåªéœ€è¦æ‰§è¡Œå‡çº§å‘½ä»¤ï¼Œåœ¨ä½¿ç”¨ä¸Šæ²¡æœ‰ä»»ä½•å·®åˆ«ã€‚æˆ‘ä»¬å°†è¿™æ¬¡å‡çº§æ ‡è®°ä¸ºç‰ˆæœ¬çš„é‡å¤§å‡çº§ï¼Œæ˜¯å› ä¸ºå†…éƒ¨çš„çªç ´æ€§å˜åŒ–å¯èƒ½ä¼šå½±å“æŸäº›æ’ä»¶çš„ä½¿ç”¨ã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œ98%çš„å‡çº§çš„ç”¨æˆ·éƒ½æ²¡æœ‰é‡åˆ°ä»»ä½•ä¸å…¼å®¹ï¼ æœ‰å“ªäº›æ–°ç‰¹æ€§?åƒä¸Šæ–‡æåˆ°çš„ä¸€æ ·ï¼Œæˆ‘ä»¬å‘å¸ƒäº†ä¸€äº›ç”±ç”¨æˆ·æŠ•ç¥¨é€‰å‡ºçš„åŠŸèƒ½ï¼Œæ„Ÿè°¢ Githubï¼ŒèµžåŠ©å•†å’Œæˆ‘ä»¬çš„æ”¯æŒè€…ï¼Œæœ‰äº†ä»–ä»¬æˆ‘ä»¬æ‰èƒ½åšå‡ºæ¯ä¸€ä¸ªæ”¹è¿›ã€‚ðŸ˜ ðŸ”¬ä½œç”¨åŸŸæå‡ï¼ˆScope Hoistingï¼‰ðŸ”¬ä½œç”¨åŸŸæå‡æ˜¯ webpack 3 çš„é‡ç‚¹åŠŸèƒ½ã€‚ä¹‹å‰ webpack åœ¨æ‰“åŒ…æ—¶ï¼Œæ‚¨çš„ bundle ä¸­çš„æ¯ä¸ªæ¨¡å—éƒ½å°†è¢«åŒ…è£…åœ¨å•ç‹¬çš„å‡½æ•°é—­åŒ…ä¸­ã€‚è¿™äº›é—­åŒ…ä¼šä½¿æ‚¨çš„ JavaScript åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œé€Ÿåº¦æ›´æ…¢ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåƒ Closure Compiler å’Œ RollupJS è¿™æ ·çš„å·¥å…·å¯ä»¥å°†æ‰€æœ‰æ¨¡å—åŒ…è£…åœ¨ä¸€ä¸ªå¤§çš„é—­åŒ…å†…ï¼Œä»Žè€Œä½¿æ‚¨çš„ä»£ç åœ¨æµè§ˆå™¨ä¸­å…·æœ‰æ›´å¿«çš„æ‰§è¡Œé€Ÿåº¦ã€‚ 70K => 37K (gzip!) savings on our main bundle using #webpack 3 RC.2 + ModuleConcatenationPlugin ðŸ˜² ðŸ”¥ Awesome work @TheLarkInn @wSokra et al! pic.twitter.com/zVfQoivT9dâ€” Jeremy Gayed ðŸ¤“ (@tizmagik) June 17, 2017 è€ŒçŽ°åœ¨ï¼Œä½¿ç”¨ webpack 3ï¼Œæ‚¨çŽ°åœ¨å¯ä»¥ åœ¨é…ç½®ä¸­æ·»åŠ ä¸‹é¢çš„æ’ä»¶ä»¥å¯ç”¨ä½œç”¨åŸŸæå‡ï¼š module.exports = { plugins: [ new webpack.optimize.ModuleConcatenationPlugin() ] }; ä½œç”¨åŸŸæå‡æ˜¯åŸºäºŽ ECMAScript Module è¯­æ³•å®žçŽ°çš„ä¸€ä¸ªç‰¹å¾ã€‚é€šè¿‡è¿™ä¸ªï¼Œwebpack å¯ä»¥æ ¹æ®ä½ æ­£åœ¨ä½¿ç”¨ä»€ä¹ˆæ ·çš„æ¨¡å—å’Œä¸€äº›å…¶ä»–æ¡ä»¶æ¥å›žé€€åˆ°æ­£å¸¸çš„æ†ç»‘ã€‚ ä¸ºäº†äº†è§£ä»€ä¹ˆè§¦å‘äº†è¿™äº›å›žé€€ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª --display-optimization-bailoutcli æ ‡å¿—ï¼Œå®ƒå°†å‘Šè¯‰ä½ æ˜¯ä»€ä¹ˆå¯¼è‡´çš„å›žé€€ã€‚ Total evaluation script time went from 2.52s to 2.06s, first meaningful paint from 3.43s to 2.70s and all initial event fired 20% earlierâ€” Jeremias Menichelli (@jeremenichelli) June 18, 2017 åŒæ—¶ï¼Œç”±äºŽä½œç”¨åŸŸæå‡ä¼šç§»é™¤æ¨¡å—å¤–çš„å‡½æ•°åŒ…è£…ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸€äº›å°çš„ä½“ç§¯æ”¹è¿›ã€‚ç„¶è€Œï¼Œæ›´æ˜¾ç€çš„æ”¹è¿›æ˜¯JavaScriptåœ¨æµè§ˆå™¨ä¸­åŠ è½½çš„é€Ÿåº¦ã€‚ å¦‚æžœæ‚¨åœ¨æ¯”è¾ƒä½¿ç”¨ä¹‹å‰å’Œä¹‹åŽæ—¶å‘çŽ°åŠ è½½é€Ÿåº¦å–å¾—äº†éžå¸¸æ£’çš„æ”¹è¿›ï¼Œè¯·éšæ—¶å›žå¤ä¸€äº›æ•°æ®ï¼Œæˆ‘ä»¬å°†å¾ˆè£å¹¸åˆ†äº«ï¼ ðŸ”® é­”æ³•æ³¨é‡Š â€Magic Commentsâ€ ðŸ”®å½“æˆ‘ä»¬åœ¨webpack 2ä¸­å¼•å…¥ä½¿ç”¨åŠ¨æ€å¯¼å…¥è¯­æ³•ï¼ˆimport()ï¼‰æ—¶ï¼Œç”¨æˆ·è¡¨ç¤ºï¼Œä»–ä»¬ä¸èƒ½åƒä½¿ç”¨ require.ensure ä¸€æ ·åˆ›å»ºå‘½å chunkã€‚æˆ‘ä»¬çŽ°åœ¨ä»‹ç»ç”±ç¤¾åŒºåˆ›å»ºçš„â€œé­”æ³•æ³¨é‡Šâ€ï¼Œå®ƒå¯ä»¥ä¼ é€’ chunk åç§°ï¼Œè¿˜æœ‰æ›´å¤šåŠŸèƒ½ï¼Œä¾‹å¦‚å¯ä»¥æ·»åŠ æ›´å¤šçš„å†…è”æ³¨é‡Šåˆ° import() è¯­å¥ä¸­ã€‚ import(/* webpackChunkName: "my-chunk-name" */ 'module'); é€šè¿‡ä½¿ç”¨æ³¨é‡Šï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨ä½¿ç”¨åŠ¨æ€å¯¼å…¥è¯­æ³•çš„åŒæ—¶ï¼Œå¯¹ä»£ç å—è¿›è¡Œå‘½åã€‚ å°½ç®¡è¿™æ˜¯æˆ‘ä»¬åœ¨ v2.4 å’Œ v2.6 ä¸­å‘å¸ƒçš„æŠ€æœ¯ç‰¹æ€§ï¼Œä½†åœ¨ v3 ä¸­ï¼Œæˆ‘ä»¬ä¿®å¤äº†è¿™äº›åŠŸèƒ½çš„ä¸€äº›é”™è¯¯ï¼Œä½¿å…¶å˜å¾—æ›´ç¨³å®šã€‚ åŒæ—¶ï¼ŒçŽ°åœ¨å…è®¸åŠ¨æ€å¯¼å…¥è¯­æ³•å…·æœ‰ä¸Ž require.ensure ç›¸åŒçš„çµæ´»æ€§ã€‚ TIL webpack /chunkName/ comments aren't just for nicer filenamesâ€”also great for organizing your chunks. Even interops w/ commonsChunk! pic.twitter.com/wjdT9y6oTEâ€” Adam Rackis (@AdamRackis) June 7, 2017 è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬æœ€æ–°æ–‡æ¡£çš„ä»£ç åˆ†å‰²éƒ¨åˆ†ï¼Œæ–‡æ¡£é«˜äº®äº†è¿™äº›æ–°åŠŸèƒ½ï¼ ðŸ˜ æŽ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼ŸðŸ˜æˆ‘ä»¬æœ‰å¾ˆå¤šåŠŸèƒ½å’Œå¢žå¼ºåŠŸèƒ½æƒ³è¦æŽ¨å‡ºï¼ä½†æˆ‘ä»¬éœ€è¦äº†è§£ç”¨æˆ·éœ€æ±‚çš„ä¼˜å…ˆçº§ã€‚æ‰€ä»¥è®¿é—®æˆ‘ä»¬çš„æŠ•ç¥¨é¡µé¢ï¼Œå¹¶æå‡ºä½ æƒ³çœ‹åˆ°çš„åŠŸèƒ½ï¼ è¿™äº›æ˜¯æˆ‘ä»¬å¸Œæœ›å¸¦ç»™æ‚¨çš„ä¸€äº›åŠŸèƒ½ï¼š æ›´å¥½åœ°æž„å»ºç¼“å­˜ æ›´å¿«çš„åˆå§‹æž„å»ºå’Œå¢žé‡æž„å»º æ›´å¥½çš„TypeScriptä½“éªŒ æ”¹è¿›é•¿æœŸç¼“å­˜ WASMæ¨¡å—æ”¯æŒ æ”¹å–„ç”¨æˆ·ä½“éªŒ ðŸ™‡ è‡´è°¢ ðŸ™‡æ„Ÿè°¢æˆ‘ä»¬æ‰€æœ‰çš„ç”¨æˆ·ï¼Œè´¡çŒ®è€…ï¼Œæ–‡æ¡£ä½œè€…ï¼Œåšå®¢ï¼ŒèµžåŠ©å•†ï¼Œæ”¯æŒè€…å’Œç»´æŠ¤è€…ã€‚æ˜¯ä»–ä»¬éƒ½å¸®åŠ©æˆ‘ä»¬ç¡®ä¿ webpack åœ¨æœªæ¥å‡ å¹´æˆåŠŸã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ„Ÿè°¢æ‰€æœ‰äººã€‚webpack å‘å±•åˆ°çŽ°åœ¨ä¸Žä½ çš„æ”¯æŒå¯†ä¸å¯åˆ†ï¼Œæˆ‘ä»¬è¿«ä¸åŠå¾…åœ°æƒ³è¦ä¸Žä½ åˆ†äº«æœªæ¥ webpack çš„æ–°è¿›å±•ï¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>å‰ç«¯æž„å»º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flowå’ŒTypeScriptä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£]]></title>
    <url>%2F2017%2F06%2F14%2Fcompare-with-Flow-and-TypeScript.html</url>
    <content type="text"><![CDATA[Flowå’ŒTypeScriptä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£é‡‡ç”¨Flowï¼†TypeScript, ä¸¤è€…ä¸Šæ‰‹æµç¨‹ä¹‹é—´çš„æ¯”è¾ƒã€‚ è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬æƒ³è¦é‡‡ç”¨ä¸€ç§ç±»åž‹æ£€æŸ¥å™¨çš„åœºæ™¯â€¦ æœ€è¿‘æˆ‘ä»¬å·²ç»æ³¨æ„åˆ°äº†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­çš„å¾ˆå¤šNaNçš„å‡ºçŽ°ã€‚æˆ‘ä»¬æœç´¢æºä»£ç å¹¶æ‰¾åˆ°ä»¥ä¸‹ä»£ç ï¼š // math.js function square(n) { return n * n; } square("oops"); æˆ‘ä»¬å¯¹è‡ªå·±å¹äº†å£æ°”ï¼Œä¹Ÿè®¸å†³å®šæ·»åŠ ä¸€ä¸ªç±»åž‹æ£€æŸ¥å™¨ã€‚æˆ‘ä»¬é€€åŽä¸€æ­¥ï¼ŒæŸ¥çœ‹æˆ‘ä»¬çš„é€‰é¡¹ï¼š Flow æˆ– TypeScriptã€‚ è¿™ä¸¤ä¸ªå·¥å…·éƒ½æœ‰ç›¸å½“ç®€å•çš„æ–¹æ³•ç»™é€ä¸ªæ–‡ä»¶åº”ç”¨ï¼š Flow: // @flow å‘æ–‡ä»¶é¡¶éƒ¨æ·»åŠ æ³¨é‡Š TypeScriptï¼šå°†æ‰©å±•åæ›´æ”¹ä¸º.jsæ‰©å±•.ts å ä½†æ˜¯è®©æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹è¿™é‡Œé¢å‘ç”Ÿäº†ä»€ä¹ˆã€‚ é‡‡ç”¨TypeScriptè¦é‡‡ç”¨TypeScriptï¼Œæˆ‘ä»¬é¦–å…ˆé‡å‘½åmath.jsä¸º math.tsï¼š // math.ts function square(n) { return n * n; } square("oops"); çŽ°åœ¨æˆ‘ä»¬å°†è¿è¡Œtypescriptï¼š (no errors) æ²¡æœ‰é”™è¯¯ï¼Œæ˜¯å› ä¸ºTypeScriptè¦æ±‚æˆ‘ä»¬ç»™å‡½æ•°é”®å…¥æ³¨é‡Šï¼Œç„¶åŽæ‰ä¼šæ ¹æ®æ³¨é‡Šæ£€æŸ¥ç±»åž‹ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š function square(n: number): number { return n * n; } square("oops"); å¦‚æžœæ²¡æœ‰è¿™äº›ç±»åž‹ï¼ŒTypeScriptå°†æ ¹æ®æ‚¨çš„é…ç½®æ‰§è¡Œä¸‹é¢ä¸¤ä»¶äº‹æƒ…ä¹‹ä¸€ï¼š éšå«åœ°å°†æ¯ä¸ªæœªçŸ¥ç±»åž‹è½¬æ¢ä¸ºanyã€‚è¿™ç§ä»»ä½•ç±»åž‹å°†è®©æ‚¨é€€å‡ºæ‰€æœ‰ç±»åž‹æ£€æŸ¥ã€‚ æˆ–è€…å¦‚æžœæ‚¨ä½¿ç”¨äº†--noImplicitAnyé€‰é¡¹ï¼Œå®ƒä¼šä¸ºä»»ä½•æœªçŸ¥ç±»åž‹æŠ›å‡ºé”™è¯¯ï¼ŒæŒ‡æ˜Žéœ€è¦æ·»åŠ ç±»åž‹æ³¨é‡Šã€‚ è¿™æ„å‘³ç€TypeScript è¦†ç›–çš„ä»£ç é‡ä¸Žæ‚¨æ‰€å†™çš„ç±»åž‹ç›¸å…³ã€‚å†™å…¥ç±»åž‹æ—¶ï¼Œç±»åž‹coverageå°†çº¿æ€§ä¸Šå‡ã€‚ ç±»åž‹è¦†ç›–ï¼ˆtype coverageï¼‰åœ¨æˆ‘ä»¬è¿›ä¸€æ­¥è®²è§£ä¹‹å‰ï¼Œæˆ‘åº”è¯¥è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ç±»åž‹è¦†ç›–ã€‚ æœªæœ‰ç±»åž‹è¦†ç›–çš„ä»£ç ç”¨çº¢è‰²æ˜¾ç¤º å¦‚æžœä½ çœ‹åˆ°ä½ çš„ä»£ç ä¸­çš„å€¼å’Œè¡¨è¾¾å¼ï¼Œå¹¶é—®ç±»åž‹æ£€æŸ¥å™¨â€œä½ çŸ¥é“è¿™æ˜¯ä»€ä¹ˆç±»åž‹å—â€ã€‚ å¦‚æžœç±»åž‹æ£€æŸ¥å™¨çŸ¥é“å®ƒç±»åž‹ï¼Œåˆ™è¦†ç›–è¯¥å€¼æˆ–è¡¨è¾¾å¼ã€‚å¦‚æžœç±»åž‹æ£€æŸ¥å™¨ä¸çŸ¥é“ç±»åž‹ï¼Œé‚£ä¹ˆå®ƒæ²¡æœ‰è¢«è¦†ç›–ã€‚ æ‚¨å¸Œæœ›æ‚¨çš„ç¨‹åºå°½å¯èƒ½å¤šåœ°æä¾›ç±»åž‹è¦†ç›–ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥åœ¨æ›´å¤šåœ°æ–¹æŠ›å‡ºé”™è¯¯æ—¶æå‰å‘Šè¯‰æ‚¨ã€‚ æ²¡æœ‰ç±»åž‹è¦†ç›–ï¼Œç±»åž‹æ£€æŸ¥å™¨ä»€ä¹ˆéƒ½ä¸æ˜¯ã€‚ é‡‡ç”¨Flow// @flow function square(n) { return n * n; } square("oops"); ç„¶åŽæˆ‘ä»¬å°†è¿è¡ŒFlowå¹¶æŸ¥çœ‹ç»“æžœï¼š function square(n) { return n * n; ^ ^ Error (x2) } square("oops"); Error (x2) string. The operand of an arithmetic operation must be a number. ç´§æŽ¥ç€å°±æŠ›å‡ºäº†ç±»åž‹é”™è¯¯ï¼Œå‘Šè¯‰æˆ‘ä»¬ä»£ç å‡ºäº†é—®é¢˜ã€‚ Flow åªéœ€è¦æˆ‘ä»¬é”®å…¥æ–‡ä»¶å’Œå¤–éƒ¨æ¨¡å—çš„å¯¼å‡ºã€‚å¯ä»¥æŽ¨æµ‹å‡ºå…¶ä»–ä¸€åˆ‡ã€‚ è¿™ä½¿å¾—ç±»åž‹è¦†ç›–çŽ‡å¿«å¾—å¤šã€‚åªéœ€å‡ ç§ç±»åž‹ï¼Œæ‚¨å¯ä»¥å¿«é€ŸèŽ·å–å…·æœ‰éžå¸¸é«˜ç±»åž‹è¦†ç›–çŽ‡çš„æ–‡ä»¶ã€‚ æ ¹æ®æˆ‘çš„ç»éªŒï¼Œæˆ‘å¯ä»¥åœ¨çŸ­çŸ­å‡ åˆ†é’Ÿå†…å°†æ–‡ä»¶è¦†ç›–çº¦70-90ï¼…ã€‚ è¿™æ˜¯ä¸€ä¸ªéžå¸¸ç§‘å­¦çš„å·®å¼‚å›¾ï¼š è¿™ä¸æ˜¯æˆ‘ä¸€å®¶ä¹‹è¨€ï¼Œä½ å¯ä»¥è‡ªå·±å°è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹å‡ ç§ç±»åž‹çš„åŒºåˆ«ã€‚ è¦æŸ¥çœ‹Flowä¸­æ–‡ä»¶çš„ç±»åž‹è¦†ç›–ï¼Œå¯ä»¥è¿è¡Œï¼š flow coverage path/to/file.js --color æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ æµé‡æŠ¥å‘Š æ¥å¸®åŠ©æ‚¨ã€‚ æ³¨æ„ï¼šæˆ‘æ²¡æœ‰æ³¨æ„åˆ°TypeScript æœ‰ä»»ä½•çš„ç±»åž‹æŠ¥å‘Šå·¥å…·ï¼ˆå¦‚æžœæ‚¨çŸ¥é“ä¸€ä¸ªï¼Œè¯·ç»™æˆ‘å‘é€ä¸€ä¸ªé“¾æŽ¥ï¼‰ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥æµ‹è¯•ä»£ç æ˜¯å¦è¦†ç›–ï¼Œä»¥ç¡®å®šå½“æ‚¨å‡ºçŽ°é”™è¯¯æ—¶æ˜¯å¦ä¼šæŠ¥å‘Šé”™è¯¯ã€‚ è¿™ä¸ªçš„å·¥ä½œåŽŸç†æ˜¯ä»€ä¹ˆè¿™ä¸¤ç§å·¥å…·å…·æœ‰ä¸åŒè¡Œä¸ºçš„åŽŸå› å½’ç»“äºŽå…¶æž¶æž„ä¹‹é—´çš„åŒºåˆ«ã€‚ TypeScriptä½“ç³»ç»“æž„ï¼šASTå¯¼å‘TypeScriptå°†éåŽ†æ‚¨çš„ç¨‹åºå¹¶æž„å»ºå·²çŸ¥ç±»åž‹çš„è¡¨ã€‚å½“å®ƒå‘çŽ°å€¼å’Œè¡¨è¾¾å¼æ—¶ï¼Œå®ƒä¼šç«‹å³ä¸ºå…¶åˆ†é…ç±»åž‹ã€‚å½“TypeScriptå‘çŽ°ä¸€ä¸ªæœªçŸ¥çš„ç±»åž‹æ—¶ï¼Œå®ƒå¿…é¡»ç«‹å³ä½œå‡ºå†³å®šï¼Œè¿™æ„å‘³ç€å°†å…¶åˆ†é…ç»™anyæˆ–æŠ›å‡ºé”™è¯¯ã€‚ Flow æž¶æž„ï¼šå›¾å½¢å¯¼å‘Flow å°†å»ºç«‹ä¸€ä¸ªä½ æ‰€æœ‰çš„å€¼å’Œè¡¨è¾¾å¼åŠå…¶å½¼æ­¤ä¹‹é—´çš„å…³ç³»çš„å›¾è¡¨ã€‚ç„¶åŽï¼Œå®ƒå°†å¼€å§‹ä¸ºæ¯ä¸ªå€¼å’Œè¡¨è¾¾å¼åˆ†é…ç±»åž‹ã€‚å¦‚æžœå®ƒæ‰¾åˆ°ä¸€ä¸ªæœªçŸ¥çš„ç±»åž‹ï¼Œå®ƒå°†ä½¿å®ƒæˆä¸ºä¸€ä¸ªâ€œå¼€æ”¾â€ç±»åž‹ï¼Œç¨åŽå†å›žæ¥åˆ¤æ–­ã€‚ ä¸€æ—¦Flowå…·æœ‰æ‚¨çš„ç¨‹åºçš„å®Œæ•´è“å›¾ï¼Œå®ƒå°†å¼€å§‹è¿žæŽ¥æ‰€æœ‰ç‚¹ï¼Œä»Žä¸€ä¸ªå€¼è¿žæŽ¥åˆ°å¦ä¸€ä¸ªå€¼åœ°è·Ÿè¸ªç±»åž‹ã€‚æ‰“å¼€ç±»åž‹æŽ¥å—æµå…¥å®ƒä»¬çš„æ‰€æœ‰å€¼çš„ç±»åž‹ - ç”Ÿæˆçš„ç±»åž‹ç§°ä¸º â€œæŽ¨æ–­ç±»åž‹â€ã€‚ ä½ å¯ä»¥çœ‹è¿™ä¸ªæ˜¯æ€Žä¹ˆå›žäº‹ã€‚æ¥çœ‹çœ‹æˆ‘ä»¬åœ¨ä¹‹å‰çš„ç±»åž‹é”™è¯¯ï¼š function square(n) { return n * n; ^ ^ Error (x2) } square("oops"); Error (x2) string. The operand of an arithmetic operation must be a number. æ³¨æ„é”™è¯¯æ˜¯æŒ‡å‘n * nè€Œä¸æ˜¯ square("oops")ã€‚å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å†™å…¥ä¸€ä¸ªç±»åž‹ä¸ºnçš„ â€œoopsâ€å­—ç¬¦ä¸²æµå…¥å®ƒï¼Œå¹¶ä¸”Flowå¼€å§‹æ£€æŸ¥nï¼Œå°±å¥½åƒå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ æ·»åŠ ç±»åž‹æ³¨é‡Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é”™è¯¯ç‚¹ç§»åŠ¨äº†ï¼š function square(n: number) { return n * n; } square("oops"); ^ Error Error: string. This type is incompatible with the expected param type of number. è¿™æå‡ºäº†ä¸€ä¸ªé‡è¦çš„ä¸€ç‚¹ï¼šFlowå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è‡ªåŠ¨æŽ¨æ–­ç±»åž‹å¹¶ä¸æ„å‘³ç€ä½ ä¸åº”è¯¥æ·»åŠ ç±»åž‹æ³¨é‡Šä½ çš„ä»£ç ã€‚ ç»“è®ºTypeScriptå’ŒFlowéƒ½æœ‰éžå¸¸å¥½çš„ä¸Šæ‰‹è¿‡ç¨‹ã€‚ä¸€ä¸ªä¸ªæ–‡ä»¶åœ°å°è¯•æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç»åŽ†ã€‚ ä½†æ˜¯ï¼Œå¦‚æžœä½¿ç”¨Flowï¼Œä½ å°±ä¼šæœ‰æ›´é«˜ä»¥åŠæ›´å¿«çš„è¦†ç›–ç±»åž‹ï¼Œä½ å°±å¯ä»¥å®‰å¿ƒç¡è§‰ã€‚ ä½¿ç”¨Flowï¼Œæ‚¨å¯ä»¥æ·»åŠ ç±»åž‹ä»¥ä½¿é”™è¯¯æ›´å‹å¥½ï¼Œè€Œä¸ä»…åªæ˜¯å‘çŽ°å®ƒä»¬ã€‚ æœ¬æ–‡è¯‘è‡ªï¼š adopting flow and typescript]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Flow</tag>
        <tag>TypeScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨RXJSç»„åˆã€è¿‡æ»¤å’Œæ˜ å°„æ•°æ®æµçš„å€¼]]></title>
    <url>%2F2017%2F06%2F05%2Fuse-RXJS-compose-filter-and-map-stream.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨RXJSç»„åˆã€è¿‡æ»¤å’Œæ˜ å°„æ•°æ®æµçš„å€¼æŸ¥è¯¢å¯è§‚æµ‹åºåˆ—åœ¨äº‹ä»¶æ¡¥æŽ¥ ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†çŽ°æœ‰çš„DOMå’ŒNode.jsäº‹ä»¶è½¬æ¢æˆå¯è§‚å¯Ÿçš„åºåˆ—ä»¥è®¢é˜…å®ƒä»¬ã€‚åœ¨æœ¬ä¸»é¢˜ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠå¯è§‚å¯Ÿåºåˆ—çš„çˆ¶çº§classè§†ä¸ºIObservableå¯¹è±¡ï¼Œå…¶ä¸­Rxç»„ä»¶æä¾›é€šç”¨LINQæ“ä½œç¬¦æ¥æ“ä½œè¿™äº›å¯¹è±¡ã€‚å¤§å¤šæ•°æ“ä½œç¬¦èŽ·å–å¯è§‚å¯Ÿçš„åºåˆ—å¹¶å¯¹å…¶æ‰§è¡Œä¸€äº›é€»è¾‘å¹¶è¾“å‡ºå¦ä¸€ä¸ªå¯è§‚æµ‹åºåˆ—ã€‚å¦å¤–ï¼Œä»Žä»£ç ç¤ºä¾‹å¯ä»¥çœ‹å‡ºï¼Œç”šè‡³å¯ä»¥åœ¨æºåºåˆ—ä¸Šä½¿ç”¨å¤šä¸ªè¿ç®—ç¬¦ï¼Œæœ€ç»ˆå°†ç»“æžœåºåˆ—è°ƒæ•´åˆ°æ‚¨çš„ç¡®åˆ‡éœ€æ±‚ã€‚ æœ¬æ–‡ç¿»è¯‘åœ¨ï¼š RXJSä¸­æ–‡æ–‡æ¡£ ä½¿ç”¨ä¸åŒçš„è¿ç®—ç¬¦æˆ‘ä»¬å·²ç»åœ¨ä»¥å‰çš„ä¸»é¢˜ä¸­ä½¿ç”¨createå’Œrangeè¿ç®—ç¬¦æ¥åˆ›å»ºå’Œè¿”å›žç®€å•çš„åºåˆ—ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨fromEventå’ŒfromEventPatternè¿ç®—ç¬¦å°†çŽ°æœ‰äº‹ä»¶è½¬æ¢æˆå¯è§‚å¯Ÿçš„åºåˆ—ã€‚åœ¨æœ¬ä¸»é¢˜ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å…¶ä»–Observableç±»åž‹çš„è¿ç®—ç¬¦ï¼Œä»¥ä¾¿å¯ä»¥è¿‡æ»¤ï¼Œåˆ†ç»„å’Œè½¬æ¢æ•°æ®ã€‚è¿™äº›è¿ç®—ç¬¦å°†å¯è§‚å¯Ÿåˆ°çš„åºåˆ—ä½œä¸ºè¾“å…¥ï¼Œå¹¶ç”Ÿæˆè¾“å‡ºå¦ä¸€ä¸ªå¯è§‚å¯Ÿåºåˆ—ã€‚ ç»„åˆä¸åŒåºåˆ—åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šç ”ç©¶å°†å„ç§å¯è§‚å¯Ÿåºåˆ—ç»„åˆæˆå•ä¸ªå¯è§‚å¯Ÿåºåˆ—çš„æ“ä½œç¬¦ã€‚è¯·æ³¨æ„ï¼Œå½“æˆ‘ä»¬ç»„åˆåºåˆ—æ—¶ï¼Œæ•°æ®ä¸ä¼šè¢«è½¬æ¢ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Concatè¿ç®—ç¬¦å°†ä¸¤ä¸ªåºåˆ—ç»„åˆæˆä¸€ä¸ªåºåˆ—å¹¶è®¢é˜…å®ƒã€‚ä¸ºäº†è¯´æ˜Žçš„ç›®çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨éžå¸¸ç®€å•çš„range(x, y)è¿ç®—ç¬¦åˆ›å»ºä¸€ä¸ªä»Žxå¼€å§‹çš„æ•´æ•°åºåˆ—ï¼Œç„¶åŽäº§ç”Ÿyä¸ªåºåˆ—æ•°å­—ã€‚ var source1 = Rx.Observable.range(1, 3); var source2 = Rx.Observable.range(1, 3); source1.concat(source2) .subscribe(console.log.bind(console)); // => 1 // => 2 // => 3 // => 1 // => 2 // => 3 æ³¨æ„ï¼Œç»“æžœåºåˆ—æ˜¯1,2,3,1,2,3ã€‚è¿™æ˜¯å› ä¸ºå½“æ‚¨ä½¿ç”¨concatè¿ç®—ç¬¦æ—¶ï¼Œç¬¬äºŒä¸ªåºåˆ—ï¼ˆsource2ï¼‰å°†åœ¨ç¬¬ä¸€ä¸ªåºåˆ—ï¼ˆsource1ï¼‰å®ŒæˆæŽ¨é€å…¶æ‰€æœ‰å€¼ä¹‹åŽæ‰ä¼šæ¿€æ´»ã€‚åªæœ‰åœ¨source1å®Œæˆä¹‹åŽï¼Œsource2æ‰ä¼šå°†å€¼æŽ¨é€åˆ°æœ€åŽçš„åºåˆ—ã€‚ç„¶åŽï¼Œè®¢é˜…è€…å°†ä»Žå¾—åˆ°çš„åºåˆ—ä¸­èŽ·å–æ‰€æœ‰å€¼ã€‚ ä¸Žmerge æ“ä½œç¬¦è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æžœè¿è¡Œä»¥ä¸‹ç¤ºä¾‹ä»£ç ï¼Œæ‚¨å°†èŽ·å¾—1,1,2,2,3,3ã€‚è¿™æ˜¯å› ä¸ºä¸¤ä¸ªåºåˆ—åŒæ—¶å¤„äºŽæ´»åŠ¨çŠ¶æ€ï¼Œå¹¶ä¸”å€¼åœ¨æ•°æ®æºä¸­å‘ç”Ÿæ—¶è¢«æŽ¨å‡ºã€‚ç»“æžœåºåˆ—ä»…åœ¨æœ€åŽä¸€ä¸ªæ•°æ®æºå®ŒæˆæŽ¨é€å€¼æ—¶å®Œæˆã€‚ var source1 = Rx.Observable.range(1, 3); var source2 = Rx.Observable.range(1, 3); source1.merge(source2) .subscribe(console.log.bind(console)); // => 1 // => 1 // => 2 // => 2 // => 3 // => 3 catch æ“ä½œç¬¦å¯ä»¥è¿›è¡Œå¦ä¸€ä¸ªæ¯”è¾ƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æžœsource1å®Œæˆæ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œé‚£ä¹ˆsource2å°†ä¸ä¼šå¯åŠ¨ã€‚å› æ­¤ï¼Œå¦‚æžœè¿è¡Œä»¥ä¸‹ç¤ºä¾‹ä»£ç ï¼Œåˆ™èŽ·å¾—1,2,3å› ä¸ºsource2ï¼ˆäº§ç”Ÿ4,5,6ï¼‰ï¼‰è¢«å¿½ç•¥ã€‚ var source1 = Rx.Observable.range(1, 3); var source2 = Rx.Observable.range(4, 3); source1.catch(source2) .subscribe(console.log.bind(console)); // => 1 // => 2 // => 3 æœ€åŽï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹onErrorResumeNextã€‚å³ä½¿ç”±äºŽé”™è¯¯å¯¼è‡´source1æ— æ³•å®Œæˆï¼Œè¯¥æ“ä½œç¬¦ä¹Ÿå°†ç§»åŠ¨åˆ°source2ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œå³ä½¿source1è¡¨ç¤ºé€šè¿‡ä½¿ç”¨throwè¿ç®—ç¬¦ç»ˆæ­¢å¼‚å¸¸çš„åºåˆ—ï¼Œç”¨æˆ·å°†æŽ¥æ”¶source2å‘å¸ƒçš„å€¼ï¼ˆ1,2,3ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æžœæ‚¨é¢„æœŸåˆ°ä»»ä½•ä¸€ä¸ªæºåºåˆ—äº§ç”Ÿä»»ä½•é”™è¯¯ï¼Œé‚£ä¹ˆä½¿ç”¨å®ƒonErrorResumeNextæ¥ä¿è¯ç”¨æˆ·ä»ç„¶ä¼šæ”¶åˆ°ä¸€äº›å€¼æ˜¯æ›´å®‰å…¨çš„ã€‚ var source1 = Rx.Observable.throw(new Error('An error has occurred.')); var source2 = Rx.Observable.range(1, 3); source1.onErrorResumeNext(source2) .subscribe(console.log.bind(console)); // => 1 // => 2 // => 3 æ˜ å°„selectæˆ– map æ“ä½œç¬¦å°†å¯è§‚å¯Ÿåˆ°çš„ä¸€ä¸ªåºåˆ—çš„æ¯ä¸ªå…ƒç´ è½¬æ¢æˆå¦ä¸€ç§å½¢å¼ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€ç³»åˆ—å­—ç¬¦ä¸²æ˜ å°„åˆ°ä¸€ç³»åˆ—è¡¨ç¤ºé•¿åº¦çš„æ•´æ•°ä¸­ã€‚ var array = ['Reactive', 'Extensions', 'RxJS']; var seqString = Rx.Observable.from(array); var seqNum = seqString.map(x => x.length); seqNum .subscribe(console.log.bind(console)); // => 8 // => 10 // => 4 åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨â€œæ¡¥æŽ¥çŽ°æœ‰äº‹ä»¶â€ä¸»é¢˜ä¸­çœ‹åˆ°çš„äº‹ä»¶è½¬æ¢ç¤ºä¾‹çš„æ‰©å±•ï¼Œæˆ‘ä»¬ä½¿ç”¨selectæˆ–mapè¿ç®—ç¬¦å°†äº‹ä»¶å‚æ•°æŠ•å½±åˆ°xå’Œyç‚¹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°†é¼ æ ‡ç§»åŠ¨äº‹ä»¶åºåˆ—è½¬æ¢ä¸ºå¯ä»¥è¿›ä¸€æ­¥è§£æžå’Œæ“ä½œçš„æ•°æ®ç±»åž‹ï¼Œå¦‚ä¸‹ä¸€ä¸ªâ€œè¿‡æ»¤â€éƒ¨åˆ†æ‰€ç¤ºã€‚ var move = Rx.Observable.fromEvent(document, 'mousemove'); var points = move.map(e => ({x: e.clientX, y: e.clientY })); points.subscribe( pos => console.log('Mouse at point ' + pos.x + ', ' + pos.y)); æœ€åŽï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹selectMany or flatMapè¿ç®—ç¬¦ã€‚selectManyæˆ–flatMapæ“ä½œç¬¦å…·æœ‰è®¸å¤šé‡è½½ï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯éœ€è¦é€‰æ‹©å™¨å‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªé€‰æ‹©å™¨å‡½æ•°æ˜¯ç”±æ•°æ®æºæŽ¨å‡ºçš„æ¯ä¸ªå€¼åŽ»è°ƒç”¨çš„ã€‚å¯¹äºŽæ¯ä¸€ä¸ªå€¼ï¼Œé€‰æ‹©å™¨å°†å…¶æ˜ å°„æˆä¸€ä¸ªè¿·ä½ çš„å¯è§‚å¯Ÿåºåˆ—ã€‚æœ€åŽï¼ŒselectManyæˆ–è€…flatMapæ“ä½œç¬¦å°†æ‰€æœ‰è¿™äº›è¿·ä½ åºåˆ—æ‰å¹³åŒ–æˆå•ä¸ªç»“æžœåºåˆ—ï¼Œç„¶åŽå°†å…¶æŽ¨é€åˆ°ç”¨æˆ·ã€‚ åœ¨æ•°æ®æºå’Œç”±é€‰æ‹©å™¨å‡½æ•°äº§ç”Ÿçš„æ‰€æœ‰è¿·ä½ å¯è§‚å¯Ÿåºåˆ—éƒ½å·²ç»å®Œæˆä¹‹åŽï¼Œæºåºåˆ—è¿”å›žselectManyæˆ–flatMapå‘å¸ƒçš„onCompletedã€‚å½“å‘ç”Ÿæºæ•°æ®æµä¸­çš„é”™è¯¯æ—¶è§¦å‘onErrorï¼Œå½“ä¸€ä¸ªå¼‚å¸¸è¢«é€‰æ‹©å‡½æ•°æŠ›å‡ºï¼Œæˆ–è€…å½“åœ¨ä»»ä½•è¿·ä½ è§‚å¯Ÿåºåˆ—çš„å‘ç”Ÿäº†é”™è¯¯ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ•°æ®æºåºåˆ—ï¼Œæ¯5ç§’äº§ç”Ÿä¸€ä¸ªæ•´æ•°ï¼Œå¹¶å†³å®šä½¿ç”¨ç”Ÿæˆçš„å‰ä¸¤ä¸ªå€¼ï¼ˆä½¿ç”¨takeè¿ç®—ç¬¦ï¼‰ã€‚ç„¶åŽï¼Œæˆ‘ä»¬ä½¿ç”¨selectManyæˆ–è€…flatMapå¯¹å¦ä¸€ä¸ªåºåˆ—{100,101,102}è¿™äº›æ•´æ•°è¿›è¡Œæ˜ å°„ã€‚é€šè¿‡è¿™æ ·åšï¼Œäº§ç”Ÿä¸¤ä¸ªè¿·ä½ è§‚å¯Ÿåºåˆ—{100,101,102}å’Œ{100,101,102}ã€‚å®ƒä»¬æœ€ç»ˆå¹³å¦åŒ–æˆ{100,101,102,100,101,102}çš„å•ä¸ªæ•´æ•°æµï¼Œå¹¶è¢«æŽ¨é€åˆ°è§‚å¯Ÿè€…ã€‚ var source1 = Rx.Observable.interval(5000).take(2); var proj = Rx.Observable.range(100, 3); var resultSeq = source1.flatMap(proj); var subscription = resultSeq.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e.message), () => console.log('onCompleted')); // => onNext: 100 // => onNext: 101 // => onNext: 102 // => onNext: 100 // => onNext: 101 // => onNext: 102 // => onCompleted è¿‡æ»¤åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨generate è¿ç®—ç¬¦åˆ›å»ºä¸€ä¸ªç®€å•çš„å¯è§‚å¯Ÿæ•°å­—åºåˆ—ã€‚è¯¥generateæ“ä½œç¬¦æœ‰å‡ ä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬æœ‰ç›¸å¯¹å’Œç»å¯¹æ—¶é—´è°ƒåº¦ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå®ƒéœ€è¦åˆå§‹çŠ¶æ€ï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ä¸º0ï¼‰ï¼Œä¸€ä¸ªæ¡ä»¶å‡½æ•°ç»ˆæ­¢ï¼ˆå°‘äºŽ10æ¬¡ï¼‰ï¼Œè¿­ä»£å™¨ï¼ˆ+1ï¼‰ï¼Œç»“æžœé€‰æ‹©å™¨ï¼ˆå½“å‰å€¼çš„å¹³æ–¹å‡½æ•°ï¼‰ï¼‰å’Œæ‰“å°åªä½¿ç”¨å°äºŽ5çš„é‚£äº›ä½¿ç”¨filteræˆ–whereè¿ç®—ç¬¦ã€‚ var seq = Rx.Observable.generate( 0, i => i &lt; 10, i => i + 1, i => i * i); var source = seq.filter(n => n &lt; 5); var subscription = source.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e.message), () => console.log('onCompleted')); // => onNext: 0 // => onNext: 1 // => onNext: 4 // => onCompleted ä»¥ä¸‹ç¤ºä¾‹æ˜¯æœ¬ä¸»é¢˜å‰é¢å·²ç»çœ‹åˆ°çš„æ˜ å°„ç¤ºä¾‹çš„æ‰©å±•ã€‚åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨selectæˆ–mapè¿ç®—ç¬¦å°†äº‹ä»¶å‚æ•°æŠ•å½±åˆ°å…·æœ‰xå’Œyçš„ç‚¹ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨filteræˆ–whereå’Œselectæˆ–mapæ“ä½œç¬¦åªæŒ‘é€‰é‚£äº›é¼ æ ‡ç§»åŠ¨ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é¼ æ ‡ç§»åŠ¨è¿‡æ»¤ï¼Œä»¥æ‰¾å‡ºåœ¨ç¬¬ä¸€å¹³åˆ†çº¿ï¼ˆå…¶ä¸­xå’Œyåæ ‡æ˜¯ç›¸ç­‰çš„ï¼‰ã€‚ var move = Rx.Observable.fromEvent(document, 'mousemove'); var points = move.map(e => ({ x: e.clientX, y: e.clientY })); var overfirstbisector = points.filter(pos => pos.x === pos.y); var movesub = overfirstbisector.subscribe(pos => console.log('mouse at ' + pos.x + ', ' pos.y)); åŸºäºŽæ—¶é—´çš„æ“ä½œæ‚¨å¯ä»¥ä½¿ç”¨ç¼“å†²åŒºè¿ç®—ç¬¦æ‰§è¡ŒåŸºäºŽæ—¶é—´çš„æ“ä½œã€‚ ç¼“å†²å¯è§‚å¯Ÿåºåˆ—æ„å‘³ç€å¯è§‚æµ‹åºåˆ—çš„å€¼åŸºäºŽæŒ‡å®šçš„æ—¶é—´æ®µæˆ–è®¡æ•°é˜ˆå€¼è¢«æ”¾å…¥ç¼“å†²åŒºã€‚è¿™åœ¨æ‚¨é¢„æœŸæœ‰å¤§é‡æ•°æ®è¢«åºåˆ—æŽ¨å‡ºçš„æƒ…å†µä¸‹ç‰¹åˆ«æœ‰ç”¨ï¼Œå¹¶ä¸”è®¢é˜…è€…æ²¡æœ‰èµ„æºæ¥å¤„ç†è¿™äº›å€¼ã€‚é€šè¿‡åŸºäºŽæ—¶é—´æˆ–è®¡æ•°ç¼“å†²ç»“æžœï¼Œå¹¶ä¸”åªæœ‰åœ¨è¶…è¿‡æ¡ä»¶æ—¶æ‰è¿”å›žå€¼åºåˆ—ï¼ˆæˆ–è€…æºåºåˆ—å®Œæˆæ—¶ï¼‰ï¼Œç”¨æˆ·å¯ä»¥æŒ‰ç…§è‡ªå·±çš„é€Ÿåº¦å¤„ç†OnNextè°ƒç”¨ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªä»¥æ¯ç§’ä¸ºæ—¶é—´å•ä½çš„ç®€å•çš„æ•´æ•°åºåˆ—ã€‚ç„¶åŽæˆ‘ä»¬ä½¿ç”¨bufferWithCountè¿ç®—ç¬¦ï¼Œå¹¶æŒ‡å®šæ¯ä¸ªç¼“å†²åŒºå°†ä¿å­˜åºåˆ—ä¸­çš„5ä¸ªé¡¹ç›®ã€‚åœ¨onNextå½“ç¼“å†²åŒºå·²æ»¡è¢«è°ƒç”¨ã€‚ç„¶åŽæˆ‘ä»¬ä½¿ç”¨ç¼“å†²åŒºçš„æ€»å’ŒArray.reduceã€‚ç¼“å†²åŒºè‡ªåŠ¨åˆ·æ–°ï¼Œå¦ä¸€ä¸ªå¾ªçŽ¯å¼€å§‹ã€‚æ‰“å°è¾“å‡ºå°†ä¸º10,35,60 â€¦ï¼Œå…¶ä¸­10 = 0 + 1 + 2 + 3 + 4,35 = 5 + 6 + 7 + 8 + 9ç­‰ã€‚ var seq = Rx.Observable.interval(1000); var bufSeq = seq.bufferWithCount(5); bufSeq .map(arr => arr.reduce((acc, x) => acc + x, 0)) .subscribe(console.log.bind(console)); // => 10 // => 35 // => 60 ... æˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡å®šæ—¶é—´è·¨åº¦ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰çš„ç¼“å†²åŒºã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œç¼“å†²åŒºå°†ä¿å­˜ç´¯ç§¯3ç§’é’Ÿçš„é¡¹ç›®ã€‚æ‰“å°è¾“å‡ºå°†ä¸º3,12,21 â€¦å…¶ä¸­3 = 0 + 1 + 2,12 = 3 + 4 + 5ï¼Œä¾æ­¤ç±»æŽ¨ã€‚ var seq = Rx.Observable.interval(1000); var bufSeq = seq.bufferWithTime(3000); bufSeq .map(arr => arr.reduce((acc, x) => acc + x, 0)) .subscribe(console.log.bind(console)); è¯·æ³¨æ„ï¼Œå¦‚æžœæ‚¨ä½¿ç”¨ä»»ä½•ä¸€ä¸ªbuffer*æˆ–window*è¿ç®—ç¬¦ï¼Œåˆ™å¿…é¡»ç¡®ä¿åºåˆ—ä¸ä¸ºç©ºï¼Œç„¶åŽå†è¿‡æ»¤ã€‚ æŒ‰ç±»åˆ«æ“ä½œæŒ‰ç±»åˆ«åˆ’åˆ†çš„æ“ä½œç¬¦ä¸»é¢˜åˆ—å‡ºäº†æŒ‰ç±»åˆ«å®žæ–½çš„Observableçš„æ‰€æœ‰ä¸»è¦æ“ä½œç¬¦; å…·ä½“æ¥è¯´ï¼šåˆ›å»ºï¼Œè½¬æ¢ï¼Œåˆå¹¶ï¼ŒåŠŸèƒ½ï¼Œæ•°å­¦ï¼Œæ—¶é—´ï¼Œå¼‚å¸¸ï¼Œæ‚é¡¹ï¼Œé€‰æ‹©å’ŒåŽŸå€¼ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>RxJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•è°ƒè¯•Node.js|ä½¿ç”¨è°·æ­Œchromeæµè§ˆå™¨è°ƒè¯•Node.js]]></title>
    <url>%2F2017%2F06%2F02%2Fdebugging-Node-js-with-google-chrome.html</url>
    <content type="text"><![CDATA[å¦‚ä½•è°ƒè¯•Node.js|ä½¿ç”¨è°·æ­Œchromeæµè§ˆå™¨è°ƒè¯•Node.jså¦‚ä½•è°ƒè¯• Node.js, è¿˜åœ¨ä½¿ç”¨ console.log æ¥è°ƒè¯• Node.js å—ï¼Œå¯ä»¥åƒè°ƒè¯•å‰ç«¯é¡µé¢ä¸€æ ·è°ƒè¯• Node.js! è°ƒè¯•æ˜¯ä»Žè½¯ä»¶åº”ç”¨ç¨‹åºä¸­è¯†åˆ«å’Œåˆ é™¤é”™è¯¯çš„ä»»åŠ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯æ‰“å°ä»£ç ä¸­çš„å€¼ã€‚æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨æœ€æ–°çš„Google Chrome DevToolsé«˜æ•ˆåœ°è°ƒè¯•Node.jsç¨‹åºã€‚ ä¸ºä»€ä¹ˆconsole.logä¸æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Ÿä½¿ç”¨console.logæ¥è°ƒè¯•ä½ çš„ä»£ç ï¼Œé€šå¸¸ä½ ä¼šæ— é™é‡å¤åœ°åš â€œåœæ­¢ä½ çš„åº”ç”¨ç¨‹åºï¼Œæ·»åŠ ä¸€ä¸ªconsole.logï¼Œå¹¶å†æ¬¡å¯åŠ¨ä½ çš„åº”ç”¨ç¨‹åºâ€ è¿™æ ·çš„æ“ä½œã€‚é™¤äº†å‡ç¼“æ‚¨çš„åº”ç”¨ç¨‹åºçš„å¼€å‘å¤–ï¼Œå®ƒè¿˜ä½¿æ‚¨çš„ä¹¦å†™å˜å¾—è„ä¹±å¹¶åˆ›å»ºä¸å¿…è¦çš„ä»£ç ã€‚æœ€åŽï¼Œå°è¯•æ³¨é”€å˜é‡ä»¥åŠå…¶ä»–å¯èƒ½çš„æ—¥å¿—è®°å½•æ“ä½œçš„å™ªç‚¹æ—¶ï¼Œå¯èƒ½ä¼šåœ¨å°è¯•æ‰¾åˆ°æ­£åœ¨è°ƒè¯•çš„å€¼æ—¶ä½¿è°ƒè¯•å˜å¾—å›°éš¾ã€‚ è°ƒè¯•å·¥å…·è°ƒè¯•å·¥å…·ä¸ºç”¨æˆ·æä¾›çš„æ˜¯å‡ ä¸ªé‡è¦çš„åŠŸèƒ½console.logæ— æ³•æä¾›ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒä»¬å…è®¸æ‚¨åœ¨ä»£ç ä¸­çš„ç‰¹å®šç‚¹æš‚åœæ‰§è¡Œåº”ç”¨ç¨‹åºï¼Œå¹¶åœ¨ç¨‹åºä»åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œä¿®æ”¹å˜é‡çš„å€¼ã€‚ è®¾ç½®Chrome for Node.jsè°ƒè¯•ä½¿ç”¨Chrome 57+ï¼ŒNode.jsè°ƒè¯•åŠŸèƒ½æ˜¯é»˜è®¤å¯ç”¨çš„ï¼Œä¸éœ€è¦åƒä»¥å‰çš„ç‰ˆæœ¬é‚£æ ·ä»Žâ€œå®žéªŒåŠŸèƒ½â€é¢æ¿æ‰‹åŠ¨å¯ç”¨å®ƒã€‚ å¦‚æžœæ‚¨è¿˜æ²¡æœ‰å®Œæˆï¼Œè¯·å°†Google Chromeæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶ç¡®ä¿ä½¿ç”¨Node.js 6.4+ã€‚ è¦å¼€å§‹è°ƒè¯•ï¼Œè¯·ä½¿ç”¨ - inspectæ ‡å¿—è¿è¡ŒNode.jsåº”ç”¨ç¨‹åºã€‚ $ node --inspect &lt;your_file> .js æŽ¥ä¸‹æ¥ï¼Œå¿½ç•¥ä»Žç»ˆç«¯ä¸­æ˜¾ç¤ºçš„â€œchrome-devtools://â€å¼€å¤´çš„URL ï¼Œè€Œæ˜¯åœ¨Google Chromeä¸­æ‰“å¼€â€œ about:inspect â€ã€‚ æœ€åŽç‚¹å‡»â€œ Open dedicated DevTools for Nodeâ€ å¼€å§‹è°ƒè¯•åº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ æ­¤å¤–ï¼Œå…³äºŽè°ƒè¯•Node.js Appçš„å®˜æ–¹æ–‡æ¡£è¿˜æä¾›äº†æ‰€æœ‰å…¶ä»–æ£€æŸ¥å™¨å·¥å…·å’Œå®¢æˆ·ç«¯é€‰é¡¹çš„è¯¦ç»†åˆ—è¡¨ã€‚ Chrome DevToolsçš„åº”ç”¨è¦ç»“æŸæœ¬æ–‡ï¼Œæˆ‘æƒ³è¯´æ˜Žä¸€ä¸‹Chrome DevToolsåœ¨ä»¥ä¸‹Expressåº”ç”¨ç¨‹åºä¸­çš„åº”ç”¨ã€‚ 'use strict' const express = require('express') const app = express() const PORT = process.env.PORT || 3000 function capitalize (str) { const firstLetter = str.charAt(0) // we can check what's inside here return `${firstLetter.toUpperCase()}${str.slice(1)}` } app.get('/:name?', (req, res) => { const name = req.params.name ? capitalize(req.params.name) : 'World' res.send(`Hello ${name}!`) }) app.listen(PORT, () => console.log(`App listening on *:${PORT}`)) è®©æˆ‘ä»¬ä»Žè¿è¡Œ- inspectæ ‡å¿—ï¼Œå¹¶æ‰“å¼€ä¸“ç”¨DevTools for Nodeå¦‚å‰æ‰€è¿°ã€‚ æ­¤æ—¶ï¼Œæ‚¨å°†å¯ä»¥è®¿é—®æ‚¨å¯èƒ½å·²ç»ç†Ÿæ‚‰çš„æ‰€æœ‰åŠŸèƒ½ï¼šæ–­ç‚¹(breakpoints)ï¼ŒåŽ‹ç¼©ä»£ç çš„æºæ˜ å°„(source map for transpiled code)ï¼Œå †å¿«ç…§æ£€æŸ¥(heap snapshot inspection)ï¼Œåˆ†é…åˆ†æž(allocation profiling)ï¼ŒJavaScriptå€¼çƒ­æ’æ‹”(JavaScript values hot-swapping)ç­‰ã€‚ å…·ä½“æ¥è¯´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ‚¨å¯ä»¥æ’å…¥æ–­ç‚¹æ¥åœæ­¢æ‰§è¡Œç¨‹åºï¼Œæ£€æŸ¥å’Œâ€œçƒ­äº¤æ¢â€å˜é‡çš„å€¼ã€‚ ä½¿ç”¨Chromeä½œä¸ºè°ƒè¯•å·¥å…·çš„å¦å¤–ä¸€ä»¶å¥½äº‹æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ç•Œé¢ðŸš€è°ƒè¯•å‰ç«¯å’ŒåŽç«¯JavaScriptä»£ç ã€‚ è¯‘æ–‡ï¼šDebugging Node.js with Google Chrome]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
        <tag>debug</tag>
        <tag>chrome</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RXJSæˆ‘è¯¥é€‰ç”¨å“ªä¸ªæ“ä½œç¬¦ä¹‹-åˆ›å»ºç¯‡]]></title>
    <url>%2F2017%2F06%2F01%2FRXJS-should-i-choose-operator-of-creating.html</url>
    <content type="text"><![CDATA[RXJSè¯¥æ€Žä¹ˆä¸Šæ‰‹ï¼Ÿè¿™ä¹ˆå¤šæ“ä½œç¬¦è¯¥ç”¨å“ªä¸ªï¼ŸRXJSæ¯”è¾ƒå¼ºå¤§ï¼Œæ“ä½œç¬¦ä¼—å¤šï¼Œæƒ³ç†Ÿæ‚‰éœ€è¦æ¯”è¾ƒé•¿æ—¶é—´çš„è¿ç”¨ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æ–°æ‰‹éƒ½æ¯”è¾ƒç–‘æƒ‘åº”è¯¥ä½¿ç”¨å“ªäº›æ“ä½œç¬¦åŽ»å®žçŽ°è‡ªå·±çš„æ•°æ®æµçš„æ“ä½œã€‚ æ›´å¤šè¯¦æƒ…è¯·ç¿»é˜… RXJSä¸­æ–‡ç¿»è¯‘æ–‡æ¡£ æˆ‘è¯¥é€‰ç”¨å“ªä¸ªæ“ä½œç¬¦? - åˆ›å»ºæ“ä½œç¬¦ä½¿ç”¨æ­¤é¡µé¢æŸ¥æ‰¾Observableç¬¦åˆæ‚¨éœ€æ±‚çš„ç±»åž‹åˆ›å»ºæ“ä½œï¼š é™æ€æ–¹æ³• æˆ‘æƒ³åˆ›å»ºä¸€ä¸ªæ–°çš„åºåˆ— ä½¿ç”¨è‡ªå®šä¹‰é€»è¾‘ Observable.create åƒä¸€ä¸ªforå¾ªçŽ¯ Observable.generate å¹¶éšæ—¶é—´å‘å°„å€¼ Observable.generateWithRelativeTime Observable.generateWithAbsoluteTime å®ƒè¿”å›žä¸€ä¸ªå€¼ Observable.return/just å¤šæ¬¡ Observable.repeat è¿™ä¼šæŠ›å‡ºé”™è¯¯ Observable.throw å®Œæˆäº† Observable.empty ä»Žæ¥æ²¡æœ‰åšä»»ä½•äº‹æƒ… Observable.never ä»Žäº‹ä»¶ Observable.fromEvent å®ƒä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°æ¥æ·»åŠ å’Œåˆ é™¤äº‹ä»¶å¤„ç†ç¨‹åº Observable.fromEventPattern æ¥è‡ªä¸€ä¸ªES6 Promise Observable.fromPromise å®ƒå¯è¿­ä»£ è¦†ç›–åˆ°æ•°ç»„ä¸­çš„å€¼ Observable.fromArray å¯¹è±¡é”®/å€¼å¯¹ Observable.pairs å¼‚æ­¥å…ƒç´  Observable.for æ•°å€¼èŒƒå›´å†…çš„å€¼ Observable.range æ¥è‡ªä¸€ä¸ªå¯è¿­ä»£çš„æ•°ç»„æˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡çš„å€¼ Observable.from æ¥è‡ªå‚æ•° Observable.of æ ¹æ®å®šæ—¶å™¨å‘å‡ºå€¼ Observable.interval å…·æœ‰å¯é€‰çš„åˆå§‹å»¶è¿Ÿ Observable.timer ä¸ä¼ å‚è°ƒç”¨å‡½æ•° åœ¨ç‰¹å®šçš„è°ƒåº¦ç¨‹åº Observable.start å¼‚æ­¥ Observable.startAsync å–å†³äºŽè®¢é˜…æ—¶ åŸºäºŽå¸ƒå°”æ¡ä»¶ Observable.if fä»Žä¸€ç»„é¢„å…ˆè®¾å®šçš„åºåˆ— Observable.case ä½¿ç”¨è‡ªå®šä¹‰é€»è¾‘ Observable.defer å®ƒå–å†³äºŽèµ„æº Observable.using æˆ‘æƒ³åŒ…è£…ä¸€ä¸ªå‡½æ•° å¹¶äº§ç”Ÿä¸€ä¸ªåºåˆ—çš„ç»“æžœ Observable.toAsync å®ƒæŽ¥å—å›žè°ƒ Observable.fromCallback å®ƒæŽ¥å—Node.jså›žè°ƒ Observable.fromNodeCallback æˆ‘æƒ³ç»“åˆå¤šä¸ªåºåˆ— å¹¶ä¸”ä»…ä»Žäº§ç”Ÿå€¼çš„åºåˆ—ä¸­æŽ¥æ”¶å€¼ Observable.amb æ‰€æœ‰äººéƒ½å·²ç»å®Œæˆé€šçŸ¥ Observable.forkJoin å¹¶è¾“å‡ºæ‰€æœ‰è¿™äº›å€¼ Observable.merge ä¸ºäº† ä¸æ”¹å˜æ—¶é‡å¤ä½¿ç”¨æœ€æ–°å€¼ Observable.combineLatest æ¯ä¸ªå€¼åªä½¿ç”¨ä¸€æ¬¡ Observable.zip é€šè¿‡è®¢é˜…æ¯ä¸ªåºåˆ—ä¸ºäº† å½“å‰ä¸€ä¸ªåºåˆ—å®Œæˆæ—¶ Observable.concat å½“å¦ä¸€ä¸ªåºåˆ—æŠ›å‡ºé”™è¯¯æ—¶ Observable.catch ä¸ç®¡å…ˆå‰çš„åºåˆ—æ˜¯å®Œæˆè¿˜æ˜¯æŠ›å‡ºé”™è¯¯ Observable.onErrorResumeNext é€šè¿‡å“åº”ä¸åŒçš„å€¼ç»„åˆï¼ˆè¿žæŽ¥å¾®ç§¯åˆ†ï¼‰ Observable.when]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>RxJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RXJSæˆ‘è¯¥é€‰ç”¨å“ªä¸ªæ“ä½œç¬¦ä¹‹-å®žä¾‹æ“ä½œç¬¦ç¯‡]]></title>
    <url>%2F2017%2F06%2F01%2FRXJS-should-i-choose-operator-of-instance.html</url>
    <content type="text"><![CDATA[RXJSæ¯”è¾ƒå¼ºå¤§ï¼Œæ“ä½œç¬¦ä¼—å¤šï¼Œæƒ³ç†Ÿæ‚‰éœ€è¦æ¯”è¾ƒé•¿æ—¶é—´çš„è¿ç”¨ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æ–°æ‰‹éƒ½æ¯”è¾ƒç–‘æƒ‘åº”è¯¥ä½¿ç”¨å“ªäº›æ“ä½œç¬¦åŽ»å®žçŽ°è‡ªå·±çš„æ•°æ®æµçš„æ“ä½œã€‚ æ›´å¤šè¯¦æƒ…è¯·ç¿»é˜… RXJSä¸­æ–‡ç¿»è¯‘æ–‡æ¡£ æˆ‘è¯¥é€‰ç”¨å“ªä¸ªæ“ä½œç¬¦? - å®žä¾‹æ“ä½œç¬¦ä½¿ç”¨æ­¤é¡µé¢é€šè¿‡ç±»åž‹æŸ¥æ‰¾Observable é€‚åˆæ‚¨éœ€è¦çš„å®žä¾‹è¿ç®—ç¬¦ï¼š å®žä¾‹æ“ä½œç¬¦ ä½¿ç”¨çŽ°æœ‰çš„åºåˆ— æˆ‘æƒ³æ”¹å˜æ¯ä¸ªå€¼ map/select æˆ‘æƒ³ä»Žæ¯ä¸ªå€¼æ‹‰ä¸€ä¸ªå±žæ€§ pluck æˆ‘æƒ³åœ¨ä¸å½±å“å€¼çš„æƒ…å†µä¸‹è¢«é€šçŸ¥å€¼ do/tap doOnNext/tapOnNext doOnError/tapOnError doOnCompleted/tapOnCompleted æˆ‘æƒ³åŒ…å«å€¼ åŸºäºŽè‡ªå®šä¹‰é€»è¾‘ filter/where ä»Žåºåˆ—å¼€å¤´ take åŸºäºŽè‡ªå®šä¹‰é€»è¾‘ takeWhile ä»Žåºåˆ—çš„æœ«å°¾ takeLast ç›´åˆ°å¦ä¸€ä¸ªåºåˆ—å‘å°„ä¸€ä¸ªå€¼æˆ–å®Œæˆ takeUntil æˆ‘æƒ³å¿½ç•¥å€¼ å…¨éƒ¨ ignoreElements ä»Žåºåˆ—çš„å¼€å¤´ skip åŸºäºŽè‡ªå®šä¹‰é€»è¾‘ skipWhile ä»Žåºåˆ—çš„æœ«å°¾ skipLast ç›´åˆ°å¦ä¸€ä¸ªåºåˆ—å‘å‡ºä¸€ä¸ªå€¼ skipUntil ä¸Žä»¥å‰çš„å€¼ç›¸åŒ distinctUntilChanged è¿™ï¼ˆè§¦å‘ï¼‰å¤ªé¢‘ç¹ throttle æˆ‘æƒ³è®¡ç®— æ€»å’Œ è¿™äº›å€¼çš„ sum å¹³å‡å€¼ average ä½¿ç”¨è‡ªå®šä¹‰é€»è¾‘ å¹¶ä¸”åªè¾“å‡ºæœ€ç»ˆå€¼ aggregate reduce å¹¶åœ¨è®¡ç®—å‡ºå€¼æ—¶è¾“å‡ºï¼ˆæ¯ä¸€æ­¥çš„ï¼‰å€¼ scan æˆ‘æƒ³ç”¨å…ƒæ•°æ®åŒ…è£…å®ƒçš„æ¶ˆæ¯ æè¿°æ¯ä¸ªæ¶ˆæ¯ materialize åŒ…æ‹¬ä»Žæœ€åŽä¸€ä¸ªä»·å€¼ä»¥æ¥çš„æ—¶é—´ timeInterval åŒ…æ‹¬æ—¶é—´æˆ³ timestamp ç»è¿‡ä¸€æ®µæ—¶é—´çš„ä¸æ´»åŠ¨ æˆ‘æƒ³æŠ›å‡ºä¸€ä¸ªé”™è¯¯ timeout æˆ‘æƒ³åˆ‡æ¢åˆ°å¦ä¸€ä¸ªåºåˆ— timeout æˆ‘æƒ³ç¡®ä¿åªæœ‰ä¸€ä¸ªå€¼ å¹¶ä¸”å¦‚æžœå­˜åœ¨å¤šäºŽæˆ–å°‘äºŽä¸€ä¸ªå€¼åˆ™æŠ›å‡ºé”™è¯¯ single å¹¶ä¸”å¦‚æžœæ²¡æœ‰å€¼ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ singleOrDefault æˆ‘åªæƒ³å–ç¬¬ä¸€ä¸ªå€¼ å¹¶ä¸”å¦‚æžœæ²¡æœ‰å€¼ï¼Œåˆ™æŠ›å‡ºé”™è¯¯ first å¹¶ä¸”å¦‚æžœæ²¡æœ‰å€¼ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ firstOrDefault åœ¨ä¸€æ®µæ—¶é—´å†… sample æˆ‘åªæƒ³å–æœ€åŽçš„å€¼ å¦‚æžœæ²¡æœ‰å€¼ï¼Œåˆ™æŠ¥é”™ last å¹¶ä¸”å¦‚æžœæ²¡æœ‰å€¼ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ lastOrDefault æˆ‘æƒ³çŸ¥é“å®ƒåŒ…å«å¤šå°‘å€¼ count æˆ‘æƒ³çŸ¥é“å®ƒæ˜¯å¦åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å€¼ contains æˆ‘æƒ³çŸ¥é“æ¡ä»¶æ˜¯å¦æ»¡è¶³ åªéœ€è¦ä»»ä¸€å€¼æ»¡è¶³ any/some éœ€è¦æ‰€æœ‰å€¼éƒ½æ»¡è¶³ all/every æˆ‘æƒ³æŠŠæ¶ˆæ¯å»¶è¿Ÿä¸€æ®µç‰¹å®šçš„æ—¶é—´ delay åŸºäºŽè‡ªå®šä¹‰é€»è¾‘ delayWithSelector æˆ‘æƒ³ç»™å€¼åˆ†ç»„ ç›´åˆ°åºåˆ—å®Œæˆ toArray toMap toSet ä½¿ç”¨è‡ªå®šä¹‰é€»è¾‘ ä½œä¸ºæ•°ç»„ buffer ä½œä¸ºåºåˆ— window æ ¹æ®ç‰¹å®šå¤§å°åˆ†æ‰¹ ä½œä¸ºæ•°ç»„ bufferWithCount ä½œä¸ºåºåˆ— windowWithCount åŸºäºŽæ—¶é—´ ä½œä¸ºæ•°ç»„ bufferWithTime ä½œä¸ºåºåˆ— windowWithTime åŸºäºŽæ—¶é—´æˆ–è®¡æ•°ï¼Œä»¥å…ˆå‘ç”Ÿè€…ä¸ºå‡† ä½œä¸ºæ•°ç»„ bufferWithTimeOrCount ä½œä¸ºåºåˆ— windowWithTimeOrCount åŸºäºŽä¸€ä¸ªæŒ‡å®šçš„key ç›´åˆ°åºåˆ—å®Œæˆ groupBy å¹¶æŽ§åˆ¶æ¯ç»„çš„ç”Ÿå‘½å‘¨æœŸ groupByUntil æˆ‘æƒ³ä¸ºæ¯ä¸ªå€¼å¼€å§‹ä¸€ä¸ªæ–°çš„åºåˆ— å¹¶ä¸”å¹¶è¡Œåœ°ä»Žæ‰€æœ‰åºåˆ—ä¸­å‘å‡ºå€¼ flatMap/selectMany å¹¶æŒ‰é¡ºåºä»Žæ¯ä¸ªåºåˆ—ä¸­è¾“å‡ºå€¼ concatMap/selectConcat å¹¶åœ¨æ–°å€¼åˆ°è¾¾æ—¶å–æ¶ˆå…ˆå‰çš„åºåˆ— flatMapLatest/selectSwitch å¹¶é€’å½’åœ°ä¸ºæ¯ä¸ªæ–°å€¼å¯åŠ¨ä¸€ä¸ªæ–°çš„åºåˆ— expand å¹¶æ ¹æ®onNextï¼ŒonErrorå’ŒonCompletedå¹¶è¡Œåœ°ä»Žæ‰€æœ‰åºåˆ—å‘å‡ºå€¼ flatMapObserver/selectManyObserver å¹¶æ ¹æ®onNextï¼ŒonErrorå’ŒonCompletedé¡ºåºåœ°ä»Žæ‰€æœ‰åºåˆ—å‘å‡ºå€¼ concatMapObserver/selectConcatObserver æˆ‘æƒ³æŠŠå®ƒä¸Žå¦ä¸€ä¸ªç»“åˆèµ·æ¥ ä¸¤è€…éƒ½å®Œæˆæ—¶å‘å‡ºé€šçŸ¥ forkJoin æˆ‘æƒ³æ‰§è¡Œå¤æ‚çš„æ“ä½œï¼Œè€Œä¸ä¼šæ‰“ç ´æµç•…çš„è°ƒç”¨ let æˆ‘æƒ³åœ¨å¤šä¸ªè®¢é˜…è€…ä¹‹é—´å…±äº«è®¢é˜… ä½¿ç”¨ç‰¹å®šçš„subjectå®žçŽ° multicast publish share å¹¶å‘æœªæ¥è®¢é˜…è€…æä¾›æœ€åŽçš„å€¼ publishLast shareLast å¹¶å‘æœªæ¥è®¢é˜…è€…é‡æ’­é»˜è®¤å€¼æˆ–æœ€æ–°å€¼ publishValue shareValue å¹¶å‘æœªæ¥çš„è®¢é˜…è€…é‡æ’­nä¸ªå€¼ replay shareReplay å‘ç”Ÿé”™è¯¯æ—¶ æˆ‘æƒ³é‡æ–°è®¢é˜… retry æˆ‘æƒ³å¼€å§‹ä¸€ä¸ªæ–°åºåˆ— catch å–å†³äºŽé”™è¯¯ catch å½“å®Œæˆæ—¶ æˆ‘æƒ³é‡æ–°è®¢é˜… repeat æˆ‘æƒ³å¼€å§‹ä¸€ä¸ªæ–°åºåˆ— concat å½“å®Œæˆæˆ–æŠ›å‡ºé”™è¯¯æ—¶ æˆ‘æƒ³å¼€å§‹ä¸€ä¸ªæ–°åºåˆ— onErrorResumeNext å½“å®Œæˆï¼ŒæŠ›å‡ºé”™è¯¯æˆ–é€€è®¢æ—¶ æˆ‘æƒ³æ‰§è¡Œä¸€ä¸ªå‡½æ•° finally æˆ‘æƒ³æ”¹å˜è·¯ç”±çš„è°ƒåº¦ç¨‹åº è°ƒç”¨subscribeï¼ˆè®¢é˜…ï¼‰ subscribeOn æ¶ˆæ¯ observeOn ä½¿ç”¨ä¸¤ä¸ªåºåˆ— æˆ‘æƒ³å†³å®šä»Žå“ªä¸ªæŽ¥æ”¶å€¼ å–å†³äºŽå“ªä¸ªåºåˆ—å…ˆå‘å‡ºå€¼ amb æˆ‘æƒ³ç¡®å®šå®ƒä»¬çš„å€¼æ˜¯å¦ç›¸ç­‰ sequenceEqual æˆ‘æƒ³åˆå¹¶å®ƒä»¬çš„å€¼ åªæœ‰å½“ç¬¬ä¸€ä¸ªåºåˆ—å‘å°„æ—¶ï¼Œä½¿ç”¨æ¯ä¸ªåºåˆ—çš„æœ€æ–°å€¼ withLatestFrom ä¸ºäº† ä¸æ”¹å˜æ—¶é‡å¤ä½¿ç”¨æœ€æ–°å€¼ combineLatest æ¯ä¸ªå€¼åªä½¿ç”¨ä¸€æ¬¡ zip é‡å¤åˆ†äº«æˆ‘é€‰æ‹©çš„â€œç”Ÿå‘½å‘¨æœŸâ€ å¹¶é€šçŸ¥æ¯ä¸ªç»„åˆ join å¹¶ç»™æ¯ä¸ªâ€œå·¦â€çš„åºåˆ—çš„å€¼ç»™â€œå³â€çš„åºåˆ— groupJoin æˆ‘æƒ³åŒ…å«ä¸¤è€…çš„å€¼ merge]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>RxJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Markoå’Œreact,preact,vueç›¸æ¯”å¿«åœ¨å“ªé‡Œ]]></title>
    <url>%2F2017%2F06%2F01%2Fwhy-Marko-faster-than-react-preact-vue.html</url>
    <content type="text"><![CDATA[Markoå’Œreact,preact,vueç›¸æ¯”å¿«åœ¨å“ªé‡Œåœ¨eBayï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨[Marko](http://markojs.com/)æ¯å¤©å¤„ç†è¶…è¿‡åäº¿çš„è¯·æ±‚ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬ç²¾ç®€æˆ‘ä»¬çš„å¼€æºUIåº“Markoã€‚æˆ‘ä»¬å¤§å¤§ä¼˜åŒ–äº†Marko ï¼Œä»¥å®žçŽ°å¿«é€Ÿæ¸²æŸ“ï¼Œé«˜çº§æ€§èƒ½æŠ€æœ¯ï¼Œå¹¶å®žçŽ°äº†æœ€å°çš„é¡µé¢é‡é‡ï¼ˆã€œ10kb gzippedï¼‰ã€‚æ€§èƒ½åªæ˜¯ä¸€ä¸ªæ–¹é¢ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜å¿…é¡»æ‰©å±•Markoä»¥æ”¯æŒæ•°ç™¾ä¸ªå›¢é˜Ÿçš„å¼€å‘ï¼Œä»Žè€Œå…è®¸å¼€å‘äººå‘˜æœ‰æ•ˆåœ°åˆ›å»ºå¯ç»´æŠ¤å’Œå¼ºå¤§çš„Webåº”ç”¨ç¨‹åºã€‚ æˆ‘ä»¬å·²ç»åˆ›å»ºäº†æˆ‘ä»¬è‡ªå·±çš„benchMarksè¿›è¡Œæ¯”è¾ƒï¼Œä¹Ÿå·²ç»å°†Markoæ·»åŠ åˆ°å…¶ä»–åŸºå‡†æµ‹è¯•ä¸­ï¼Œä½†æ˜¯åŸºå‡†æµ‹è¯•å¹¶ä¸æ€»æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚å°½ç®¡æˆ‘ä»¬å°½å¯èƒ½å…¬å¹³åœ°å¯¹å¾…æˆ‘ä»¬çš„åŸºå‡†ï¼Œä½†æœ€é‡è¦çš„æ˜¯åœ¨çŽ°å®žä¸–ç•Œçš„åº”ç”¨ä¸­çš„è¡¨çŽ°ï¼Œè€Œä¸æ˜¯ä¸“æ³¨äºŽå¾®è§‚åŸºå‡†ã€‚è¿™å°±æ˜¯V8å›¢é˜Ÿè½¬è€Œé‡‡ç”¨æ–°çš„æ–¹æ³•æ¥è¡¡é‡å’Œç†è§£çŽ°å®žJavaScriptæ€§èƒ½çš„ä¸€ä¸ªåŽŸå› ã€‚ åŒæ ·ï¼Œæˆ‘ä»¬å·²ç»è§‚å¯Ÿè¿‡æˆ‘ä»¬çš„å¼€å‘äººå‘˜å®žé™…å¼€å‘ä¸­å¦‚ä½•ç¼–å†™ä»–ä»¬çš„Markoç»„ä»¶ï¼Œå¹¶ä¸”å‘çŽ°äº†å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–çš„æ¨¡å¼ã€‚è€Œä¸æ˜¯å…³æ³¨æœ¬æ–‡ä¸­çš„åŸºå‡†æµ‹è¯•ï¼Œæˆ‘æƒ³å…³æ³¨æˆ‘ä»¬åº”ç”¨äºŽMarkoçš„ä¼˜åŒ–ç»†èŠ‚ã€‚ å¤šä¸ªç¼–è¯‘è¾“å‡ºMarkoæ˜¯ä¸€ä¸ªåœ¨æœåŠ¡å™¨å’Œæµè§ˆå™¨ä¸­è¿è¡Œçš„åŒæž„UIåº“ã€‚æ­£å¦‚Michael Rawlingsåœ¨â€œ æœåŠ¡å™¨ç«¯æ¸²æŸ“æŸ“ â€ä¸­æåˆ°çš„ï¼Œå½“åœ¨æœåŠ¡å™¨ä¸Šå‘ˆçŽ°æ—¶ï¼ŒMarkoç›´æŽ¥å‘ˆçŽ°å¯ä»¥ä½œä¸ºHTTPå“åº”å‘é€çš„æ–‡æ¡£ï¼ˆHTMLï¼‰çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚ åœ¨æµè§ˆå™¨ä¸­å‘ˆçŽ°æ—¶ï¼Œå¿…é¡»è§£æžHTMLå­—ç¬¦ä¸²æ‰èƒ½æ›´æ–°DOMã€‚å› æ­¤ï¼ŒMarkoé€šè¿‡ç¨‹åºå°†è§†å›¾ç¼–è¯‘ä¸ºç›´æŽ¥å‘ˆçŽ°åˆ°è™šæ‹Ÿæ–‡æ¡£ï¼ˆVDOMï¼‰æ ‘ï¼Œè¿™å¯ä»¥é’ˆå¯¹æµè§ˆå™¨æœ‰æ•ˆåœ°æ›´æ–°çœŸå®žçš„DOMã€‚ ç»™å‡ºä»¥ä¸‹æ¨¡æ¿ï¼š &lt;div>Hello ${input.name}!&lt;/div> ç¼–è¯‘ä¸ºæœåŠ¡å™¨ç¼–è¯‘è¾“å‡ºé’ˆå¯¹æœåŠ¡å™¨ä¸Šçš„HTMLè¾“å‡ºè¿›è¡Œäº†ä¼˜åŒ–ï¼š var marko_template = require("marko/html").t(__filename), marko_helpers = require("marko/runtime/html/helpers"), marko_escapeXml = marko_helpers.x; function render(input, out) { out.w("&lt;div>Hello " + marko_escapeXml(input.name) + "!&lt;/div>"); } ç¼–è¯‘ä¸ºæµè§ˆå™¨ç¼–è¯‘è¾“å‡ºé’ˆå¯¹æµè§ˆå™¨ä¸­çš„è™šæ‹ŸDOMæ¸²æŸ“è¿›è¡Œäº†ä¼˜åŒ–ï¼š var marko_template = require("marko/vdom").t(__filename); function render(input, out) { out.e("DIV", null, 3) .t("Hello ") .t(input.name) .t("!"); } æ¨¡å—åŒ–è¿è¡Œæ—¶Markoè¿è¡Œæ—¶å¹¶ä¸ä½œä¸ºå•ä¸ªJavaScriptæ–‡ä»¶åˆ†å‘ã€‚ç›¸åï¼ŒMarkoç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªJavaScriptæ¨¡å—ï¼Œè¯¥æ¨¡å—ä»…å¯¼å…¥å®žé™…éœ€è¦çš„è¿è¡Œæ—¶éƒ¨åˆ†ã€‚è¿™å…è®¸æˆ‘ä»¬å‘Markoæ·»åŠ æ–°åŠŸèƒ½ï¼Œè€Œä¸ä¼šä½¿çŽ°æœ‰åº”ç”¨ç¨‹åºè†¨èƒ€ã€‚ä¾‹å¦‚ï¼Œç»™å‡ºä»¥ä¸‹æ¨¡æ¿ï¼š $ var color = 'red'; &lt;div style={backgroundColor: color}>&lt;/div> åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œéœ€è¦é¢å¤–çš„è¿è¡Œæ—¶ä»£ç æ¥æ ¹æ®æ‰€æä¾›styleçš„JavaScriptå¯¹è±¡å‘ˆçŽ°å±žæ€§ã€‚å¯¼å…¥styleAttråŠ©æ‰‹çš„ç¼–è¯‘ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š var marko_styleAttr = require("marko/runtime/vdom/helper-styleAttr"); function render(input, out) { var color = 'red'; out.e("DIV", { style: marko_styleAttr({ backgroundColor: color }) }, 0, 4); } é«˜æ€§èƒ½çš„æœåŠ¡å™¨ç«¯æ¸²æŸ“ä¸ŽåŸºäºŽä¸“é—¨è¿›è¡Œè™šæ‹ŸDOMæ¸²æŸ“çš„JSXçš„è§£å†³æ–¹æ¡ˆç›¸æ¯”ï¼ŒMarkoåœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æ–¹é¢å…·æœ‰å·¨å¤§çš„ä¼˜åŠ¿ã€‚å½“æ¸²æŸ“åˆ°æœåŠ¡å™¨ä¸Šçš„è™šæ‹ŸDOMæ ‘æ—¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸¤æ­¥çš„è¿‡ç¨‹æ¥å‘ˆçŽ°HTMLï¼š é¦–å…ˆåœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„è™šæ‹ŸDOMæ ‘ ç¬¬äºŒéå°†è™šæ‹ŸDOMæ ‘åºåˆ—åŒ–ä¸ºå¯ä»¥é€šè¿‡çº¿è·¯å‘é€çš„HTMLå­—ç¬¦ä¸²ï¼ˆè¿™éœ€è¦éåŽ†æ•´ä¸ªæ ‘ç»“æž„ï¼‰ ç›¸æ¯”ä¹‹ä¸‹ï¼ŒMarkoç›´æŽ¥ä¸€æ¬¡æ€§æ¸²æŸ“ä¸€æ•´ä¸ªHTMLæµã€‚æ²¡æœ‰ä¸­é—´æ ‘æ•°æ®ç»“æž„ã€‚ é™æ€å­æ ‘çš„ç¼–è¯‘æ—¶ä¼˜åŒ–ç»™å‡ºä»¥ä¸‹æ¨¡æ¿ï¼š &lt;div>This is a &lt;strong>static&lt;/strong> node&lt;/div> Markoå°†ä¼šè®¤è¯†åˆ°ï¼Œæ¨¡æ¿ç‰‡æ®µæ¯æ¬¡éƒ½ä¼šäº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Œå› æ­¤ä¼šåƒä»¥ä¸‹ç¼–è¯‘è¾“å‡ºä¸€æ ·åˆ›å»ºä¸€ä¸ªè™šæ‹ŸDOMèŠ‚ç‚¹ï¼š var marko_node0 = marko_createElement("DIV", null, 3, ...) .t("This is a ") .e("STRONG", null, 1) .t("static") .t(" node"); function render(input, out) { out.n(marko_node0); } æ¸²æŸ“é™æ€å­æ ‘å‡ ä¹Žæ˜¯é›¶æˆæœ¬ã€‚æ­¤å¤–ï¼ŒMarkoå°†è·³è¿‡å¯¹æ¯”/ä¿®è¡¥é™æ€å­æ ‘ã€‚ åŒæ ·ï¼Œåœ¨æœåŠ¡å™¨ä¸Šï¼ŒMarkoä¼šå°†æ¨¡æ¿çš„é™æ€éƒ¨åˆ†åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼š function render(input, out) { out.w("&lt;div>This is a &lt;strong>static&lt;/strong> node&lt;/div>"); } é™æ€å±žæ€§çš„ç¼–è¯‘æ—¶ä¼˜åŒ–Markoè¿˜å°†ä¼˜åŒ–åŠ¨æ€å…ƒç´ çš„é™æ€å±žæ€§ã€‚ ç»™å‡ºä»¥ä¸‹æ¨¡æ¿ï¼š &lt;div.hello>Hello ${input.name}!&lt;/div> Markoå°†äº§ç”Ÿä»¥ä¸‹ç¼–è¯‘è¾“å‡ºï¼š var marko_attrs0 = { "class": "hello" }; function render(input, out) { out.e("DIV", marko_attrs0, 3) .t("Hello ") .t(input.name) .t("!"); } è¯·æ³¨æ„ï¼Œå±žæ€§å¯¹è±¡åªåˆ›å»ºä¸€æ¬¡ï¼Œå®ƒç”¨äºŽæ¯ä¸ªæ¸²æŸ“ã€‚å¦å¤–ï¼Œé™æ€å±žæ€§ä¸ä¼šå‘ç”Ÿ diffing/patchingã€‚ æ™ºèƒ½ç¼–è¯‘å™¨ä½¿ç”¨Markoï¼Œæˆ‘ä»¬å€¾å‘äºŽåœ¨ç¼–è¯‘æ—¶å°½å¯èƒ½å¤šåœ°æ‰§è¡Œã€‚è¿™ä½¿æˆ‘ä»¬çš„ç¼–è¯‘å™¨æ›´åŠ å¤æ‚ï¼Œä½†å®ƒåœ¨è¿è¡Œæ—¶ç»™æˆ‘ä»¬å¸¦æ¥äº†å¾ˆå¤§çš„æ”¶èŽ·ã€‚æˆ‘ä»¬æœ‰ã€œ90ï¼…çš„ä»£ç è¦†ç›–çŽ‡å’Œè¶…è¿‡2000ä¸ªæµ‹è¯•ï¼Œä»¥ç¡®ä¿ç¼–è¯‘å™¨æ­£å¸¸å·¥ä½œã€‚æ­¤å¤–ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼ŒMarkoç¼–è¯‘å™¨ä¸ºç»™å®šçš„æ¨¡æ¿æä¾›è¿è¡Œæ—¶æç¤ºï¼Œä»¥ä¾¿è¿è¡Œæ—¶å¯ä»¥é’ˆå¯¹ç‰¹å®šæ¨¡å¼è¿›è¡Œä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼Œè¯†åˆ«çš„Markoå¦‚æžœHTMLå…ƒç´ ä»…å…·æœ‰class/id/styleå®šä¹‰å’Œåšç‰ˆæœ¬æ¯”è¾ƒæ—¶/ä¿®è¡¥è¿è¡Œæ—¶ä¼˜åŒ–äº†è¿™äº›è™šæ‹ŸDOMèŠ‚ç‚¹ï¼ˆMarkoç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ï¼Œæ ‡è®°ç®€å•çš„è™šæ‹ŸDOMèŠ‚ç‚¹ç”¨äºŽé’ˆå¯¹ diffing/patching é€»è¾‘ï¼‰ã€‚ äº‹ä»¶å§”æ‰˜å¦‚æžœä½ æ­£åœ¨å»ºç«‹ä¸€ä¸ªUIç»„ä»¶ï¼Œæ‚¨å°†å¾ˆå¯èƒ½éœ€è¦ç¼–å†™ä»£ç æ¥å¤„ç†ä¸åŒçš„DOMäº‹ä»¶ï¼ˆclickï¼Œsubmitï¼Œç­‰ï¼‰ã€‚å¼€å‘äººå‘˜å¸¸å¸¸ç¼–å†™ä½¿ç”¨el.addEventListener(...)æˆ–ä½¿ç”¨è¯¸å¦‚jQueryçš„åº“æ¥æ·»åŠ DOMäº‹ä»¶ç›‘å¬å™¨çš„ä»£ç ã€‚å½“æ‚¨ä½¿ç”¨Markoæž„å»ºUIç»„ä»¶æ—¶ï¼Œæ‚¨ä»ç„¶å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œï¼Œä½†æ˜¯åœ¨åˆå§‹åŒ–å¤§é‡ç»„ä»¶æ—¶ï¼Œåœ¨é™„åŠ ä¾¦å¬å™¨æ—¶ä¼šå‡ºçŽ°å¼€é”€ã€‚ç›¸åï¼ŒMarkoå»ºè®®ä½¿ç”¨å£°æ˜Žå¼äº‹ä»¶ç»‘å®šï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š &lt;button type="button" on-click("handleClick")> Click Me &lt;/button> å½“ä½¿ç”¨å£°æ˜Žæ€§äº‹ä»¶ç»‘å®šæ—¶ï¼Œäº‹å®žä¸Šæ²¡æœ‰é™„åŠ ä»»ä½•DOMäº‹ä»¶ä¾¦å¬å™¨ã€‚ç›¸åï¼ŒMarkoä¼šä¸ºæ¯ä¸ªDOMäº‹ä»¶ï¼ˆåœ¨å¯åŠ¨æ—¶å®Œæˆï¼‰ä¸ºé¡µé¢çš„æ ¹DOMå…ƒç´ é™„åŠ ä¸€ä¸ªç›‘å¬å™¨ã€‚å½“Markoåœ¨æ ¹èŠ‚ç‚¹å¤„æ”¶åˆ°äº‹ä»¶æ—¶ï¼Œå®ƒå°†æŠŠäº‹ä»¶å§”æ‰˜ç»™è¯¥äº‹ä»¶çš„ç›¸åº”ç»„ä»¶ã€‚è¿™æ˜¯é€šè¿‡æŸ¥çœ‹event.targetå±žæ€§æ¥æŸ¥çœ‹äº‹ä»¶å‘ç”Ÿçš„ä½ç½®ï¼Œç„¶åŽå‘ä¸ŠéåŽ†æ ‘æ¥æŸ¥æ‰¾éœ€è¦é€šçŸ¥çš„ç»„ä»¶ã€‚å› æ­¤ï¼Œå½“æ ¹ç›®å½•æ•èŽ·DOMäº‹ä»¶æ—¶ï¼Œä¼šåšæ›´å¤šçš„å·¥ä½œï¼Œä½†è¿™ç§æ–¹æ³•ä½¿ç”¨çš„å†…å­˜å°‘å¾—å¤šï¼Œå¹¶å‡å°‘äº†åˆå§‹åŒ–æ—¶éœ€è¦å®Œæˆçš„ã€‚å°†äº‹ä»¶å§”æ´¾ç»™ç»„ä»¶çš„é¢å¤–å¼€é”€å¹¶ä¸æ˜Žæ˜¾ï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç›Šçš„ä¼˜åŒ–ã€‚ è¯‘æ–‡ï¼šwhy-is-marko-fast]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Marko</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[npm@5å‘å¸ƒæœ‰å“ªäº›æ”¹è¿›]]></title>
    <url>%2F2017%2F06%2F01%2Fnpm-5-published.html</url>
    <content type="text"><![CDATA[npm@5å‘å¸ƒæœ‰å“ªäº›æ”¹è¿›ä»Žä»Šå¤©å¼€å§‹ï¼Œå¦‚æžœæ‚¨è¾“å…¥â€œnpm install npm@latest -gâ€ï¼Œé‚£ä¹ˆæ‚¨å°†è¢«æ›´æ–°ä¸ºnpmç‰ˆæœ¬5ã€‚å¦å¤–ï¼Œåœ¨æ‰€æœ‰Node.js 8çš„æ–°å®‰è£…ä¸­éƒ½æ†ç»‘äº†npm@5 ï¼Œå®ƒå·²ç»æ›¿ä»£äº†Node.js 7åœ¨Node Projectçš„å½“å‰ç‰ˆæœ¬ä¸­ã€‚ åœ¨è¿‡åŽ»ä¸€å¹´åŠçš„æ—¶é—´é‡Œï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨åŠªåŠ›è§£å†³å¤§é‡çš„ç—›ç‚¹ï¼Œå…¶ä¸­æœ‰äº›æ˜¯åˆ›å»ºnpmä»¥æ¥å°±å·²ç»å­˜åœ¨çš„ã€‚ä»Šå¤©çš„å‘å¸ƒæ˜¯å¯¹npmé€Ÿåº¦ï¼Œä¸€è‡´æ€§å’Œç”¨æˆ·ä½“éªŒçš„æœ€å¤§æ”¹è¿›ã€‚ å‘å¸ƒè¯´æ˜Žä¸­æœ‰ä»€ä¹ˆæ–°å†…å®¹å’Œæ›´æ”¹å†…å®¹çš„æ˜Žç¡®åˆ—è¡¨ï¼Œä½†è¿™é‡Œæœ‰ä¸€äº›äº®ç‚¹ï¼š é€Ÿåº¦å¾ˆå¿«é‡æ–°ç¼–æŽ’äº†åŒ…å…ƒæ•°æ®ï¼Œè½¯ä»¶åŒ…ä¸‹è½½å’Œè½¯ä»¶åŒ…ç¼“å­˜ï¼Œè¿™å¤§å¤§åŠ å¿«äº†å·¥ä½œã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒæœŸæœ›æ€§èƒ½æå‡20-100ï¼…; æˆ‘ä»¬è¿˜çœ‹åˆ°ä¸€äº›å®‰è£…å’Œç‰ˆæœ¬å†²çªçš„è¿è¡Œé€Ÿåº¦æé«˜äº†5å€ã€‚ ç”±äºŽnpmæœ€åˆçš„è®¾è®¡ï¼Œå¼€å‘äººå‘˜å·²ç»æ”¹å˜äº†ä»–ä»¬å¦‚ä½•ä½¿ç”¨npmã€‚npmç”Ÿæ€ç³»ç»Ÿä¸ä»…å‘ˆæŒ‡æ•°çº§å¢žé•¿ï¼Œè€Œä¸”ä»Ž2014å¹´èµ·ï¼Œå¹³å‡npmè½¯ä»¶åŒ…ä¸­çš„ä¾èµ–å…³ç³»æ•°é‡å¢žåŠ äº†250ï¼…ã€‚çŽ°åœ¨ï¼Œæ›´å¤šçš„å¼€å‘äººå‘˜çŽ°åœ¨å¯ä»¥åœ¨æœ¬åœ°å®‰è£…Babelï¼Œwebpackå’ŒTapç­‰æœ‰ç”¨å·¥å…·ï¼Œè€Œä¸æ˜¯å…¨å±€ã€‚è¿™æ˜¯ä¸€ä¸ªæœ€ä½³å®žè·µï¼Œä½†è¿™æ„å‘³ç€â€œnpm installâ€å¯ä»¥åšæ›´å¤šçš„å·¥ä½œã€‚ é‰´äºŽæˆ‘ä»¬ç¤¾åŒºçš„è§„æ¨¡ï¼Œä»»ä½•é€Ÿåº¦ä¸Šå‡éƒ½ä¼šä¸ºæ•°ç™¾ä¸‡ç”¨æˆ·å¸¦æ¥å·¨å¤§çš„èŠ‚çœï¼Œæ›´ä¸ç”¨è¯´æˆ‘ä»¬çš„æ‰€æœ‰ç»„ç»‡å’Œnpmä¼ä¸šå®¢æˆ·ã€‚ä½¿npm @ 5å˜å¿«æˆä¸ºä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„ç›®æ ‡ã€‚ ç›®æ ‡ä¸€è‡´é»˜è®¤é”æ–‡ä»¶Shrinkwrapå¾ˆæ—©å°±å·²ç»æ˜¯npmçš„ä¸€éƒ¨åˆ†ï¼Œä½†npm@5ä½¿lockfilesæˆä¸ºé»˜è®¤ï¼Œæ‰€ä»¥æ‰€æœ‰çš„npmå®‰è£…çŽ°åœ¨éƒ½æ˜¯å¯é‡çŽ°çš„ã€‚åœ¨å®‰è£…ç»™å®šç‰ˆæœ¬çš„è½¯ä»¶åŒ…æ—¶ï¼Œæ¯æ¬¡å®‰è£…å®ƒæ‚¨èŽ·å¾—çš„æ–‡ä»¶å°†æ˜¯ç›¸åŒçš„ã€‚ æˆ‘ä»¬å‘çŽ°æ— æ•°å¸¸è§ä¸”è€—æ—¶çš„é—®é¢˜å¯èƒ½ä¸Žä¸åŒå¼€å‘äººå‘˜çŽ¯å¢ƒåˆ©ç”¨ä¸åŒè½¯ä»¶åŒ…ç‰ˆæœ¬æ—¶å‘ç”Ÿçš„â€œæ¼‚ç§»â€ç›¸å…³ã€‚ä½¿ç”¨é»˜è®¤é”æ–‡ä»¶ï¼Œè¿™ä¸å†æ˜¯é—®é¢˜ã€‚ä½ ä¸ä¼šæµªè´¹æ—¶é—´ï¼Œè¯•å›¾æ‰¾å‡ºä¸€ä¸ªé”™è¯¯ï¼Œåªæ˜¯ä¸ºäº†äº†è§£å®ƒæ¥è‡ªè¿è¡Œä¸åŒç‰ˆæœ¬çš„å›¾ä¹¦é¦†çš„äººã€‚ SHA-512å“ˆå¸Œnpm@5å¢žåŠ äº†å¯¹Node.jsæ”¯æŒçš„ä»»ä½•tarball HashåŠŸèƒ½çš„æ”¯æŒï¼Œå¹¶ä»¥SHA-512 hashå‘å¸ƒã€‚é€šè¿‡æ£€æŸ¥æ‰€æœ‰ä¸‹è½½çš„è½¯ä»¶åŒ…ï¼Œæ‚¨å¯ä»¥é˜²æ­¢æ•°æ®æŸåå’Œæ¶æ„æ”»å‡»ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥ç›¸ä¿¡æ‚¨ä»Žnpmä¸‹è½½çš„ä»£ç æ˜¯ä¸€è‡´å’Œå®‰å…¨çš„ã€‚ è‡ªæ„ˆç¼“å­˜æˆ‘ä»¬çš„æ–°ç¼“å­˜å¾ˆå®¹æ˜“æŸåï¼Œä½†ä¹Ÿæ›´å…·å¼¹æ€§ã€‚å¤šä¸ªnpmè¿›ç¨‹ä¸ä¼šç ´åå…±äº«ç¼“å­˜ï¼Œnpm@5å°†æ£€æŸ¥æ’å…¥å’Œæå–çš„æ•°æ®ï¼Œä»¥é˜²æ­¢å®‰è£…æŸåçš„æ•°æ®ã€‚å¦‚æžœç¼“å­˜é¡¹å¤±è´¥å®Œæ•´æ€§æ£€æŸ¥ï¼Œnpm@5å°†è‡ªåŠ¨åˆ é™¤å®ƒå¹¶é‡æ–°èŽ·å–ã€‚ æ›´æ˜“ä½¿ç”¨æ ¹æ®æ‚¨çš„åé¦ˆï¼Œæˆ‘ä»¬é€šè¿‡npm @ 5ä¸­çš„ä¼˜åŒ–æ”¹è¿›äº†ç”¨æˆ·ä½“éªŒã€‚å…¶ä¸­å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯è¾“å‡ºæ›´å¤šçš„æœ‰ç”¨çš„æç¤ºä¿¡æ¯ã€‚æœ€å¥½çš„ä¾‹å­æ˜¯ï¼Œnpmä¸å†æ˜¾ç¤ºpackageä¸Šçš„æ•´ä¸ªæ ‘; ç›¸åï¼Œæ‚¨å°†çœ‹åˆ°æœ‰å…³å®‰è£…å†…å®¹çš„æ‘˜è¦æŠ¥å‘Šã€‚ç”±äºŽå¹³å‡æ¯ä¸ªpackageä¸­çš„ä¾èµ–å…³ç³»è¾ƒå¤§ï¼Œå› æ­¤æˆ‘ä»¬è¿›è¡Œäº†æ­¤æ›´æ”¹ã€‚é€ä¸ªæ–‡ä»¶è¯»å‡ºç»“æžœæ˜¯è¶…è¿‡ä¸€å®šæ•°é‡å°±ä¼šæ˜¾å¾—éžå¸¸ç¬¨é‡ã€‚ æ¯”è¾ƒæœ‰ä¸€ä¸ªé¡¹ç›®ä½¿ç”¨ benchmark æ¯”è¾ƒäº† yarn, pnpm, npm çš„æ•ˆçŽ‡, ä¼ é€é—¨ ä¸‹é¢æ˜¯æ¯”è¾ƒç»“æžœï¼š Installer Average over 5 runs yarn â€“offline 5.88 pnpm â€“offline 6.72 pnpm (cached) 6.86 npm 5.x (shrinkpacked, compressed) 8.35 npm 5.x (shrinkpacked) 8.94 npm 5.x (cached) 11.36 npm 4.x (cached) 13.47 yarn 13.71 npm 5.x 14.93 pnpm 17.57 npm 4.x (shrinkpacked, compressed) 18.73 npm 4.x (shrinkpacked) 18.78 npm 4.x 29.73]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSXæ˜¯ä»€ä¹ˆé¬¼(WTF-is-JSX)]]></title>
    <url>%2F2017%2F05%2F30%2FWTF-JSX.html</url>
    <content type="text"><![CDATA[JSXæ˜¯ä»€ä¹ˆé¬¼(WTF-is-JSX)JSXå®žé™…ä¸Šå¾ˆç®€å•ï¼šåªéœ€è¦èŠ±1åˆ†é’Ÿé˜…è¯»è¿™ä¸ªï¼Œä½ ä¼šæ˜Žç™½æœ‰å…³è¿™ä¸ªæœ‰è¶£çš„æ›¿ä»£æ¨¡æ¿çš„ä¸€åˆ‡ã€‚ æ›¿æ¢æ ‡é¢˜ï¼šâ€œèžå…¥JSXâ€ Pragmaæ‚¨å¯ä»¥å£°æ˜Žæ¯ä¸ªæ–‡ä»¶æˆ–æ¯ä¸ªå‡½æ•°æ¥å‘Šè¯‰æ‚¨çš„transpilerï¼ˆä¾‹å¦‚ï¼šBabelï¼‰æ¯ä¸ªèŠ‚ç‚¹åœ¨è¿è¡Œæ—¶åº”è°ƒç”¨çš„å‡½æ•°çš„åç§°ï¼ˆè¯·å‚é˜…â€œTranspilationâ€ï¼‰ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¯´çš„æ˜¯â€œ h()ä¸ºæ¯ä¸ªèŠ‚ç‚¹æ³¨å…¥ä¸€ä¸ªå‡½æ•°â€ï¼š /** @jsx h */ Transpilationå¦‚æžœä½ è¿˜æ²¡æœ‰ä½¿ç”¨è§£æžå™¨ï¼Œä½ åº”è¯¥æ˜¯å°è¯•ä¸€ä¸‹ã€‚ä½¿ç”¨ES6 / ES2015 ç¼–å†™ï¼Œè°ƒè¯•ï¼Œæµ‹è¯•å’Œè¿è¡ŒJavaScriptæ—¶æ›´ä¸ºé«˜æ•ˆã€‚Babelæ˜¯æœ€å—æ¬¢è¿Žå’ŒæŽ¨èçš„é€æžå™¨ï¼Œæ‰€ä»¥æˆ‘ä¼šå‡è®¾ä½ æ­£åœ¨ä½¿ç”¨å®ƒã€‚ é™¤äº†å°†ES6 / ES7 +è¯­æ³•è½¬æ¢ä¸º ES5 ä»¥å¤–ï¼ŒBabelè¿˜åŒ…æ‹¬å¯¹JSX å¼€ç®±å³ç”¨çš„è½¬æ¢æ”¯æŒã€‚æ‚¨ä¸éœ€è¦æ·»åŠ æˆ–æ›´æ”¹ä»»ä½•å†…å®¹ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚ é€šè¿‡æŸ¥çœ‹ä¸€ä¸ªéžå¸¸ç®€å•çš„ä¾‹å­æ¥äº†è§£å®ƒçš„å·¥ä½œåŽŸç†æ˜¯æœ€ç®€å•çš„ï¼š è½¬æ¢å‰ :( ä½ å†™çš„ä»£ç ï¼‰ /** @jsx h */ let foo = &lt;div id="foo">Hello!&lt;/div>; è½¬æ¢åŽ :(ä½ è¿è¡Œçš„ä»£ç ï¼‰ var foo = h('div', {id:"foo"}, 'Hello!'); ä½ å¯èƒ½çœ‹ç¬¬äºŒä¸ªä»£ç ç‰‡æ®µçš„æ—¶å€™ï¼Œè®¤ä¸ºä½¿ç”¨å‡½æ•°æž„å»ºUIä¸ä¼šé‚£ä¹ˆç³Ÿç³• è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘åä¸Šäº† JSX çš„è½¦ï¼šå¦‚æžœå®ƒä»Žåœ°çƒä¸Šæ¶ˆå¤±äº†ï¼Œç”¨æ‰‹å†™çš„è¾“å‡ºä¾ç„¶ä¼šå¾ˆèˆ’æœã€‚ JSXåªæ˜¯ä¸€ç§å·²ç»ç›¸å½“ä¸é”™çš„è¯­æ³•çš„ç³–ã€‚ äººä»¬ç”šè‡³æŠŠå®ƒç”¨äºŽæ•´ä¸ªé¡¹ç›®ï¼šhyperscript æˆ‘ä»¬æ¥æž„å»ºä¸€ä¸ªJSXæ¸²æŸ“å™¨é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰è½¬æ¢ä»£ç åŽè°ƒç”¨çš„ h() å‡½æ•°ã€‚ ä½ è°ƒç”¨ä»»ä½•ä½ æƒ³è¦çš„ï¼Œæˆ‘ä½¿ç”¨h()ï¼Œå› ä¸ºè¿™ç§ç±»åž‹çš„â€œæž„å»ºå™¨â€åŠŸèƒ½çš„åŽŸå§‹æƒ³æ³•è¢«ç§°ä¸ºhyperscript (â€œhypertextâ€œ + â€œjavascriptâ€).ã€‚ function h(nodeName, attributes, ...args) { let children = args.length ? [].concat(...args) : null; return { nodeName, attributes, children }; } å¥½çš„ï¼Œè¿™çœ‹èµ·æ¥å¾ˆç®€å•ï¼ˆps: åªå¤„ç†äº† childrenï¼‰ ä¸ç†Ÿæ‚‰ES6 / ES2015ï¼Ÿ è¿™â€¦åœ¨å‚æ•°åˆ—è¡¨æ˜¯ä¸€ä¸ªrest paramã€‚å®ƒå°†â€œå…¶ä½™â€çš„å‚æ•°æ”¶é›†åˆ°æ•°ç»„ä¸­ã€‚ è¯¥concat(â€¦args)ä½æ˜¯ä¸€ä¸ªæ‰©å±•è¿ç®—ç¬¦ï¼šå®ƒéœ€è¦è¯¥æ•°ç»„å¹¶å°†å…¶æ‰©å±•ä¸ºå‚æ•°concat()ã€‚è¿™é‡Œä½¿ç”¨çš„concat()æ˜¯å°†å­èŠ‚ç‚¹æŽ¨å…¥æ•°ç»„ã€‚ çŽ°åœ¨æˆ‘ä»¬æœ‰è¿™äº›åµŒå¥—çš„JSONå¯¹è±¡æˆ‘ä»¬çš„h()å‡½æ•°åå‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªè¿™æ ·çš„â€œæ ‘â€ï¼š { nodeName: "div", attributes: { "id": "foo" }, children: ["Hello!"] } æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæŽ¥å—è¯¥æ ¼å¼å¹¶æŠ›å‡ºå®žé™…DOMèŠ‚ç‚¹çš„å‡½æ•°ï¼š(å³æ²‰æŸ“vdom) function render(vnode) { // å­—ç¬¦ä¸²åªè½¬æ¢æˆ æ–‡æœ¬èŠ‚ç‚¹ï¼š if (vnode.split) return document.createTextNode(vnode); // ä½¿ç”¨ VDOM çš„ nodeName åˆ›å»ºä¸€ä¸ªDOM æ ‡ç­¾ let n = document.createElement(vnode.nodeName); // æ‹·è´æ‰€æœ‰å±žæ€§åˆ°æ–°èŠ‚ç‚¹ä¸Š let a = vnode.attributes || {}; Object.keys(a).forEach( k => n.setAttribute(k, a[k]) ); // æ¸²æŸ“å¹¶æ·»åŠ å­èŠ‚ç‚¹ (vnode.children || []).forEach( c => n.appendChild(render(c)) ); return n; } ï¼šï¼‰ ä¸éš¾ç†è§£è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ å¦‚æžœæœ‰å¸®åŠ©ï¼Œæ‚¨å¯ä»¥å°†â€œè™šæ‹ŸDOMâ€è§†ä¸ºä¸€ä¸ªéžå¸¸ç®€å•çš„é…ç½®ï¼Œç”¨äºŽæž„å»ºç»™å®šçš„DOMç»“æž„ã€‚ è™šæ‹ŸDOMçš„å¥½å¤„æ˜¯å®ƒéžå¸¸è½»å·§ã€‚å°å¯¹è±¡å¼•ç”¨å…¶ä»–å°å¯¹è±¡ï¼Œä¸€ä¸ªç”±æ˜“äºŽä¼˜åŒ–çš„åº”ç”¨ç¨‹åºé€»è¾‘æž„æˆçš„ç»“æž„ã€‚ è¿™ä¹Ÿæ„å‘³ç€å®ƒä¸å—ä»»ä½•æ¸²æŸ“é€»è¾‘æˆ–ç¼“æ…¢çš„DOMæ–¹æ³•çš„æŸç¼šã€‚ ä½¿ç”¨JSXæˆ‘ä»¬çŸ¥é“JSXè¢«è½¬æ¢æˆh()å‡½æ•°è°ƒç”¨ã€‚ é‚£äº›å‡½æ•°è°ƒç”¨åˆ›å»ºä¸€ä¸ªç®€å•çš„â€œè™šæ‹Ÿâ€DOMæ ‘ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥render()å‡½æ•°æ¥åˆ¶ä½œä¸€ä¸ªåŒ¹é…çš„â€œçœŸå®žâ€DOMæ ‘ã€‚ è¿™å°±æ˜¯è¿™æ ·çš„ï¼š // JSX -> VDOM: let vdom = &lt;div id="foo">Hello!&lt;/div>; // VDOM -> DOM: let dom = render(vdom); // add the tree to &lt;body>: document.body.appendChild(dom); Partialsï¼Œè¿­ä»£ä¸Žé€»è¾‘ï¼šæ²¡æœ‰æ–°çš„è¯­æ³• æˆ‘ä»¬æ‹¥æœ‰æ‰€æœ‰çš„JavaScriptè¯­æ³•ï¼Œè€Œä¸æ˜¯æ¨¡æ¿è¯­è¨€å¼•å…¥çš„æœ‰é™æ¦‚å¿µã€‚ï¼ˆPS:è¿™æ˜¯JSXèƒœè¿‡æ¨¡æ¿è¯­è¨€çš„åœ°æ–¹ï¼‰ â€œPartialsâ€æ˜¯ç”±æ— é€»è¾‘/æœ‰é™é€»è¾‘æ¨¡æ¿å¼•æ“Žå¼•å…¥çš„æ¦‚å¿µï¼Œç”¨äºŽåœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­é‡å¤ä½¿ç”¨è§†å›¾å—ã€‚ è¿­ä»£ä¼¼ä¹Žæ˜¯æ¯ä¸ªæ–°çš„æ¨¡æ¿è¯­è¨€éƒ½é‡æ–°å‘æ˜Žçš„ä¸œè¥¿ï¼ˆæˆ‘å’Œä»»ä½•äººä¸€æ ·æœ‰ç½ªï¼‰ã€‚ä½¿ç”¨JSXï¼Œæ²¡æœ‰æ–°çš„è¯­æ³•æ¥å­¦ä¹ ï¼šè¿­ä»£æ‚¨åœ¨JavaScriptç¨‹åºä¸­çš„å…¶ä»–ä»»ä½•åœ°æ–¹ã€‚æ‚¨é€‰æ‹©æœ€é€‚åˆç»™å®šä»»åŠ¡è¿­ä»£å¼çš„ï¼š[].forEach()ï¼Œ[].map()ï¼Œforå’Œwhileå¾ªçŽ¯ç­‰ é€»è¾‘ï¼Œåƒè¿­ä»£ï¼Œæ˜¯æ¨¡æ¿è¯­è¨€å–œæ¬¢é‡æ–°å‘æ˜Žçš„ä¸œè¥¿ã€‚ä¸€æ–¹é¢ï¼Œæ— é€»è¾‘æ¨¡æ¿åœ¨å°†é€»è¾‘åµŒå…¥åˆ°è§†å›¾æ–¹æ³•éžå¸¸å¼±ï¼šæœ‰é™çš„ç»“æž„ï¼Œå¦‚\{\{ \#if value}}å°†é€»è¾‘æŽ¨å…¥æŽ§åˆ¶å™¨å±‚ï¼Œé¼“åŠ±è†¨èƒ€ã€‚è¿™è§„é¿äº†æž„å»ºè¯­è¨€æ¥æè¿°æ›´å¤æ‚çš„é€»è¾‘ï¼Œé¿å…å¯é¢„è§æ€§å’Œå®‰å…¨éšæ‚£ã€‚ åœ¨å¦ä¸€æ–¹é¢ï¼Œä½¿ç”¨ä»£ç ç”Ÿæˆï¼ˆä¸€ç§ä»Žç²—ç•¥åˆ°ä¸å¯åŽŸè°…çš„æŠ€æœ¯ï¼‰çš„å¼•æ“Žé€šå¸¸å…·æœ‰æ‰§è¡Œé€»è¾‘æˆ–ç”šè‡³è¿­ä»£ä»»æ„JavaScriptè¡¨è¾¾å¼çš„èƒ½åŠ›ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç†ç”±ï¼Œä¸æƒœä¸€åˆ‡ä»£ä»·é¿å…è¿™ç§æƒ…å†µï¼šæ‚¨çš„ä»£ç è¢«ä»ŽåŽŸå§‹ä½ç½®ï¼ˆä¹Ÿè®¸æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œé—­åŒ…æˆ–æ ‡è®°å†…ï¼‰ä¸­å‰¥ç¦»å‡ºæ¥ï¼Œå¹¶å¯¹â€œåˆ«çš„åœ°æ–¹â€è¯„ä¼°ã€‚è¿™å¯¹æˆ‘æ¥è¯´æ˜¯ä¸å¯é¢„æµ‹çš„æˆ–è¶³å¤Ÿå®‰å…¨çš„ã€‚ JSXå…è®¸æ‰€æœ‰ JavaScriptçš„è¯­è¨€åŠŸèƒ½ï¼Œè€Œä¸ä¾èµ–äºŽåœ¨æž„å»ºæ­¥éª¤ä¸­ç”Ÿæˆå¥‡æ€ªçš„ä»£ç ï¼Œæ²¡æœ‰eval()å’Œæ‰©å±•ã€‚ // å°†æ•°ç»„ä¸­çš„å­—ç¬¦ä¸²ä»¥åˆ—è¡¨çš„å½¢å¼å±•ç¤º let items = ['foo', 'bar', 'baz']; // åˆ›å»ºåˆ—è¡¨li function item(text) { return &lt;li>{text}&lt;/li>; } // ä¸€ä¸ªä½¿ç”¨è¿­ä»£å’Œå¤ç”¨çš„è§†å›¾ let list = render( &lt;ul> { items.map(item) } &lt;/ul> ); render()è¿”å›žä¸€ä¸ªDOMèŠ‚ç‚¹ï¼ˆåœ¨ä¸Šè¿°æƒ…å†µä¸‹æ˜¯è¿”å›žåˆ—è¡¨ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠå®ƒæ”¾åˆ°DOMä¸­ï¼š document.body.appendChild(list); æŠŠå®ƒæ”¾åœ¨ä¸€èµ·ä»¥ä¸‹æ˜¯å°åž‹è™šæ‹ŸDOMæ¸²æŸ“å™¨å’Œä½¿ç”¨å®ƒçš„è§†å›¾çš„å®Œæ•´æºç ã€‚ å…·æœ‰ä¸€äº›æ ·å¼çš„CodePenå¯åœ¨ä¸‹é¢èŽ·å¾—ã€‚ åŒæ ·ï¼Œæˆ‘ä¹Ÿå†™äº†ä¸€ä¸ªä¾‹å­ï¼šåœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨JSXæ¸²æŸ“DOM const ITEMS = 'hello there people'.split(' '); // turn an Array into list items: let list = items => items.map( p => &lt;li> {p} &lt;/li> ); // view with a call out ("partial") to generate a list from an Array: let vdom = ( &lt;div id="foo"> &lt;p>Look, a simple JSX DOM renderer!&lt;/p> &lt;ul>{ list(ITEMS) }&lt;/ul> &lt;/div> ); // render() converts our "virtual DOM" (see below) to a real DOM tree: let dom = render(vdom); // append the new nodes somewhere: document.body.appendChild(dom); // Remember that "virtual DOM"? It's just JSON - each "VNode" is an object with 3 properties. let json = JSON.stringify(vdom, null, ' '); // The whole process (JSX -> VDOM -> DOM) in one step: document.body.appendChild( render( &lt;pre id="vdom">{ json }&lt;/pre> ) ); Codepenæ¼”ç¤º]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>JSX</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxJSäº‹ä»¶æ¡¥æŽ¥]]></title>
    <url>%2F2017%2F05%2F05%2FRxJS-events-binding.html</url>
    <content type="text"><![CDATA[äº‹ä»¶æ¡¥æŽ¥RxJS æä¾›å·¥åŽ‚æ–¹æ³•æ¥æ¡¥æŽ¥ DOM æˆ– Node.js ä¸­å·²å­˜åœ¨çš„å¼‚æ­¥æ•°æ®æºï¼Œæ‰€ä»¥ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸°å¯Œçš„åˆ›ä½œã€è¿‡æ»¤å’Œèµ„æºç®¡ç†åŠŸèƒ½å¯¹RxJSæä¾›çš„ä»»ä½•ç±»åž‹çš„æ•°æ®æµè¿›è¡Œæ“ä½œã€‚è¿™ç¯‡æ–‡ç« æŽ¢è®¨ fromEvent å’Œ fromEventPatternæ“ä½œç¬¦ï¼Œå®ƒå…è®¸å¯¼å…¥ä¸€ä¸ª DOM æˆ–è€…æ™®é€šäº‹ä»¶åˆ° RxJS çš„æ•°æ®æµã€‚æ¯æ¬¡å¼•å‘äº‹ä»¶æ—¶ï¼Œä¸€ä¸ª OnNext æ¶ˆæ¯å°†ä¼ é€’åˆ°æ•°æ®æµã€‚ç„¶åŽï¼Œå¯ä»¥åƒå…¶ä»–ä»»ä½•æ•°æ®æµä¸€æ ·æ“ä½œäº‹ä»¶æ•°æ®æµã€‚ RxJS ä¸æ‰“ç®—å–ä»£çŽ°æœ‰çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡åž‹å¦‚ Promises æˆ– callbacksã€‚ä½†æ˜¯ï¼Œå½“ä½ å°è¯•ç»„åˆäº‹ä»¶ï¼Œ RxJSçš„å·¥åŽ‚æ–¹æ³•ä¼šæä¾›ç®€ä¾¿çš„æ–¹æ³•ç»™ä½ ï¼Œä½ å®Œå…¨æ„Ÿå—ä¸åˆ°å½“å‰ä½¿ç”¨äº†ä½•ç§ç¼–ç¨‹æ¨¡å¼ã€‚è¿™çœŸçš„å¾ˆæ–¹ä¾¿ç»´æŠ¤ï¼ˆæ¯”å¦‚å–æ¶ˆè®¢é˜…ï¼‰å’Œç­›é€‰ï¼ˆæ¯”å¦‚é€‰æ‹©åˆé€‚çš„æ•°æ®ï¼‰æ•°æ®æºã€‚åœ¨æœ¬èŠ‚å’Œä¸‹èŠ‚ä¸­ï¼Œä½ å¯ä»¥å°è¯• RxJS çš„è¿™äº›ç‰¹æ€§å¦‚ä½•ååŠ©ä½ å®Œæˆå¼‚æ­¥ç¼–ç¨‹ã€‚ è‡ªç„¶ï¼ŒRxJS æ”¯æŒä¸€æ‰¹åº“å’Œä»–ä»¬çš„å‹¾å­å‡½æ•°åŽ»ä½¿ç”¨ä»–ä»¬çš„äº‹ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚ jQuery, Zepto.js, AngularJS, Ember.js å’Œ Backbone.jsã€‚è¿™ç§è¡Œä¸ºï¼Œä¸ç®¡æ€Žæ ·åªèƒ½é‡å†™æœ¬åœ°ç»‘å®šã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ RxJS ä¹Ÿæ”¯æŒ Node.js EventEmitter çš„äº‹ä»¶å‹¾å­ã€‚ å°†ä¸€ä¸ª DOM äº‹ä»¶è½¬æ¢æˆ RxJS æ•°æ®æµæŽ¥ä¸‹æ¥è¿™ä¸ªä¾‹å­ä¸ºé¼ æ ‡ç§»åŠ¨äº‹ä»¶åˆ›å»ºäº†ä¸€ä¸ª DOM äº‹ä»¶æ“ä½œï¼Œå¹¶ä¸”åœ¨é¡µé¢ä¸Šæ‰“å°å‡ºé¼ æ ‡çš„åæ ‡ã€‚ var result = document.getElementById('result'); document.addEventListener('mousemove', e => result.innerHTML = e.clientX + ', ' + e.clientY, false); å¯¼å…¥ä¸€ä¸ªäº‹ä»¶åˆ° RxJS, ä½ å¯ä»¥ä½¿ç”¨ fromEvent æ“ä½œç¬¦ï¼Œå¹¶ä¸”ä¼ å…¥è¢«æ¡¥æŽ¥çš„äº‹ä»¶å‚æ•°ã€‚ç„¶åŽå®ƒä¼šå°†äº‹ä»¶è½¬æ¢æˆæ•°æ®æµã€‚ ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°† DOM çš„ mousemove äº‹ä»¶æµè½¬æ¢æˆäº‹ä»¶æµï¼ˆå¯è§‚å¯Ÿå¯¹è±¡ï¼‰ã€‚æ¯æ¬¡é¼ æ ‡ç§»åŠ¨äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œè®¢é˜…éƒ½ä¼šæŽ¥æ”¶åˆ°ä¸€ä¸ª onNext äº‹ä»¶ã€‚ç„¶åŽæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¿™ç§é€šçŸ¥çš„äº‹ä»¶å‚æ•°å¹¶èŽ·å¾—é¼ æ ‡çš„åæ ‡ã€‚ var result = document.getElementById('result'); var source = Rx.Observable.fromEvent(document, 'mousemove'); var subscription = source.subscribe(e => result.innerHTML = e.clientX + ', ' + e.clientY); åœ¨è¿™ä¸ªä¾‹å­ä¸­è¦æ³¨æ„ï¼Œï¼ˆé¼ æ ‡ï¼‰ç§»åŠ¨å˜æˆä¸€ä¸ªæ•°æ®æµä»¥ä¾¿æˆ‘ä»¬è¿›ä¸€æ­¥æ“ä½œã€‚ Querying Observable Sequences è¿™ç¯‡æ–‡ç« å°†ä¼šå±•ç¤ºå¦‚ä½•å°†è¯¥åºåˆ—æŠ•å°„åˆ°ç‚¹ç±»åž‹é›†åˆä¸­å¹¶ç­›é€‰å…¶å†…å®¹ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºåªæŽ¥æ”¶æ»¡è¶³ä¸€å®šæ¡ä»¶çš„å€¼ã€‚ äº‹ä»¶å¤„ç†ç¨‹åºçš„é”€æ¯ç”± subscribe æ–¹æ³•è¿”å›žçš„ Disposable å¯¹è±¡å¤„ç†ã€‚è°ƒç”¨ dispose å°†ä¼šé‡Šæ”¾ç”±è¯¥åºåˆ—æ‰€ä½¿ç”¨çš„æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬åº•å±‚äº‹ä»¶å¤„ç†ç¨‹åºã€‚è¿™æœ¬è´¨ä¸Šæ˜¯å–æ¶ˆè®¢é˜…äº‹ä»¶ã€‚ fromEvent æ–¹æ³•è¿˜æ”¯æŒå‘å¤šä¸ªé¡¹ç›®æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºï¼Œæ¯”å¦‚ä¸€æ•´ä¸ª DOM èŠ‚ç‚¹åˆ—è¡¨ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­å°†ä¼šç»™åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ·»åŠ  â€˜clickâ€™ äº‹ä»¶ã€‚ var result = document.getElementById('result'); var sources = document.querySelectorAll('div'); var source = Rx.Observable.fromEvent(sources, 'click'); var subscription = source.subscribe(e => result.innerHTML = e.clientX + ', ' + e.clientY); å¦å¤–ï¼ŒfromEvent ä¹Ÿæ”¯æŒç±»åº“ï¼Œåƒ jQuery, Zepto.js, AngularJS, Ember.js and Backbone.jsï¼š var $result = $('#result'); var $sources = $('div'); var source = Rx.Observable.fromEvent($sources, 'click'); var subscription = source.subscribe(e => $result.html(e.clientX + ', ' + e.clientY)); å¦‚æžœè¡¨çŽ°ä¸å¦‚é¢„æœŸï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½® Rx.config.useNativeEvents ä¸º true åŽ»é‡å†™å®ƒï¼Œè¿™ä¼šæ— è§†ä»»ä½•ç±»åº“ã€‚ // åªä½¿ç”¨åŽŸç”Ÿäº‹ä»¶ï¼Œå°½ç®¡å¼•ç”¨äº† jQuery Rx.config.useNativeEvents = true; // åªä½¿ç”¨åŽŸç”Ÿäº‹ä»¶ var result = document.getElementById('result'); var source = Rx.Observable.fromEvent(document, 'mousemove'); var subscription = source.subscribe(e => result.innerHTML = e.clientX + ', ' + e.clientY); å¦å¤–ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°ç»™äº‹ä»¶ç³»ç»Ÿçš„äº‹ä»¶æ·»åŠ è®¸å¤šå¿«æ·æ–¹å¼ï¼Œæ¯”å¦‚ mousemoveï¼Œ ç”šè‡³æ˜¯ Pointer and Touch äº‹ä»¶ã€‚ Rx.dom = {}; var events = "blur focus focusin focusout load resize scroll unload click dblclick " + "mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " + "change select submit keydown keypress keyup error contextmenu"; if (root.PointerEvent) { events += " pointerdown pointerup pointermove pointerover pointerout pointerenter pointerleave"; } if (root.TouchEvent) { events += " touchstart touchend touchmove touchcancel"; } events.split(' ').forEach(e => { Rx.dom[e] = (element, selector) => Rx.Observable.fromEvent(element, e, selector) }); çŽ°åœ¨æˆ‘ä»¬å¯ä»¥é‡å†™å•ä¸ªé¼ æ ‡æ‹–æ‹½äº‹ä»¶ï¼š var draggable = document.getElementById('draggable'); var mousedrag = Rx.dom.mousedown(draggable).flatMap(md => { md.preventDefault(); var start = getLocation(md); return Rx.dom.mousemove(document) .map(mm => getDelta(start, mm)) .takeUntil(Rx.dom.mouseup(draggable)); }); æ³¨æ„è¿™åœ¨ RxJS-DOM é¡¹ç›®ä¸­å·²ç»å¯ç”¨ï¼Œä½†ä½ è‡ªå·±å®žçŽ°ä¹Ÿåªéœ€è¦å¾ˆå°‘é‡çš„ä»£ç ã€‚ å°† Node.js äº‹ä»¶è½¬æ¢æˆ RxJS æ•°æ®æµNode.js ä¹Ÿæ”¯æŒç±»ä¼¼ EventEmitter: var Rx = require('rx'), EventEmitter = require('events').EventEmitter; var eventEmitter = new EventEmitter(); var source = Rx.Observable.fromEvent(eventEmitter, 'data') var subscription = source.subscribe(data => console.log('data: ' + data)); eventEmitter.emit('data', 'foo'); // => data: foo ä½¿ç”¨ FromEventPattern æ¡¥æŽ¥è‡ªå®šä¹‰äº‹ä»¶ä¸‹é¢æœ‰ä¸€ä¸ªä½¿ç”¨ç±»åº“å®žçŽ°äº‹ä»¶è®¢é˜…å’Œé€€è®¢çš„å®žä¾‹ã€‚fromEventPattern æ–¹æ³•å°±æ˜¯ä¸ºäº†è¿™ä¸ªç›®çš„è€Œåˆ›å»ºçš„ï¼Œç”¨æ¥æ¡¥æŽ¥è¿™äº›è‡ªå®šä¹‰äº‹ä»¶ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥æƒ³ä½¿ç”¨ jQuery on æ–¹æ³•åŽ»æ¡¥æŽ¥ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¸‹åˆ—ä»£ç è½¬æ¢ä¸ºåŸºäºŽè¡¨æ ¼è¡Œå•å‡»çš„ alertã€‚ $( "#dataTable tbody" ).on('click', 'tr', e => alert($( e.target ).text())); ä½¿ç”¨ fromEventPattern æ–¹æ³•è½¬æ¢åŽçš„ä»£ç çœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ã€‚æ¯ä¸ªå‡½æ•°åœ¨å¤„ç†å‡½æ•°ä¸­ä¼ é€’ï¼Œå…è®¸æ‚¨è°ƒç”¨ on å’Œ off æ–¹æ³•æ¥æ­£ç¡®å¤„ç†äº‹ä»¶çš„å¤„ç†ã€‚ var $tbody = $('#dataTable tbody'); var source = Rx.Observable.fromEventPattern( function addHandler (h) { $tbody.on('click', 'tr', h); }, function delHandler (h) { $tbody.off('click', 'tr', h); }); var subscription = source.subscribe(e => alert($( e.target ).text())); é™¤äº†è¿™ç§å¸¸ç”¨çš„æ”¯æŒå¤–ï¼Œæˆ‘ä»¬ä¹Ÿæ”¯æŒ addHandler è¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¯ä»¥é€šè¿‡ removeHandler åŽ»å®Œå…¨é€€è®¢ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Dojo Toolkit å’Œ on æ¨¡å—ã€‚ require(['dojo/on', 'dojo/dom', 'rx', 'rx.async', 'rx.binding'], (on, dom, rx) => { var input = dom.byId('input'); var source = Rx.Observable.fromEventPattern( function addHandler (h) { return on(input, 'click', h); }, function delHandler (_, signal) { signal.remove(); } ); var subscription = source.subscribe( x => console.log('Next: Clicked!'), err => console.log('Error: ' + err), () => console.log('Completed')); on.emit(input, 'click'); // => Next: Clicked! }); ç›¸å…³å†…å®¹æ¦‚å¿µ Querying Observable Sequences æœ¬æ–‡ç¿»è¯‘åœ¨: RxJSä¸­æ–‡æ–‡æ¡£]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>RxJS</tag>
        <tag>bridging</tag>
        <tag>event</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨RxJSåˆ›å»ºå’Œè®¢é˜…å•ä¸€æ•°æ®æµ]]></title>
    <url>%2F2017%2F05%2F04%2Fcreating_and_subscribing_to_simple_observable_sequences.html</url>
    <content type="text"><![CDATA[æ¥è‡ª åˆ›å»ºå’Œè®¢é˜…å•ä¸€å¯è§‚å¯Ÿåºåˆ—ä½ ä¸éœ€è¦åŽ»å®žçŽ° Observable ç±»åŽ»åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿåºåˆ—ã€‚ åŒæ ·çš„ï¼Œä½ ä¹Ÿä¸éœ€è¦åŽ»å®žçŽ° Observer åŽ»è®¢é˜…æ•°æ®æµã€‚é€šè¿‡å®‰è£… Rx åº“ï¼Œä½ å¯ä»¥åˆ©ç”¨ Observableç±»åž‹ï¼Œå®ƒæä¾›äº†è®¸å¤šæ“ä½œç¬¦æ¥æ ¹æ®é›¶ä¸ªï¼Œä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ åŽ»åˆ›å»ºä¸€ä¸ªæ•°æ®æµã€‚å¦å¤–ï¼Œ RxJS è¿˜æä¾› subscribe æ–¹æ³•å…è®¸ä½ ä½¿ç”¨ onNext, onError å’Œ onCompleted å‡½æ•°ã€‚ ä»Žé›¶åˆ›å»ºä¸€ä¸ªæ•°æ®æµåœ¨ä½¿ç”¨æ“ä½œç¬¦ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€çœ‹æ€Žæ ·ä½¿ç”¨ Rx.Observable.create æ–¹æ³•ä»Žé›¶åˆ›å»º Observable ã€‚ é¦–å…ˆï¼Œ æˆ‘ä»¬éœ€è¦ç¡®è®¤å¼•ç”¨äº† rx.js æ ¸å¿ƒæ–‡ä»¶ã€‚ å¦‚æžœæˆ‘ä»¬ä½¿ç”¨ Node.jsï¼Œ æˆ‘ä»¬å¯ä»¥è¿™æ ·å¼•å…¥: var Rx = require('rx'); åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ æˆ‘ä»¬å°†åªäº§ç”Ÿä¸€ä¸ªå•ä¸€å€¼42ï¼Œç„¶åŽæ ‡è®°ä¸ºå®Œæˆã€‚ å¦‚æžœä¸éœ€è¦æ¸…é™¤ï¼Œè¿”å›žå€¼æ˜¯å®Œå…¨å¯é€‰çš„ã€‚ var source = Rx.Observable.create(observer => { // äº§ç”Ÿä¸€ä¸ªå•ä¸€å€¼ç„¶åŽå®Œæˆã€‚ observer.onNext(42); observer.onCompleted(); // ä»»ä½•æ¸…é™¤çš„é€»è¾‘å†™åœ¨è¿™é‡Œ return () => console.log('disposed') }); var subscription = source.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e), () => console.log('onCompleted')); // => onNext: 42 // => onCompleted subscription.dispose(); // => disposed å¯¹äºŽå¤§å¤šæ•°æ“ä½œï¼Œ è¿™å®Œå…¨æ˜¯å¤šä½™çš„ï¼Œä½†è¿™å±•ç¤ºäº†éžå¸¸åŸºç¡€çš„å¤§éƒ¨åˆ† RxJS æ“ä½œç¬¦æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ åˆ›å»ºåŠè®¢é˜…å•ä¸€æ•°æ®æµæŽ¥ä¸‹æ¥çš„ä¾‹å­ä½¿ç”¨ Observable ç±»çš„ range æ“ä½œç¬¦æ¥åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸€äº›æ•°å­—çš„å•ä¸€æ•°æ®æµã€‚è§‚å¯Ÿè€…ä½¿ç”¨ Observable ç±»çš„ Subscribe è®¢é˜…è¿™ä¸ªæ•°æ®æµé›†åˆï¼Œ å¹¶ä¸”å¤„ç†å›žè°ƒ onNext, onError and onCompletedã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªä»Ž x å¼€å§‹çš„æ•´æ•°åºåˆ—ï¼Œç„¶åŽæŽ¥ä¸‹æ¥äº§ç”Ÿ y ä¸ªã€‚ åªè¦è®¢é˜…äº†æ•°æ®æµï¼Œæ•°æ®å°±ä¼šå‘é€ç»™è§‚å¯Ÿè€…ã€‚onNextå‡½æ•°ä¼šæ‰“å°å‡ºè¿™ä¸ªå€¼ã€‚ // åˆ›å»ºä¸€ä¸ªä»Ž 1 å¼€å§‹ï¼ŒåŒ…å« 5 ä¸ªæ•´æ•°çš„æ•°æ®æµ var source = Rx.Observable.range(1, 5); // æ‰“å°æ¯ä¸ªå€¼ var subscription = source.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e), () => console.log('onCompleted')); // => onNext: 1 // => onNext: 2 // => onNext: 3 // => onNext: 4 // => onNext: 5 // => onCompleted å½“ä¸€ä¸ªè§‚å¯Ÿè€…è®¢é˜…äº†ä¸€ä¸ªæ•°æ®æµï¼Œ subscribe æ–¹æ³•èƒŒåŽä½¿ç”¨çš„å¼‚æ­¥æ“ä½œå–å†³äºŽæ“ä½œç¬¦ã€‚å› äº›ï¼Œ subscribe çš„è°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œå› ä¸ºè°ƒç”¨è€…åœ¨å®Œæˆåºåˆ—è§‚å¯Ÿä¹‹å‰ä¸ä¼šè¢«é˜»å¡žã€‚è¿™ç¯‡æ–‡ç«  Using Schedulers æä¾›äº†æ›´å¤šä¿¡æ¯ã€‚ æ³¨æ„ subscribe æ–¹æ³•è¿”å›žä¸€ä¸ª Disposableï¼Œæ‰€ä»¥ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°é€€è®¢å’Œé”€æ¯å®ƒã€‚å½“ä½ åœ¨å¯è§‚å¯Ÿå¯¹è±¡ä¸Šè°ƒç”¨ dispose æ–¹æ³•æ—¶ï¼Œè§‚å¯Ÿè€…å°†ä¼šåœæ­¢ç›‘å¬æ•°æ®æµã€‚æ­£å¸¸æ¥è¯´ï¼Œä½ ä¸éœ€è¦ç²¾ç¡®åœ°è°ƒç”¨ dispose é™¤éžä½ éœ€è¦æå‰é€€è®¢ï¼Œæˆ–è€…å½“æ•°æ®æµçš„ç”Ÿå‘½å‘¨æœŸæ¯”è§‚å¯Ÿè€…çš„è¿˜é•¿ã€‚ Rx çš„è®¢é˜…è¢«è®¾è®¡æˆ è§¦å‘-ä¸¢å¼ƒ çš„åœºæ™¯ï¼Œå¹¶ä¸éœ€è¦ç»ˆç»“è€…ã€‚æ³¨æ„åˆ°ï¼Œå¯è§‚å¯Ÿå¯¹è±¡çš„æ“ä½œç¬¦çš„é»˜è®¤è¡¨çŽ°æ˜¯ åªè¦æœ‰å¯èƒ½ï¼ˆæ¯”å¦‚ï¼ŒonCompleted æˆ– onError æ¶ˆæ¯è¢«å‘é€æ—¶ï¼‰ï¼Œè®¢é˜…å°±ä¼šè¢«é”€æ¯ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç å°†ä¼šè®¢é˜… a å’Œ b ä¸¤ä¸ªæ•°æ®æµã€‚å¦‚æžœ a æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œ x ä¼šç«‹å³é€€è®¢ b ã€‚ var x = Rx.Observable.zip(a, b, (a1, b1) => a1 + b1).subscribe(); è¿˜å¯ä»¥è°ƒæ•´ä»£ç ç¤ºä¾‹ä»¥ä½¿ç”¨è§‚å¯Ÿè€…çš„ Create è¿ç®—ç¬¦ï¼Œåˆ›å»ºå¹¶ä»ŽæŒ‡å®šçš„ OnNext, OnError, å’Œ OnCompleted å›žè°ƒè¿”å›žä¸€ä¸ªè§‚å¯Ÿè€…ã€‚ç„¶åŽä½ å¯ä»¥ä¼ é€’ observer ç»™ observable çš„ subscribe æ–¹æ³•ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†è¿™ç§å†™æ³•ã€‚ // åˆ›å»ºåŒ…å« 5ä¸ªæ•´æ•°çš„æ•°æ®æµï¼Œä»Ž 1 å¼€å§‹ var source = Rx.Observable.range(1, 5); // åˆ›å»ºè§‚å¯Ÿè€… var observer = Rx.Observer.create( x => console.log('onNext: %s', x), e => console.log('onError: %s', e), () => console.log('onCompleted')); // æ‰“å°æ¯ä¸ªç»“æžœ var subscription = source.subscribe(observer); // => onNext: 1 // => onNext: 2 // => onNext: 3 // => onNext: 4 // => onNext: 5 // => onCompleted å¦å¤–ï¼Œä»Žé›¶åˆ›å»ºä¸€ä¸ªæ•°æ®æµï¼Œä½ ä¹Ÿå¯ä»¥å°†å·²å­˜åœ¨çš„ æ•°æ®ï¼Œ äº‹ä»¶ï¼Œå›žè°ƒä»¥åŠ promise è½¬æ¢æˆæ•°æ®æµã€‚ä¸‹ä¸€èŠ‚çš„ä¸»é¢˜å°†ä¼šæ•™ä½ æ€Žä¹ˆåšã€‚ æ³¨æ„ï¼Œè¿™ä¸€èŠ‚åªå±•ç¤ºäº†å¯ä»¥ä»Žé›¶åˆ›å»ºæ•°æ®æµçš„å¾ˆå°‘ä¸€éƒ¨åˆ†æ“ä½œç¬¦ã€‚å­¦ä¹ æ›´å¤šå…¶ä»–çš„ LINQ æ“ä½œç¬¦ï¼Œ å¯ä»¥æŸ¥çœ‹ Querying Observable Sequences. ä½¿ç”¨å®šæ—¶å™¨æŽ¥ä¸‹æ¥çš„ä¾‹å­ä½¿ç”¨ timer æ“ä½œç¬¦åŽ»åˆ›å»ºä¸€ä¸ªæ•°æ®æµã€‚ è¿™ä¸ªæ•°æ®æµå°†åœ¨5ç§’åŽè¾“å‡ºç¬¬ä¸€ä¸ªå€¼ï¼ŒæŽ¥ç€æ¯1ç§’è¾“å‡ºåŽé¢çš„å€¼ã€‚ä¸ºäº†è¯´æ˜Žï¼Œ æˆ‘ä»¬é…åˆ timestamp æ“ä½œç¬¦åŽ»æŸ¥è¯¢ï¼Œä½¿æ¯ä¸€ä¸ªè¢«æŽ¨å‡ºæ¥çš„å€¼å°†åœ¨å‘å¸ƒæ—¶è¿½åŠ æ—¶é—´æˆ³ã€‚è¿™æ ·ï¼Œå½“æˆ‘ä»¬è®¢é˜…è¿™ä¸ªæ•°æ®æºæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŽ¥æ”¶åˆ°å€¼å’Œæ—¶é—´æˆ³ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤æˆ‘ä»¬æ˜¯å¦åœ¨æµè§ˆå™¨å¼•å…¥äº†ç›¸å…³çš„æ–‡ä»¶ã€‚æ³¨æ„ RxJS NPM åŒ…å·²ç»é»˜è®¤åŒ…å«äº†æ‰€æœ‰æ“ä½œç¬¦ã€‚ ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ä¾‹å­ï¼š console.log('Current time: ' + Date.now()); var source = Rx.Observable.timer( 5000, /* 5 ç§’ */ 1000 /* 1 ç§’ */) .timestamp(); var subscription = source.subscribe( x => console.log(x.value + ': ' + x.timestamp)); /* è¾“å‡ºå¯èƒ½åƒè¿™æ ·å­ */ // Current time: 1382560697820 // 0: 1382560702820 // 1: 1382560703820 // 2: 1382560704820 é€šè¿‡ä½¿ç”¨ timestamp æ“ä½œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥è¯å®žï¼Œç¬¬ä¸€ä¸ªå€¼ç¡®å®žæ˜¯å¼€å§‹5ç§’åŽè¾“å‡ºï¼Œç„¶åŽæ¯1ç§’è¾“å‡ºä¸€ä¸ªå€¼ã€‚ å°†æ•°ç»„å’Œå¯è¿­ä»£å¯¹è±¡è½¬æ¢ä¸ºæ•°æ®æµä½¿ç”¨ Rx.Observable.from æ“ä½œç¬¦ï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªæ•°ç»„è½¬æ¢ä¸ºæ•°æ®æµã€‚ var array = [1,2,3,4,5]; // å°†æ•°ç»„è½¬æ¢ä¸ºæ•°æ®æµ var source = Rx.Observable.from(array); // è¾“å‡ºæ¯ä¸ªå€¼ var subscription = source.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e), () => console.log('onCompleted')); // => onNext: 1 // => onNext: 2 // => onNext: 3 // => onNext: 4 // => onNext: 5 // => onCompleted ä½ ä¹Ÿå¯ä»¥è½¬æ¢ç±»æ•°ç»„ç»“æž„ï¼Œæ¯”å¦‚åŒ…å« length å±žæ€§å’Œæ•°å­—ç´¢å¼•çš„å¯¹è±¡ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªç®€å•æœ‰ä¸€ä¸ªåŒ…å«é•¿åº¦ä¸º5çš„å¯¹è±¡ã€‚ var arrayLike = { length: 5 }; // è½¬æ¢æ•°ç»„ä¸ºæ•°æ®æµ var source = Rx.Observable.from(arrayLike, (v, k) => k); // è¾“å‡ºæ¯ä¸ªå€¼ var subscription = source.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e), () => console.log('onCompleted')); // => onNext: 1 // => onNext: 2 // => onNext: 3 // => onNext: 4 // => onNext: 5 // => onCompleted å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ ES6 å¯è¿­ä»£å¯¹è±¡ï¼Œå¦‚ Map å’Œ Set ä½¿ç”¨ from è½¬æ¢æˆæ•°æ®æµã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†èŽ·å–ä¸€ä¸ª Set å¯¹è±¡ï¼Œå¹¶ä¸”å°†å®ƒè½¬æ¢æˆæ•°æ®æµã€‚ var set = new Set([1,2,3,4,5]); // è½¬æ¢ Set ä¸ºæ•°æ®æµ var source = Rx.Observable.from(set); // è½¬å‡ºæ¯ä¸ªå€¼ var subscription = source.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e), () => console.log('onCompleted')); // => onNext: 1 // => onNext: 2 // => onNext: 3 // => onNext: 4 // => onNext: 5 // => onCompleted æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å®ƒåº”ç”¨åœ¨ Map å¯¹è±¡ä¸Šé¢ã€‚ var map = new Map([['key1', 1], ['key2', 2]]); // å°† Map è½¬æ¢æˆæ•°æ®æµ var source = Rx.Observable.from(map); // æ‰“å°æ¯ä¸ªå€¼ var subscription = source.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e), () => console.log('onCompleted')); // => onNext: key1, 1 // => onNext: key2, 2 // => onCompleted from æ–¹æ³•ä¹Ÿæ”¯æŒ ES6 generatorsï¼Œå¯ä»¥ä½ çš„æµè§ˆå™¨å·²ç»æ”¯æŒï¼Œæˆ–å°†è¦æ”¯æŒã€‚è¿™å…è®¸æˆ‘ä»¬å®žçŽ°ä¸€äº›åƒ æ–æ³¢é‚£å¥‘åºåˆ— ç­‰ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢æˆæ•°æ®æµã€‚ function* fibonacci () { var fn1 = 1; var fn2 = 1; while (1){ var current = fn2; fn2 = fn1; fn1 = fn1 + current; yield current; } } // å°† generator è½¬æ¢æˆæ•°æ®æµ var source = Rx.Observable.from(fibonacci()).take(5); // æ‰“å°æ¯ä¸ªå€¼ var subscription = source.subscribe( x => console.log('onNext: %s', x), e => console.log('onError: %s', e), () => console.log('onCompleted')); // => onNext: 1 // => onNext: 1 // => onNext: 2 // => onNext: 3 // => onNext: 5 // => onCompleted å†·ï¼ˆæƒ°æ€§ï¼‰ vs. çƒ­ï¼ˆéžæƒ°æ€§ï¼‰ æ•°æ®æµå†·æ•°æ®æµçš„å¼€å§‹è¿è¡Œå–å†³äºŽè®¢é˜…ï¼Œæ¯”å¦‚ï¼Œæ•°æ®æµåªæœ‰å½“ subscribe è°ƒç”¨çš„æ—¶å€™æ‰å¼€å§‹è¾“å‡ºå€¼ã€‚ç”¨æˆ·ä¹‹é—´ä¹Ÿæ²¡æœ‰å…±äº«å€¼ã€‚è¿™äº›æ˜¯ä¸Žçƒ­æ•°æ®æµçš„ä¸åŒä¹‹å¤„ï¼Œçƒ­æ•°æ®åƒæµé¼ æ ‡ç§»åŠ¨äº‹ä»¶æˆ–è‚¡ç¥¨ä»£ç è¿™æ ·çš„è®¢é˜…æ—¶å°±å·²ç»ä¸æ–­è¾“å‡ºå€¼ã€‚å½“è§‚å¯Ÿè€…è®¢é˜…çƒ­æ•°æ®æµæ—¶ï¼Œå®ƒå°†ä¼šèŽ·å–æµçš„å®žæ—¶å€¼ã€‚çƒ­æ•°æ®æµæ˜¯ä¸Žæ‰€æœ‰è®¢é˜…è€…å…±äº«çš„ï¼Œæ¯ä¸ªè®¢é˜…è€…æŒ‰é¡ºåºæŽ¨é€ä¸‹ä¸€ä¸ªå€¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå°±ç®—æ²¡æœ‰äººè®¢é˜…ä¸€ä¸ªç‰¹å®šçš„è‚¡ç¥¨ï¼Œè‚¡ç¥¨å¸‚åœºä¹Ÿå°†ç»§ç»­æ ¹æ®å¸‚åœºåŠ¨å‘æ›´æ–°å…¶ä»·å€¼ã€‚å½“æœ‰æ³¨å†Œè€…å¯¹è¿™æ”¯è‚¡ç¥¨æ„Ÿå…´è¶£æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨èŽ·å¾—è‚¡ç¥¨çš„æœ€æ–°å€¼ã€‚ ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†ä¸€ä¸ªå†·æ•°æ®æµã€‚è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Interval æ“ä½œç¬¦åŽ»åˆ›å»ºä¸€ä¸ªå•ä¸€æ•°æ®æµå¹¶åœ¨ç‰¹å®šçš„æ—¶é—´é—´éš”è¾“å‡ºå€¼ï¼Œè¿™ä¸ªä¾‹å­ä¸­æ˜¯é—´éš”1ç§’ã€‚ ä¸¤ä¸ªè§‚å¯Ÿè€…è®¢é˜…è¿™ä¸ªæ•°æ®æµå¹¶æ‰“å°è¾“å‡ºå€¼ã€‚ä½ ä¼šæ³¨æ„åˆ°æ•°æ®æµä¼šä¸ºæ¯ä¸ªè®¢é˜…è€…é‡ç½®ï¼Œç¬¬äºŒä¸ªè®¢é˜…è€…ä¹Ÿæ˜¯ä»Žç¬¬1ä¸ªå€¼å¼€å§‹çš„ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿åœ¨æµè§ˆå™¨ä¸­å¼•å…¥äº†ç›¸å…³æ–‡ä»¶ã€‚æ³¨æ„ RxJS NPM åŒ…å·²ç»é»˜è®¤åŒ…å«äº†æ‰€æœ‰æ“ä½œç¬¦ã€‚ ç„¶åŽæ˜¯ä¾‹å­ï¼š var source = Rx.Observable.interval(1000); var subscription1 = source.subscribe( x => console.log('Observer 1: onNext: ' + x), e => console.log('Observer 1: onError: ' + e.message), () => console.log('Observer 1: onCompleted')); var subscription2 = source.subscribe( x => console.log('Observer 2: onNext: ' + x), e => console.log('Observer 2: onError: ' + e.message), () => console.log('Observer 2: onCompleted')); setTimeout(() => { subscription1.dispose(); subscription2.dispose(); }, 5000); // => Observer 1: onNext: 0 // => Observer 2: onNext: 0 // => Observer 1: onNext: 1 // => Observer 2: onNext: 1 // => Observer 1: onNext: 2 // => Observer 2: onNext: 2 // => Observer 1: onNext: 3 // => Observer 2: onNext: 3 æŽ¥ä¸‹æ¥çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ publish æ“ä½œç¬¦å°†å‰é¢çš„å†·æ•°æ®æºè½¬æ¢æˆçƒ­æ•°æ®æºï¼Œè¿”å›žä¸€ä¸ª ConnectableObservable å®žä¾‹ï¼Œæˆ‘ä»¬ç§°ä¸º hotã€‚publish æ“ä½œç¬¦é€šè¿‡å‘å¤šä¸ªè®¢é˜…æœåŠ¡å™¨å¹¿æ’­å•ä¸ªè®¢é˜…æ¥æä¾›å…±äº«è®¢é˜…çš„æœºåˆ¶ã€‚hotå˜é‡ä½œä¸ºä»£ç†è®¢é˜… sourceï¼Œå› ä¸ºå®ƒä»Ž source æŽ¥æ”¶å€¼ï¼ŒæŽ¨åˆ°è‡ªå·±çš„ç”¨æˆ·. æˆ‘ä»¬ä½¿ç”¨ ConnectableObservable.prototype.connect å»ºç«‹è®¢é˜…çš„å¤‡ä»½æºï¼Œå¹¶å¼€å§‹æŽ¥æ”¶å€¼ã€‚å› ä¸º ConnectableObservable ç»§æ‰¿è‡ª Observableï¼Œ æˆ‘ä»¬å¯ä»¥åœ¨å®ƒè¿è¡Œä¹‹å‰ä½¿ç”¨ subscribe åŽ»è®¢é˜…è¿™ä¸ªçƒ­æ•°æ®æµã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­è¦æ³¨æ„ï¼Œå½“ subscription1è®¢é˜…å®ƒçš„æ—¶å€™çƒ­æ•°æ®æµè¿˜æ²¡æœ‰å¼€å§‹ã€‚å› äº›ï¼Œæ²¡æœ‰å€¼è¾“å‡ºç»™è®¢é˜…è€…ã€‚åªæœ‰è°ƒç”¨ Connect ä¹‹åŽï¼Œè¾“å‡ºå€¼æ‰ä¼šæŽ¨é€ç»™ subscription1ã€‚3ç§’çš„å»¶è¿Ÿä¹‹åŽï¼Œsubscription2 è®¢é˜…äº†çƒ­æ•°æ®æµï¼Œå¹¶ä¸”ç«‹å³å¼€å§‹æŽ¥æ”¶å½“å‰è¾“å‡ºå€¼ï¼ˆå½“å‰å€¼æ˜¯3ï¼‰ï¼Œä¸€ç›´åˆ°æœ€åŽã€‚è¾“å‡ºç»“æžœçœ‹èµ·æ¥åƒè¿™æ ·ï¼š // => Current time: 1382562433256 // => Current Time after 1st subscription: 1382562433260 // => Current Time after connect: 1382562436261 // => Observer 1: onNext: 0 // => Observer 1: onNext: 1 // => Current Time after 2nd subscription: 1382562439262 // => Observer 1: onNext: 2 // => Observer 2: onNext: 2 // => Observer 1: onNext: 3 // => Observer 2: onNext: 3 // => Observer 1: onNext: 4 // => Observer 2: onNext: 4 é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤æˆ‘ä»¬å¼•å…¥äº†ç›¸å…³æ–‡ä»¶ã€‚æ³¨æ„ RxJS NPMåŒ…å·²ç»é»˜è®¤åŒ…å«äº†æ‰€æœ‰æ“ä½œç¬¦ã€‚ æŽ¥ä¸‹æ¥æ˜¯ä¾‹å­ï¼ console.log('Current time: ' + Date.now()); // åˆ›å»ºä¸€ä¸ªæ•°æ®æµ var source = Rx.Observable.interval(1000); // å°†æ•°æ®æµè½¬æ¢æˆçƒ­æ•°æ®æµ var hot = source.publish(); // ç¬¬ä¸€ä¸ªè®¢é˜…æ—¶æ²¡æœ‰å€¼è¾“å‡º var subscription1 = hot.subscribe( x => console.log('Observer 1: onNext: %s', x), e => console.log('Observer 1: onError: %s', e), () => console.log('Observer 1: onCompleted')); console.log('Current Time after 1st subscription: ' + Date.now()); // ç©ºé—² 3 ç§’ setTimeout(() => { // çƒ­æ•°æ®æºè¿žæŽ¥å¹¶å¼€å§‹è¾“å‡ºå€¼ç»™è®¢é˜…è€… hot.connect(); console.log('Current Time after connect: ' + Date.now()); // åˆç©ºé—² 3 ç§’ setTimeout(() => { console.log('Current Time after 2nd subscription: ' + Date.now()); var subscription2 = hot.subscribe( x => console.log('Observer 2: onNext: %s', x), e => console.log('Observer 2: onError: %s', e), () => console.log('Observer 2: onCompleted')); }, 3000); }, 3000); // => Current Time after connect: 1431197578426 // => Observer 1: onNext: 0 // => Observer 1: onNext: 1 // => Observer 1: onNext: 2 // => Current Time after 2nd subscription: 1431197581434 // => Observer 1: onNext: 3 // => Observer 2: onNext: 3 // => Observer 1: onNext: 4 // => Observer 2: onNext: 4 // => Observer 1: onNext: 5 // => Observer 2: onNext: 5 // => ... ç±»æŽ¨ è¿™æœ‰åŠ©äºŽæ€è€ƒå†·çƒ­æ•°æ®æºçš„å…³ç³»ï¼Œå°±åƒä¸€ä¸ªäººçœ‹ï¼ˆsubscribeï¼‰ç”µå½±å’Œè¡¨æ¼”ã€‚ å†·æ•°æ®æµï¼šç”µå½±ã€‚ çƒ­æ•°æ®æµï¼šçŽ°åœºæ¼”å‡º é‡æ’­çƒ­æ•°æ®æµï¼šå½•æ’­çŽ°åœºæ¼”å‡º ä½ ç®¡ä½ ä½•æ—¶è§‚çœ‹ç”µå½±ï¼Œä½ çœ‹ç”µå½±å’Œåˆ«äººçœ‹éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå°½ç®¡æ‰€æœ‰è§‚çœ‹è€…çœ‹çš„éƒ½æ˜¯ç›¸åŒçš„å†…å®¹ã€‚å¦ä¸€æ–¹é¢ï¼Œä¸€ä¸ªè¡¨æ¼”æ˜¯ä¸Žå¤šä¸ªè§‚çœ‹éƒ½ä¸€èµ·åˆ†äº«çš„ã€‚å¦‚æžœä½ è¿Ÿåˆ°äº†ï¼Œä½ å°†ä¼šé”™è¿‡ä¸€éƒ¨åˆ†ã€‚ä¸ç®¡æ€Žæ ·ï¼Œå¦‚æžœè®°å½•ä¸‹æ¥äº†ï¼ˆåœ¨ RxJSä¸­å¯ä»¥ä½¿ç”¨ BehaviorSubject æˆ– ReplaySubjectï¼‰ï¼Œä½ ä¹Ÿå¯åƒçœ‹ç”µå½±ä¸€æ ·çœ‹çŽ°åœºæ¼”å‡ºã€‚.publish().refCount() çŽ°åœºè¡¨æ¼”æ˜¯è‰ºæœ¯å®¶åœ¨æ²¡æœ‰äººè§‚çœ‹çš„æƒ…å†µä¸‹é€€å‡ºæ¯”èµ›ï¼Œå½“è§‚ä¼—ä¸­è‡³å°‘æœ‰ä¸€äººå‡ºçŽ°æ—¶ï¼Œä»–ä¼šé‡æ–°å¼€å§‹æ¼”å¥ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>RxJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Coverageé’ˆå¯¹jså’Œcssçš„ä»£ç è¦†ç›–æ£€æµ‹-Chrome_devtoolsçš„æ–°åŠŸèƒ½]]></title>
    <url>%2F2017%2F04%2F06%2Fcheck-coverage-of-js-and-css-used-in-Chrome-devtools.html</url>
    <content type="text"><![CDATA[Coverageé’ˆå¯¹jså’Œcssçš„ä»£ç è¦†ç›–æ£€æµ‹-Chrome_devtoolsçš„æ–°åŠŸèƒ½ä¹Ÿè®¸ä½ ä¹‹å‰ç”¨è¿‡ä¸€äº›åƒ css usageã€css used è¿™æ ·çš„æµè§ˆå™¨æ’ä»¶åŽ»æ£€æµ‹ä»£ç è¦†ç›–çŽ‡ã€‚ä½†çŽ°åœ¨ï¼ŒChromeçš„å®žéªŒç‰ˆæœ¬Canaryç»ˆäºŽå®žçŽ°äº†ä»£ç è¦†ç›–çŽ‡æ£€æµ‹ï¼Œè¿™æ„å‘³ç€å®ƒå°†å¾ˆå¿«æ™®åŠåˆ°æ­£å¼ç‰ˆæœ¬ã€‚è¿™æ˜¯ä¸€ä¸ªä»¤äººå…´å¥‹çš„åŠŸèƒ½ï¼Œåœ¨ä½¿ç”¨JavaScriptå’ŒCSSæ—¶éžå¸¸æœ‰ç”¨ï¼Œæ‰€ä»¥æˆ‘ä¼šåšä¸€ä¸ªå¿«é€Ÿçš„æ¼”ç¤ºï¼Œå¹¶æŽ¢ç´¢å®ƒå¦‚ä½•ä½¿ç”¨ã€‚ å®ƒåšäº†äº›ä»€ä¹ˆäº‹æƒ…ä»£ç è¦†ç›–å¯ä»¥åœ¨æ‚¨è¿è¡Œæ‚¨çš„Webåº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼ŒéåŽ†æ¯ä¸ªJS / CSSæ–‡ä»¶ï¼Œçœ‹çœ‹å“ªäº›ä»£ç è¡Œè¿è¡Œï¼Œå“ªäº›ä»£ç æ²¡æœ‰è¿è¡Œã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘åšäº†ä¸€ä¸ªç®€å•çš„é™æ€ç½‘é¡µï¼ŒChromeç”Ÿæˆäº†é¡µé¢ä¸Šå­˜åœ¨çš„CSSå’ŒJSæ–‡ä»¶çš„é—®é¢˜æ±‡æ€»ã€‚å³ä¾§çš„æ æ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶çš„ç›¸å¯¹å¤§å°ï¼Œçº¢è‰²è¡¨ç¤ºæœªä½¿ç”¨çš„ä»£ç ï¼Œç»¿è‰²æ˜¾ç¤ºè¿è¡Œçš„ä»£ç ã€‚ è®°å½•ä»£ç è¦†ç›–èŒƒå›´ä¸Ždevtoolsæ—¶é—´è½´ç±»ä¼¼ï¼Œæ‚¨ç‚¹å‡»å¼€å§‹è®°å½•ï¼Œç„¶åŽåœ¨æ‚¨çš„ç«™ç‚¹è¿›è¡Œæ­£å¸¸çš„äº¤äº’ã€‚å®ŒæˆåŽï¼ŒChromeä¼šè¿›è¡Œä¸€äº›è®¡ç®—å¹¶ç”Ÿæˆè¯»æ•°ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å¾ˆå¥½å¥‡ç½‘ç«™ä¸Šæœ‰å¤šå°‘æœªä½¿ç”¨çš„CSSï¼Œæ‰€ä»¥æˆ‘å¯¼èˆªåˆ°å„ä¸ªå­é¡µé¢ï¼Œä»¥ç¡®ä¿æˆ‘è§¦åŠåˆ°æ¯ä¸ªcssã€‚æžœç„¶ï¼Œè¿™é‡Œæœ‰å¾ˆå¤šæ”¹è¿›çš„ç©ºé—´ï¼Œå› ä¸ºæˆ‘çš„ç½‘ç«™ä¸Šçš„cssçš„97ï¼…æ²¡æœ‰ä½¿ç”¨ï¼ Chromeè¿˜å¯è®©æ‚¨æ·±å…¥ç ”ç©¶å•ä¸ªæ–‡ä»¶çš„ä»£ç èŒƒå›´ã€‚åœ¨è¿™é‡Œï¼Œå·¦è¾¹çš„çº¢è‰²/ç»¿è‰²æ¡æ˜¾ç¤ºå“ªä¸€è¡Œæ‰§è¡Œäº†ï¼Œå“ªä¸€è¡Œæ²¡æœ‰ã€‚è¯·æ³¨æ„ï¼Œå½“æ£€æŸ¥æœ€å°åŒ–çš„æ–‡ä»¶æ—¶ï¼Œå¯ä»¥æŒ‰æ–‡ä»¶å·¦ä¸‹è§’çš„æŒ‰é’®æ¥â€œprettifyâ€ä»£ç ã€‚ è¿™æœ‰ä»€ä¹ˆç”¨åœ¨ä¸€ä¸ªå¤æ‚çš„æˆ–é•¿æœŸçš„é¡¹ç›®ä¸Šå·¥ä½œæ—¶ï¼Œå¾ˆå®¹æ˜“ç§¯ç´¯å†—ä½™ä»£ç ã€‚å¦‚æžœä½ ä½¿ç”¨ webpack æˆ–å¦ä¸€ä¸ªJSæž„å»ºç³»ç»Ÿï¼Œå¯ä»¥é˜²æ­¢å¤§å¤šæ•°æ— ç”¨çš„JSä»£ç ã€‚ä½†æ˜¯å¯¹äºŽCSSæ¥è¯´ï¼Œè¿™æ ·åšå¯èƒ½ä¼šæœ‰ç‚¹æ£˜æ‰‹ã€‚æœ‰äº†è¿™ä¸ªè¦†ç›–å·¥å…·ï¼Œåœ¨Chromeæ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„æ–¹å¼æ¥å¿«é€Ÿäº†è§£å¤šå°‘å†—ä½™çš„ä»£ç åœ¨è¿è¡Œï¼Œå“ªäº›æ–‡ä»¶éœ€è¦ä¼˜åŒ–ã€‚ å¦‚ä½•æ‰èƒ½ä½¿ç”¨å®ƒä¸‹è½½Chromeçš„å®žéªŒç‰ˆæœ¬Canaryæˆ–ç­‰å¾…æ­¤åŠŸèƒ½æ›´æ–°åˆ°æ­£å¼ç‰ˆæœ¬ã€‚ ã€è¯‘æ–‡å‚è€ƒã€‘ï¼šhttps://blog.logrocket.com/using-the-chrome-devtools-new-code-coverage-feature-ca96c3dddcaf]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>coverage</tag>
        <tag>Chrome_devtools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦ä¹ RxJSéœ€è¦çŸ¥é“çš„å¥‡æ·«æŠ€å·§]]></title>
    <url>%2F2017%2F04%2F05%2Fwhat-you-need-to-know-about-RxJS.html</url>
    <content type="text"><![CDATA[å­¦ä¹ RxJSéœ€è¦çŸ¥é“çš„å¥‡æ·«æŠ€å·§å°è¯•ç”»ç å®å›¾ä¸ºä½ æƒ³åˆ›å»ºçš„æµç”»ä¸€ä¸ªç å®å›¾ã€‚ é€šè¿‡ç”»ç å®å›¾ï¼Œä½ å°†ä¼šå¾ˆæ¸…æ¥šä½ åº”è¯¥ä½¿ç”¨å“ªäº›æ“ä½œç¬¦ã€‚ ç å®å›¾å°±æ˜¯æ¯ä¸ªç å®è¡¨ç¤ºå½“å‰çš„ä¸€ä¸ªäº‹ä»¶æˆ–çŠ¶æ€ã€‚ç å®å›¾éœ€è¦åŒ…å«è¾“å…¥å’Œè¾“å‡ºæµã€‚ é€šè¿‡ç”»ç å®å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨å¼‚æ­¥è°ƒç”¨äº‹ä»¶å›žè°ƒä¹‹å‰ï¼Œéœ€è¦å»¶è¿Ÿæ£€æµ‹ç”¨æˆ·çš„è¾“å…¥ã€‚åœ¨è¿™ä¸ªä¾‹å›¾é‡Œå±•ç¤ºçš„æ˜¯throttleæ“ä½œç¬¦çš„å»¶è¿Ÿã€‚ä»Žä¸€ä¸ªæµåˆ›å»ºå¦ä¸€ä¸ªæµï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ flatMap æˆ– selectMany æ“ä½œç¬¦ã€‚ç„¶åŽå°±æœ‰äº†ä¸‹é¢çš„ä»£ç ï¼š var dictionarySuggest = userInput.throttle(250).flatMap(input => serverCall(input)); ä½•æ—¶å¿½ç•¥è¿™æ¡æŒ‡å—å¦‚æžœä½ æ„Ÿè§‰ä½ å·²ç»å¯ä»¥å¾ˆç†Ÿç»ƒåœ°ç¼–å†™å‡ºä½ æƒ³è¦çš„æµï¼Œä½ å¯ä»¥çœåŽ»ç”»ç å®å›¾è¿™ä¸€æ­¥ã€‚ä¸ç®¡æ€Žæ ·ï¼Œå°±ç®—æ˜¯ Rx å›¢é˜Ÿçš„æˆå‘˜åœ¨å†™ä»£ç çš„æ—¶å€™ä¹Ÿä»ç„¶ä¼šå…ˆç”»ä¸€ç”»ç å®å›¾ã€‚ è°ƒç”¨ subscribe æ—¶ä¼ é€’å¤šä¸ªå‚æ•°ä¸ºäº†æ–¹ä¾¿ï¼Œ Rx æä¾›ä¸€ä¸ªsubscribeæ–¹æ³•æ¥åŠ è½½è§‚å¯Ÿè€…çš„å›žè°ƒå‡½æ•°ã€‚ è§‚å¯Ÿè€…åªéœ€è¦å®žçŽ°è¿™ä¸‰ä¸ªæ–¹æ³•ï¼ˆonNext, onError & onCompletedï¼‰ã€‚ subscribeæ–¹æ³•çš„æ‰©å±•å…è®¸å¼€å‘äººå‘˜ä½¿ç”¨è¿™äº›æ–¹æ³•çš„é»˜è®¤é€‰é¡¹ã€‚ æ¯”å¦‚ï¼š å½“è°ƒç”¨subscribeæ–¹æ³•æ—¶åªæœ‰ä¸€ä¸ªonNextå‚æ•°ï¼ŒonErrorå°†æ•èŽ·æ¥è‡ªäº‹ä»¶æµçš„å¼‚å¸¸ã€‚onCompletedåœ¨è¿™é‡Œä»€ä¹ˆä¹Ÿä¸ä¼šåšã€‚ å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå¤„ç†å¼‚å¸¸æ˜¯å¾ˆé‡è¦çš„ï¼ˆä¸ç®¡æ˜¯å¯¹äºŽæ¢å¤è¿˜æ˜¯ä¸­æ–­åº”ç”¨ç¨‹åºï¼‰ã€‚ çŸ¥é“äº‹ä»¶æµæ˜¯å¦å®Œæˆä¹Ÿç»å¸¸æ˜¯å¾ˆé‡è¦çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‘Šè¯‰ç”¨æˆ·ä»–çš„æ“ä½œæ˜¯å¦å®Œæˆäº†ã€‚ æ‰€ä»¥ï¼Œæœ€å¥½æä¾›å®Œæ•´çš„ä¸‰ä¸ªå‚æ•°ç»™ subscribe æ“ä½œç¬¦ã€‚ RxJSè¿˜æä¾›äº†ä¸‰ç§æ–¹ä¾¿çš„æ–¹æ³•ï¼Œå…¶ä»…è®¢é˜…æ‰€æœŸæœ›çš„åºåˆ—çš„ä¸€éƒ¨åˆ†ã€‚å…¶ä»–çš„å¤„ç†ç¨‹åºä¼šé»˜è®¤ä¸ºåŽŸæ¥çš„è¡Œä¸ºã€‚æœ‰ä¸‰ä¸ªè¿™æ ·çš„åŠŸèƒ½ï¼š subscribeOnNext: åªå¯¹åº” onNext æ¶ˆæ¯ subscribeOnError: åªå¯¹åº” onError æ¶ˆæ¯ subscribeOnCompleted: åªå¯¹åº” onCompleted æ¶ˆæ¯. ä½•æ—¶å¿½ç•¥è¿™æ¡æŒ‡å— å½“æµç¡®å®šä¸ä¼šæœ‰å®ŒæˆçŠ¶æ€ï¼Œæ¯”å¦‚ keyupäº‹ä»¶ã€‚ å½“æµç¡®å®šä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ¯”å¦‚ä¸€ä¸ªäº‹ä»¶ï¼Œä¸€ä¸ªå®Œå…¨ç¡®å®šçš„æµã€‚ å½“é»˜è®¤è¡Œä¸ºæ˜¯ç¬¦åˆé¢„æœŸçš„æ—¶å€™ã€‚ è€ƒè™‘é€šè¿‡ç‰¹å®šçš„è°ƒåº¦ç¨‹åºå¹¶å‘å¼•å…¥æ“ä½œç¬¦ç›¸æ¯”ä½¿ç”¨observeonæ“ä½œç¬¦æ¥æ”¹å˜å¯è§‚å¯Ÿåºåˆ—äº§ç”Ÿæ¶ˆæ¯çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæ›´å¥½çš„åšæ³•æ˜¯åœ¨æ­£ç¡®çš„åœ°æ–¹å¼€å§‹åˆ›å»ºå¹¶å‘ã€‚ é€šè¿‡æ­£ç¡®çš„è°ƒåº¦å™¨å°†ä¼šå‡å°‘ ObserveOnæ“ä½œç¬¦çš„ä½¿ç”¨ã€‚ ä¾‹Rx.Observable.range(0, 90000, Rx.Scheduler.requestAnimationFrame).subscribe(draw); åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¥è‡ªrangeæ“ä½œç¬¦çš„å›žè°ƒå°†ä¼šé€šè¿‡window.requestAnimationFrameä¼ é€’ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ rangeæ“ä½œç¬¦çš„å›žè°ƒå°†è¢«è°ƒç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“é€’å½’è°ƒç”¨ç«‹å³æ‰§è¡Œæ—¶ï¼Œrangeè¿‡è½½å°†ä¼šä»£æ›¿ onNextåœ¨Rx.Scheduler.currentThreadä¸Šçš„è°ƒç”¨ã€‚ é€šè¿‡æä¾›Rx.Scheduler.requestAnimationFrameè°ƒåº¦ç¨‹åºï¼Œ æ‰€æœ‰æ¥è‡ªobservableçš„æ¶ˆæ¯éƒ½å°†ä¼šåœ¨ window.requestAnimationFrameå›žè°ƒä¸­äº§ç”Ÿã€‚ ä½•æ—¶å¿½ç•¥è¿™æ¡æŒ‡å—å½“ç»“åˆæ¥è‡ªä¸åŒæ‰§è¡Œä¸Šä¸‹æ–‡çš„å‡ ä¸ªäº‹ä»¶æ—¶ï¼Œä½¿ç”¨æŒ‡å—4.4å°†æ‰€æœ‰æ¶ˆæ¯å°½å¯èƒ½æ™šåœ°æ”¾åœ¨ç‰¹å®šçš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ å°½å¯èƒ½å°‘ä¸”å°½å¯èƒ½è¿Ÿåœ°è°ƒç”¨observeOn æ“ä½œç¬¦é€šè¿‡ä½¿ç”¨ observeOn æ“ä½œç¬¦ï¼Œ ä¸€ä¸ªé¢„å®šçš„åŠŸèƒ½æ˜¯é€šè¿‡åŽŸå§‹çš„æ¶ˆæ¯æµæ¥èŽ·å–ä¿¡æ¯ã€‚è¿™å¯èƒ½ä¼šæ”¹å˜æ—¶åºä¿¡æ¯ä»¥åŠå¯¹ç³»ç»Ÿæ–½åŠ é¢å¤–çš„åŽ‹åŠ›ã€‚åœ¨æŸ¥è¯¢ä¸­å»¶è¿Ÿä½¿ç”¨è¿™ä¸ªæ“ä½œç¬¦å¯ä»¥æ”¹å–„è¿™ä¸¤ä¸ªé—®é¢˜ã€‚ Samplevar result = xs.throttle(1000) .flatMap(x => ys.takeUntil(zs).sample(250).map(y => x + y)) .merge(ws) .filter(x => x &lt; 10) .observeOn(Rx.Scheduler.requestAnimationFrame); è¿™ä¸ªä¾‹å­åˆå¹¶äº†å¤šä¸ª è¿è¡Œåœ¨ä¸åŒä¸Šä¸‹æ–‡çš„ observable ã€‚è¿™ä¸ªæŸ¥è¯¢ç­›é€‰æŽ‰äº†å¤§éƒ¨åˆ†ä¿¡æ¯ã€‚å°†observeOnæ“ä½œç¬¦æ”¾åœ¨æŸ¥è¯¢ä¸­çš„å‰é¢ä¼šå¯¹ç­›é€‰å‡ºæ¥çš„æ¶ˆæ¯åšé¢å¤–çš„å·¥ä½œã€‚æœ€åŽæ‰è°ƒç”¨ observeOn å°†ä¼šæœ€å¤§é™åº¦åœ°æé«˜æ€§èƒ½ã€‚ ä½•æ—¶å¿½ç•¥è¿™æ¡æŒ‡å—å¦‚æžœä½ ä½¿ç”¨çš„ observable å¹¶æ²¡æœ‰æŒ‡å®šä¸åŒçš„ä¸Šä¸‹æ–‡çŽ¯å¢ƒã€‚è¿™ç§æƒ…å†µä¸‹å¯ä»¥ä¸å¿…ä½¿ç”¨ observeOn æ“ä½œç¬¦ã€‚ å…³æ³¨å†…å­˜é™åˆ¶RxJS æœ‰å¾ˆå¤šæ“ä½œç¬¦å’Œç±»å¯ä»¥åœ¨å†…å­˜ä¸­åˆ›å»º observable, æ¯”å¦‚ï¼šreplay æ“ä½œç¬¦ã€‚å½“è¿™äº›å†…å­˜å­˜å‚¨ç€ observable æ—¶ï¼Œè¿™äº›ç¼“å­˜çš„å¤§å°å°†å–å†³äºŽ observable çš„æ“ä½œã€‚å¦‚æžœç¼“å­˜è¿‡å¤§ï¼Œå°†ä¼šé€ æˆå†…å­˜æº¢å‡ºã€‚æœ‰è®¸å¤šç¼“å†²æ“ä½œç¬¦æä¾›ç­–ç•¥æ¥é™åˆ¶ç¼“å†²åŒºï¼Œä¸ç®¡æ˜¯ä»Žæ—¶é—´æ–¹é¢è¿˜æ˜¯å¤§å°ã€‚æä¾›è¿™ä¸ªé™åˆ¶å°†è§£å†³å†…å­˜åŽ‹åŠ›é—®é¢˜ã€‚ ä¾‹å­var result = xs.replay(null, 10000, 1000 * 60 /* 1 hr */).refCount(); è¿™ä¸ªä¾‹å­ä¸­ï¼Œreplay æ“ä½œç¬¦åˆ›å»ºäº†ä¸€ä¸ª buffer. æˆ‘ä»¬æœ‰é™åˆ¶è¿™ä¸ª buffer æœ€å¤šåŒ…å« 10,000 æ¡ä¿¡æ¯ä»¥åŠæœ€å¤šä¿ç•™è¿™äº›ä¿¡æ¯1å°æ—¶ã€‚ ä½•æ—¶å¿½ç•¥è¿™æ¡æŒ‡å—å½“ observable åˆ›å»ºäº†å¤§é‡çš„ä¿¡æ¯åªå¡«å……äº†ä¸€å°å— bufferï¼Œ æˆ–è€…å½“ bufferæœ¬èº«æœ‰å¤§å°é™åˆ¶ã€‚ ä½¿ç”¨ do/tap æ“ä½œç¬¦çš„å‰¯ä½œç”¨å¾ˆæ˜Žæ˜¾æœ‰å¾ˆå¤š Rx æ“ä½œç¬¦ä½¿ç”¨å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™å¯ä»¥åœ¨è¿™äº›å‚æ•°ä¸­ä¼ é€’ä»»ä½•æœ‰æ•ˆçš„ç”¨æˆ·ä»£ç ã€‚è¿™äº›ä»£ç å¯ä»¥æ”¹å˜å…¨å±€çŠ¶æ€ï¼ˆæ¯”å¦‚æ”¹å˜å…¨å±€å˜é‡ï¼Œè¯»å†™ç¡¬ç›˜ç­‰ç­‰ï¼‰ã€‚ Rx æ˜¯é€šè¿‡æ¯ä¸ªæ“ä½œç¬¦ç»„åˆèµ·æ¥è¿è¡Œçš„ï¼ˆé™¤äº†å…±äº«æ“ä½œç¬¦ï¼Œä¾‹å¦‚â€œpublishâ€ï¼‰ã€‚è¿™å°†ä½¿å‰¯ä½œç”¨å‘ç”Ÿåœ¨æ¯ä¸ªè®¢é˜…ã€‚ å¦‚æžœè¿™ç§è¡¨çŽ°æ˜¯æœŸæœ›çš„è¡Œä¸ºï¼Œæœ€å¥½å¼„æ¸…æ¥šåœ¨ do/tap æ“ä½œç¬¦ä¸­æœ‰å‰¯ä½œç”¨çš„è¿™éƒ¨åˆ†ä»£ç ã€‚è¿™äº›æ–¹æ³•ä¼šè¿‡è½½ï¼Œåªèƒ½è°ƒç”¨æŒ‡å®šçš„æ–¹æ³•ï¼Œæ¯”å¦‚ doOnNext/tapOnNextï¼ŒdoOnError/tapOnError,doOnCompleted/tapOnCompleted ä¾‹var result = xs.filter(x => x.failed).tap(x => log(x)); è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿‡æ»¤å¤±è´¥çš„æ¶ˆæ¯ã€‚å°†å®ƒä»¬åˆ†å‘åˆ°è®¢é˜…observableçš„ä»£ç ä¹‹å‰è®°å½•è¯¥æ¶ˆæ¯ã€‚æ­¤è®°å½•æœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼ˆæ¯”å¦‚ï¼šå°†æ¶ˆæ¯æ”¾ç½®åœ¨è®¡ç®—æœºçš„äº‹ä»¶æ—¥å¿—ä¸­ï¼‰å¹¶æ˜Žç¡®åœ°é€šè¿‡è°ƒç”¨do/tapæ“ä½œç¬¦ã€‚ å‡è®¾æ¶ˆæ¯å¯ä»¥ä¼ è¾¾ï¼Œç›´åˆ°é€€è®¢å®Œæˆç”±äºŽRxJS ä½¿ç”¨æŽ¨æ¨¡å¼ï¼Œæ¶ˆæ¯å¯ä»¥é€šè¿‡ä¸åŒçš„ä¸Šä¸‹æ–‡çŽ¯å¢ƒå‘é€ã€‚ å½“é€€è®¢çš„æ—¶å€™ï¼Œæ¶ˆæ¯å¯èƒ½è¿˜åœ¨è·¯ä¸Šã€‚å½“é€€è®¢è¿˜æ²¡æœ‰å®Œæˆçš„æ—¶å€™ï¼Œè¿™äº›æ¶ˆæ¯ä»ç„¶å¯ä»¥è¢«ä¼ è¾¾ã€‚å½“æŽ§åˆ¶æƒè¢«è¿”å›žæ—¶ï¼Œæ¶ˆæ¯å°†ä¸èƒ½å†ä¼ è¾¾ã€‚é€€è®¢è¿‡ç¨‹å¯ä»¥æ˜¯åœ¨ä¸€ä¸ªä¸åŒçš„ä¸Šä¸‹æ–‡çŽ¯å¢ƒä¸­è¿›è¡Œã€‚ ä½•æ—¶å¿½ç•¥è¿™æ¡æŒ‡å—ä¸€æ—¦ onCompleted æˆ– onError æ–¹æ³•è¢«è°ƒç”¨ï¼ŒRxJSè¯­æ³•å¯ä»¥ä¿è¯è®¢é˜…å·²ç»“æŸã€‚ ä½¿ç”¨ publish æ“ä½œç¬¦åˆ†äº«å‰¯ä½œç”¨å› ä¸ºè®¸å¤š observableæ˜¯å†·é—¨çš„(see cold vs. hot on Channel 9), æ¯ä¸ªè®¢é˜…éƒ½æœ‰å•ç‹¬çš„å‰¯ä½œç”¨ã€‚ æŸäº›æƒ…å†µä¸‹ï¼Œè¿™äº›å‰¯ä½œç”¨åªå‘ç”Ÿä¸€æ¬¡ã€‚publish æ“ä½œç¬¦é€šè¿‡å‘å¤šä¸ªç”¨æˆ·å¹¿æ’­å•ä¸ªè®¢é˜…æ¥æä¾›å…±äº«è®¢é˜…çš„æœºåˆ¶ã€‚ æœ‰å‡ ä¸ªè¿‡è½½publishè¿ç®—ç¬¦ã€‚æœ€æ–¹ä¾¿çš„è¿‡è½½æ˜¯é‚£äº›æä¾›äº†ä¸€ä¸ªå‡½æ•°å°è£… observable å…±äº«çš„å‰¯ä½œç”¨çš„å‚æ•°ã€‚ ä¾‹var xs = Rx.Observable.create(observer => { console.log('Side effect'); observer.onNext('hi!'); observer.onCompleted(); }); xs.publish(sharedXs => { sharedXs.subscribe(console.log); sharedXs.subscribe(console.log); return sharedXs; }).subscribe(); è¿™ä¸ªä¾‹å­ä¸­ï¼Œxs æ˜¯ä¸€ä¸ªæœ‰å‰¯ä½œç”¨çš„ï¼ˆå†™å…¥consoleï¼‰ observableã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå•ç‹¬çš„è®¢é˜…éƒ½ä¼šè§¦å‘è¿™äº›å‰¯ä½œç”¨ã€‚ publish æ“ä½œç¬¦ä½¿ç”¨xså•ç‹¬ç»™æ‰€æœ‰è®¢é˜…è€… sharedXs å˜é‡åŽ»è®¢é˜…ã€‚ ä½•æ—¶å¿½ç•¥è¿™æ¡æŒ‡å—åªæœ‰å½“ publish æ“ä½œç¬¦éœ€è¦å…±äº«å‰¯ä½œç”¨æ—¶æ‰ä½¿ç”¨è¿™æ¡æŒ‡å—ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥åˆ›å»ºå•ç‹¬çš„è®¢é˜…ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼šä¸ç®¡æ˜¯è®¢é˜…æ²¡æœ‰å‰¯ä½œç”¨çš„æˆ–æ˜¯å‰¯ä½œç”¨å¯ä»¥æ‰§è¡Œå¤šæ¬¡æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚ å‚è€ƒ åŒæ­¥ç¿»è¯‘è‡³RxJSä¸­æ–‡æ–‡æ¡£]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>RxJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆé€‰æ‹© RxJS?]]></title>
    <url>%2F2017%2F04%2F04%2Fwhy-rxjs.html</url>
    <content type="text"><![CDATA[Why RxJS?ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆé€‰æ‹© RxJS? ä¸ºä»€ä¹ˆä¸æ˜¯ Promises? Promises å¯ä»¥å¾ˆå¥½åœ°è§£å†³å¼‚æ­¥æ“ä½œï¼Œåƒä½¿ç”¨ XMLHttpRequest åŽ»æŸ¥è¯¢æœåŠ¡å™¨, å®ƒé¢„æœŸä¼šè¿”å›žå€¼å¹¶ä¸”æœ€ç»ˆå®Œæˆè¯·æ±‚ã€‚ The Reactive Extensions ç»Ÿä¸€äº† JavaScript ä¸­çš„ Promises, callbacks ä»¥åŠäº‹ä»¶æ•°æ®ï¼Œæ¯”å¦‚ DOMè¾“å…¥, Web Workers, Web Sockets. ä¸€æ—¦æˆ‘ä»¬ç»Ÿä¸€äº†è¿™äº›æ¦‚å¿µï¼Œå°±å¯ä»¥è¿›è¡Œå„ç§å„æ ·çš„ç»„åˆ. ä¸ºäº†è®©æ‚¨äº†è§£ä¸°å¯Œçš„ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Œå®ƒä»Žæ–‡æœ¬è¾“å…¥ä¸­æŽ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œç„¶åŽæŸ¥è¯¢æœåŠ¡ï¼Œç¡®ä¿ä¸ä¼šå¯¹æ¯ä¸ªé”®ç›˜è¾“å…¥çš„è¿›è¡Œæ³›æ»¥åœ°è°ƒç”¨ï¼Œè€Œæ˜¯ä»¥ä¸€ç§æ›´è‡ªç„¶çš„æ–¹å¼è°ƒç”¨ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°†å¼•ç”¨JavaScriptæ–‡ä»¶ï¼ŒåŒ…æ‹¬jQueryï¼Œå°½ç®¡RxJSæ²¡æœ‰ä¾èµ–äºŽjQuery â€¦ æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»Žè¾“å…¥æ¡†èŽ·å–ç”¨æˆ·è¾“å…¥ï¼Œä½¿ç”¨Rx.Observable.fromEvent æ–¹æ³•ç›‘å¬ keyup äº‹ä»¶. å¦‚æžœ jQuery, Zepto, AngularJS and Ember.js å¯ç”¨ï¼Œå°†ä¼šä½¿ç”¨å®ƒä»¬æ¥ç»‘å®šäº‹ä»¶, å¦åˆ™å°†ä½¿ç”¨åŽŸç”Ÿäº‹ä»¶ç»‘å®š. è¿™è·Ÿæ‚¨çš„æ¡†æž¶æ€è€ƒäº‹ä»¶çš„ä¸€è‡´æ–¹å¼ï¼Œå› æ­¤æ²¡æœ‰ä»»ä½•æƒŠå–œã€‚ var $input = $('#input'), $results = $('#results'); /* åªä»Ž keyup äº‹ä»¶èŽ·å¾—è¾“å…¥å€¼ */ var keyups = Rx.Observable.fromEvent($input, 'keyup') .map(e => e.target.value) .filter(text => text.length > 2); /* å‡½æ•°èŠ‚æµè¾“å‡ºè®¾ç½®ä¸º 500ms */ var throttled = keyups.throttle(500 /* ms */); /* çŽ°åœ¨åˆ¤æ–­å€¼æ˜¯å¦æœ‰æ”¹å˜ï¼ŒåªèŽ·å–ä¸åŒçš„å€¼ */ var distinct = throttled.distinctUntilChanged(); çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥æŸ¥è¯¢ç»´åŸºç™¾ç§‘ï¼åœ¨RxJSä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹å³é€šè¿‡Rx.Observable.fromPromiseæ–¹æ³•ç»‘å®šåˆ°ä»»ä½•Promises A+çš„å®žçŽ°ä¸Šï¼Œæˆ–è€…ç›´æŽ¥è¿”å›žå®ƒï¼Œå¹¶å°†å…¶å°è£…ã€‚ function searchWikipedia (term) { return $.ajax({ url: 'http://en.wikipedia.org/w/api.php', dataType: 'jsonp', data: { action: 'opensearch', format: 'json', search: term } }).promise(); } ä¸€æ—¦åˆ›å»ºï¼ŒçŽ°åœ¨æˆ‘ä»¬å¯ä»¥å°†ä¸åŒçš„èŠ‚æµè¾“å…¥ç»‘å®šåœ¨ä¸€èµ·ï¼Œç„¶åŽæŸ¥è¯¢æœåŠ¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†è°ƒç”¨flatMapLatestèŽ·å–è¯¥å€¼ï¼Œå¹¶ç¡®ä¿æˆ‘ä»¬ä¸ä¼šæœ‰ä»»ä½•æ··ä¹±çš„è°ƒç”¨ã€‚ var suggestions = distinct.flatMapLatest(searchWikipedia); æœ€åŽï¼Œæˆ‘ä»¬å°†åœ¨å¯è§‚å¯Ÿå¯¹è±¡ä¸Šè°ƒç”¨subscribeæ–¹æ³•å¼€å§‹æ‹‰æ•°æ®ã€‚ suggestions.subscribe(data => { var res = data[1]; /* Do something åƒæ•°æ®ç»‘å®š */ $results.empty(); $.each(res, (_, value) => $('&lt;li>' + value + '&lt;/li>').appendTo($results)); }, error => { /* handle any errors */ $results.empty(); $('&lt;li>Error: ' + error + '&lt;/li>').appendTo($results); }); ç¿»è¯‘å‚è€ƒ åŒæ­¥å‘å¸ƒRxJSä¸­æ–‡æ–‡æ¡£]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>RxJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Lerpçš„åº”ç”¨-åˆ©ç”¨ç®€å•çº¿æ€§æ’å€¼æ¥å¹³æ»‘åŠ¨ç”»æ•ˆæžœ]]></title>
    <url>%2F2017%2F03%2F20%2Flerp-application-uses-simple-linear-interpolation-to-smooth-animation-effects.html</url>
    <content type="text"><![CDATA[Lerpçš„åº”ç”¨-åˆ©ç”¨ç®€å•çº¿æ€§æ’å€¼æ¥å¹³æ»‘åŠ¨ç”»æ•ˆæžœä¸Šä¸€ç¯‡çš„ RxJSçš„åŠ¨ç”»ç®€ä»‹ é‡Œæåˆ°ä¸€ä¸ªåŠ¨ç”»å¹³æ»‘çš„å°æŠ€å·§, è¿™é‡Œå±•ç¤ºå‡ ä¸ªä¾‹å­ï¼Œå®ƒçœŸçš„å¾ˆç®€å•å´å¾ˆæœ‰ç”¨ã€‚ Lerpæ˜¯ä¸¤ç‚¹ä¹‹é—´çš„çº¿æ€§æ’å€¼çš„åˆ«ç§°ã€‚è¿™æ˜¯ä¸€ä¸ªå®žçŽ°èµ·æ¥ç›¸å½“ç®€å•çš„æ•ˆæžœï¼Œä½†å¯ä»¥çœŸæ­£æ”¹å–„ä½ çš„åŠ¨ç”»çš„å¤–è§‚ï¼Œå¦‚æžœä½ å°†ä¸€ä¸ªå¯¹è±¡ä»Žç‚¹Aç§»åŠ¨åˆ°ç‚¹B. å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå¦‚æžœæ‚¨æœ‰ä¸€ä¸ªå¯¹è±¡çš„å½“å‰ä½ç½®å’Œç›®æ ‡çš„ä½ç½®ï¼Œæ‚¨å¯ä»¥çº¿æ€§å†…æ’è¿™äº›ç‚¹ä¹‹é—´çš„è·ç¦»çš„ç™¾åˆ†æ¯”ï¼Œå¹¶åœ¨æ¯ä¸ªåŠ¨ç”»å¸§ä¸Šæ›´æ–°è¯¥ä½ç½®ã€‚ function lerp(position, targetPosition) { // è®¡ç®—å½“å‰ä½ç½®ä¸Žç›®æ ‡ä½ç½®å·®å€¼çš„ 20% position.x += (targetPosition.x - position.x)*0.2; position.y += (targetPosition.y - position.y)*0.2; } é€šè¿‡è¿™æ ·åšï¼Œå¯¹è±¡ç§»åŠ¨çš„é‡éšç€ä½ç½®å’Œç›®æ ‡ä¹‹é—´çš„è·ç¦»å‡å°è€Œå˜å°ã€‚è¿™æ„å‘³ç€å¯¹è±¡å°†è¶Šæ¥è¶ŠæŽ¥è¿‘å®ƒçš„ç›®æ ‡ï¼Œé€Ÿåº¦å°†å‡æ…¢ï¼Œè¿™åˆ›é€ ä¸€ä¸ªå¾ˆå¥½çš„ç¼“å’Œæ•ˆæžœã€‚ ä¸€äº›ä¾‹å­è¿™é‡Œæœ‰ä¸€ä¸ªçƒè·Ÿéšç”¨æˆ·çš„é¼ æ ‡æˆ–è§¦æ‘¸è¿åŠ¨çš„ä¾‹å­ã€‚å¦‚æžœæˆ‘ä»¬ä½¿çƒç§»åŠ¨åˆ°é¼ æ ‡ç§»åŠ¨çš„åœ°æ–¹ï¼Œçƒçš„ç§»åŠ¨å¯ä»¥éžå¸¸å¿«ä½†çœ‹èµ·æ¥æœ‰ç‚¹è„±èŠ‚ã€‚å¦‚æžœæˆ‘ä»¬å¿«é€Ÿç§»åŠ¨é¼ æ ‡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°å•ç‹¬çš„â€œçƒå½±â€ã€‚ è¿™é‡Œæ˜¯åŒæ ·çš„æ¼”ç¤ºï¼Œé™¤äº†è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨lerpã€‚ä¸æ˜¯å°†çƒç«‹å³å‘å³ç§»åŠ¨åˆ°é¼ æ ‡ä½ç½®ï¼Œæˆ‘ä»¬æ¯æ¬¡å°†å®ƒç§»åŠ¨10ï¼…çš„è·ç¦»ã€‚ æ³¨æ„çƒçš„è¿åŠ¨å¾ˆå¹³æ»‘ï¼Œæ•´ä½“æ›´ä»¤äººæ„‰å¿«çš„æ•ˆæžœã€‚ è¿™é‡Œæ˜¯ä½¿ç”¨lerpçš„å¦ä¸€ä¸ªä¾‹å­ã€‚è¿™æ¬¡æˆ‘ä»¬æœ‰ä¸€ä¸ªæ»šåŠ¨æŒ‡ç¤ºå™¨ï¼Œå½“æ‚¨å‘ä¸‹æ»šåŠ¨â€œé¡µé¢â€æ—¶æ›´æ–°ã€‚ æ‰€ä»¥ï¼Œlerpâ€œæŠŠæˆâ€æ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„å·¥å…·ï¼Œæˆ‘ä»¬çš„ç½‘ç»œåŠ¨ç”»å¥—è·¯ï¼Œä»¥å¯¹æŠ—çº¿æ€§æˆ–é”¯é½¿çŠ¶çš„è¿åŠ¨ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>animate</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxJSçš„åŠ¨ç”»ç®€ä»‹]]></title>
    <url>%2F2017%2F03%2F19%2Fanimated-intro-rxjs.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡è¯‘è‡ª An Animated Intro to RxJS ä½ å¯èƒ½å¬è¯´è¿‡RxJSï¼ŒReactiveXï¼Œæˆ–ååº”å¼ç¼–ç¨‹ï¼Œæˆ–è€…ç”šè‡³åªå¬è¿‡å‡½æ•°å¼ç¼–ç¨‹ã€‚è¿™äº›æœ¯è¯­åœ¨è°ˆè®ºæœ€æ–°å’Œæœ€å‰æ²¿çš„å‰ç«¯æŠ€æœ¯æ—¶å˜å¾—è¶Šæ¥è¶Šçªå‡ºã€‚å¦‚æžœä½ åƒæˆ‘ä¸€æ ·ï¼Œå½“ä½ ç¬¬ä¸€æ¬¡å°è¯•å­¦ä¹ å®ƒæ—¶ï¼Œä½ æ„Ÿåˆ°å¾ˆå›°æƒ‘ã€‚ æ ¹æ®ReactiveX.ioï¼š ReactiveXæ˜¯ä¸€ä¸ªåº“ï¼Œç”¨äºŽé€šè¿‡ä½¿ç”¨å¯è§‚å¯Ÿåºåˆ—æ¥ç»„æˆå¼‚æ­¥å’ŒåŸºäºŽäº‹ä»¶çš„ç¨‹åºã€‚ è¿™å¥è¯åŒ…å«äº†å¾ˆå¤šè¦æ¶ˆåŒ–çš„å†…å®¹ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é‡‡ç”¨ä¸€ç§ä¸åŒçš„æ–¹æ³•æ¥å­¦ä¹ RxJSï¼ˆReactiveXçš„JavaScriptå®žçŽ°ï¼‰å’ŒObservablesï¼Œé€šè¿‡åˆ›å»ºååº”å¼åŠ¨ç”»ã€‚ ç†è§£Observableæ•°ç»„æ˜¯å…ƒç´ çš„é›†åˆï¼Œä¾‹å¦‚[1, 2, 3, 4, 5]ã€‚ä½ å¯ä»¥ç«‹å³å¾—åˆ°æ‰€æœ‰çš„å…ƒç´ ï¼Œä½ å¯ä»¥åšçš„äº‹æƒ…åƒmapï¼Œfilterå’Œæ˜ å°„ä»–ä»¬ã€‚è¿™å…è®¸ä½ ä»¥ä»»ä½•ä½ æƒ³è¦çš„æ–¹å¼è½¬æ¢å…ƒç´ çš„é›†åˆã€‚ çŽ°åœ¨å‡è®¾é˜µåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ éšæ—¶é—´å‘ç”Ÿ; ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ ä¸æ˜¯ç«‹å³å¾—åˆ°æ‰€æœ‰çš„å…ƒç´ ï¼Œè€Œæ˜¯ä¸€æ¬¡ä¸€ä¸ªã€‚ä½ å¯èƒ½å¾—åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ åœ¨ç¬¬1ç§’ï¼Œä¸‹ä¸€ä¸ªåœ¨ç¬¬3ç§’ï¼Œä¾æ­¤ç±»æŽ¨ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•è¡¨ç¤ºï¼š è¿™å¯ä»¥è¢«æè¿°ä¸ºå€¼çš„æµï¼Œæˆ–äº‹ä»¶åºåˆ—ï¼Œæˆ–æ›´ç¡®åˆ‡åœ°ï¼Œç§°ä¸ºobservableã€‚ observableæ˜¯éšæ—¶é—´çš„å€¼çš„é›†åˆã€‚ å°±åƒä½¿ç”¨æ•°ç»„ä¸€æ ·ï¼Œæ‚¨å¯ä»¥å¯¹è¿™äº›å€¼è¿›è¡Œæ˜ å°„ï¼Œè¿‡æ»¤ç­‰æ“ä½œï¼Œä»¥åˆ›å»ºå’Œç»„åˆæ–°çš„observableã€‚æœ€åŽï¼Œä½ å¯ä»¥è®¢é˜…è¿™äº›observableï¼Œå¹¶åœ¨steamçš„å€¼ä¹‹åŽæ‰§è¡Œä½ æƒ³è¦åšçš„äº‹ã€‚è¿™æ˜¯RxJSçš„æºã€‚ RxJSèµ·æ­¥å¼€å§‹ä½¿ç”¨RxJSçš„æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨CDNï¼Œè™½ç„¶æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å®‰è£…ï¼Œè¿™å–å†³äºŽé¡¹ç›®çš„éœ€è¦ã€‚ &lt;!-- the latest, minified version of RxJS --> &lt;script src="https://unpkg.com/@reactivex/rxjs@latest/dist/global/Rx.min.js">&lt;/script> ä¸€æ—¦ä½ çš„é¡¹ç›®ä¸­æœ‰RxJSï¼Œä½ å¯ä»¥ä»Žä»»ä½•ä¸œè¥¿ä¸­åˆ›å»ºä¸€ä¸ªobservable ï¼š const aboutAnything = 42; // ä»Žå˜é‡åˆ›å»º // The observable emits that value, then completes. const meaningOfLife$ = Rx.Observable.just(aboutAnything); // ä»Žæ•°ç»„æˆ–å¯éåŽ†çš„ç»“æž„ä¸­åˆ›å»º // The observable emits each item from the array, then completes. const myNumber$ = Rx.Observable.from([1, 2, 3, 4, 5]); // From a promise. // The observable emits the result eventually, then completes (or errors). const myData$ = Rx.Observable.fromPromise(fetch('http://example.com/users')); // ä»Žäº‹ä»¶ä¸­åˆ›å»º // The observable continuously emits events from the event listener. const mouseMove$ = Rx.Observable .fromEvent(document.documentElement, 'mousemove'); æ³¨æ„ï¼šå˜é‡æœ«å°¾çš„ç¾Žå…ƒç¬¦å·$æ˜¯ä¸€ä¸ªçº¦å®šï¼Œè¡¨ç¤ºè¯¥å˜é‡æ˜¯ä¸€ä¸ªå¯è§‚å¯Ÿè€…ã€‚Observableå¯ä»¥ç”¨æ¥å¯¹ä»»ä½•å¯ä»¥è¡¨ç¤ºä¸ºéšæ—¶é—´å˜åŒ–çš„å€¼çš„æµè¿›è¡Œå»ºæ¨¡ï¼Œä¾‹å¦‚äº‹ä»¶ï¼ŒPromisesï¼Œè®¡æ—¶å™¨ï¼Œé—´éš”å’ŒåŠ¨ç”»ã€‚ å› ä¸ºï¼Œè¿™äº›å¯è§‚å¯Ÿçš„ä¸œè¥¿ä¸åšä»»ä½•äº‹æƒ…ï¼Œè‡³å°‘ç›´åˆ°ä½ å®žé™…è§‚å¯Ÿä»–ä»¬ã€‚ä¸€ä¸ªç®€å•çš„è®¢é˜…å°†åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½¿ç”¨åˆ›å»º.subscribe()ï¼š myNumber$.subscribe(number => console.log(number)); // Result: // > 1 // > 2 // > 3 // > 4 // > 5 è®©æˆ‘ä»¬å®žè·µçœ‹çœ‹ï¼š const docElm = document.documentElement; const cardElm = document.querySelector('#card'); const titleElm = document.querySelector('#title'); const mouseMove$ = Rx.Observable .fromEvent(docElm, 'mousemove'); mouseMove$.subscribe(event => { titleElm.innerHTML = `${event.clientX}, ${event.clientY}` }); ä»ŽmouseMove$è§‚å¯Ÿåˆ°çš„ï¼Œæ¯æ¬¡mousemoveäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè®¢é˜…æ”¹å˜titleElmçš„.innerHTMLçš„é¼ æ ‡çš„ä½ç½®ã€‚è¯¥.mapæ“ä½œï¼ˆæ®å·¥ä½œåŽŸç†ç±»ä¼¼Array.prototype.mapæ–¹æ³•ï¼‰å¯å¸®åŠ©ç®€åŒ–äº‹æƒ…ï¼š // Produces e.g., {x: 42, y: 100} instead of the entire event const mouseMove$ = Rx.Observable .fromEvent(docElm, 'mousemove') .map(event => ({ x: event.clientX, y: event.clientY })); ä½¿ç”¨ä¸€äº›æ•°å­¦å’Œå†…è”æ ·å¼ï¼Œæ‚¨å¯ä»¥ä½¿å¡ç‰‡æœå‘é¼ æ ‡æ—‹è½¬ã€‚pos.y / clientHeightå’Œpos.x / clientWidthè®¡ç®—ä¸º0å’Œ1ä¹‹é—´çš„å€¼ï¼Œæ‰€ä»¥ä¹˜ä»¥ç”±50å‡åŽ»ä¸€åŠï¼ˆ25ï¼‰äº§ç”Ÿçš„å€¼ä»Ž-25åˆ°25ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬çš„æ—‹è½¬å€¼ï¼š const docElm = document.documentElement; const cardElm = document.querySelector('#card'); const titleElm = document.querySelector('#title'); const { clientWidth, clientHeight } = docElm; const mouseMove$ = Rx.Observable .fromEvent(docElm, 'mousemove') .map(event => ({ x: event.clientX, y: event.clientY })) mouseMove$.subscribe(pos => { const rotX = (pos.y / clientHeight * -50) - 25; const rotY = (pos.x / clientWidth * 50) - 25; cardElm.style = ` transform: rotateX(${rotX}deg) rotateY(${rotY}deg); `; }); ä½¿ç”¨ .merge åˆå¹¶çŽ°åœ¨è®©æˆ‘ä»¬å‡è®¾ä½ æƒ³è®©è¿™ä¸ªé€‚åº”è§¦æ‘¸è®¾å¤‡ï¼Œä¸ç®¡æ˜¯é¼ æ ‡äº‹ä»¶æˆ–æ˜¯è§¦æ‘¸åŠ¨ä½œã€‚æ²¡æœ‰ä»»ä½•æ··ä¹±çš„å›žè°ƒï¼Œä½ å¯ä»¥é€šè¿‡RxJSä½¿ç”¨å¾ˆå¤šæ–¹æ³•æ¥ç»“åˆObservableã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯ä»¥ä½¿ç”¨.mergeå®žçŽ°ã€‚å°±åƒäº¤é€šå¤šæ¡è½¦é“åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„è½¦é“ï¼Œè¿™å°†è¿”å›žä¸€ä¸ªåŒ…å«æ‰€æœ‰æ•°æ®çš„Observableé€šè¿‡åˆå¹¶å¤šä¸ªObservable. const touchMove$ = Rx.Observable .fromEvent(docElm, 'touchmove') .map(event => ({ x: event.touches[0].clientX, y: event.touches[0].clientY })); const move$ = Rx.Observable.merge(mouseMove$, touchMove$); move$.subscribe(pos => { // ... }); ç»§ç»­ï¼Œå°è¯•åœ¨è§¦æ‘¸å±è®¾å¤‡ä¸Šå¹³ç§»å·¦å³ï¼š è¿˜æœ‰å¾ˆå¤šå…¶ä»–æœ‰ç”¨çš„Observableåˆå¹¶æ–¹æ³•ï¼Œå¦‚.switch()ï¼Œ.combineLatest()å’Œ.withLatestFrom()ï¼Œæˆ‘ä»¬ç»§ç»­å…³æ³¨ä¸‹ä¸€ä¸ªç‚¹ã€‚ æ·»åŠ å¹³æ»‘çš„è¿åŠ¨æ—‹è½¬å¡åŠ¨ä½œæœ‰ç‚¹å¤ªæ­»æ¿ã€‚åªè¦é¼ æ ‡ï¼ˆæˆ–æ‰‹æŒ‡ï¼‰åœæ­¢ï¼Œæ—‹è½¬å³åˆ»åœæ­¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œçº¿æ€§å†…æ’ï¼ˆçº¿æ€§æ’å€¼ï¼‰éƒ½å¯ä»¥ä½¿ç”¨ã€‚ä¸€èˆ¬æŠ€æœ¯ä¸­æè¿°è¿™ä¸ªä¼Ÿå¤§çš„æ•™ç¨‹ç”±é›·åˆ‡å°”Â·å²å¯†æ–¯ã€‚æœ¬è´¨ä¸Šï¼Œè€Œä¸æ˜¯ä»ŽAç‚¹è·³åˆ°Bï¼Œçº¿æ€§æ’å€¼ä¼šåœ¨æ¯ä¸€ä¸ªåŠ¨ç”»è¿è¡Œä¸€å°éƒ¨åˆ†ã€‚è¿™å°†äº§ç”Ÿä¸€ä¸ªå¹³æ»‘çš„è¿‡æ¸¡ï¼Œç”šè‡³å½“é¼ æ ‡/è§¦æ‘¸ç§»åŠ¨å·²åœæ­¢ã€‚ è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°å®žçŽ°è¿™ä¸ªåŠŸèƒ½ï¼šè®¡ç®—ç»™å®šåˆå§‹å€¼å’Œç»ˆå€¼ä¸‹ä¸€ä¸ªå€¼ï¼Œé‡‡ç”¨çº¿æ€§æ’å€¼ï¼š function lerp(start, end) { const dx = end.x - start.x; const dy = end.y - start.y; return { x: start.x + dx * 0.1, y: start.y + dy * 0.1, }; } éžå¸¸ç®€çº¦ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªçº¯å‡½æ•°æ¯æ¬¡è¿”å›žä¸€ä¸ªæ–°çš„ï¼Œçº¿æ€§å†…æ’çš„ä½ç½®å€¼ï¼Œé€šè¿‡ç§»åŠ¨å½“å‰çš„ï¼ˆå¼€å§‹ï¼‰æŽ¥è¿‘æ¯ä¸ªåŠ¨ç”»å¸§ä¸Šçš„ä¸‹ä¸€ä¸ªï¼ˆå®Œï¼‰ä½ç½®10ï¼…çš„ä½ç½®ã€‚ è°ƒåº¦å’Œ.intervalé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨RxJSä¸­è¡¨ç¤ºåŠ¨ç”»å¸§ï¼ŸåŽŸæ¥ï¼ŒRxJSæœ‰ä¸€ä¸ªå«åšSchedulersçš„ä¸œè¥¿ï¼Œå®ƒæŽ§åˆ¶ä»€ä¹ˆæ—¶å€™ä»Žä¸€ä¸ªobservableå‘å‡ºæ•°æ®ï¼Œå½“è®¢é˜…éƒ½å¼€å§‹æŽ¥æ”¶å€¼ã€‚ ä½¿ç”¨Rx.Observable.interval()ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªobservableï¼Œå®ƒåœ¨å›ºå®šçš„æ—¶é—´é—´éš”å‘å‡ºå€¼ï¼Œä¾‹å¦‚æ¯éš”ä¸€ç§’ï¼ˆRx.Observable.interval(1000)ï¼‰ã€‚å¦‚æžœåˆ›å»ºä¸€ä¸ªéžå¸¸å¾®å°çš„æ—¶é—´é—´éš”ï¼Œä¾‹å¦‚Rx.Observable.interval(0)ï¼Œå¹¶å¸Œæœ›å®ƒåªåœ¨æ¯ä¸ªåŠ¨ç”»å¸§ä¸Šå‘å‡ºå€¼ï¼Œé‚£ä¹ˆåœ¨åŠ¨ç”»å¸§å†…Rx.Scheduler.animationFrameæ¯éš”16åˆ°17mså°±ä¼šå‘å‡ºä¸€ä¸ªå€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š const animationFrame$ = Rx.Observable.interval(0, Rx.Scheduler.animationFrame); ç»“åˆ.withLatestFromè¦åˆ›å»ºå¹³æ»‘çº¿æ€§æ’å€¼ï¼Œæ‚¨åªéœ€è¦å…³å¿ƒæ¯ä¸ªåŠ¨ç”»å¸§çš„æœ€æ–°é¼ æ ‡æˆ–è§¦æ‘¸ä½ç½®ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæœ‰ä¸€ä¸ªæ“ä½œç¬¦å«.withLatestFrom()ï¼š const smoothMove$ = animationFrame$ .withLatestFrom(move$, (frame, move) => move); çŽ°åœ¨ï¼ŒsmoothMove$æ˜¯ä¸€ä¸ªæ–°çš„observableï¼Œmove$ åªæœ‰å½“animationFrame$å‘å‡ºä¸€ä¸ªå€¼æ—¶ï¼Œæ‰ä¼šå‘å‡ºæœ€æ–°çš„å€¼ã€‚è¿™æ˜¯å¿…é¡»çš„ - ä½ å¹¶ä¸æƒ³è¦çš„åŠ¨ç”»å¸§å¤–å‘å‡ºçš„å€¼ï¼ˆé™¤éžä½ çœŸçš„å–œæ¬¢jankï¼‰ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æè¿°å½“ç»„åˆæ¥è‡ªæ¯ä¸ªå¯è§‚å¯Ÿçš„æœ€æ–°å€¼æ—¶è¦åšä»€ä¹ˆçš„å‡½æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå”¯ä¸€é‡è¦çš„å€¼æ˜¯moveå€¼ï¼Œè¿™æ˜¯æ‰€æœ‰è¿”å›žçš„å€¼ã€‚ ä¸Žè¿‡æ¸¡.scançŽ°åœ¨ä½ æœ‰ä¸€ä¸ªobservableä»Žmove$æ¯ä¸ªåŠ¨ç”»å¸§å‘å‡ºæœ€æ–°çš„å€¼ï¼Œæ˜¯æ—¶å€™æ·»åŠ çº¿æ€§æ’å€¼äº†ã€‚.scan()è¿ç®—ç¬¦â€œç§¯ç´¯â€ä»Žå¯è§‚å¯Ÿåˆ°çš„å½“å‰å€¼å’Œä¸‹ä¸€ä¸ªå€¼ï¼Œæä¾›ç»™éœ€è¦è¿™äº›å€¼çš„å‡½æ•°ã€‚ è¿™å¯¹äºŽæˆ‘ä»¬çš„çº¿æ€§æ’å€¼ç”¨ä¾‹æ˜¯å®Œç¾Žçš„ã€‚è®°ä½ï¼Œæˆ‘ä»¬çš„lerp(start, end)å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼šstartï¼ˆcurrentï¼‰å€¼å’Œendï¼ˆnextï¼‰å€¼ã€‚ const smoothMove$ = animationFrame$ .withLatestFrom(move$, (frame, move) => move) .scan((current, next) => lerp(current, next)); // or simplified: .scan(lerp) çŽ°åœ¨ï¼Œæ‚¨å¯ä»¥è®¢é˜…smoothMove$ä»£æ›¿move$åœ¨æ“ä½œä¸­æŸ¥çœ‹çº¿æ€§æ’å€¼ï¼š ç»“è®ºRxJS ä¸æ˜¯ä¸€ä¸ªåŠ¨ç”»åº“ï¼Œå½“ç„¶ï¼Œä½†å¯¹äºŽå¤„ç†éšæ—¶é—´å˜åŒ–çš„å€¼ï¼Œå®ƒçš„å¯ç»„åˆä»¥åŠå£°æ˜Žæ€§çš„æ–¹å¼æ˜¯ReactiveXæ¼”ç¤ºåŠ¨ç”»çš„æ ¸å¿ƒæ¦‚å¿µã€‚ååº”å¼ç¼–ç¨‹æ˜¯è€ƒè™‘ç¼–ç¨‹çš„å¦ç±»æ–¹å¼ï¼Œå…·æœ‰è®¸å¤šä¼˜ç‚¹ï¼š å®ƒæ˜¯å£°æ˜Žæ€§çš„ï¼Œå¯ç»„åˆçš„å’Œä¸å¯å˜çš„ï¼Œé¿å…å›žè°ƒåœ°ç‹±ï¼Œå¹¶ä½¿ä½ çš„ä»£ç æ›´ç®€æ´ï¼Œå¯é‡ç”¨å’Œæ¨¡å—åŒ–ã€‚ å®ƒåœ¨å¤„ç†æ‰€æœ‰ç±»åž‹çš„å¼‚æ­¥æ•°æ®æ—¶éžå¸¸æœ‰ç”¨ï¼Œæ— è®ºæ˜¯èŽ·å–æ•°æ®ï¼Œé€šè¿‡WebSocketsè¿›è¡Œé€šä¿¡ï¼Œç›‘å¬æ¥è‡ªå¤šä¸ªæºçš„å¤–éƒ¨äº‹ä»¶ï¼Œç”šè‡³æ˜¯åŠ¨ç”»ã€‚ â€œå…³æ³¨çš„åˆ†ç¦»â€ - æ‚¨ä½¿ç”¨Observableå’Œè¿ç®—ç¬¦å£°æ˜Žæ€§åœ°è¡¨ç¤ºæ‚¨æœŸæœ›çš„æ•°æ®ï¼Œç„¶åŽåœ¨ä¸€ä¸ªå•ç‹¬çš„ä¸Šä¸‹æ–‡çŽ¯å¢ƒä¸­å¤„ç†.subscribe()ï¼Œè€Œä¸ä¼šåœ¨æ‚¨çš„åŽŸä»£ç ä¸Šäº§ç”Ÿå‰¯ä½œç”¨ã€‚ æœ‰è¿™ä¹ˆå¤šè¯­è¨€çš„å®žçŽ°äº†å®ƒ - Javaï¼ŒPHPï¼ŒPythonï¼ŒRubyï¼ŒCï¼ƒï¼ŒSwiftå’Œå…¶ä»–ä½ å¯èƒ½æ²¡æœ‰å¬è¯´è¿‡çš„ã€‚ å®ƒä¸æ˜¯ä¸€ä¸ªæ¡†æž¶ï¼Œå®ƒä¸Žè®¸å¤šæµè¡Œçš„æ¡†æž¶ï¼ˆå¦‚Reactï¼ŒAngularå’ŒVueï¼‰å¯ä»¥éžå¸¸å¥½åœ°èžåˆåœ¨ä¸€èµ·ã€‚ ä½ å¯ä»¥å¾—åˆ°è¡Œå®¶æŒ‡ç‚¹ï¼Œå¦‚æžœä½ æƒ³è¦ï¼Œä½†ReactiveXä»Žè¢«æå‡ºåˆ°çŽ°åœ¨å®žæ–½äº†è¿‘åå¹´å‰ï¼ˆ2009å¹´ï¼‰ï¼Œç”±åˆ›æ„æ‰€äº§ç”Ÿçš„Conal Elliottå’Œä¿ç½—Â·èƒ¡è¾¾å…‹ 2å¹´å‰ï¼ˆ1997å¹´ï¼‰ï¼Œåœ¨æè¿°åŠŸèƒ½æ€§ååº”çš„åŠ¨ç”»ï¼ˆæƒŠå–œæƒŠå–œï¼‰ã€‚ä¸ç”¨è¯´ï¼Œå®ƒç»è¿‡äº†è¶³å¤Ÿçš„æµ‹è¯•ã€‚ æœ¬æ–‡æŽ¢è®¨äº†ä¸€äº›æœ‰ç”¨çš„éƒ¨åˆ†å’ŒRxJSçš„æ¦‚å¿µ-åˆ›å»ºä¸Žè®¢é˜….fromEvent()å’Œ.interval()ï¼Œå¯¹è®¢é˜…æ“ä½œ.map()å’Œ.scan()ï¼Œå¤šä¸ªè®¢é˜…ç›¸ç»“åˆ.merge()å’Œ.withLatestFrom()ï¼Œå¹¶ä¸Žå¼•å…¥è°ƒåº¦Rx.Scheduler.animationFrameã€‚æœ‰å¾ˆå¤šå…¶ä»–æœ‰ç”¨çš„èµ„æºå­¦ä¹ RxJSï¼š ReactiveXï¼šRxJS - å®˜æ–¹æ–‡æ¡£ RxMarbles - ç”¨äºŽå¯è§†åŒ–è§‚å¯Ÿ Reactiveç¼–ç¨‹çš„ä»‹ç» å¦‚æžœä½ æƒ³è¿›ä¸€æ­¥æ·±å…¥RxJSåŠ¨ç”»ï¼ˆå’Œä½¿ç”¨æ›´å¤šçš„CSSå˜é‡ï¼‰ï¼Œè¯·æŸ¥çœ‹æˆ‘çš„å¹»ç¯ç‰‡ä»ŽCSS Dev Conf 2016å’Œæˆ‘2016å¹´çš„æ¼”è®²ä»ŽJSConfå†°å²›å…³äºŽååº”å¼åŠ¨ç”»ä¸ŽCSSå˜é‡ã€‚è¿™é‡Œæœ‰ä¸€äº›ä½¿ç”¨RxJSåˆ›å»ºçš„åŠ¨ç”»å¯èƒ½å¯¹è§¦å‘çµæ„Ÿæœ‰å¸®åŠ©ï¼š 3Dæ•°å­—æ—¶é’Ÿ å¿ƒè„appæ¦‚å¿µ é€è§†ä½¿ç”¨RxJSæ‹–åŠ¨]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>RxJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡åŠ¨å›¾ç®€å•é€šä¿—åœ°äº†è§£Flexboxçš„å·¥ä½œåŽŸç†ï¼ˆäºŒï¼‰]]></title>
    <url>%2F2017%2F03%2F13%2Fan-animated-guide-to-flexbox-2.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡è¯‘è‡ª Scott Domes Flexå±žæ€§æ˜¯ä¸€ä¸ªå¤åˆå±žæ€§ï¼Œè€Œå¤§éƒ¨åˆ†æ•™ç¨‹ä¸­éƒ½åªè®¾ç½®ä¸€ä¸ªå€¼ï¼Œä½†å…¶å®žå®ƒåŒ…å«äº† flex-basisã€flex-growã€flex-shrink. è®©æˆ‘ä»¬æ·±å…¥äº†è§£Flexbox - ä»¥åŠå¦‚ä½•åˆ©ç”¨å®ƒæ¥æž„å»ºé€‚åº”æ€§å¼ºå’Œæ¼‚äº®çš„å¸ƒå±€. å±žæ€§ä¸€ï¼š Flex-Basisåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦æŠŠå®ƒç”¨äºŽå¤–éƒ¨å®¹å™¨ä¸­ã€‚è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬è¯•ç€æŠŠå®ƒç”¨åœ¨å®¹å™¨å†…çš„å­å…ƒç´ ä¸­ã€‚ è¿™æ˜¯ä¸€ä¸ªå¾ˆä¸èµ·çœ¼çš„å±žæ€§ï¼Œä½†ä¹Ÿå¾ˆç›´æŽ¥ã€‚ Flex-basis æŽ§åˆ¶ç€ä¸€ä¸ªå…ƒç´ çš„é»˜è®¤å¤§å°ï¼Œåœ¨å…¶ä»– flex å±žæ€§åº”ç”¨ä¹‹å‰ã€‚ åœ¨ä¸‹é¢çš„ GIF çœ‹æ¥ï¼Œå®ƒçš„ä½œç”¨å’Œ width çš„ä½œç”¨ä¸€æ ·ï¼š æ˜¯ä»€ä¹ˆè®© flex-basis è¡¨çŽ°å¾—å’Œ width ä¸€æ ·ï¼Ÿäº‹å®žä¸Šï¼Œå®ƒå¯¹åº”ç€ flex çš„åæ ‡è½´ã€‚ flex-basis å½±å“æ— ç´ åœ¨ä¸»è½´ä¸Šçš„å¤§å° è®©æˆ‘ä»¬çœ‹çœ‹ä¿æŒ flex-basis çš„å€¼ä¸å˜ï¼Œä½†æ˜¯æ”¹å˜ä¸»è½´æ–¹å‘ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼š æ³¨æ„åˆ°ï¼Œæˆ‘ä»Žæ‰‹åŠ¨è®¾ç½®é«˜åº¦å˜æˆæ‰‹åŠ¨è®¾ç½®å®½åº¦ã€‚ Flex-basis å½±å“å®½åº¦è¿˜æ˜¯é«˜åº¦å–å†³äºŽ flex-direction çš„å€¼ã€‚ å±žæ€§äºŒï¼šFlex GrowçŽ°åœ¨ï¼Œæˆ‘ä»¬æ¥ç‚¹æ›´å¤æ‚çš„ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬è®¾ç½®ç»™æ‰€æœ‰æ–¹å—è®¾ç½®ç›¸åŒçš„å®½åº¦ï¼Œ120px: çŽ°åœ¨ï¼Œå½“å®ƒåŠ ä¸Šå±žæ€§ flex-growï¼ˆé»˜è®¤å€¼ä¸º0ï¼‰.è¿™æ„å‘³ç€ï¼Œä¸å…è®¸æ–¹å—è‡ªåŠ¨å……æ»¡å®¹å™¨ã€‚ æ²¡ç†è§£ï¼ŸçŽ°åœ¨ç»™æ¯ä¸ªæ–¹å—çš„ flex-grow å±žæ€§è®¾ç½®ä¸º 1ï¼š æ‰€æœ‰æ–¹å—å…±åŒå……æ»¡äº†å®¹å™¨çš„æ•´ä¸ªå®½åº¦ï¼Œå¹¶ä¸”æ˜¯å¹³å‡åˆ†ã€‚ flex-grow å±žæ€§è¦†ç›–äº† width å±žæ€§ã€‚ è®©äººå›°æƒ‘çš„æ˜¯ flex-grow çš„å€¼åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ flex-grow: 1 æ„å‘³ç€ä»€ä¹ˆï¼Ÿ å¥½å§ï¼Œä¸‹å›¾æ˜¯ç»™æ¯ä¸ªæ–¹å—è®¾ç½® flex-grow å€¼ä¸º 999 çš„è¡¨çŽ°ï¼š è¿™çœŸæ˜¯ã€‚ã€‚å®Œå…¨ä¸€æ ·ã€‚ é‚£æ˜¯å› ä¸º flex-grow ä¸æ˜¯ä¸€ä¸ªç»å¯¹çš„å€¼ï¼Œè€Œæ˜¯ä¸€ä¸ªç›¸å¯¹çš„å€¼ã€‚ é‡è¦çš„ä¸æ˜¯ä¸€ä¸ªæ–¹å— flex-grow å€¼çš„æœ¬èº«ï¼Œè€Œæ˜¯è¿™ä¸ªå€¼å’Œå…¶ä»–æ–¹å—çš„å€¼çš„å…³ç³»ã€‚ å¦‚æžœç»™æ¯ä¸ªæ–¹å—è®¾ç½® flex-grow: 1ï¼Œ ç„¶åŽè°ƒæ•´ç¬¬3ä¸ªæ–¹å—çš„ flex-grow å±žæ€§ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å˜åŒ–ï¼š æƒ³è¦çœŸæ­£æ˜Žç™½è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬å¿«é€Ÿç•¥è¿‡ä¸€ä¸ªç®€å•çš„æ•°å­¦è®¡ç®—ã€‚ æ¯ä¸ªæ­£æ–¹å½¢éƒ½ä»¥flex-growä¸º1å¼€å§‹ã€‚å¦‚æžœæˆ‘ä»¬å°†æ¯ä¸ªæ­£æ–¹å½¢çš„flex-growç›¸åŠ ï¼Œåˆ™æ€»å’Œä¸º6ã€‚å› æ­¤ï¼Œå®¹å™¨è¢«åˆ†æˆ6ä¸ªå•ç‹¬çš„éƒ¨åˆ†ã€‚æ¯ä¸ªæ­£æ–¹å½¢å¢žé•¿åˆ°å¯ç”¨ç©ºé—´çš„1/6ä»¥å¡«æ»¡å®¹å™¨ã€‚ å½“è®¾ç½®ç¬¬3ä¸ªæ–¹å—çš„flex-grow ä¸º 2ï¼Œ çŽ°åœ¨å®¹å™¨è¢«åˆ†æˆ7ä»½ï¼Œå› ä¸º flex-grow å±žæ€§çš„å€¼çš„æ€»å’Œä¸º 1+1+2+1+1+1. æ–¹å—3èŽ·å¾— 2/7 çš„å®½åº¦ï¼Œå‰©ä¸‹çš„èŽ·å¾— 1/7ã€‚ å½“è®¾ç½®ç¬¬3ä¸ªæ–¹å—ä¸º flex-grow: 3ï¼Œ å®¹å™¨è¢«åˆ†æˆ8ä»½ï¼ˆ1+1+3+1+1+1ï¼‰, æ–¹å—3å  3/8, å‰©ä¸‹çš„å  1/8. ä»¥æ­¤ç±»æŽ¨ã€‚ flex-growæ˜¯å æ‰€æœ‰å€¼æ€»å’Œçš„æ¯”ä¾‹ã€‚å¦‚æžœç»™æ‰€æœ‰æ–¹å—è®¾ç½®flex-grow: 4, æ–¹å—3è®¾ç½® flex-grow: 12, æ•ˆæžœå’Œç»™å®ƒä»¬åˆ†åˆ«è®¾ç½® 1 å’Œ 3 æ˜¯ä¸€æ ·çš„ã€‚ æœ€åŽä¸€ç‚¹ï¼Œflex-grow å’Œ flex-basis éƒ½å’Œä¸»è½´å¯¹åº”ã€‚æˆ‘ä»¬çš„æ–¹å—åªä¼šå¢žé•¿å®½åº¦ï¼Œé™¤éžè®¾ç½® flex-direction ä¸º column. å±žæ€§ä¸‰ï¼š Flex Shrinkflex-shrink å’Œ flex-growæ­£å¥½ç›¸åï¼Œå†³å®šæ¯ä¸ªæ–¹å—å¯ä»¥æ”¶ç¼©å¤šå°‘ã€‚ å®ƒåªæœ‰åœ¨å…ƒç´ å¿…é¡»æ”¶ç¼©ä»¥é€‚åº”å…¶å®¹å™¨æ—¶æ‰èµ·ä½œç”¨ - å³å½“å®¹å™¨å¤ªå°æ—¶ã€‚ å®ƒçš„ä¸»è¦ç”¨é€”æ˜¯æŒ‡å®šå“ªäº›å…ƒç´ è¦ç¼©å°ï¼Œå“ªäº›å…ƒç´ ä¸ç”¨ç¼©å°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæ–¹å—çš„ flex-shrink å€¼ä¸º1 - è¿™æ„å‘³ç€å®ƒä¼šéšç€å®¹å™¨çš„æ”¶ç¼©è€Œæ”¶ç¼©ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„è¡¨çŽ°ã€‚åœ¨ä¸‹é¢çš„GIFSä¸­ï¼Œæ­£æ–¹å½¢çš„flex-growä¸º1ï¼Œå› æ­¤å®ƒä»¬å¡«å……äº†å®¹å™¨ï¼Œå¹¶ä¸”flex-shrinkä¸º1ï¼Œå› æ­¤å®ƒä»¬è¢«å…è®¸æ”¶ç¼©. çŽ°åœ¨è®©æˆ‘ä»¬å°†æ–¹å—3çš„flex-shrinkè®¾ç½®ä¸º0.å®ƒç¦æ­¢æ”¶ç¼©ï¼Œæ‰€ä»¥å®ƒä¼šå¢žé•¿ä»¥é€‚åº”å®¹å™¨ï¼Œä½†å®ƒæ‹’ç»æ”¶ç¼©åˆ°å…¶è®¾ç½®çš„120pxå®½åº¦ä»¥ä¸‹ã€‚ flex-shrinkçš„é»˜è®¤å€¼æ˜¯1 - è¿™æ„å‘³ç€ä½ çš„å…ƒç´ ä¼šæ”¶ç¼©ï¼Œé™¤éžè®¾ç½®ä¸º0åŽ»ç¦æ­¢å®ƒã€‚ åŒæ ·ï¼Œflex-shrink æ˜¯æŒ‰æ¯”ä¾‹çš„ã€‚å¦‚æžœä¸€ä¸ªç›’å­çš„flex-shrinkä¸º6ï¼Œå…¶ä½™çš„flex-shrinkä¸º2ï¼Œä¸€ä¸ªç›’å­å°†ä»¥3å€çš„é€Ÿåº¦ç¼©å‡ï¼Œå½“ç©ºé—´è¢«åŽ‹ç¼©ã€‚ æ³¨æ„è¿™é‡Œè¯´çš„æ˜¯ï¼šå…·æœ‰3xå¼¹æ€§æ”¶ç¼©çš„æ–¹å—å°†æ¯”å…¶ä»–æ–¹å—ç¼©çŸ­3å€ã€‚è¿™å¹¶ä¸æ„å‘³ç€å®ƒå°†æ”¶ç¼©1/3çš„å®½åº¦ã€‚ ç¨åŽï¼Œæˆ‘ä»¬ä¼šæ·±å…¥äº†è§£è¿™åˆ°åº•ä¼šæ”¶ç¼©æˆ–å¢žé•¿å¤šå°‘ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹æœ€åŽä¸€ä¸ªå±žæ€§ï¼Œå¹¶æŠŠæ‰€æœ‰æ··åœ¨ä¸€èµ·ã€‚ å±žæ€§å››ï¼š Flexflex æ˜¯ grow, shrink ä»¥åŠ basis çš„ç¼©å†™ï¼Œå¤åˆå±žæ€§ã€‚ å®ƒçš„é»˜è®¤å€¼æ˜¯ 0(grow) 1ï¼ˆshrinkï¼‰auto(basis). æœ€åŽä¸€ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬ç®€åŒ–åˆ°ä¸¤ä¸ª boxs è¿™æ˜¯å®ƒä»¬çš„å±žæ€§ï¼š .square#one { flex: 2 1 300px; } .square#two { flex: 1 2 300px; } ä¸¤è€…éƒ½æœ‰ç›¸åŒçš„ flex-basiså±žæ€§ã€‚è¿™æ„å‘³ç€å¦‚æžœå®ƒä»¬éƒ½æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼ˆå®¹å™¨æ˜¯600pxåŠ ä¸Šè¾¹è·å’Œå¡«å……ç©ºé—´ï¼‰ï¼Œå®ƒä»¬éƒ½å°†æ˜¯300pxå®½åº¦ã€‚ ä½†éšç€å®¹å™¨çš„å¢žé•¿ï¼ŒSquare 1ï¼ˆå…·æœ‰æ›´é«˜çš„flex-growï¼‰å°†å¢žé•¿ä¸¤å€ã€‚éšç€ç›’å­çš„æ”¶ç¼©ï¼ŒSquare 2ï¼ˆå…·æœ‰æ›´é«˜çš„flex-shrinkï¼‰å°†ç¼©çŸ­ä¸¤å€ã€‚ å®ƒæ˜¯å¦‚ä½•å¢žé•¿å’Œæ”¶ç¼©çš„è¿™é‡Œæœ‰å¯èƒ½ä¼šæ··æ·†ï¼šå½“Square 1å¢žé•¿æ—¶ï¼Œå®ƒä¸ä¼šå¢žé•¿åˆ°Square 2çš„ä¸¤å€ã€‚åŒæ ·ï¼Œå½“Square 2ç¼©å°æ—¶ï¼Œå®ƒä¸ä¼šç¼©å°åˆ°Square 1çš„ä¸€åŠå¤§å° - å³ä½¿æ¯”çŽ‡çš„æ”¶ç¼©çŽ‡ä¸º2æ¯”1ã€‚ è¿™ä¸æ˜¯ä»–ä»¬çš„å¤§å° 2æ¯”1æˆ–1æ¯”2.è¿™æ˜¯ä»–ä»¬çš„æ”¶ç¼©å’Œå¢žé•¿çš„é€Ÿåº¦çš„æ¯”ä¾‹ã€‚ ä¸€ç‚¹æ•°å­¦è®¡ç®—å®¹å™¨çš„èµ·å§‹å¤§å°ä¸º640åƒç´ ã€‚åœ¨å®¹å™¨çš„æ¯ä¸€è¾¹å ç”¨20pxçš„å¡«å……åŽï¼Œè¿™ç•™ä¸‹äº†è¶³å¤Ÿçš„ç©ºé—´ï¼Œä¸¤ä¸ªæ–¹å—æ¢å¤åˆ°å®ƒä»¬çš„flex-basisçš„300px. å½“å®¹å™¨è®¾ç½®ä¸º430pxæ—¶ï¼Œæˆ‘ä»¬ä¸¢å¤±äº†210pxçš„ç©ºé—´ã€‚æ­£æ–¹å½¢1ï¼Œflex-shrink:1ï¼Œå¤±åŽ»70pxã€‚æ–¹å½¢2ï¼Œflex-shrink: 2ï¼Œå¤±åŽ»140pxã€‚ å½“å®¹å™¨ç¼©å°åˆ°340pxæ—¶ï¼Œæˆ‘ä»¬çŽ°åœ¨å·²ç»å¤±åŽ»äº†300åƒç´ çš„ç©ºé—´ã€‚æ–¹å—1æŸå¤±100åƒç´ ï¼Œæ–¹å—2æŸå¤±200åƒç´ . æŸå¤±çš„ç©ºé—´æ ¹æ®å®ƒä»¬å„è‡ªçš„æ”¶ç¼©çŽ‡ï¼ˆ2:1ï¼‰çš„æ¯”çŽ‡æ¥åˆ†å‰²ã€‚ flex-growåŒæ ·ã€‚å½“å®¹å™¨å¢žé•¿åˆ°940pxï¼Œæˆ‘ä»¬èŽ·å¾—äº†300pxçš„ç©ºé—´ï¼ŒSquare 1èŽ·å¾—äº†é¢å¤–çš„200pxï¼ŒSquare 2èŽ·å¾—äº†é¢å¤–çš„100pxã€‚ åœ¨ä¸Šé¢çš„GIFä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å®½åº¦å¦‚ä½•æ ¹æ®æ¯”çŽ‡è¿›è¡Œè°ƒæ•´ï¼Œå¢žé‡ï¼ˆÎ”ï¼‰æ˜¾ç¤ºä¸ŽåŸºäºŽflex-basisçš„å·®å¼‚ã€‚]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>Flexbox</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡åŠ¨å›¾ç®€å•é€šä¿—åœ°äº†è§£Flexboxçš„å·¥ä½œåŽŸç†ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2017%2F03%2F13%2Fan-animated-guide-to-flexbox-1.html</url>
    <content type="text"><![CDATA[Flexbox çš„å·¥ä½œåŽŸç†æ˜¯æ€Žæ ·çš„ï¼Œè®©æˆ‘ä»¬é€šè¿‡å½©è‰²çš„åŠ¨æ€å›¾æ¥äº†è§£ã€‚Flexbox æ‰¿è¯ºå°†æˆ‘ä»¬ä»Žå¹³åº¸çš„ css ä¸­è§£æ•‘å‡ºæ¥ï¼ˆæ¯”å¦‚åž‚ç›´å¯¹é½ï¼‰ã€‚ å¥½å§ï¼ŒFlexbox ç¡®å®žå®žçŽ°äº†è¿™ä¸€ç›®æ ‡ã€‚ä½†æ˜¯æŽŒæ¡å®ƒè¿™ç§æ–°æ¨¡å¼æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚ æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬åšä¸€äº›åŠ¨å›¾æ¥çœ‹çœ‹ Flexbox æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æž„å»ºæ›´å¥½çš„å¸ƒå±€ã€‚ Flexbox çš„åŸºæœ¬åŽŸç†å°±æ˜¯è®©å¸ƒå±€çµæ´»ç›´è§‚ã€‚ ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œè®©å®¹å™¨è‡ªå·±å†³å®šå¦‚ä½•å¹³å‡åˆ†é…å­èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬å­èŠ‚ç‚¹çš„å¤§å°å’Œå®ƒä»¬ä¹‹é—´çš„é—´éš”ã€‚ è¿™äº›åŽŸç†å¬èµ·æ¥ä¸é”™ã€‚ä¸è¿‡è¿˜æ˜¯è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®žè·µä¸­æ˜¯æ€Žæ ·çš„ã€‚ è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥ä»‹ç» Flexbox çš„ 5 ä¸ªæœ€å¸¸è§çš„åŸºæœ¬å±žæ€§ã€‚æˆ‘ä»¬å°†æŽ¢ç´¢å®ƒä»¬åšäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥æ€Žæ ·ä½¿ç”¨ï¼Œä»¥åŠå®ƒä»¬çš„çœŸå®žè¡¨çŽ°ã€‚ å±žæ€§#1: Display: Flex æœ‰å››ä¸ªä¸åŒå¤§å°çš„ div æ”¾åœ¨ä¸€ä¸ªç°è‰²å®¹å™¨ä¸­ã€‚çŽ°åœ¨ï¼Œæ¯ä¸ª div éƒ½è®¾ç½®ä¸º display: blockã€‚æ¯ä¸ª div å—éƒ½å æ®äº†æ•´è¡Œè¡Œå®½ã€‚ ä¸ºäº†åº”ç”¨ Flexbox, ä½ éœ€è¦å…ˆå°†ä½ çš„ å®¹å™¨ å˜æˆ Flex å®¹å™¨ï¼Œ å°±åƒä¸‹é¢è¿™æ ·ç®€å•ï¼š #container { display: flex; } å¹¶æ²¡æœ‰å¾ˆå¤§çš„æ”¹å˜â€”â€”çœ‹èµ·æ¥åªæ˜¯ div å—æŽ’åˆ—æˆä¸€è¡Œã€‚ä½†æ˜¯åœ¨å¹•åŽï¼Œä½ åšäº†ä¸€äº›å¾ˆå¼ºå¤§çš„äº‹ã€‚ä½ ç»™è¿™äº›æ–¹å—ä¸€ä¸ª flex ä¸Šä¸‹æ–‡ çŽ°åœ¨ä½ å¯ä»¥åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­åŽ»å®šä½ divï¼Œ è¿™æ¯”ä¼ ç»Ÿ css è¦ç®€å•å¤šäº†ã€‚ å±žæ€§#2: Flex Directionä¸€ä¸ª Flexbox å®¹å™¨æœ‰ä¸¤ä¸ªåæ ‡è½´ï¼šä¸€ä¸ªä¸»åæ ‡è½´ å’Œ ä¸€ä¸ªäº¤å‰åæ ‡è½´ã€‚é»˜è®¤çœ‹èµ·æ¥åƒè¿™æ ·: é»˜è®¤åœ°ï¼Œå…ƒç´ æŒ‰ä¸»è½´æ–¹å‘æŽ’åˆ—ï¼Œä»Žå·¦åˆ°å³ã€‚ è¿™æ˜¯å°±ä¸ºä»€ä¹ˆä½ åº”ç”¨ display: flex æ—¶ï¼Œå…ƒç´ ä¼šæ¨ªå‘æŽ’åˆ—æ˜¾ç¤ºã€‚ ç„¶è€Œ Flex-direction å¯ä»¥æ—‹è½¬ä½ çš„ä¸»è½´ã€‚ #container { display: flex; flex-direction: column; } è¿™é‡Œæœ‰ä¸ªå¾ˆé‡è¦çš„åŒºåˆ«ï¼š flex-direction: column å¹¶æ²¡æœ‰è®©æ–¹å—æŒ‰åž‚ç›´åæ ‡è½´æŽ’åˆ—ã€‚å®ƒä½¿åž‚ç›´åæ ‡è½´å˜æˆä¸»è½´ã€‚ flex-direction è¿˜æœ‰å…¶ä»–å‡ ä¸ªé€‰é¡¹ï¼š row-reverse å’Œ column-reverse å±žæ€§#3: Justify ContentJustify-content æŽ§åˆ¶å…ƒç´ åœ¨ä¸»è½´æ–¹å‘ä¸Šçš„å¯¹é½æ–¹å¼ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ·±å…¥ä¸»è½´å’Œäº¤å‰è½´çš„åŒºåˆ«ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å›žåˆ° flex-direction: row: #container { display: flex; flex-direction: row; justify-content: flex-start; } justify-content æœ‰äº”ä¸ªå¯å–å€¼ï¼š Flex-start Flex-end Center Space-between Space-around Space-around å’Œ space-between æ˜¯æœ€ä¸ç›´è§‚çš„ã€‚space-between åªåœ¨å…ƒç´ ä¹‹é—´æ’å…¥é—´éš™ï¼Œè€Œå…ƒç´ ä¸Žå®¹å™¨ä¹‹é—´åˆ™æ²¡æœ‰ã€‚ Space-around åœ¨æ–¹å—çš„æ¯ä¸€è¾¹éƒ½æ’å…¥ç›¸ç­‰çš„é—´éš™ã€‚è¿™æ„å‘³ç€ï¼Œæœ€è¾¹ä¸Šæ–¹å—ä¸Žå®¹å™¨ä¹‹é—´çš„ç©ºéš™åªæœ‰æ–¹å—ä¹‹é—´çš„ç©ºéš™çš„ä¸€åŠï¼ˆæ¯ä¸ªæ–¹å—éƒ½è´¡çŒ®ä¸é‡å çš„ç›¸ç­‰é—´éš™ï¼Œæ‰€ä»¥åŠ å€äº†ï¼‰ æœ€åŽè¦æ³¨æ„çš„æ˜¯ justify-content åªä½œç”¨åœ¨ä¸»è½´ï¼Œè€Œ flex-direction åˆ™åˆ‡æ¢ä¸»è½´æ–¹å‘ã€‚è¿™å¯¹æŽ¥ä¸‹æ¥ååˆ†é‡è¦â€¦ å±žæ€§ #4: Align Itemså¦‚æžœä½ ç†è§£äº† justify-content, align-items ç†è§£èµ·æ¥æ˜¯è½»è€Œæ˜“ä¸¾çš„ã€‚ å°±åƒ justify-content åªå¯¹ä¸»è½´èµ·ä½œç”¨ï¼Œ align-items åˆ™åªå¯¹åž‚ç›´åæ ‡è½´èµ·ä½œç”¨ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ align-items çš„å–å€¼ï¼š flex-start flex-end center stretch baseline å‰ä¸‰ä¸ªå°±å’Œ justify-content ä¸€æ ·ï¼Œæ²¡æœ‰æ‚¬å¿µã€‚ æŽ¥ä¸‹æ¥ä¸¤ä¸ªæœ‰ç‚¹éš¾ç†è§£ã€‚ stretch æ„å‘³ç€å æ»¡æ•´ä¸ªåž‚ç›´åæ ‡è½´çš„å¤§å°ã€‚ baseline è¡¨ç¤ºå…ƒç´ å¯¹é½æ®µè½æ ‡ç­¾çš„åº•éƒ¨ã€‚ ï¼ˆæ³¨æ„ï¼š align-items: stretchï¼Œå¿…é¡»å°†é«˜åº¦å±žæ€§è®¾ç½®ä¸º auto ï¼Œ å¦åˆ™å°†ä¼šè¦†ç›– stretch å±žæ€§ï¼‰ å¯¹äºŽ baseline ï¼Œå¦‚æžœåˆ é™¤æ‰€æœ‰æ®µè½æ ‡ç­¾ï¼Œå°†ä¼šå¯¹é½æ‰€æœ‰å…ƒç´ åº•éƒ¨ã€‚å°±åƒè¿™æ ·ï¼š ä¸ºäº†æ›´å¥½åœ°æ¼”ç¤ºä¸»è½´å’Œäº¤å‰è½´çš„åŒºåˆ«ï¼Œè®©æˆ‘ä»¬åˆå¹¶åº”ç”¨ justify-content å’Œ align-itemsï¼Œç„¶åŽçœ‹çœ‹ flex-direction ä¸åŒå–å€¼çš„åŒºåˆ«ï¼š å³ä½¿åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæ­£æ–¹å½¢éƒ½åž‚ç›´å’Œæ°´å¹³å±…ä¸­ï¼Œä½†ä¸¤è€…ä¸å¯äº’æ¢ã€‚ å±žæ€§#5: Align SelfAlign-self å…è®¸ä½ æ‰‹åŠ¨æŽ§åˆ¶æŒ‡å®šå…ƒç´ çš„æŽ’åˆ—æ–¹å¼ã€‚ è¿™åŸºæœ¬ä¸Šæ˜¯è¦†ç›–ä¸€ä¸ªå…ƒç´ çš„ align-items çš„å±žæ€§ã€‚æ‰€æœ‰å±žæ€§å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè™½ç„¶é»˜è®¤æ˜¯ autoï¼Œä½†æ˜¯ç»§æ‰¿å®¹å™¨çš„ align-items å±žæ€§ã€‚ #container { align-items: flex-start; } .square#one { align-self: center; } /*åªæœ‰è¿™ä¸ªæ–¹å—æ˜¯å±…ä¸­çš„*/ çœ‹çœ‹æ˜¯æ€Žæ ·çš„è¡¨çŽ°ã€‚è®¾ç½®ä¸¤ä¸ªæ–¹å—çš„ align-self å±žæ€§ï¼Œå…¶ä½™çš„è®¾ç½®æˆ align-items: center å’Œ flex-direction: rowã€‚ ç»“è®ºå³ä½¿æˆ‘ä»¬åˆšåˆšäº†è§£äº† Flexbox çš„çš®æ¯›ï¼Œè¿™äº›å‘½ä»¤åº”è¯¥è¶³ä»¥è®©æ‚¨å¤„ç†æœ€åŸºæœ¬çš„å¯¹é½æ–¹å¼ï¼Œå¹¶è®©å†…å®¹åœ¨å®¹å™¨ä¸­åž‚ç›´å¯¹é½ã€‚ ã€ç¿»è¯‘åŽŸæ–‡ã€‘ï¼š How Flexbox works â€” explained with big, colorful, animated gifs]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>Flexbox</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jséåŽ†Objectå¯¹è±¡å¯æžšä¸¾å±žæ€§ã€ä¸å¯æžšä¸¾å±žæ€§ã€åŽŸåž‹é“¾å±žæ€§å’Œè‡ªèº«å±žæ€§]]></title>
    <url>%2F2017%2F01%2F13%2Fhow-to-enumerate-object-properties.html</url>
    <content type="text"><![CDATA[jséåŽ†Objectå¯¹è±¡å¯æžšä¸¾å±žæ€§ã€ä¸å¯æžšä¸¾å±žæ€§ã€åŽŸåž‹é“¾å±žæ€§å’Œè‡ªèº«å±žæ€§åˆ©ç”¨hasOwnPropertyã€getOwnPropertyNamesã€Object.keysã€forâ€¦inéåŽ†å¯¹è±¡çš„å¯æžšä¸¾å±žæ€§ã€ä¸å¯æžšä¸¾å±žæ€§ã€åŽŸåž‹é“¾ä¸Šçš„å±žæ€§å’Œè‡ªèº«å±žæ€§ã€‚ é¦–å…ˆæ¥çœ‹çœ‹å„ç§æ–¹æ³•çš„ç”¨æ³•åŠå…¼å®¹æ€§ã€‚ hasOwnPropertyObject.prototype.hasOwnProperty(name) æ–¹æ³•ç”¨æ¥åˆ¤æ–­æŸä¸ªå¯¹è±¡æ˜¯å¦å«æœ‰æŒ‡å®šçš„è‡ªèº«å±žæ€§ï¼Œå®ƒæœ¬èº«æ˜¯å¯¹è±¡åŽŸåž‹é“¾ä¸Šçš„é»˜è®¤æ–¹æ³•ã€‚ hasOwnProperty æ–¹æ³•æ˜¯ ES3 å°±æ ‡å‡†åŒ–äº†ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒå…¼å®¹æ€§é—®é¢˜ã€‚ ä½†ç”±äºŽ hasOwnProperty æ˜¯åŽŸåž‹é“¾ä¸Šçš„æ–¹æ³•ï¼Œæ‰€ä»¥æœ‰å¯èƒ½è¢«å¯¹è±¡çš„è‡ªèº«æ–¹æ³•æ‰€å±è”½ã€‚å¦‚ï¼š var foo = { hasOwnProperty: function() { return false; }, bar: 'Here be dragons' }; foo.hasOwnProperty('bar'); // å§‹ç»ˆè¿”å›ž false // å¦‚æžœæ‹…å¿ƒè¿™ç§æƒ…å†µï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨åŽŸåž‹é“¾ä¸ŠçœŸæ­£çš„ hasOwnProperty æ–¹æ³• ({}).hasOwnProperty.call(foo, 'bar'); // true Object.prototype.hasOwnProperty.call(foo, 'bar'); // true getOwnPropertyNamesObject.getOwnPropertyNames(obj)æ–¹æ³•è¿”å›žä¸€ä¸ªç”±æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰è‡ªèº«å±žæ€§çš„å±žæ€§åï¼ˆåŒ…æ‹¬ä¸å¯æžšä¸¾å±žæ€§ï¼‰ç»„æˆçš„æ•°ç»„, è¯¥æ–¹æ³•ä¸ä¼šèŽ·å–åˆ°åŽŸåž‹é“¾ä¸Šçš„å±žæ€§ã€‚å¦‚ï¼š // çˆ¶ç±»æž„é€ å‡½æ•° function ParentClass() {} ParentClass.prototype.inheritedMethod = function() {}; // ç»§æ‰¿ var ChildClass = Object.create(ParentClass.prototype, { // ä¸å¯æžšä¸¾å±žæ€§ getFoo: { value: function() { return this.foo; }, enumerable: false } }); // è‡ªèº«å¯æžšä¸¾å±žæ€§ ChildClass.foo = 1; // å†å®šä¹‰ä¸€ä¸ªåŽŸåž‹é“¾å±žæ€§ ChildClass.prototype.prototypeMethod = function() {}; console.log(Object.getOwnPropertyNames(my_obj).sort()); // ["foo", "getFoo"] å…¼å®¹æ€§åˆ° IE9, es 5æ ‡å‡†ã€‚ Object.keys()è¿”å›žè¯¥å¯¹è±¡çš„æ‰€æœ‰å¯æžšä¸¾è‡ªèº«å±žæ€§çš„å±žæ€§åã€‚ //å…·æœ‰éšæœºé”®æŽ’åºçš„æ•°ç»„ç±»å¯¹è±¡ var an_obj = { 100: 'a', 2: 'b', 7: 'c' }; console.log(Object.keys(an_obj)); // console: ['2', '7', '100'] è¿™äº›å±žæ€§çš„é¡ºåºä¸Žæ‰‹åŠ¨éåŽ†ï¼ˆå¦‚for..inï¼‰è¯¥å¯¹è±¡å±žæ€§æ—¶çš„ä¸€è‡´ã€‚ æ³¨æ„ï¼šObject.keys å’Œ getOwnPropertyNames ï¼Œåœ¨ES5ï¼Œå¦‚æžœæ­¤æ–¹æ³•çš„å‚æ•°ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆåŽŸå§‹çš„ï¼‰ï¼Œé‚£ä¹ˆå®ƒä¼šé€ æˆ TypeErrorã€‚åœ¨ES6ï¼Œéžå¯¹è±¡çš„å‚æ•°å°†è¢«å¼ºåˆ¶è½¬æ¢ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚ Object.keys("foo"); Object.getOwnPropertyNames("foo"); // TypeError: "foo" is not an object (ES5 code) Object.keys("foo"); // ["0", "1", "2"] (ES6 code) Object.getOwnPropertyNames("foo"); // ["0", "1", "2", "length"] (ES6 code) å…¼å®¹æ€§åˆ° IE9, es 5æ ‡å‡†ã€‚ for..inæ‰‹åŠ¨éåŽ†ï¼Œå¯ä»¥éåŽ†åˆ°è‡ªèº«å’ŒåŽŸåž‹é“¾ä¸Šæ‰€æœ‰å¯æžšä¸¾çš„å±žæ€§ã€‚ åªèŽ·å–è‡ªèº«å¯æžšä¸¾å±žæ€§ ç›´æŽ¥ç”¨ Object.keys() IE9 ä»¥ä¸‹å¯ä»¥é€šè¿‡hasOwnPropertyå®žçŽ°ï¼š if (!Object.keys) Object.keys = function(o) { if (o !== Object(o)) throw new TypeError('Object.keys called on a non-object'); var k=[],p; for (p in o) if (Object.prototype.hasOwnProperty.call(o,p)) k.push(p); return k; } åªèŽ·å–è‡ªèº«ä¸å¯æžšä¸¾å±žæ€§ é€šè¿‡ Object.keys() æŽ’é™¤å¯æžšä¸¾å±žæ€§ var target = myObject; var enum_and_nonenum = Object.getOwnPropertyNames(target); // æŽ’é™¤å¯æžšä¸¾å±žæ€§ var enum_only = Object.keys(target); var nonenum_only = enum_and_nonenum.filter(function(key) { var indexInEnum = enum_only.indexOf(key); if (indexInEnum == -1) { // not found in enum_only keys mean the key is non-enumerable, // so return true so we keep this in the filter return true; } else { return false; } }); console.log(nonenum_only); é€šè¿‡propertyIsEnumerableåˆ¤æ–­ï¼Œè¯¥æ–¹æ³•è¿”å›žBooleanå€¼ï¼Œä¸å¯æžšä¸¾è¿”å›žfalseã€‚ var target = myObject; var enum_and_nonenum = Object.getOwnPropertyNames(target); var enum_only = Object.keys(target); var nonenum_only = enum_and_nonenum.filter(function(key) { // ç­›é€‰ä¸å¯æžšä¸¾å±žæ€§ return !target.propertyIsEnumerable(key) }); console.log(nonenum_only); åªèŽ·å–åŽŸåž‹é“¾ä¸Šçš„å¯æžšä¸¾å±žæ€§ ç›´æŽ¥ç”¨ for..in var o = Object.getPrototypeOf(targetObj); // è·³è¿‡éåŽ†è‡ªèº«å±žæ€§ï¼Œç›´æŽ¥ä»ŽåŽŸåž‹ä¸Šå¼€å§‹ var k=[],p; for (p in o) if (Object.prototype.hasOwnProperty.call(o,p)) k.push(p); return k; æ³¨æ„ï¼Œè¿™æ ·éåŽ†å‡ºæ¥çš„å±žæ€§ä¹Ÿä¸ä¸€å®šèƒ½è®¿é—®ï¼Œ å› ä¸ºè‡ªèº«å±žæ€§å¯èƒ½ä¼šå±è”½æŽ‰åŽŸåž‹ä¸Šçš„å±žæ€§ã€‚ åªèŽ·å–åŽŸåž‹é“¾ä¸Šçš„ä¸å¯æžšä¸¾å±žæ€§æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æžœä½¿ç”¨ getOwnPropertyNamesï¼Œåªèƒ½å•ç‹¬èŽ·å–ä¸€å±‚åŽŸåž‹é“¾ï¼Œå¿…é¡»ä¸€çº§ä¸€çº§éåŽ†å¾€ä¸Šæ‰¾ï¼Œè€Œä¸”è¿™ä¹Ÿä¸ä¸€å®šæœ‰åœºæ™¯ï¼Œå› ä¸ºåŽŸåž‹é“¾ä¸Šçš„æ–¹æ³•é‡åæ˜¯ä¼šè¢«å±è”½çš„ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>getOwnPropertyNames</tag>
        <tag>hasOwnProperty</tag>
        <tag>Object.keys</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ¯”è¾ƒinstanceofä¸ŽisPrototypeOf]]></title>
    <url>%2F2017%2F01%2F12%2Fcompare-instanceof-with-isPrototypeof.html</url>
    <content type="text"><![CDATA[æ¯”è¾ƒinstanceofä¸ŽisPrototypeOfåœ¨javascriptä¸­ï¼Œinstanceof å’Œ isPrototypeOf éƒ½å¯ä»¥åˆ¤æ–­ä¸€ä¸ªåŽŸåž‹æ˜¯å¦åœ¨å¦ä¸€ä¸ªå®žä¾‹çš„åŽŸåž‹é“¾ä¸­ï¼Œé‚£ä»–ä»¬æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œä¸ºä»€ä¹ˆè¯´ isPrototypeOf å¯ä»¥æ›¿ä»£ instanceof ã€‚ instanceof ç”¨æ³•function Super() { // init code } function Sub() { Super.call(this); // other init code } Sub.prototype = new Super(); var sub = new Sub(); å¯¹äºŽä¸Šé¢çš„ä»£ç ï¼Œç”¨ instanceof å¯ä»¥åƒè¿™æ ·ç¡®å®šä»–ä»¬çš„å…³ç³»ï¼š sub instanceof Super; // true isPrototypeOf ç”¨æ³•å¤ç”¨ä¸Šé¢çš„ä»£ç ï¼Œç”¨ isPrototypeOf å¯ä»¥è¿™æ ·å†™ï¼š Super.prototype.isPrototypeOf(sub); // true åŒºåˆ«ä¹ä¸€çœ‹ï¼Œéƒ½å¯ä»¥ç”¨ï¼Œä½†æŸç§æƒ…å†µä¸‹æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä¾‹å¦‚ï¼š var super = { // some super properties } var sub = Object.create(super); sub.someProp = 5; var sub = Object.create(sub); console.log(super.isPrototypeOf(sub)); // true console.log(sub instanceof super); // TypeError è¿™æ—¶å€™ super å¹¶ä¸æ˜¯æž„é€ å‡½æ•°ï¼Œæ— æ³•ä½¿ç”¨ instanceof, åªèƒ½ä½¿ç”¨ isPrototypeOf. ç»“è®ºç»“è®ºå°±æ˜¯ isPrototypeOf èƒ½ä½¿ç”¨çš„åœºæ™¯æ›´å¹¿ï¼Œå®Œå…¨å¯ä»¥æ›¿ä»£ instanceofï¼Œ åªæ˜¯å†™èµ·æ¥æ²¡é‚£ä¹ˆç®€æ´ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>instanceof</tag>
        <tag>isPrototypeOf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascripté€šè¿‡Vibration APIå®žçŽ°æ‰‹æœºæŒ¯åŠ¨åé¦ˆæé«˜ç”¨æˆ·ä½“éªŒ]]></title>
    <url>%2F2017%2F01%2F10%2Fuse-javascript-vibration-feedback-to-improve-user-experience.html</url>
    <content type="text"><![CDATA[javascripté€šè¿‡Vibration APIå®žçŽ°æ‰‹æœºæŒ¯åŠ¨åé¦ˆæé«˜ç”¨æˆ·ä½“éªŒç›®å‰å¤§å¤šæ•°çš„ç§»åŠ¨è®¾å¤‡å‡å…·å¤‡ç¡¬ä»¶èƒ½åŠ›æ”¯æŒæŒ¯åŠ¨ï¼Œè®©è½¯ä»¶ä»£ç é€šè¿‡ä½¿è®¾å¤‡æ‘‡æ™ƒæ¥å‘ç”¨æˆ·æä¾›ç‰©ç†åé¦ˆã€‚Vibration API ä¸º Webåº”ç”¨ç¨‹åºæä¾›è®¿é—®æ­¤ç¡¬ä»¶çš„èƒ½åŠ›ã€‚å¦‚æžœè®¾å¤‡ä¸æ”¯æŒï¼Œåˆ™ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæžœã€‚ æŒ¯åŠ¨æè¿°æŒ¯åŠ¨è¢«æŠ½è±¡æˆã€å¼€-å…³ã€‘è„‰å†²çš„æ¨¡å¼ï¼Œä¸”å¯ä»¥å…·æœ‰å˜åŒ–çš„é•¿åº¦ã€‚å‚æ•°å¯ä»¥æ˜¯å•ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæŒç»­æŒ¯åŠ¨çš„æ¯«ç§’æ•° (ms)ï¼›æˆ–å¯ç”±å¤šä¸ªæ•´æ•°ç»„æˆçš„æ•°ç»„ï¼Œè¾¾åˆ°æŒ¯åŠ¨å’Œæš‚åœå¾ªçŽ¯çš„æ•ˆæžœã€‚åªè¦å•ä¸€ window.navigator.vibrate() å‡½å¼å³å¯æŽ§åˆ¶æŒ¯åŠ¨ã€‚ å•æ¬¡æŒ¯åŠ¨ä½ å¯æŒ‡å®šå•ä¸€æ•°å€¼ï¼Œæˆ–ç”¨åªæœ‰ä¸€ä¸ªæ•°å€¼æˆå‘˜çš„æ•°ç»„ï¼Œè®©è®¾å¤‡æŒ¯åŠ¨ 1 æ¬¡ï¼š window.navigator.vibrate(200); window.navigator.vibrate([200]); ä»¥ä¸Šä¸¤ä¸ªä¾‹å­éƒ½å¯ä»¥ä½¿è®¾å¤‡æŒ¯åŠ¨ 200 ms. å¤šæ¬¡æŒ¯åŠ¨ä¸€ä¸ªæ•°ç»„çš„å€¼æè¿°äº†è£…ç½®æŒ¯åŠ¨ä¸Žä¸æŒ¯åŠ¨çš„äº¤æ›¿æ—¶é—´æ®µã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼éƒ½è½¬æ¢ä¸ºæ•´æ•°ï¼Œç„¶åŽäº¤æ›¿è§£é‡Šä¸ºè®¾å¤‡åº”è¯¥æŒ¯åŠ¨çš„æ¯«ç§’æ•°å’Œä¸æŒ¯åŠ¨çš„æ¯«ç§’æ•°ã€‚ä¾‹å¦‚: window.navigator.vibrate([200, 100, 200]); è¿™ä¼šä½¿è®¾å¤‡æŒ¯åŠ¨200 msï¼Œç„¶åŽæš‚åœ100 msï¼Œç„¶åŽå†æ¬¡æŒ¯åŠ¨è®¾å¤‡200 msã€‚ æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è®¾å®šå¤šä¸ªæŒ¯åŠ¨/æš‚åœå¯¹ï¼Œæ•°ç»„çš„å€¼å¯ä»¥æ˜¯å¶æ•°æˆ–å¥‡æ•°ä¸ªï¼› å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºŽæŒ¯åŠ¨åœ¨æ¯ä¸ªæŒ¯åŠ¨å‘¨æœŸç»“æŸæ—¶è‡ªåŠ¨åœæ­¢ï¼Œå› æ­¤æ‚¨ä¸å¿…æä¾›æœ€åŽä¸€ä¸ªå€¼åŽ»æš‚åœï¼Œæ¢å¥è¯è¯´ï¼Œæ•°ç»„é•¿åº¦åªéœ€è¦è®¾ç½®å¥‡æ•°ä¸ªã€‚ åœæ­¢æŒ¯åŠ¨å½“è°ƒç”¨ window.navigator.vibrate() çš„å‚æ•°ä¸ºã€Œ0ã€ã€ç©ºç™½æ•°ç»„ï¼Œæˆ–æ•°ç»„å…¨ä¸ºã€Œ0ã€æ—¶ï¼Œå³å¯å–æ¶ˆç›®å‰è¿›è¡Œä¸­çš„æŒ¯åŠ¨ã€‚ æŒç»­æŒ¯åŠ¨ä¸€äº›åŸºäºŽsetIntervalå’ŒclearIntervalæ“ä½œå°†å…è®¸æ‚¨åˆ›å»ºæŒç»­çš„æŒ¯åŠ¨ï¼š var vibrateInterval; // Starts vibration at passed in level function startVibrate(duration) { navigator.vibrate(duration); } // Stops vibration function stopVibrate() { // Clear interval and stop persistent vibrating if(vibrateInterval) clearInterval(vibrateInterval); navigator.vibrate(0); } // Start persistent vibration at given duration and interval // Assumes a number value is given function startPeristentVibrate(duration, interval) { vibrateInterval = setInterval(function() { startVibrate(duration); }, interval); } å½“ç„¶ä¸Šé¢çš„ä»£ç ç‰‡æ®µæ²¡æœ‰è€ƒè™‘åˆ°æŒ¯åŠ¨å‚æ•°ä¸ºæ•°ç»„æƒ…å†µ; åŸºäºŽé˜µåˆ—çš„æŒä¹…æ€§æŒ¯åŠ¨å°†éœ€è¦è®¡ç®—æ•°ç»„é¡¹çš„å’Œï¼Œå¹¶åŸºäºŽè¯¥æ•°é‡åˆ›å»ºå‘¨æœŸï¼ˆå¯èƒ½å…·æœ‰é¢å¤–çš„å»¶è¿Ÿï¼‰ã€‚ ç”ŸæˆæŒ¯åŠ¨èŠ‚å¥å¯ä»¥é€šè¿‡vibe.js toolè¿™ä¸ªå·¥å…·æ¥ç”Ÿæˆä½ éœ€è¦çš„æŒ¯åŠ¨é¢‘çŽ‡ï¼Œç„¶åŽå¤åˆ¶å®ƒåˆ°ä½ çš„ä»£ç é‡Œã€‚ libæˆ‘å†™äº†ä¸€ä¸ªå°libï¼Œæ–¹ä¾¿ä½¿ç”¨vibrate.js demo: DEMO è¯‘è‡ªï¼š MDN Vibration API]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>html5</tag>
        <tag>Vibration</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”±lodashå¼•å‡ºæ•°ç»„Arrayçš„sliceæ–¹æ³•æ€§èƒ½æŽ¢ç©¶]]></title>
    <url>%2F2016%2F11%2F25%2Fexplore-lodash-and-slice-of-Array-slice-peformance.html</url>
    <content type="text"><![CDATA[ç”±lodashå¼•å‡ºæ•°ç»„Arrayçš„sliceæ–¹æ³•æ€§èƒ½æŽ¢ç©¶lodash æºç ä¸­ï¼Œå‘çŽ°æ•°ç»„æˆªå–æ“ä½œå¹¶æ²¡æœ‰ç›´æŽ¥ä½¿ç”¨arrayçš„sliceæ–¹æ³•ï¼Œè€Œæ˜¯å†™äº†ä¸ª baseSlice æ–¹æ³•ï¼Œæ›´é‡è¦çš„æ˜¯ baseSlice æ–¹æ³•é‡Œï¼Œä¹Ÿå¹¶æ²¡æœ‰ä½¿ç”¨ slice æ–¹æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨å¾ªçŽ¯ç´¢å¼•çš„æ–¹å¼åŽ»å®žçŽ°ã€‚è¿™è®©æˆ‘é™·å…¥æ€è€ƒï¼Œéš¾é“åŽŸç”ŸArrayçš„sliceæ–¹æ³•è¿˜ä¸å¦‚å¾ªçŽ¯å¿«ï¼Ÿ lodash æºç å¦‚ä¸‹ï¼š function baseSlice(array, start, end) { var index = -1, length = array.length; if (start &lt; 0) { start = -start > length ? 0 : (length + start); } end = end > length ? length : end; if (end &lt; 0) { end += length; } length = start > end ? 0 : ((end - start) >>> 0); start >>>= 0; var result = Array(length); while (++index &lt; length) { result[index] = array[index + start]; } return result; } äºŽæ˜¯å°±å¼€å§‹å†™ä»£ç æ¯”è¾ƒï¼š æ“ä½œé•¿åº¦ä¸º100çš„æ•°ç»„ï¼Œæ‰§è¡Œ10000æ¬¡ï¼š var baseArray = []; var i = -1; while (++ i &lt; 100) { // å®šä¹‰ä¸€ä¸ª10000é•¿åº¦çš„æ•°ç»„ä»¥ä¾›ä½¿ç”¨ baseArray[i] = i; } console.time('slice with no args'); for (var i = 0; i &lt; 10000; i++){ baseArray.slice(); } console.timeEnd('slice with no args'); console.time('slice with args'); for (var i = 0; i &lt; 10000; i++){ baseArray.slice(20, 40); } console.timeEnd('slice with args'); console.time('index'); for (var i = 0; i &lt; 10000; i++){ var result = Array(100); var index = -1; var length = baseArray.length; while (++index &lt; length) { result[index] = baseArray[index]; } } console.timeEnd('index'); console.time('index with no init array'); for (var i = 0; i &lt; 10000; i++){ var result = []; var index = -1; var length = baseArray.length; while (++index &lt; 20) { result[index] = baseArray[index]; } } console.timeEnd('index with no init array'); å¯¹æ¯”ç»“æžœï¼š // chrome ç‰ˆæœ¬ 54.0.2840.98 (64-bit) slice with no args: 93.3ms slice with args: 175ms index: 365ms index with no init array: 546ms // safari ç‰ˆæœ¬ 9.0.2 (11601.3.9) slice with no args: 122.152ms slice with args: 117.181ms index: 60076.301ms index with no init array: 62055.406ms //firefox 50.0 slice with no args: 462.07ms slice with args: 442.25ms index: 194206.08ms index with no init array: 184714.59ms ç”±äºŽmac oxæ— æ³•æµ‹è¯•IE, å¯ä»¥çœ‹å‡ºï¼Œchromeæ€»ä½“è¦æ¯”safafiã€firefoxå¿«å¾ˆå¤šï¼› sliceæ–¹æ³•ä¸Šï¼Œsafariå’Œchromeå·®ä¸å¤šï¼Œ chromeä¸‹sliceæœ‰å‚æ•°æ¯”æ— å‚æ•°æ…¢ï¼› æ–°å»ºæ•°ç»„Array()å’Œ []æ€§èƒ½å·®ä¸å¤šï¼› è¿™ä¹ˆçœ‹æ¥ï¼Œé‚£ç”¨åŽŸç”Ÿ slice æ˜Žæ˜¾ä¼šæ›´å¥½ï¼Œä¸ºä»€ä¹ˆ lodash è¦ç”¨å¾ªçŽ¯ç´¢å¼•å‘¢ï¼Ÿéš¾é“æ˜¯å› ä¸ºä¸€èˆ¬åº”ç”¨æ•°ç»„éƒ½ä¸ä¼šè¿™ä¹ˆå¤§ï¼Œé‚£æ”¹æˆé•¿åº¦ä¸º100çš„æ•°ç»„è¿›è¡Œæ“ä½œï¼› // chrome slice with no args: 6ms slice with args: 4.12ms index: 5.82ms index with no init array: 7.96ms // safari slice with no args: 9.158ms slice with args: 8.432ms index: 640.311ms index with no init array: 643.174ms //firefox slice with no args: 17.56ms slice with args: 17.53ms index: 2174.15ms index with no init array: 2198.15ms å‘çŽ°ç»“è®ºå¹¶æ²¡æœ‰æ”¹å˜ã€‚ ç„¶åŽå°±å‘lodashæäº†question, å›žå¤æ˜¯ï¼š The perf wins of Array#slice vs. baseSlice depends on the size of the array. That is a minor point though as the perf of that method is not likely to be an issue. The reason we use baseSlice is because we treat arrays as dense while Array#slice will respect sparse arrays. å¤§æ¦‚æ„æ€æ˜¯ï¼Œä»–è§‰å¾—æ€§èƒ½æ²¡æœ‰å¤ªå¤§çš„å·®åˆ«ï¼ŒArray#sliceå’ŒbaseSliceæ€§èƒ½å¼ºå¼±å–å†³äºŽæ•°ç»„çš„å¤§å°ã€‚è¿™é‡Œé‡‡ç”¨baseSliceæ˜¯å› ä¸ºä»–ä»¬è¦è§†æ‰€æœ‰ä¸ºå¯†é›†æ•°æ®ï¼Œè€ŒArray#sliceä¼šå¤„ç†ç¨€ç–æ•°ç»„ã€‚ ç„¶åŽå°±æœ‰ä¸‹é¢çš„æµ‹è¯•ï¼š ä½¿ç”¨ Array#sliceå’ŒbaseSlice åˆ†åˆ«æˆªå–æ•°ç»„å…¶ä¸­ä¸€æ®µï¼Œå¾ªçŽ¯1000000æ¬¡ï¼š var baseArray = []; var i = -1; while (++ i &lt; 100000) { // å®šä¹‰ä¸€ä¸ª10000é•¿åº¦çš„æ•°ç»„ä»¥ä¾›ä½¿ç”¨,è¿™é‡Œæ•°ç»„é•¿åº¦å¹¶ä¸å½±å“æ€§èƒ½ï¼Œæ€§èƒ½å½±å“ä¸»è¦åœ¨äºŽæˆªå–çš„é•¿åº¦ã€‚ baseArray[i] = i; } console.time('slice with args'); for (var i = 0; i &lt; 1000000; i++){ baseArray.slice(0, 20); } console.timeEnd('slice with args'); console.time('index'); for (var i = 0; i &lt; 1000000; i++){ var result = Array(20); var index = -1; while (++index &lt; 20) { result[index] = baseArray[index]; } } console.timeEnd('index'); ä¸åŒæˆªå–é•¿åº¦åœ¨chromeä¸‹çš„æ•ˆæžœï¼š // æˆªå–é•¿åº¦ 20 slice with args: 110ms index: 78.9ms // æˆªå–é•¿åº¦ 30 slice with args: 114ms index: 112ms // æˆªå–é•¿åº¦ 30 slice with args: 132ms index: 146ms ç”±æ­¤çœ‹å‡ºï¼Œæˆªå–é•¿åº¦ä¸º30å·¦å³æ—¶ï¼ŒArray#sliceå’Œloopæ–¹å¼æ€§èƒ½åŸºæœ¬ä¸€æ ·ï¼Œè€Œ Array#slice åŸºæœ¬ä¸å—æˆªå–é•¿åº¦çš„å½±å“ã€‚ æ‰€ä»¥ç»“è®ºæ˜¯ï¼Œå½“é•¿åº¦ä¸º30ä»¥ä¸‹æ—¶ï¼Œlodashçš„æ–¹æ³•æ˜¯æ¯”è¾ƒé«˜æ•ˆçš„ï¼Œå½“ç„¶ï¼Œè¿™å½±å“å¾®ä¹Žå…¶å¾®ã€‚åƒ_.chunkæ–¹æ³•ï¼Œä¸€èˆ¬åœºæ™¯åˆ†ç»„éƒ½ä¸ä¼šå¤ªé•¿ã€‚ ç–‘æƒ‘æ˜¯ï¼Œå¯¹æˆ‘çš„å›žå¤çš„åŽåŠå¥æˆ‘æ²¡æ€Žä¹ˆçœ‹æ‡‚ï¼Œå¯†é›†æ•°æ®å’Œç¨€ç–æ•°æ®å¯¹è¿™æœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>lodash</tag>
        <tag>array</tag>
        <tag>slice</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Debounce and Throttle çš„å¯è§†åŒ–è§£é‡Š]]></title>
    <url>%2F2016%2F11%2F17%2FDebounce-and-Throttle-explain-visualizatly.html</url>
    <content type="text"><![CDATA[Debounce and Throttle çš„å¯è¦–åŒ–è§£é‡‹Debounce å’Œ Throttleæ˜¯ä¸¤ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ JavaScript ä¸­ä½¿ç”¨ï¼Œä»¥æé«˜æˆ‘ä»¬å¯¹æ‰§è¡ŒåŠŸèƒ½çš„æŽ§åˆ¶ï¼Œåœ¨äº‹ä»¶å¤„ç†çš„æ—¶å€™ç‰¹åˆ«æœ‰ç”¨ã€‚ æ¯”å–»è¿™ä¸¤ç§æŠ€æœ¯éƒ½å›žç­”åŒæ ·çš„é—®é¢˜â€œä¸€ä¸ªåŠŸèƒ½å¯ä»¥éšç€æ—¶é—´è¢«æŽ¨ç§»å¤šä¹…ï¼Ÿâ€ Debounceï¼šæŠŠå®ƒçœ‹æˆæ˜¯â€œå¤šä¸ªåˆ†ç»„äº‹ä»¶ä¹‹ä¸€â€ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œä½ å›žå®¶ï¼Œå†è¿›å…¥ç”µæ¢¯ï¼Œé—¨æ­£åœ¨å…³é—­â€¦â€¦ï¼Œçªç„¶ä½ çš„é‚»å±…å‡ºçŽ°åœ¨å¤§åŽ…ï¼Œå¹¶è¯•å›¾è·³ä¸Šç”µæ¢¯ã€‚è¦æœ‰ç¤¼è²Œï¼å¹¶æ‰“å¼€å¤§é—¨ï¼Œä»–è¯´ï¼šä½ ç­‰ç­‰ï¼Œè®©æˆ‘ä¸€èµ·ä¸Šã€‚ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸Žç¬¬ä¸‰äººå†æ¬¡å‘ç”Ÿï¼Œç­‰ç­‰â€¦è¿™å¯èƒ½ä¼šå»¶ç¼“å‡ºå‘å‡ åˆ†é’Ÿã€‚ Throttleï¼šæŠŠå®ƒçœ‹æˆæ˜¯ä¸€ä¸ªé˜€ï¼Œå®ƒè§„å®šäº†æ‰§è¡Œçš„æµç¨‹ã€‚æˆ‘ä»¬å¯ä»¥åˆ¤æ–­å‡½æ•°å¯ä»¥åœ¨ä¸€å®šæ—¶é—´å†…è¢«è°ƒç”¨çš„æœ€å¤§æ¬¡æ•°ã€‚å› æ­¤ï¼Œå†ç”¨ç”µæ¢¯æ¯”å–»..ä½ æœ‰è¶³å¤Ÿçš„ç¤¼è²Œï¼ŒæŒç»­10ç§’ç­‰äººï¼Œä½†ä¸€æ—¦æ—¶é—´åˆ°äº†ï¼Œä½ ä¸€å®šè¦èµ°ï¼ æ—  Debounce æˆ– Throttle äº‹ä»¶å¤„ç†ç¨‹åºå°±åƒä¸€æ¬¡åªèƒ½ä¸€ä¸ªäººç”¨çš„ç”µæ¢¯ï¼šæ²¡æœ‰é‚£ä¹ˆé«˜æ•ˆã€‚ æˆ‘å¸Œæœ›è¿™ä¸ªåæ¯”å–»å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œä½†æœ‰æ—¶è¨€è¯­å¹¶ä¸ä¼šå¯¹æŽŒæ¡è¿™äº›æ¦‚å¿µæœ‰å¤šå¤§çš„å¸®åŠ©ï¼Œæ‰€ä»¥æˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ¼”ç¤ºåŽ»ç†è§£ Debounce å’Œ Throttle æ¦‚å¿µï¼Œå¹¶æŠŠå®ƒä»¬åº”ç”¨åˆ°mousemoveäº‹ä»¶ã€‚ function elevator_departure(name){ alert(name + " was the last one. Nobody else? Let's go then"); }; var debounced_elevator_departure = $.debounce(200, false, elevator_departure); debounced_elevator_departure('John'); debounced_elevator_departure('Mike'); debounced_elevator_departure('Peter'); // You will see *only* one message, "Peter was the last one. Nobody else? Let's go then"; æˆ‘å‘çŽ°è¿™3ä¸ªäººåœ¨JavaScriptä¸­éƒ½é€šè¿‡debounceå’Œthrottleæ‰§è¡Œäº†ã€‚æˆ‘çœŸçš„å»ºè®®ä½ å…ˆè¯»ä¸€ä¸‹ Ben Alman's çš„æ–‡ç« ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ debounce å’Œ throttle. underscore å’Œ lodash æœ‰ä¸åŒçš„å®žçŽ°æ–¹å¼ï¼Œä½†å‚æ•°éƒ½æ˜¯ä¸€æ ·çš„ï¼ˆé™¤äº† throttleæ²¡æœ‰ trailingï¼‰. Underscore.js by Jeremy Ashkenas * Lodash.js by John-David Dalton * jQuery Plugin by Ben Alman. æ¼”ç¤ºè¿™é‡Œæ˜¯è§†è§‰æ¼”ç¤º: è¿™æ˜¯æˆªå›¾ï¼š æ³¨æ„ï¼š è¿™ä¸ªçš„æºä»£ç æ¼”ç¤ºåœ¨GitHubä¸Šæ‰˜ç®¡ã€‚ å¦‚æžœä½ çœ‹åˆ°åŠ¨ç”»åœ¨æµè§ˆå™¨ä¸­å¹¶ä¸æµç•…ï¼Œè¯·åœ¨ä¸€ä¸ªå•ç‹¬çš„é¡µé¢æ‰“å¼€æ¼”ç¤ºï¼Œæˆ–è€…å°è¯•åœ¨Chromeä¸­ã€‚ æˆ‘é€šè¿‡åœ¨é¼ æ ‡åŒºåŸŸ tappingæ¥åŽ»åœ¨AndroidçŽ¯å¢ƒä¸‹æ¼”ç¤ºå®ƒ æ¯ä¸ªå•å…ƒä»£è¡¨çº¦30æ¯«ç§’ï¼Œä½†JSæ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥æµè§ˆå™¨æ˜¯ä¸æ˜¯å‡†ç¡®ã€‚è¿™ä¸ªæ¼”ç¤ºå¹¶ä¸æ˜¯æƒ³æˆä¸ºä¸€ä¸ªæœ€ä½³å®žè·µï¼Œåªæ˜¯ä¸ºäº†æ›´å¥½åœ°åŽ»ç†è§£æ¦‚å¿µã€‚ å½“ä½ åšäº†setTimeoutï¼Œæ—¶é—´é—´éš”å¯èƒ½ä¸åŒï¼Œåœ¨æ¯ä¸ªæµè§ˆå™¨åœ¨4mså’Œ15msçš„ä¹‹é—´ï¼ˆå°¼å¤æ‹‰æ–¯Zakasçš„æ–‡ç« ï¼‰ï¼Œç”šè‡³æ˜¯setTimeout(fn,0)è‡³å°‘éœ€è¦4æ¯«ç§’ã€‚åœ¨å¦ä¸€æ–¹é¢ï¼Œæ—¶é—´ä¸º1æ¯«ç§’ä¸ºæœ€å°å•ä½çš„ã€‚ åœ¨mousemoveç¬¬ä¸€è¡Œä¸­çš„äº‹ä»¶ä¹Ÿæœ‰åšèŠ‚æµï¼ˆ80æ¯«ç§’ï¼‰ã€‚è¿™å¯¹ç†è§£æ¼”ç¤ºæœ‰æ‰€å¸®åŠ©ã€‚ è¦èŽ·å¾— trailingé€‰é¡¹$.throttleï¼Œä½ éœ€è¦ä¼ é€’falseã€‚ ä¸è¦å¿˜äº†ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯builderï¼Œä»–ä»¬è¿”å›žä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä½ åªéœ€è¦æ‰§è¡Œä¸€æ¬¡ã€‚ åº”ç”¨åœºæ™¯debounce æ¡ˆä¾‹ç”¨å®ƒå‡å°‘æ‰§è¡Œé¢‘ç¹çš„äº‹ä»¶ã€‚ä¾‹å­ï¼š å½“å°†è¦å¤„ç†çš„textareaçš„å¿«é€Ÿæ‰“å­—ï¼šä½ ä¸æƒ³æ‰§è¡Œå¤„ç†å‡½æ•°ï¼Œç›´åˆ°ç”¨æˆ·åœæ­¢è¾“å…¥å†æ¥å¤„ç†æ–‡æœ¬ã€‚ å½“æ•°æ®ä¿å­˜åˆ°é€šè¿‡AJAXæœåŠ¡å™¨ï¼šä½ ä¸æƒ³æ¯ç§’è°ƒç”¨éžå¸¸ç¼“æ…¢çš„é‚®ä»¶æœåŠ¡å™¨ throttle æ¡ˆä¾‹å’Œdebounce ä¸€æ ·ï¼Œä½†å¦‚æžœæƒ³æ¯éš”ä¸€æ®µæ—¶é—´å¿…é¡»æ‰§è¡Œäº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å®ƒï¼š å‡è®¾ç”¨æˆ·ä¸åœåœ°å¿«é€Ÿè¾“å…¥30ç§’ï¼Œå¯èƒ½ä½ ä¼šæƒ³æ¯5ç§’æ‰§è¡Œä¸€æ¬¡å‡½æ•°ï¼› ä¸€äº›å¯¹æ€§èƒ½æœ‰å½±å“çš„äº‹ä»¶ä½†åˆå¿…é¡»å¤„ç†ï¼šscroll, mouseweel, mousemoveã€‚ä¸€ä¸ªç®€å•çš„é¼ æ ‡æ»šè½®è¿åŠ¨å¯ä»¥åœ¨ä¸€ç§’é’Ÿå†…è§¦å‘å‡ åä¸ªäº‹ä»¶ã€‚ æœ¬æ–‡ç¿»è¯‘è‡ª Debounce and Throttle: a visual explanation ========= update on 11-21 ========= exampledebouncevar validation = _.debounce(function () { ... // æ ¡éªŒè¾“å…¥ï¼Œé€»è¾‘å¯èƒ½è¿˜ä¼šæœ‰ç‚¹å¤æ‚ }, 250) jQuery('input').keyup(validation) // è¾“å…¥å®Œæˆæˆ–åœé¡¿250msåŽæ‰åŽ»æ‰§è¡Œæ ¡éªŒï¼Œå¦‚æžœä¸åœè¾“å…¥10sï¼Œåˆ™10så†…éƒ½ä¸ä¼šè§¦å‘ /** * debounceç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºå¯é€‰å‚æ•°ï¼Œ * leadingä¸ºtrueæ—¶ï¼Œåˆ™åœ¨äº‹ä»¶å¼€å§‹æ—¶é¦–å…ˆæ‰§è¡Œä¸€æ¬¡ï¼Œ é»˜è®¤å€¼ä¸º falseï¼› * trailingä¸ºtrueæ—¶ï¼Œåˆ™åœ¨ç»“æŸæ—¶è§¦å‘, é»˜è®¤å€¼ä¸º trueï¼› * maxWaitè®¾ç½®æ¯éš”å¤šé•¿æ—¶é—´å¿…é¡»è§¦å‘ï¼› */ function foo () { ... } jQuery('input').on('keyup', _.debounce(foo, 300, { 'leading': true, // æ³¨æ„ï¼š æ‰§è¡Œçš„å‰ææ˜¯å®šæ—¶å™¨ä¸ºundefined 'trailing': false, 'maxWait': 1000 })); // debounceè¿˜å¯ä»¥è¢«å–æ¶ˆ jQuery('button').on('click', function() { validation.cancel(); }); throttlefunction mousemove () { ... } jQuery('#div').on('mousemove', _.throttle(mousemove, 100)) // æ¯100mså¿…é¡»è§¦å‘ä¸€æ¬¡ // mousemoveä¼šåœ¨å®šæ—¶å™¨å¼€å§‹æ—¶è§¦å‘, ä½†5åˆ†é’Ÿå†…ä¸ä¼šæœ‰ç¬¬äºŒæ¬¡ jQuery('#div').on('mousemove', _.throttle(mousemove, 300000, { 'leading': true, // å®šæ—¶å™¨å‰æ²¿è§¦å‘ï¼Œé»˜è®¤å€¼ä¸ºtrue 'trailing': false // å®šæ—¶å™¨åŽæ²¿è§¦å‘ï¼Œé»˜è®¤å€¼ä¸ºtrue })); // throttle åŒæ ·å¯ä»¥è¢«å–æ¶ˆ jQuery(window).on('popstate', throttled.cancel);]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>debounce</tag>
        <tag>throttle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ npm shrinkwrap æ¥ç®¡ç†é¡¹ç›®ä¾èµ–]]></title>
    <url>%2F2016%2F10%2F20%2Fuse-npm-shrinkwrap-to-manage-reference-projects.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨ npm shrinkwrap æ¥ç®¡ç†é¡¹ç›®ä¾èµ–ç®¡ç†ä¾èµ–æ˜¯ä¸€ä¸ªå¤æ‚è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­å¿…å®šä¼šé‡åˆ°çš„é—®é¢˜ã€‚ åœ¨Node.jsé¡¹ç›®å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿç»å¸¸éœ€è¦å®‰è£…å’Œå‡çº§å¯¹åº”çš„ä¾èµ–ã€‚è™½ç„¶ npm ä»¥åŠè¯­æ„åŒ–çš„ç‰ˆæœ¬å· (semantic versioning, semver) è®©å¼€å‘è¿‡ç¨‹ä¸­ä¾èµ–çš„èŽ·å–å’Œå‡çº§å˜å¾—éžå¸¸å®¹æ˜“ï¼Œ ä½†ä¸ä¸¥æ ¼çš„ç‰ˆæœ¬å·é™åˆ¶ï¼Œä¹Ÿå¸¦æ¥äº†ç‰ˆæœ¬å·çš„ä¸ç¡®å®šæ€§ã€‚ä¸»è¦çš„é—®é¢˜å¯èƒ½æœ‰ä¸‰ä¸ªï¼š npm å»ºè®®ä½¿ç”¨ semver çš„åº”ç”¨ç¨‹åºç‰ˆæœ¬ï¼Œä½†è¿™ä¹Ÿå®Œå…¨ä¾èµ–ç¬¬ä¸‰æ–¹åŒ…éµå®ˆè¿™ä¸€è§„åˆ™ã€‚å¦‚æžœä½ ä¾èµ–äºŽçš„åŒ…ä¸éµå¾ª semver ï¼Œæˆ–è€…ä¾èµ–çš„åŒ…çš„æ–°ç‰ˆæœ¬æœ‰é‡å¤§æ›´æ”¹ï¼ˆè€Œä½ ä½¿ç”¨äº† ^ çš„å®½æ³›ç‰ˆæœ¬å®‰è£…ï¼‰ï¼Œè¿™æ½œåœ¨å¯èƒ½æ˜¯ä¼šå¯¼è‡´é—®é¢˜çš„ã€‚ å¦ä¸€ä¸ªé—®é¢˜çš„å‡ºçŽ°æ˜¯ç”±äºŽ npm å®‰è£…ä¾èµ–çš„æœºåˆ¶ã€‚npm çš„å®‰è£…åŒ…æ˜¯æœ‰å±‚æ¬¡ç»“æž„çš„ï¼Œæ‰‹åŠ¨æŽ§åˆ¶è¦å®‰è£…çš„è½¯ä»¶åŒ…çš„ç‰ˆæœ¬å·å¯ä»¥å®žçŽ°ï¼Œä½†æ˜¯ä½ åªèƒ½åœ¨ package.json ä½¿ç”¨ç²¾ç¡®çš„ç‰ˆæœ¬å·æŽ§åˆ¶ä½ çš„ç›´æŽ¥ä¾èµ–åŒ…ï¼Œä½†é‚£äº›å¤šå±‚ä»¥ä¸Šçš„ä¾èµ–å°±æ²¡åŠžæ³•æŽ§åˆ¶äº†ï¼›ä¸€ä¸ªç¬¬ä¸‰æ–¹åŒ…ä¸ä¸¥è°¨çš„ç‰ˆæœ¬ä¾èµ–ç”Ÿå‘½å¯èƒ½ç ´åä½ çš„ä¾èµ–ç®¡ç†ã€‚ åœ¨å¼€å‘é˜¶æ®µæ‰§è¡Œå¾—åˆ°çš„ç‰ˆæœ¬ï¼Œå’ŒåŽç»­éƒ¨ç½²æ—¶å¾—åˆ°çš„å¯èƒ½æ˜¯ä¸ä¸€è‡´çš„ï¼Œæ›´ä¸å¯æŽ§çš„æ˜¯ï¼Œä½ ä¾èµ–çš„ç¬¬ä¸‰æ–¹åŒ…ä¹Ÿæœ‰è¿™æ ·çš„æƒ…å†µä¼šå¯¼è‡´æ½œåœ¨çš„ä¸Šçº¿é£Žé™©ã€‚ å¦‚æžœè¦æŽ§åˆ¶ä¸Šçº¿çš„é£Žé™©ï¼Œæˆ‘ä»¬å°±å¿…éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ—¶å€™ï¼Œå°±éœ€è¦ä½¿ç”¨ npm shrinkwrap è¿™ä¸ªå‘½ä»¤æ¥è§£å†³é—®é¢˜ã€‚ npm shrinkwrapnpm shrinkwrap å¯ä»¥æŒ‰ç…§å½“å‰é¡¹ç›® node_modules ç›®å½•å†…çš„å®‰è£…åŒ…æƒ…å†µç”Ÿæˆç¨³å®šçš„ç‰ˆæœ¬å·æè¿°ã€‚ æ¯”æ–¹è¯´ï¼Œæœ‰ä¸€ä¸ªåŒ… A { "name": "A", "version": "0.1.0", "dependencies": { "B": "]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>npm</tag>
        <tag>shrinkwrap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”¨Git-Hooksè¿›è¡Œè‡ªåŠ¨éƒ¨ç½²,è®©æäº¤å‘å¸ƒè‡ªåŠ¨åŒ–]]></title>
    <url>%2F2016%2F08%2F11%2FGit-Hooks.html</url>
    <content type="text"><![CDATA[ä¹‹å‰äº†è§£çš„è‡ªåŠ¨åŒ–éƒ¨ç½²éƒ½æ˜¯jekinsè¿™æ ·é›†æˆåŒ–çš„æˆç†Ÿçš„å·¥å…·ã€‚æœ€è¿‘å› ä¸ºæœ‰æœ‹å‹æäº¤ä»£ç æ—¶ï¼Œä¸æƒ³ç™»é™†æœåŠ¡å™¨æ‹‰å–ä»£ç ï¼Œæ‰äº†è§£åˆ° git hooksã€‚çœ‹æ¥è¿˜æ˜¯gitä½¿ç”¨ä¸åˆ°ä½ã€‚ä¹‹å‰ä¸€ç›´éƒ½æ˜¯æœ¬åœ°å¼€å‘å¹¶æäº¤ä»£ç ï¼Œæµ‹è¯•æ—¶ï¼Œäººå·¥ç™»é™†æµ‹è¯•æœåŠ¡å™¨åŽ»æ‹‰å–æœ€æ–°ä»£ç ã€‚ ç½‘ä¸Šèµ„æ–™è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œæœ€åŽåœ¨æœ¬æœºæµ‹è¯•æ˜¯æˆåŠŸäº†çš„ã€‚ ä¸»è¦é€‰è¦æ˜Žç™½å‡ ä¸ªå…³é”®ç‚¹ï¼š git init â€“bare post-receive æ–‡ä»¶ SSH è®¤è¯ è¿™å‡ ä¸ªéƒ½æ¯”è¾ƒå®¹æ˜“æ‰¾åˆ°èµ„æ–™ã€‚ git init â€“bareå’Œ git init ä¸ä¸€æ ·çš„æ˜¯ï¼Œgit init --bareå¹¶ä¸å­˜å‚¨å®žé™…ä»£ç ï¼Œä»“åº“æ–‡ä»¶å¤¹ä¸ä¼šçœ‹åˆ°ä»»ä½•é¡¹ç›®ä»£ç ï¼Œåè€Œç”Ÿæˆäº†ä¸€äº› .gitä¹‹å¤–çš„æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­ hooksæ–‡ä»¶å¤¹å°±æ˜¯å­˜æ”¾gitå‘½ä»¤æ“ä½œåŽéœ€è¦æ‰§è¡Œçš„è„šæœ¬ã€‚ éœ€è¦æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªæ‰§è¡Œgit init --bareä½œä¸ºè¿œç«¯ä»“åº“ï¼Œä¸€ä¸ªæ‰§è¡Œgit initä½œä¸ºæœåŠ¡å™¨é¡¹ç›®ç›®å½•ã€‚ æœ¬åœ°å¼€å‘ç›®å½•å’ŒæœåŠ¡å™¨é¡¹ç›®ç›®å½•çš„remoteéƒ½è¦æŒ‡å‘ æœåŠ¡å™¨çš„è¿œç«¯ä»“åº“ã€‚ post-receive æ–‡ä»¶post-receive æ–‡ä»¶æ˜¯git push ä¹‹åŽï¼Œæ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œè‡ªåŠ¨éƒ¨ç½²çš„è„šæœ¬ä»£ç å°±å†™åœ¨è¿™é‡Œã€‚ å¦‚ï¼š #!/bin/sh unset GIT_DIR echo "è¿œç¨‹å¼€å§‹æ›´æ–°" NowPath=`pwd` echo $NowPath DeployPath="../deploy" cd $DeployPath git pull origin master echo "è¿œç¨‹æ›´æ–°å®Œæ¯•" cd $NowPath exit 0 è¿™é‡Œæœ‰ä¸€ç‚¹æ¯”è¾ƒå®¹æ˜“å‡ºé—®é¢˜çš„å°±æ˜¯è·¯å¾„ï¼Œæœ€å¥½è¿˜æ˜¯ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚ è„šæœ¬é‡Œè¿˜å¯ä»¥åŠ å…¥ä»»ä½•æƒ³æ‰§è¡Œçš„è„šæœ¬ï¼Œæ¯”å¦‚æ‰“åŒ…ç¼–è¯‘ã€‚ ä¸è¿‡è¦æ³¨æ„ä½¿ç”¨ chmod +x post-receive æ”¹å˜ä¸€ä¸‹æƒé™ï¼ŒæœåŠ¡å™¨ç«¯çš„é…ç½®å°±åŸºæœ¬å®Œæˆäº†ã€‚ SSHè®¤è¯è¿™ä¸ªåœ¨ mac os x å’Œ linuxéƒ½æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ç”¨åˆ«äººçš„windowsé…ç½®çš„æ—¶å€™ç»å¸¸éƒ½ä¼šå‡ºçŽ°è®¤è¯å¤±è´¥ï¼Œå°±ç®—è®¤è¯æˆåŠŸäº†ï¼Œä¹Ÿæ— æ³•æ‰§è¡Œè„šæœ¬ï¼Œå¯¹è¿™ä¸ªè¿˜æ˜¯ä¸å¤ªç†Ÿæ‚‰ã€‚æˆ‘çŒœå¯èƒ½æ˜¯ cmd çš„é—®é¢˜ï¼Œssh ç™»é™†åŽè¿˜é‡åˆ°è¿‡ä¹±ç ã€‚ è¿™äº›éƒ½é…ç½®å¥½ä¹‹åŽï¼Œæœ¬åœ°å¼€å‘åªéœ€è¦æäº¤ä»£ç ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥é¢„è§ˆæœ€æ–°ä»£ç äº†ã€‚]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack-sourcemapé€‰é¡¹åº”è¯¥é€‰å“ªä¸ª]]></title>
    <url>%2F2016%2F08%2F08%2Fwebpack-sourcemap-options.html</url>
    <content type="text"><![CDATA[webpack-sourcemapé€‰é¡¹åº”è¯¥é€‰å“ªä¸ªä½¿ç”¨ webpack ä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œä½†æ˜¯æ¯æ¬¡çœ‹åˆ°åˆ«çš„é¡¹ç›®é…ç½®ï¼Œè¿˜æ˜¯ä¼šåŽ»æµè§ˆä¸€éã€‚è¿™æ¬¡åˆšå¥½çœ‹åˆ°ä¸€ä¸ª devtool: '#eval-source-map'ï¼Œå°±æœ‰äº›å¥½å¥‡ï¼Œä¹‹å‰éƒ½æ˜¯é»˜è®¤ä½¿ç”¨ #source-map å¹¶æ²¡æœ‰è¿‡å¤šåŽ»æ³¨æ„å®ƒã€‚googleä¸€ä¸‹ï¼Œå‘çŽ°è¿™ä¸ª devtool é€‰é¡¹è¿˜ä¸å°‘ï¼Œé‚£æˆ‘ä»¬åˆ°åº•é€‰å“ªä¸ªå‘¢ï¼Œå®ƒä»¬æœ‰å“ªäº›åŒºåˆ«ã€‚ å…ˆæ¥çœ‹çœ‹å®˜æ–¹æ–‡æ¡£çš„ç›¸å…³æè¿°ï¼š æœ‰æž„å»ºé€Ÿåº¦ï¼Œé‡æ–°æž„å»ºé€Ÿåº¦ï¼Œæ‰“åŒ…é€Ÿåº¦ï¼Œæ¥æº è¿™å‡ é¡¹çš„å±•ç¤ºã€‚ ç„¶åŽå¯ä»¥çœ‹çœ‹è¿™ä¸€ç¯‡æ–‡ç« ï¼Œå¯¹è¿™å‡ ä¸ªé€‰é¡¹æè¿°å¾—æ¯”è¾ƒè¯¦ç»†ï¼š https://chemzqm.me/webpack-sourcemap æ‘˜å‡ºä¸»è¦éƒ¨åˆ†ï¼š eval æ–‡æ¡£ä¸Šè§£é‡Šçš„å¾ˆæ˜Žç™½ï¼Œæ¯ä¸ªæ¨¡å—éƒ½å°è£…åˆ° eval åŒ…è£¹èµ·æ¥ï¼Œå¹¶åœ¨åŽé¢æ·»åŠ  //# sourceURL source-map è¿™æ˜¯æœ€åŽŸå§‹çš„ source-map å®žçŽ°æ–¹å¼ï¼Œå…¶å®žçŽ°æ˜¯æ‰“åŒ…ä»£ç åŒæ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„ sourcemap æ–‡ä»¶ï¼Œ å¹¶åœ¨æ‰“åŒ…æ–‡ä»¶çš„æœ«å°¾æ·»åŠ  //# sourceURL æ³¨é‡Šè¡Œå‘Šè¯‰ JS å¼•æ“Žæ–‡ä»¶åœ¨å“ªå„¿ hidden-source-map æ–‡æ¡£ä¸Šä¹Ÿè¯´äº†ï¼Œå°±æ˜¯ soucremap ä½†æ²¡æ³¨é‡Šï¼Œæ²¡æ³¨é‡Šæ€Žä¹ˆæ‰¾æ–‡ä»¶å‘¢ï¼Ÿè²Œä¼¼åªèƒ½é åŽç¼€ï¼Œè­¬å¦‚ xxx/bundle.js æ–‡ä»¶ï¼ŒæŸäº›å¼•æ“Žä¼šå°è¯•åŽ»æ‰¾ xxx/bundle.js.map inline-source-map ä¸ºæ¯ä¸€ä¸ªæ–‡ä»¶æ·»åŠ  sourcemap çš„ DataUrlï¼Œæ³¨æ„è¿™é‡Œçš„æ–‡ä»¶æ˜¯æ‰“åŒ…å‰çš„æ¯ä¸€ä¸ªæ–‡ä»¶è€Œä¸æ˜¯æœ€åŽæ‰“åŒ…å‡ºæ¥çš„ï¼ŒåŒæ—¶è¿™ä¸ª DataUrl æ˜¯åŒ…å«ä¸€ä¸ªæ–‡ä»¶å®Œæ•´ souremap ä¿¡æ¯çš„ Base64 æ ¼å¼åŒ–åŽçš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª urlã€‚ eval-source-map è¿™ä¸ªå°±æ˜¯æŠŠ eval çš„ sourceURL æ¢æˆäº†å®Œæ•´ souremap ä¿¡æ¯çš„ DataUrl cheap-source-map ä¸åŒ…å«åˆ—ä¿¡æ¯ï¼Œä¸åŒ…å« loader çš„ sourcemapï¼Œï¼ˆè­¬å¦‚ babel çš„ sourcemapï¼‰ cheap-module-source-map ä¸åŒ…å«åˆ—ä¿¡æ¯ï¼ŒåŒæ—¶ loader çš„ sourcemap ä¹Ÿè¢«ç®€åŒ–ä¸ºåªåŒ…å«å¯¹åº”è¡Œçš„ã€‚æœ€ç»ˆçš„ sourcemap åªæœ‰ä¸€ä»½ï¼Œå®ƒæ˜¯ webpack å¯¹ loader ç”Ÿæˆçš„ sourcemap è¿›è¡Œç®€åŒ–ï¼Œç„¶åŽå†æ¬¡ç”Ÿæˆçš„ã€‚ webpack ä¸ä»…æ”¯æŒè¿™ 7 ç§ï¼Œè€Œä¸”å®ƒä»¬è¿˜æ˜¯å¯ä»¥ä»»æ„ç»„åˆçš„ï¼Œå°±å¦‚æ–‡æ¡£æ‰€è¯´ï¼Œä½ å¯ä»¥è®¾ç½® souremap é€‰é¡¹ä¸º cheap-module-inline-source-mapã€‚ ç»“åˆå®˜æ–¹çš„åˆ—è¡¨æ¯”è¾ƒå’Œå¼•ç”¨çš„è¿™ç¯‡æ–‡ç« çš„ä»‹ç»ï¼Œå°±æ¯”è¾ƒå®¹æ˜“é€‰æ‹©åˆé€‚çš„é€‰é¡¹äº†ã€‚å»ºè®®å¼€å‘æ—¶ä½¿ç”¨ #cheap-module-eval-source-mapï¼Œæµ‹è¯•çŽ¯å¢ƒæˆ–çº¿ä¸Šæœ‰éœ€è¦çš„è¯ä½¿ç”¨ #cheap-module-source-map]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>å‰ç«¯æž„å»º</tag>
        <tag>sourcemap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ApplicationCacheç¦»çº¿ç¼“å­˜åšä¸€ä¸ªh5ç¦»çº¿åº”ç”¨]]></title>
    <url>%2F2016%2F06%2F30%2Fuse-ApplicationCache-to-build-html5-offline-web-app.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨ApplicationCacheç¦»çº¿ç¼“å­˜åšä¸€ä¸ªh5ç¦»çº¿åº”ç”¨åŽŸç”Ÿappå¯ä»¥ç¦»çº¿æ“ä½œï¼Œåœ¨ä»¥å‰æ˜¯ç›¸å¯¹web appçš„ä¼˜åŠ¿ï¼Œwebå¿…é¡»è”ç½‘æ‰èƒ½åˆ·æ–°ä½¿ç”¨ã€‚è™½ç„¶æ‰€æœ‰æµè§ˆå™¨éƒ½æœ‰ç¼“å­˜æœºåˆ¶ï¼Œä½†å®ƒä»¬å¹¶ä¸ä¸€å®šæ€»èƒ½èµ·åˆ°é¢„æœŸçš„ä½œç”¨ã€‚HTML5 ä½¿ç”¨ ApplicationCache æŽ¥å£è§£å†³äº†ç”±ç¦»çº¿å¸¦æ¥çš„éƒ¨åˆ†éš¾é¢˜ã€‚å³ä½¿ç”¨æˆ·åœ¨ç¦»çº¿çŠ¶æ€ä¸‹æŒ‰äº†åˆ·æ–°æŒ‰é’®ï¼Œæ‚¨çš„åº”ç”¨ä¹Ÿä¼šæ­£å¸¸åŠ è½½å’Œè¿è¡Œã€‚ ä½¿ç”¨ç¼“å­˜æŽ¥å£å¯ä¸ºæ‚¨çš„åº”ç”¨å¸¦æ¥ä»¥ä¸‹ä¸‰ä¸ªä¼˜åŠ¿ï¼š ç¦»çº¿æµè§ˆ - ç”¨æˆ·å¯åœ¨ç¦»çº¿æ—¶æµè§ˆæ‚¨çš„å®Œæ•´ç½‘ç«™ é€Ÿåº¦ - ç¼“å­˜èµ„æºä¸ºæœ¬åœ°èµ„æºï¼Œå› æ­¤åŠ è½½é€Ÿåº¦è¾ƒå¿«ã€‚ æœåŠ¡å™¨è´Ÿè½½æ›´å°‘ - æµè§ˆå™¨åªä¼šä»Žå‘ç”Ÿäº†æ›´æ”¹çš„æœåŠ¡å™¨ä¸‹è½½èµ„æºã€‚ å¼•ç”¨æ¸…å•æ–‡ä»¶manifestå±žæ€§è¦å¯ç”¨æŸä¸ªåº”ç”¨çš„åº”ç”¨ç¼“å­˜ï¼Œè¯·åœ¨æ–‡æ¡£çš„ html æ ‡è®°ä¸­æ·»åŠ  manifest å±žæ€§ï¼š &lt;!DOCTYPE html> &lt;html manifest="app.manifest"> ... &lt;/html> æ‚¨åº”åœ¨è¦ç¼“å­˜çš„ç½‘ç»œåº”ç”¨çš„æ¯ä¸ªé¡µé¢ä¸Šéƒ½æ·»åŠ  manifest å±žæ€§ã€‚å¦‚æžœç½‘é¡µä¸åŒ…å« manifest å±žæ€§ï¼Œæµè§ˆå™¨å°±ä¸ä¼šç¼“å­˜è¯¥ç½‘é¡µï¼ˆé™¤éžæ¸…å•æ–‡ä»¶ä¸­æ˜Žç¡®åˆ—å‡ºäº†è¯¥å±žæ€§ï¼‰ã€‚è¿™å°±æ„å‘³ç€ç”¨æˆ·æµè§ˆçš„æ¯ä¸ªåŒ…å« manifest çš„ç½‘é¡µéƒ½ä¼šéšå¼æ·»åŠ åˆ°åº”ç”¨ç¼“å­˜ã€‚å› æ­¤ï¼Œæ‚¨æ— éœ€åœ¨æ¸…å•ä¸­åˆ—å‡ºæ¯ä¸ªç½‘é¡µã€‚ manifest å±žæ€§å¯æŒ‡å‘ç»å¯¹ç½‘å€æˆ–ç›¸å¯¹è·¯å¾„ï¼Œä½†ç»å¯¹ç½‘å€å¿…é¡»ä¸Žç›¸åº”çš„ç½‘ç»œåº”ç”¨åŒæºã€‚ æ¸…å•æ–‡ä»¶æ ¼å¼ä¸Ž MIME ç±»åž‹è®¾ç½®æ¸…å•æ–‡ä»¶å¯ä½¿ç”¨ä»»ä½•æ–‡ä»¶æ‰©å±•åï¼Œä½†å¿…é¡»ä»¥æ­£ç¡®çš„ text/cache-manifest MIME ç±»åž‹æä¾›ã€‚ ä¸‹é¢æ˜¯å‡ ä»¶ç½‘ç»œæœåŠ¡çš„é…ç½®ä¾‹å­ï¼š Apache: æ–°å»ºæˆ–è€…ç¼–è¾‘çŽ°æœ‰çš„ .htaccess æ–‡ä»¶ï¼Œåœ¨é‡Œé¢åŠ ä¸Šä¸€è¡Œ AddType text/cache-manifest .manifest Nginx: ä¿®æ”¹ mime.types æ–‡ä»¶ï¼Œåœ¨é‡Œé¢å¢žåŠ  manifest æ–‡ä»¶çš„æ˜ å°„ text/cache-manifest manifest Tomcatï¼š ä¿®æ”¹ web.xml æ–‡ä»¶ï¼Œåœ¨é‡Œé¢å¢žåŠ  manifest text/cache-manifest æ¸…å•æ–‡ä»¶ç»“æž„åŸºæœ¬çš„æ¸…å•æ ¼å¼ï¼š CACHE MANIFEST index.html stylesheet.css images/logo.png scripts/main.js æ‚¨éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š CACHE MANIFEST å­—ç¬¦ä¸²åº”åœ¨ç¬¬ä¸€è¡Œï¼Œä¸”å¿…ä¸å¯å°‘ã€‚ ç½‘ç«™çš„ç¼“å­˜æ•°æ®é‡ä¸å¾—è¶…è¿‡ 5 MBã€‚ä¸è¿‡ï¼Œå¦‚æžœæ‚¨è¦ç¼–å†™çš„æ˜¯é’ˆå¯¹ Chrome ç½‘ä¸Šåº”ç”¨åº—çš„åº”ç”¨ï¼Œå¯ä½¿ç”¨ unlimitedStorage å–æ¶ˆè¯¥é™åˆ¶ã€‚ å¦‚æžœæ¸…å•æ–‡ä»¶æˆ–å…¶ä¸­æŒ‡å®šçš„èµ„æºæ— æ³•ä¸‹è½½ï¼Œå°±æ— æ³•è¿›è¡Œæ•´ä¸ªç¼“å­˜æ›´æ–°è¿›ç¨‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å°†ç»§ç»­ä½¿ç”¨åŽŸåº”ç”¨ç¼“å­˜ã€‚ å®Œæ•´çš„æ¸…å•æ ¼å¼ï¼š CACHE MANIFEST # daksfljs3kl23j3k43 hash ä»¥ä¾¿åšç‰ˆæœ¬æŽ§åˆ¶ # é»˜è®¤éƒ¨åˆ†ï¼Œæ˜¾å¼ç¼“å­˜è¿™äº›æ–‡ä»¶ CACHE: /favicon.ico index.html stylesheet.css images/logo.png scripts/main.js # æ­¤éƒ¨åˆ†ä¸‹åˆ—å‡ºçš„æ–‡ä»¶æ˜¯éœ€è¦è¿žæŽ¥åˆ°æœåŠ¡å™¨çš„ç™½åå•èµ„æºã€‚æ— è®ºç”¨æˆ·æ˜¯å¦å¤„äºŽç¦»çº¿çŠ¶æ€ï¼Œå¯¹è¿™äº›èµ„æºçš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šç»•è¿‡ç¼“å­˜ã€‚ NETWORK: login.php /myapi http://api.twitter.com # æ­¤éƒ¨åˆ†æ˜¯å¯é€‰çš„ï¼Œç”¨äºŽæŒ‡å®šæ— æ³•è®¿é—®èµ„æºæ—¶çš„åŽå¤‡ç½‘é¡µã€‚å…¶ä¸­ç¬¬ä¸€ä¸ª URI ä»£è¡¨èµ„æºï¼Œç¬¬äºŒä¸ªä»£è¡¨åŽå¤‡ç½‘é¡µã€‚ä¸¤ä¸ª URI å¿…é¡»ç›¸å…³ï¼Œå¹¶ä¸”å¿…é¡»ä¸Žæ¸…å•æ–‡ä»¶åŒæºã€‚ # offline.jpg will be served in place of all images in images/large/ # offline.html will be served in place of all other .html files FALLBACK: images/large/ images/offline.jpg *.html /offline.html åº”ç”¨ç¼“å­˜åªåœ¨å…¶æ¸…å•æ–‡ä»¶å‘ç”Ÿæ›´æ”¹æ—¶æ‰ä¼šæ›´æ–°ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ‚¨ä¿®æ”¹äº†å›¾ç‰‡èµ„æºæˆ–æ›´æ”¹äº† JavaScript å‡½æ•°ï¼Œè¿™äº›æ›´æ”¹ä¸ä¼šé‡æ–°ç¼“å­˜ã€‚æ‚¨å¿…é¡»ä¿®æ”¹æ¸…å•æ–‡ä»¶æœ¬èº«æ‰èƒ½è®©æµè§ˆå™¨åˆ·æ–°ç¼“å­˜æ–‡ä»¶ã€‚ è¿™äº›éƒ¨åˆ†å¯æŒ‰ä»»æ„é¡ºåºæŽ’åˆ—ï¼Œä¸”æ¯ä¸ªéƒ¨åˆ†å‡å¯åœ¨åŒä¸€æ¸…å•ä¸­é‡å¤å‡ºçŽ°; å¯ä½¿ç”¨é€šé…ç¬¦ã€‚ è¯·æ³¨æ„ï¼š HTTP ç¼“å­˜æ ‡å¤´ä»¥åŠå¯¹é€šè¿‡ SSL æä¾›çš„ç½‘é¡µè®¾ç½®çš„ç¼“å­˜é™åˆ¶å°†è¢«æ›¿æ¢ä¸ºç¼“å­˜æ¸…å•ã€‚å› æ­¤ï¼Œé€šè¿‡ https æä¾›çš„ç½‘é¡µå¯å®žçŽ°ç¦»çº¿è¿è¡Œã€‚chrome æœªæ¥å°†ä¼šç¦æ­¢éž https ç½‘é¡µä½¿ç”¨ ApplicationCache åŠŸèƒ½ï¼ˆupdated 2016-06-30ï¼‰ æ›´æ–°ç¼“å­˜åº”ç”¨åœ¨ç¦»çº¿åŽå°†ä¿æŒç¼“å­˜çŠ¶æ€ï¼Œé™¤éžå‘ç”Ÿä»¥ä¸‹æŸç§æƒ…å†µï¼š ç”¨æˆ·æ¸…é™¤äº†æµè§ˆå™¨å¯¹æ‚¨ç½‘ç«™çš„æ•°æ®å­˜å‚¨ã€‚ æ¸…å•æ–‡ä»¶ç»è¿‡ä¿®æ”¹ã€‚è¯·æ³¨æ„ï¼šæ›´æ–°æ¸…å•ä¸­åˆ—å‡ºçš„æŸä¸ªæ–‡ä»¶å¹¶ä¸æ„å‘³ç€æµè§ˆå™¨ä¼šé‡æ–°ç¼“å­˜è¯¥èµ„æºã€‚æ¸…å•æ–‡ä»¶æœ¬èº«å¿…é¡»è¿›è¡Œæ›´æ”¹ã€‚ åº”ç”¨ç¼“å­˜é€šè¿‡ç¼–ç¨‹æ–¹å¼è¿›è¡Œæ›´æ–°ã€‚ ç¼“å­˜çŠ¶æ€window.applicationCache å¯¹è±¡æ˜¯å¯¹æµè§ˆå™¨çš„åº”ç”¨ç¼“å­˜çš„ç¼–ç¨‹è®¿é—®æ–¹å¼ã€‚å…¶ status å±žæ€§å¯ç”¨äºŽæŸ¥çœ‹ç¼“å­˜çš„å½“å‰çŠ¶æ€ï¼š var appCache = window.applicationCache; switch (appCache.status) { case appCache.UNCACHED: // UNCACHED == 0 return 'UNCACHED'; break; case appCache.IDLE: // IDLE == 1 return 'IDLE'; break; case appCache.CHECKING: // CHECKING == 2 return 'CHECKING'; break; case appCache.DOWNLOADING: // DOWNLOADING == 3 return 'DOWNLOADING'; break; case appCache.UPDATEREADY: // UPDATEREADY == 4 return 'UPDATEREADY'; break; case appCache.OBSOLETE: // OBSOLETE == 5 return 'OBSOLETE'; break; default: return 'UKNOWN CACHE STATUS'; break; }; ç”¨ js è°ƒç”¨ applicationCache.update() å°†å°è¯•æ›´æ–°ç”¨æˆ·çš„ç¼“å­˜ï¼ˆå‰ææ˜¯å·²æ›´æ”¹æ¸…å•æ–‡ä»¶ï¼‰ã€‚æœ€åŽï¼Œå½“ applicationCache.status å¤„äºŽ UPDATEREADY çŠ¶æ€æ—¶ï¼Œè°ƒç”¨ applicationCache.swapCache() å³å¯å°†åŽŸç¼“å­˜æ¢æˆæ–°ç¼“å­˜ã€‚ var appCache = window.applicationCache; appCache.update(); // Attempt to update the user's cache. ... if (appCache.status == window.applicationCache.UPDATEREADY) { appCache.swapCache(); // The fetch was successful, swap in the new cache. } è¯·æ³¨æ„ï¼šä»¥è¿™ç§æ–¹å¼ä½¿ç”¨ update() å’Œ swapCache() ä¸ä¼šå‘ç”¨æˆ·æä¾›æ›´æ–°çš„èµ„æºã€‚æ­¤æµç¨‹åªæ˜¯è®©æµè§ˆå™¨æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„æ¸…å•ã€ä¸‹è½½æŒ‡å®šçš„æ›´æ–°å†…å®¹ä»¥åŠé‡æ–°å¡«å……åº”ç”¨ç¼“å­˜ã€‚å› æ­¤ï¼Œè¿˜éœ€è¦å¯¹ç½‘é¡µè¿›è¡Œä¸¤æ¬¡é‡æ–°åŠ è½½æ‰èƒ½å‘ç”¨æˆ·æä¾›æ–°çš„å†…å®¹ï¼Œå…¶ä¸­ç¬¬ä¸€æ¬¡æ˜¯èŽ·å¾—æ–°çš„åº”ç”¨ç¼“å­˜ï¼Œç¬¬äºŒæ¬¡æ˜¯åˆ·æ–°ç½‘é¡µå†…å®¹ã€‚ å¥½æ¶ˆæ¯æ˜¯ï¼Œæ‚¨å¯ä»¥é¿å…é‡æ–°åŠ è½½ä¸¤æ¬¡çš„éº»çƒ¦ã€‚è¦ä½¿ç”¨æˆ·æ›´æ–°åˆ°æœ€æ–°ç‰ˆç½‘ç«™ï¼Œå¯è®¾ç½®ç›‘å¬å™¨ï¼Œä»¥ç›‘å¬ç½‘é¡µåŠ è½½æ—¶çš„ updateready äº‹ä»¶ï¼š // Check if a new cache is available on page load. window.addEventListener('load', function(e) { window.applicationCache.addEventListener('updateready', function(e) { if (window.applicationCache.status == window.applicationCache.UPDATEREADY) { // Browser downloaded a new app cache. // Swap it in and reload the page to get the new hotness. window.applicationCache.swapCache(); if (confirm('A new version of this site is available. Load it?')) { window.location.reload(); } } else { // Manifest didn't changed. Nothing new to server. } }, false); }, false); applicationCache äº‹ä»¶äº‹ä»¶ä¼šç”¨äºŽç›‘å¬ç¼“å­˜çš„çŠ¶æ€ã€‚æµè§ˆå™¨ä¼šå¯¹ä¸‹è½½è¿›åº¦ã€åº”ç”¨ç¼“å­˜æ›´æ–°å’Œé”™è¯¯çŠ¶æ€ç­‰æƒ…å†µè§¦å‘ç›¸åº”äº‹ä»¶ã€‚ä»¥ä¸‹ä»£ç æ®µä¸ºæ¯ç§ç¼“å­˜äº‹ä»¶ç±»åž‹è®¾ç½®äº†äº‹ä»¶ç›‘å¬å™¨ï¼š var appCache = window.applicationCache; unction handleCacheEvent(e) { //... } function handleCacheError(e) { alert('Error: Cache failed to update!'); }; // Fired after the first cache of the manifest. appCache.addEventListener('cached', handleCacheEvent, false); // Checking for an update. Always the first event fired in the sequence. appCache.addEventListener('checking', handleCacheEvent, false); // An update was found. The browser is fetching resources. appCache.addEventListener('downloading', handleCacheEvent, false); // The manifest returns 404 or 410, the download failed, // or the manifest changed while the download was in progress. appCache.addEventListener('error', handleCacheError, false); // Fired after the first download of the manifest. appCache.addEventListener('noupdate', handleCacheEvent, false); // Fired if the manifest file returns a 404 or 410. // This results in the application cache being deleted. appCache.addEventListener('obsolete', handleCacheEvent, false); // Fired for each resource listed in the manifest as it is being fetched. appCache.addEventListener('progress', handleCacheEvent, false); // Fired when the manifest resources have been newly redownloaded. appCache.addEventListener('updateready', handleCacheEvent, false); å¦‚æžœæ¸…å•æ–‡ä»¶æˆ–å…¶ä¸­æŒ‡å®šçš„èµ„æºæ— æ³•ä¸‹è½½ï¼Œæ•´ä¸ªæ›´æ–°éƒ½å°†å¤±è´¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å°†ç»§ç»­ä½¿ç”¨åŽŸåº”ç”¨ç¼“å­˜ã€‚ åŽŸæ–‡ï¼š åº”ç”¨ç¼“å­˜åˆçº§ä½¿ç”¨æŒ‡å— htmlæ ‡å‡†]]></content>
      <categories>
        <category>html</category>
      </categories>
      <tags>
        <tag>ApplicationCache</tag>
        <tag>html5</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­£ç¡®æ£€æµ‹Javascriptæ•°æ®ç±»åž‹]]></title>
    <url>%2F2016%2F06%2F08%2Fhow-to-get-Javascript-type-of-variables-correctly.html</url>
    <content type="text"><![CDATA[å¦‚ä½•æ­£ç¡®æ£€æµ‹Javascriptæ•°æ®ç±»åž‹ typeofå¯¹äºŽä»»ä½•å˜é‡æ¥è¯´ï¼Œä½¿ç”¨typeof æ€»æ˜¯ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›žä»¥ä¸‹6ç§ç±»åž‹ä¹‹ä¸€ï¼š number string boolean object function undefined è¦æ³¨æ„ null ä½¿ç”¨ typeof æ£€æµ‹æ—¶è¿”å›žçš„æ˜¯ â€˜objectâ€™ å¯¹äºŽ null å¯ä»¥ä½¿ç”¨ function type(o) { return (o === null) ? 'null' : typeof(o) } constructor(æž„é€ å‡½æ•°å±žæ€§å€¼)ä½¿ç”¨ constructor å±žæ€§å¯ä»¥åˆ¤æ–­ç»å¤§éƒ¨åˆ†æ•°æ®çš„ç±»åž‹ã€‚ var a = 1; a.constructor // number var a = {}; a.constructor // object var a = []; a.constructor // array var a = true; a.constructor // boolean var a = 'true'; a.constructor // string var a = function aaa(){}; a.constructor // function ä½†æ˜¯å¯¹äºŽ undefined å’Œ null ç‰¹æ®Šå€¼ï¼Œä¸èƒ½èƒ½ä½¿ç”¨ constructor,ä¼šç›´æŽ¥æŠ›å‡ºå¼‚å¸¸ã€‚å¯ä»¥å…ˆè½¬æ¢å¸ƒå°”å€¼ï¼Œå¦‚æžœä¸º trueï¼Œåˆ™è¯´æ˜Žä¸æ˜¯ undefined å’Œnull , å†è°ƒç”¨ constructorå±žæ€§ function type(o) { return !o ? o : (o).constructor } Object.prototype.toStringä½¿ç”¨ toString() æ–¹æ³•æ£€æµ‹å¯¹è±¡ç±»åž‹æ˜¯æœ€å®‰å…¨ã€æœ€å‡†ç¡®çš„ã€‚å®ƒè¿”å›žçš„å­—ç¬¦ä¸²å½¢å¼å¦‚ä¸‹ [object class], å…¶ä¸­ï¼Œ objectè¡¨ç¤ºå¯¹è±¡çš„é€šç”¨ç±»åž‹ï¼Œclassè¡¨ç¤ºå¯¹è±¡çš„å†…éƒ¨ç±»åž‹ã€‚ ä½†æ˜¯ï¼Œè¦èŽ·å–å¯¹è±¡classå€¼çš„å”¯ä¸€æ–¹æ³•æ˜¯å¿…é¡»è°ƒç”¨ Object å¯¹è±¡å®šä¹‰çš„é»˜è®¤ toString() æ–¹æ³•ï¼Œå› ä¸ºä¸åŒå¯¹è±¡éƒ½ä¼šé¢„å®šä¹‰è‡ªå·±çš„ toString() æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æŽ¥è°ƒç”¨å¯¹è±¡çš„ toString() æ–¹æ³•ã€‚ var a = new Date() a.toString() // å½“å‰çš„UTCæ—¶é—´å­—ç¬¦ä¸² var a = new Date() Object.prototype.toString.apply(a) å®Œå–„çš„æ£€æµ‹æ–¹æ³• // è¿”å›žå€¼æœ‰ï¼š 'undefined', 'null', 'number', 'boolean', 'object', 'function', 'regexp', 'string', 'array', 'date', 'error' function typeOf(o) { var _toString = Object.prototype.toString; var _type = { 'undefined': 'undefined', 'number': 'number', 'boolean': 'boolean', 'string': 'string', '[object Function]': 'function', '[object RegExp]': 'regexp', '[object Array]': 'array', '[object Date]': 'date', '[object Error]': 'error' } return _type[typeof o] || _type[_toString.call(o)] || (o ? 'object' : 'null') }]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>typeof</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git å°è®°]]></title>
    <url>%2F2016%2F05%2F16%2Fgit-mardown.html</url>
    <content type="text"><![CDATA[æœ‰ä¸€äº›ä¸å¤ªå¸¸ç”¨çš„gitå‘½ä»¤è®°å½•ä¸‹ git amendå½“ä¸€äº›æ›´æ”¹å·²æäº¤ï¼Œå´å‘çŽ°æ¼æäº¤äº†ä¸€éƒ¨åˆ†æ–‡ä»¶ï¼Œè¿™æ—¶å°±å¯ä»¥ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥æŠŠæ¼çš„éƒ¨åˆ†è¿½åŠ åˆ°ä¸Šä¸€æ¬¡æäº¤ git add forgotten_file.rb git commit â€“â€“amend reset softåˆšåˆšæäº¤ï¼Œå´åˆå‘çŽ°åˆšæ‰çš„ä»£ç è¿˜æœ‰bugï¼Œæƒ³å†æ¬¡ä¿®æ”¹åŽå†æäº¤ git reset â€“â€“soft HEAD^ æ³¨æ„ä¸Ž git reset --hard HEAD^ ä¸åŒçš„æ˜¯ï¼Œ--softå¹¶ä¸åŒæŠŠä¸Šä¸€æ¬¡æäº¤çš„ä»£ç åˆ é™¤ï¼Œåªæ˜¯æŠŠå®ƒå˜æˆæœªæäº¤çš„çŠ¶æ€ï¼Œè€Œ--hardå´ä¼šå®Œå…¨æ’¤æ¶ˆä¸Šä¸€æ¬¡æäº¤çš„ä»£ç ã€‚ git blameå½“ä½ æƒ³æŸ¥å‡ºï¼Œä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œæ¯ä¸€è¡Œä»£ç æ˜¯è°ç¼–è¾‘çš„ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ git blame robin.md git checkout tags/v1.0å½“åˆ†æ”¯åå’Œæ ‡ç­¾åç›¸åŒæ—¶ï¼Œéœ€è¦è¿™æ ·å†™ branch_atå½“ä½ æƒ³ä»ŽæŸä¸€åŽ†å²ç‰ˆæœ¬ä¸­å¼€ä¸€ä¸ªåˆ†æ”¯ï¼Œè€Œä¸æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ä¸­å¼€åˆ†æ”¯ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š git branch test_branch eadnadk213dsafdsafkl234j32ll34l2l rebaseå½“è¿œç¨‹materåˆ†æ”¯å·²æ›´æ”¹ï¼Œ æœ¬åœ°åˆåŸºäºŽæ—§ç‰ˆæœ¬çš„masterè¿›è¡Œçš„æäº¤ï¼Œå¯ä»¥é‡æ–°æŒ‡å®šåŸºäºŽè¿œç¨‹masterï¼Œä¹‹åŽå†æäº¤ï¼Œé¿å…å†²çªæ—¶æŠŠè¿œç¨‹çš„ä»£ç merge æŽ‰ï¼š git rebase origin/master master git push origin master git reflogreflogæ˜¯gitç”¨æ¥è®°å½•å¼•ç”¨å˜åŒ–çš„ä¸€ç§æœºåˆ¶ï¼Œæ¯”å¦‚è®°å½•åˆ†æ”¯çš„å˜åŒ–æˆ–è€…æ˜¯HEADå¼•ç”¨çš„å˜åŒ–ã€‚å¯ä»¥ç”¨æ¥æŸ¥æ‰¾æ“ä½œè®°å½•ä»¥åŠæ¢å¤æ•°æ® git submodule addæ·»åŠ å¤–éƒ¨é¡¹ç›®ä¸ºå­æ¨¡å— git rebase -i]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pm2ä¸€ä¸ªå¸¦æœ‰è´Ÿè½½å‡è¡¡åŠŸèƒ½çš„Nodeåº”ç”¨çš„è¿›ç¨‹ç®¡ç†å™¨]]></title>
    <url>%2F2016%2F05%2F04%2Fpm2-Node-process-manager.html</url>
    <content type="text"><![CDATA[pm2ä¸€ä¸ªå¸¦æœ‰è´Ÿè½½å‡è¡¡åŠŸèƒ½çš„Nodeåº”ç”¨çš„è¿›ç¨‹ç®¡ç†å™¨PM2æ˜¯ä¸€ä¸ªæä¾›äº†å†…ç½®çš„è´Ÿè½½å‡è¡¡çš„Node.jsåº”ç”¨ç¨‹åºè¿›ç¨‹ç®¡ç†å™¨ã€‚å®ƒå¯ä»¥è®©ä½ ä¿æŒåº”ç”¨ç¨‹åºæ°¸è¿œåœ¨çº¿ï¼Œæ— éœ€åœæœºåœ°é‡å¯åº”ç”¨ï¼Œä¹Ÿæœ‰åŠ©äºŽç³»ç»Ÿç®¡ç†å‘˜å·¥ä½œã€‚ å®‰è£… PM2$ npm install pm2 -g å¯åŠ¨åº”ç”¨$ pm2 start app.js è¿™æ ·ï¼Œåº”ç”¨å°±å·²ç»åœ¨åŽå°å¯åŠ¨ï¼Œå¹¶è¢«ç›‘æµ‹ä¿æŒåœ¨çº¿ã€‚ æ¨¡å—ç³»ç»ŸPM2 å†…åµŒä¸€ä¸ªç®€å•å¼ºå¤§çš„æ¨¡å—ç³»ç»Ÿï¼Œå¯ä»¥ç›´æŽ¥åƒä¸‹é¢è¿™æ ·å®‰è£…æ¨¡å— $ pm2 install &lt;module_name> pm2-logrotate æ—¥å¿—ç®¡ç†åŠåˆ†å‰²æ¨¡å— pm2-webshell å¼ºå¤§çš„æµè§ˆå™¨æ¨¡æ‹Ÿç»ˆç«¯ pm2-auto-pull æŒç»­é›†æˆï¼Œè‡ªåŠ¨æ‹‰å–ä»£ç  æ›´æ–°PM2# Install latest pm2 version $ npm install pm2 -g # Save process list, exit old PM2 &amp; restore all processes $ pm2 update ä¸»è¦ç‰¹æ€§å‘½ä»¤æ¦‚è§ˆ$ npm install pm2 -g # Install PM2 $ pm2 start app.js # Start, Daemonize and auto restart application $ pm2 start app.js -i 4 # Start 4 instances of application in cluster mode # it will load balance network queries to each app $ pm2 start app.js --name="api" # Start application and name it "api" $ pm2 start app.js --watch # Restart application on file change $ pm2 start script.sh # Start bash script $ pm2 list # List all processes started with PM2 $ pm2 monit # Display memory and cpu usage of each app $ pm2 show [app-name] # Show all informations about application $ pm2 logs # Display logs of all apps $ pm2 logs [app-name] # Display logs for a specific app $ pm2 flush $ pm2 stop all # Stop all apps $ pm2 stop 0 # Stop process with id 0 $ pm2 restart all # Restart all apps $ pm2 reload all # Reload all apps in cluster mode $ pm2 gracefulReload all # Graceful reload all apps in cluster mode $ pm2 delete all # Kill and delete all apps $ pm2 delete 0 # Delete app with id 0 $ pm2 scale api 10 # Scale app with name api to 10 instances $ pm2 reset [app-name] # Reset number of restart for [app-name] $ pm2 startup # Generate a startup script to respawn PM2 on boot $ pm2 save # Save current process list $ pm2 resurrect # Restore previously save processes $ pm2 update # Save processes, kill PM2 and restore processes $ pm2 generate # Generate a sample json configuration file $ pm2 deploy app.json prod setup # Setup "prod" remote server $ pm2 deploy app.json prod # Update "prod" remote server $ pm2 deploy app.json prod revert 2 # Revert "prod" remote server by 2 $ pm2 module:generate [name] # Generate sample module with name [name] $ pm2 install pm2-logrotate # Install module (here a log rotation system) $ pm2 uninstall pm2-logrotate # Uninstall module $ pm2 publish # Increment version, git push and npm publish å¼€å¯è¿›ç¨‹çš„å¤šç§æ–¹å¼$ pm2 start app.js --watch # Restart application on file change $ pm2 start script.sh # Start bash script $ pm2 start app.js -- -a 34 # Start app and pass option -a 34 $ pm2 start app.json # Start all applications declared in app.json $ pm2 start my-python-script.py --interpreter python è¿›ç¨‹ç®¡ç†åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹ï¼š $ pm2 list ç®¡ç†è¿›ç¨‹ $ pm2 stop &lt;app_name|id|'all'|json_conf> $ pm2 restart &lt;app_name|id|'all'|json_conf> $ pm2 delete &lt;app_name|id|'all'|json_conf> æŸ¥çœ‹è¿›ç¨‹çš„è¯¦æƒ… $ pm2 describe &lt;id|app_name> CPU / å†…å­˜ç›‘æµ‹$ pm2 monit æ—¥å¿—å·¥å…·pm2 logs ['all'|'PM2'|app_name|app_id] [--err|--out] [--lines &lt;n>] [--raw] [--timestamp [format]] ä¾‹ï¼š $ pm2 logs $ pm2 logs WEB-API --err $ pm2 logs all --raw $ pm2 logs --lines 5 $ pm2 logs --timestamp "HH:mm:ss" $ pm2 logs WEB-API --lines 0 --timestamp "HH:mm" --out $ pm2 logs PM2 --timestamp $ pm2 flush // Clear all the logs å¼€æœºå¯åŠ¨PM2å¯ä»¥è‡ªåŠ¨ç”Ÿæˆå¹¶é…ç½®å¼€æœºå¯åŠ¨è„šæœ¬ï¼Œè®©æœåŠ¡å™¨åœ¨é‡å¯çš„æ—¶å€™å¯ä»¥ä¿æŒåº”ç”¨åœ¨çº¿ $ pm2 startup # auto-detect platform $ pm2 startup [platform] # render startup-script for a specific platform, the [platform] could be one of: # ubuntu|centos|redhat|gentoo|systemd|darwin|amazon æ›´å¤šæŸ¥çœ‹>>]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­è¿›ç¨‹child_processè®©Node.jså…·å¤‡å‘½ä»¤è¡Œçš„åŠŸèƒ½]]></title>
    <url>%2F2016%2F04%2F22%2Fchild-process-make-Node-js-have-bash-feature.html</url>
    <content type="text"><![CDATA[åœ¨Nodeä¸­ä½¿ç”¨å­è¿›ç¨‹çš„ç›®çš„ï¼Œæ­£æ˜¯å¸Œæœ›ä»ŽNodeåº”ç”¨ç¨‹åºä¸­é€šè¿‡å‘½ä»¤è¡Œçš„æ–¹å¼è®¿é—®è®¡ç®—æœºèµ„æºã€‚ å…±æœ‰å››ç§ä¸åŒçš„æŠ€æœ¯æ¥åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ child_process.spawnspawnæ˜¯åˆ›å»ºå­è¿›ç¨‹æœ€å¸¸è§çš„æ–¹æ³•ã€‚ä¾‹ï¼š var spawn = require('child_process').spawn, pwd = spawn('pwd'); pwd.stdout.on('data', function(data){ console.log('stdout:' + data); }); pwd.stderr.on('data', function(data){ console.log('stderr' + data); }); pwd.on('close', function(code){ console.log('child process close with code' + code); }); pwd.on('exit', function(code){ console.log('child process exit with code' + code); }); å‚æ•°ä½œä¸ºæ•°ç»„ä¼ å…¥ å­è¿›ç¨‹å¯¹ stdout å’Œ stderr ç›¸å…³äº‹ä»¶å¯ä»¥è¿›è¡Œæ•èŽ· å­è¿›ç¨‹é€€å‡ºä»£ç ä¸º 1ï¼Œè¡¨ç¤ºå‘ç”Ÿäº†é”™è¯¯ï¼›æ²¡æœ‰é”™è¯¯æ—¶ï¼Œé€€å‡ºä»£ç ä¸º 0 å°½é‡ä½¿ç”¨closeäº‹ä»¶è€Œä¸æ˜¯exitäº‹ä»¶ï¼Œåœ¨è¿›ç¨‹ç»“æŸåŽè®¿é—®å…¶æ•°æ®å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒ å¦‚ä½•ä½¿ç”¨ stdin æ ‡å‡†è¾“å…¥å¯¹è±¡å‘¢ï¼š var spawn = require('child_process').spawn, find = spawn('find', ['.', '-ls']), grep = spawn('grep', ['test']); grep.stdout.setEncoding('utf8'); find.stdout.on('data', function(data){ grep.stdin.write(data); }); grep.stdout.on('data', function(data){ console.log(data); }) ä¸Šé¢è¿™æ®µä¾‹å­æ¨¡æ‹Ÿäº†Unixç®¡é“ï¼ˆ|ï¼‰åŠŸèƒ½ï¼Œå¯ä»¥å°†ä¸€ä¸ªå‘½ä»¤çš„ç»“æžœä¼ é€’ç»™å¦ä¸€ä¸ªå‘½ä»¤ä½œä¸ºè¾“å…¥ã€‚ child_process.exec å’Œ child_process.execFileé€šè¿‡ child_process.exec å’Œ child_process.execFile æ¥å¯åŠ¨ shell æ‰§è¡Œå‘½ä»¤å¯ä»¥ç¼“å­˜å‘½ä»¤æ‰§è¡Œçš„ç»“æžœ child_process.execFile çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‘½ä»¤æˆ–æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼Œ ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰å‚æ•°åˆ—è¡¨ï¼Œ ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å›žè°ƒå‡½æ•°ï¼Œè¯¥å›žè°ƒå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼š error, stdout å’Œ stderrã€‚å¦‚æžœæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œæ‰§è¡Œç»“æžœä¼šä¿å­˜åˆ° stdoutã€‚ child_process.exec åˆ™æ²¡æœ‰å¯é€‰å‚æ•°åˆ—è¡¨ï¼Œåªæœ‰ execFile æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ã€‚ var execFile = require('child_process').execFile, child; child = execFile('ls', ['-l'], function(error, stdout, stderr){ if (error == null) { console.log('stdout: ' + stdout); } }); execFile æ–¹æ³•ä¼šæ›´å®‰å…¨ï¼Œå› ä¸ºå®ƒçš„å‘½ä»¤è¡Œå‚æ•°ä½œä¸ºæ•°ç»„ä¼ å…¥ã€‚ child_process.forkfork å…¶å®žæ˜¯å¯¹ spawnçš„å°è£…ï¼Œç›®çš„æ˜¯ä¸ºäº†å¯åŠ¨å­è¿›ç¨‹å¹¶è¿è¡Œ Node.jsæ¨¡å—ã€‚ ä¾‹ï¼š fork('./child.js') ç›¸å½“äºŽ spawn('node', ['./child.js']) æ­¤æ–¹æ³•ä¼šåœ¨çˆ¶è¿›ç¨‹ä¸Žå­è¿›ç¨‹ä¹‹é—´å»ºç«‹ä¸€ä¸ªçœŸå®žçš„é€šä¿¡ç®¡é“ï¼Œç”¨äºŽè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä½†é€šè¿‡forkç”Ÿæˆçš„æ¯ä¸ªå­è¿›ç¨‹éƒ½éœ€è¦ä¸€ä¸ªå…¨æ–°çš„ V8 å®žä¾‹ï¼Œè¿™éœ€è¦è€—è´¹æ›´å¤šæ—¶é—´å’Œå†…å­˜ã€‚ var n = child_process.fork('./child.js'); n.on('message', function(m) { console.log('PARENT got message:', m); }); n.send({ hello: 'world' }); send æ–¹æ³•ç”¨äºŽè¿›ç¨‹é—´é€šä¿¡ï¼Œ é€šè¿‡ç›‘å¬messageäº‹ä»¶æ¥èŽ·å–æ¶ˆæ¯]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
        <tag>child_process</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-v15.0å‡çº§æŒ‡å—]]></title>
    <url>%2F2016%2F04%2F19%2FReact-v15-0-upgrade-guide.html</url>
    <content type="text"><![CDATA[React-v15.0å‡çº§æŒ‡å— ä¸»è¦å˜åŒ–åŠ å…¥document.createElement å¹¶ä¸”åºŸå¼ƒ data-reactidç»è¿‡æˆ‘ä»¬è®¨è®ºï¼ŒDOM æœ‰å¾ˆå¤§çš„æ”¹å˜ã€‚å…¶ä¸­æœ€å€¼å¾—å…³æ³¨çš„ä¸€ä¸ªå˜åŒ–å°±æ˜¯ï¼Œæˆ‘ä»¬ä¸å†ç»™æ¯ä¸ª DOMè®¾ç½®data-reactidå±žæ€§ã€‚è™½ç„¶è¿™æ›´éš¾çœ‹å‡ºä¸€ä¸ªç½‘é¡µæ˜¯å¦ä½¿ç”¨äº† Reactï¼Œä½†ä¼˜åŠ¿æ˜¯DOMæ›´è½»é‡äº†ã€‚è¿™ä¸€æ”¹å˜è®©æˆ‘ä»¬ä½¿ç”¨ document.createElementæ¥åˆå§‹æ¸²æŸ“æˆä¸ºå¯èƒ½ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šç”Ÿæˆå¤§é‡çš„HTMLå­—ç¬¦ä¸²ï¼Œç„¶åŽä½¿ç”¨ node.innerHTMLæ¥æ’å…¥ã€‚å½“æ—¶ï¼Œæˆ‘ä»¬å†³å®šå°½å¿«åœ¨å¤§éƒ¨åˆ†æ¡ˆä¾‹å’Œæ”¯æŒçš„æµè§ˆå™¨ä¸­ä½¿ç”¨document.createElementã€‚æµè§ˆå™¨æŒç»­åœ°æ”¹å–„ï¼Œå› æ­¤å…¼å®¹æ‰€æœ‰æµè§ˆå™¨ä¸å†æ˜¯æ­£ç¡®çš„ã€‚ä½¿ç”¨ createElementå¯ä»¥è®©Reactçš„å…¶ä»–åŠŸèƒ½è¿è¡Œå¾—æ›´å¿«ã€‚åŽŸæ¥çš„idsç”¨æ¥æ˜ å°„Reactç»„ä»¶çš„äº‹ä»¶ï¼Œè¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å¯¹æ¯ä¸€ä¸ªäº‹ä»¶åšå¾ˆå¤šå·¥ä½œï¼Œå³ä½¿æˆ‘ä»¬å°½å¯èƒ½åœ°ç¼“å­˜è¿™äº›æ•°æ®ã€‚æ­£å¦‚æˆ‘ä»¬é‡åˆ°è¿‡çš„ï¼Œç¼“å­˜å’Œç¼“å­˜å¤±æ•ˆå¾ˆå®¹æ˜“å‡ºé”™ï¼Œæˆ‘ä»¬å‘çŽ°è®¸å¤šé—®é¢˜éƒ½æ— æ³•é‡çŽ°ã€‚çŽ°åœ¨æˆ‘ä»¬åœ¨æ¸²æŸ“çš„æ—¶å€™å¯ä»¥ç›´æŽ¥å»ºç«‹æ˜ å°„ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰äº†èŠ‚ç‚¹çš„é’©å­ã€‚ data-reactidä»ç„¶å­˜åœ¨äºŽæœåŠ¡ç«¯æ¸²æŸ“ä¸­ã€‚ä¸ç®¡æ€Žæ ·ï¼Œè¿™å·²ç»æ¯”ä»¥å‰è¦å°å¾ˆå¤šäº†ï¼Œå¹¶ä¸”è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„è‡ªå¢žè®¡æ•°å™¨ã€‚ ä¸å†æœ‰é¢å¤–çš„ æ ‡ç­¾å¦ä¸€ä¸ªå…³äºŽDOMè®¨è®ºçš„é‡å¤§å˜åŒ–æ˜¯å¦‚ä½•æ¸²æŸ“æ–‡æœ¬å—ã€‚ä¹‹å‰ä½ å¯èƒ½å…³æ³¨åˆ°Reactæ¸²æŸ“äº†å¾ˆå¤šé¢å¤–çš„æ ‡ç­¾ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨ä¸»é¡µæ¸²æŸ“Hello {this.props.name}ï¼Œç»“æžœåŒ…å«äº†ä¸¤å±‚æ ‡ç­¾ã€‚çŽ°åœ¨æˆ‘ä»¬æ¸²æŸ“æ—¶ä½¿ç”¨æ³¨é‡ŠèŠ‚ç‚¹ç©¿æ’åœ¨æ™®é€šæ–‡æœ¬å¤–æ¥åˆ’åˆ†ã€‚è¿™è®©æˆ‘ä»¬åŒæ ·æ‹¥æœ‰æ›´æ–°éƒ¨åˆ†æ–‡æœ¬çš„èƒ½åŠ›ï¼Œè€Œä¸ç”¨é¢å¤–çš„æ ‡ç­¾ã€‚å¾ˆå°‘äººä¼šè¿™äº›çœŸå®žçš„é¢å¤–æ ‡ç­¾æœ‰ä¾èµ–ï¼Œæ‰€ä»¥ä½ å¾ˆå¯ä»¥ä¸ä¼šå—åˆ°ä»»ä½•å½±å“ã€‚ä½†æ˜¯å¦‚æžœä½ åœ¨æ ·å¼æ–‡ä»¶ä¸­å¯¹æ ‡ç­¾æœ‰å®šä¹‰ï¼Œä½ å¯èƒ½éœ€è¦ä½œå‡ºç›¸åº”çš„è°ƒæ•´ã€‚ä½ ä»ç„¶å¯ä»¥åœ¨ä½ çš„ç»„ä»¶é‡Œæ˜¾å¼åœ°æŒ‡å®šæ¸²æŸ“è¿™äº›æ ‡ç­¾ã€‚ çŽ°åœ¨ä½¿ç”¨æ³¨é‡ŠèŠ‚ç‚¹æ¸²æŸ“ nullæˆ‘ä»¬è¿˜åˆ©ç”¨æ³¨é‡ŠèŠ‚ç‚¹æ¥æ¸²æŸ“nullã€‚æ¸²æŸ“nullæ˜¯æˆ‘ä»¬åœ¨React v0.11ç‰ˆæœ¬æ·»åŠ çš„ç‰¹æ€§ï¼Œå¹¶ä¸”é€šæ¥æ¸²æŸ“ å…ƒç´ æ¥åº”ç”¨ã€‚çŽ°åœ¨é€šè¿‡æ¸²æŸ“æ³¨é‡ŠèŠ‚ç‚¹ï¼Œä½ çš„æ ·å¼å¯èƒ½ä¼šæœ‰ä¸€äº›é”™ä¹±ï¼Œå°¤å…¶æ˜¯å½“ä½ ä½¿ç”¨äº†:nth-childè¿™æ ·çš„é€‰æ‹©å™¨ã€‚Reactä½¿ç”¨æ ‡ç­¾ï¼Œä¸€ç›´åœ¨è€ƒè™‘å¦‚ä½•Reactå‘½ä¸­DOMçš„å®žçŽ°ç»†èŠ‚ã€‚æˆ‘ä»¬ç›¸ä¿¡è¿™äº›å˜åŒ–æ˜¯å®‰å…¨çš„ã€‚å¦å¤–ï¼Œæˆ‘ä»¬å·²ç»åœ¨è®¸å¤šå…¸åž‹çš„åº”ç”¨ä¸­çœ‹åˆ°è¿™äº›å˜åŒ–åœ¨æå‡Reactçš„æ€§èƒ½ã€‚ ç»„ä»¶çŽ°åœ¨ä¹Ÿå¯ä»¥è¿”å›ž nullæˆ‘ä»¬åœ¨React v0.14æ·»åŠ äº†å®šä¹‰æ— çŠ¶æ€ç»„ä»¶çš„åŠŸèƒ½ã€‚ä¸ç®¡æ€Žæ ·ï¼ŒReact 0.14ä»ç„¶å…è®¸ä½ å®šä¹‰ä¸€ä¸ªéžç»§æ‰¿React.Componentæˆ–è€…ä½¿ç”¨ React.createClass()åˆ›å»ºçš„ç»„ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å‡†ç¡®åœ°åˆ¤æ–­ä½ çš„ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°è¿˜æ˜¯ä¸€ä¸ªç±»ï¼Œå¹¶ä¸”ä¹Ÿä¸å…è®¸ä½ ä»Žä¸­è¿”å›žä¸€ä¸ªnullã€‚è¿™ä¸ªé—®é¢˜åœ¨React 15ä¸­å·²ç»è§£å†³ï¼Œä½ å¯ä»¥åœ¨ä½ ä»»ä½•ç»„ä»¶ä¸­è¿”å›žnullï¼Œä¸ç®¡æ˜¯å‡½æ•°è¿˜æ˜¯ç±»ã€‚ å¢žåŠ SVGæ”¯æŒæ‰€æœ‰çš„SVGæ ‡ç­¾çŽ°åœ¨éƒ½å·²å®Œç¾Žæ”¯æŒã€‚ï¼ˆæžå°‘çš„æ ‡ç­¾åœ¨React.DOMé‡Œä¸å­˜åœ¨ï¼Œä½†JSXå’ŒReact.createElementæ”¯æŒæ‰€æœ‰æ ‡ç­¾åï¼‰ã€‚æ‰€æœ‰è¢«æµè§ˆå™¨æ”¯æŒçš„SVGå±žæ€§ä¹Ÿå…¨éƒ¨æ”¯æŒã€‚å¦‚æžœä½ å‘çŽ°å°‘äº†ä»€ä¹ˆå±žæ€§ï¼Œè¯·ç»™æˆ‘ä»¬æ issueã€‚ æœ¬æ–‡ç¿»è¯‘è‡ª React v15.0]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react-routeråŠ¨æ€è·¯ç”±ä¸Žwebpackåˆ†ç‰‡thunks]]></title>
    <url>%2F2016%2F04%2F18%2Freact-router-and-Webpack-thunks.html</url>
    <content type="text"><![CDATA[react-routeråŠ¨æ€è·¯ç”±ä¸Žwebpackåˆ†ç‰‡thunkså¯¹äºŽå¤§åž‹åº”ç”¨æ¥è¯´ï¼Œä¸€ä¸ªé¦–å½“å…¶å†²çš„é—®é¢˜å°±æ˜¯æ‰€éœ€åŠ è½½çš„ JavaScript çš„å¤§å°ã€‚ç¨‹åºåº”å½“åªåŠ è½½å½“å‰æ¸²æŸ“é¡µæ‰€éœ€çš„ JavaScriptã€‚æœ‰äº›å¼€å‘è€…å°†è¿™ç§æ–¹å¼ç§°ä¹‹ä¸ºâ€œä»£ç åˆ†æ‹†â€ â€” å°†æ‰€æœ‰çš„ä»£ç åˆ†æ‹†æˆå¤šä¸ªå°åŒ…ï¼Œåœ¨ç”¨æˆ·æµè§ˆè¿‡ç¨‹ä¸­æŒ‰éœ€åŠ è½½ã€‚ å¯¹äºŽåº•å±‚ç»†èŠ‚çš„ä¿®æ”¹ä¸åº”è¯¥éœ€è¦å®ƒä¸Šé¢æ¯ä¸€å±‚çº§éƒ½è¿›è¡Œä¿®æ”¹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸ºä¸€ä¸ªç…§ç‰‡æµè§ˆé¡µæ·»åŠ ä¸€ä¸ªè·¯å¾„ä¸åº”è¯¥å½±å“åˆ°é¦–é¡µåŠ è½½çš„ JavaScript çš„å¤§å°ã€‚ä¹Ÿä¸èƒ½å› ä¸ºå¤šä¸ªå›¢é˜Ÿå…±ç”¨ä¸€ä¸ªå¤§åž‹çš„è·¯ç”±é…ç½®æ–‡ä»¶è€Œé€ æˆåˆå¹¶æ—¶çš„å†²çªã€‚ è·¯ç”±æ˜¯ä¸ªéžå¸¸é€‚äºŽåšä»£ç åˆ†æ‹†çš„åœ°æ–¹ï¼šå®ƒçš„è´£ä»»å°±æ˜¯é…ç½®å¥½æ¯ä¸ª viewã€‚ å¦‚æžœä½ ä½¿ç”¨è¿‡å•é¡µåº”ç”¨çš„æ¡†æž¶ï¼Œé‚£ä½ å¯èƒ½åº”ç”¨è¿‡è·¯ç”±ã€‚è·¯ç”±å¯ä»¥è®©ä½ çš„åº”ç”¨çœ‹èµ·æ¥å¥½åƒæœ‰å¾ˆå¤šâ€œé¡µé¢â€ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ youdomain.com/aboutæ¥èŽ·å–å…¬å¸ç›¸å…³çš„ä»‹ç»ä¿¡æ¯ã€‚ åœ¨è¿™é‡Œä½¿ç”¨åŒå¼•å·ï¼Œæ˜¯å› ä¸ºè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šçš„â€œé¡µé¢â€ã€‚ é€šè¿‡å„ç§æµè¡Œçš„æž„å»ºå·¥å…·çš„é…ç½®ï¼Œæ‰€æœ‰çš„è„šæœ¬æœ€åŽéƒ½å¾—åˆ°è¿žæˆä¸€ç‰‡å·¨å¤§çš„.jsæ–‡ä»¶ã€‚å½“ä½ è®¿é—® youdomain.com/about è¿™ä¸ªé¡µé¢çš„æ—¶å€™ï¼Œä½ ä¼šä¸‹è½½åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å†…å®¹ã€‚ä½†ç”¨æˆ·å¯èƒ½æ ¹æœ¬ä¸æƒ³ï¼Œä¹Ÿä¸ä¼šåŽ»æµè§ˆè¿™äº›å†…å®¹ã€‚è¿™æ˜¯éžå¸¸ç³Ÿç³•çš„ï¼Œä¹Ÿä¼šè®©ä½ çš„åº”ç”¨å˜å¾—è¶Šæ¥è¶Šå¤§ã€‚ å¯¹äºŽä¸€ä¸ªä¸ä½¿ç”¨ä»»ä½•æ¡†æž¶çš„æ™®é€šç½‘é¡µï¼Œä½ é¦–å…ˆæ˜¯ä¸‹è½½ä¸€ä¸ª .html æ–‡ä»¶ï¼Œç„¶åŽæ˜¯ä»Žç¼“å­˜ä¸­èŽ·å–è„šæœ¬å’Œæ ·å¼æ–‡ä»¶ã€‚ç”¨æˆ·åªä¸‹è½½ä»–éœ€è¦çš„å†…å®¹ï¼Œä»…æ­¤è€Œå·²ã€‚ ä½ æƒ³è®©ä½ çš„React.jsåº”ç”¨ä¹ŸæŒ‰éœ€åŠ è½½å—ï¼Ÿ å‰ææ¡ä»¶ ä½¿ç”¨ react-router åšä¸ºè·¯ç”±è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºè¿™æ˜¯åŠŸèƒ½æœ€å¼ºå¤§çš„ Reactè·¯ç”±æ–¹æ¡ˆï¼› webpackä½œä¸ºæž„å»ºå·¥å…·ï¼Œå› ä¸ºå®ƒæœ‰å¼ºå¤§çš„åˆ†ç‰‡èƒ½åŠ›å’Œé½å…¨çš„åŠŸèƒ½ react-routerä¸‹é¢æ˜¯ä¸€ä¸ªå¸¸è§çš„è·¯ç”±ä¾‹å­ï¼š var HomePage = require('./HomePage.jsx'); var AboutPage = require('./AboutPage.jsx'); var FAQPage = require('./FAQPage.jsx'); &lt;Router history={history}> &lt;Route path="/" component={HomePage} /> &lt;Route path="/about" component={AboutPage} /> &lt;Route path="/faq" component={FAQPage} /> &lt;/Router> ä¸ºäº†æ–¹ä¾¿è§£é‡Šï¼Œçœç•¥äº†å¾ˆå¤šä»£ç  å¦‚æžœä¸€ä¸ªç”¨æˆ·æµè§ˆ yourdomain.com/abouté¡µé¢ï¼Œä»–å°†çœ‹åˆ°AboutPage ç»„ä»¶ï¼›å¦‚æžœæŸ¥çœ‹ yourdomain.com/faqé¡µé¢ï¼Œå°†çœ‹åˆ° FAQPageç»„ä»¶ç­‰ç­‰ã€‚å½“ä½ ä½¿ç”¨è·¯ç”±åŽ»é…ç½®ä½ çš„åº”ç”¨ï¼Œè¿™äº›ç»„ä»¶å’Œç›¸å…³ä»£ç å°†è¢«æ‰“åŒ…æˆä¸€ä¸ª.jsæ–‡ä»¶ã€‚ å€¼å¾—åº†å¹¸çš„æ˜¯ï¼Œreact-routerçš„ æ ‡ç­¾æœ‰ä¸€ä¸ªå«åšgetComponentçš„å¼‚æ­¥çš„æ–¹æ³•åŽ»èŽ·å–ç»„ä»¶ã€‚ä»–æ˜¯ä¸€ä¸ªfunctionæŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯locationå’Œcallbackã€‚å½“react-routeræ‰§è¡Œå›žè°ƒå‡½æ•° callback(null, ourComponent)æ—¶ï¼Œè·¯ç”±åªæ¸²æŸ“ourComponentç»„ä»¶ã€‚ getComponentè®©æˆ‘ä»¬æ¥é‡å†™ä¸Šé¢çš„ä¾‹å­æ¥æ”¯æŒå¼‚æ­¥ç»„ä»¶ï¼š &lt;Router history={history}> &lt;Route path="/" getComponent={(location, callback) => { // åœ¨è¿™é‡Œæ‰§è¡Œå¼‚æ­¥æ“ä½œ callback(null, HomePage); }} /> &lt;Route path="/about" getComponent={(location, callback) => { // åœ¨è¿™é‡Œæ‰§è¡Œå¼‚æ­¥æ“ä½œ callback(null, AboutPage); }} /> &lt;Route path="/faq" getComponent={(location, callback) => { // åœ¨è¿™é‡Œæ‰§è¡Œå¼‚æ­¥æ“ä½œ callback(null, FAQPage); }} /> &lt;/Router> è¿™äº›ç»„ä»¶ä¼šåœ¨éœ€è¦çš„æ—¶å€™å¼‚æ­¥åŠ è½½ã€‚è¿™äº›ç»„ä»¶ä»ç„¶ä¼šåœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”ä½ çš„åº”ç”¨çœ‹èµ·æ¥ä¸ä¼šæœ‰ä»»ä½•ä¸åŒã€‚ä½†æ˜¯æ²¡æœ‰å®ƒï¼Œæˆ‘ä»¬çš„ç½‘é¡µå°†æ— æ³•è¿è¡Œã€‚ webpackwebpack æœ‰ä¸€ä¸ªç‰¹æ€§å«åš chunkingï¼ˆåˆ†ç‰‡ï¼‰ï¼Œæ„æ€å°±æ˜¯é€šè¿‡è¾“å‡ºå¤šä¸ªæ–‡ä»¶ï¼ˆchunksï¼‰æ¥æ›¿ä»£ä¸€ä¸ªæ€»çš„å¤§çš„æ–‡ä»¶ã€‚ä½ ä»£ç é‡Œçš„åˆ†å‰²ç‚¹ï¼ˆsplit pointsï¼‰å†³å®šäº†å“ªäº›æ¨¡å—è¢«åˆ†åˆ°å“ªäº›æ–‡ä»¶é‡Œã€‚ Split Points(åˆ†å—ç‚¹)webpack æä¾›äº†å¾ˆå¤šæ–¹å¼åŽ»è®©æˆ‘ä»¬è®¾ç½®åˆ†å—ç‚¹ã€‚ä½†æœ€æœ‰ç”¨çš„ä¸€ä¸ªå°±æ˜¯ require.ensureæ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š function loadModule() { require.ensure([], function(require) { var module = require('module.js'); }, "MyModule"); } module.js æ¨¡å—å°†é€šè¿‡webpack è¾“å‡ºåœ¨ç¬¬äºŒä¸ªæ–‡ä»¶é‡Œï¼Œå¹¶ä¸”å½“æµè§ˆå™¨æ‰§è¡Œrequire.ensureçš„æ—¶å€™åŠ è½½ã€‚ï¼ˆå½“loadModuleè¢«è°ƒç”¨çš„æ—¶å€™å¹¶ä¸ä¼šåŠ è½½ï¼‰ require.ensureæ–¹æ³•çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æŒ‡å®šæ¨¡å—åç§°ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯é€‰é¡¹ï¼Œå¦‚æžœä¸å¡«ï¼Œå°†ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª IDä½œä¸ºæ–‡ä»¶åã€‚ è¿™ç¦»æˆåŠŸè¿˜å·®ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é…ç½®webpack.config.jsæ–‡ä»¶æ¥æ”¯æŒåˆ†ç‰‡thunks é…ç½®åœ¨webpack é…ç½®æ–‡ä»¶ä¸­çš„ outputé€‰é¡¹è®¾ç½®chunkFilename: output: { chunkFilename: '[name].chunk.js' } ä½ ä¹Ÿå¯ä»¥è®¾ç½®[chunkhash]å’Œ[ID]å˜é‡ä½œä¸ºåˆ†å—çš„æ–‡ä»¶åã€‚å¦‚æžœæ²¡æœ‰æŒ‡å®š[name]å˜é‡ï¼Œå°†ä¼šä½¿ç”¨ ID ä½œä¸ºåˆ†å—æ–‡ä»¶åã€‚ è¿™å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æœ‰ä¸ªé—®é¢˜ã€‚é€šç”¨çš„ä¾èµ–é€šå¸¸éƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚å¦‚æžœåœ¨ä½ åº”ç”¨çš„æ¨¡å—ä¸­ä½¿ç”¨äº†Reactï¼ŒReactå°†åŒ…å«åœ¨æ¯ä¸€ä¸ªåˆ†ç‰‡æ–‡ä»¶thunksä¸­ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ CommonsChunkPluginæ’ä»¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨ä½ çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  plugins é€‰é¡¹ï¼š plugins: [ new webpack.optimize.CommonsChunkPlugin('common.js') ] æˆ‘å–œæ¬¢ä½¿ç”¨ common.js ä½œä¸ºæ–‡ä»¶åï¼Œå› ä¸ºè¿™æ ·å¾ˆç›´è§‚ï¼Œä½†å®ƒä¹Ÿå¯ä»¥ä»»æ„æŒ‡å®šã€‚ éžå¸¸å¥½ï¼Œä»£ç åˆ†å‰²å®Œæˆã€‚è®©æˆ‘ä»¬é…åˆreact-routerä¸€èµ·ä½¿ç”¨ã€‚ æ•´åˆè¿˜è®°å¾—æˆ‘ä»¬ä¸Šé¢æåˆ°çš„å¼‚æ­¥åŠ è½½ç»„ä»¶çš„è·¯ç”±å—ï¼Ÿä¸Šé¢é€šè¿‡ requireå¼•ç”¨ HomePageç»„ä»¶ã€‚è®©æˆ‘ä»¬é…åˆä½¿ç”¨ getComponent å’Œ require.ensure æ¥å®žçŽ°æŒ‰éœ€åŠ è½½ã€‚ &lt;Route path="/" getComponent={(location, callback) => { require.ensure([], function (require) { var HomePage = require('./HomePage.jsx'); callback(null, HomePage); }, 'HomePage'); }} /> æŠŠ requireæ”¾åœ¨ callbacké‡Œæ›´ç®€æ´ï¼š &lt;Route path="/" getComponent={(location, callback) => { require.ensure([], function (require) { callback(null, require('./HomePage.jsx')); }, 'HomePage'); }} /> å®Œæ•´çš„ä»£ç å¦‚ä¸‹ï¼š &lt;Router history={history}> &lt;Route path="/" getComponent={(location, callback) => { require.ensure([], function (require) { callback(null, require('./HomePage.jsx')); }); }} /> &lt;Route path="/about" getComponent={(location, callback) => { require.ensure([], function (require) { callback(null, require('./AboutPage.jsx')); }); }} /> &lt;Route path="/faq" getComponent={(location, callback) => { require.ensure([], function (require) { callback(null, require('./FAQPage.jsx')); }); }} /> &lt;/Router> æœ¬æ–‡ç¿»è¯‘è‡ª http://blog.mxstbr.com/2016/01/react-apps-with-pages/ å‚è€ƒ http://react-guide.github.io/react-router-cn/docs/guides/advanced/DynamicRouting.html]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>react-router</tag>
        <tag>router</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå…¨å±€å¯¹è±¡ï¼šglobalã€processå’ŒBuffer]]></title>
    <url>%2F2016%2F04%2F14%2FNode-global-object-global-process-and-Buffer.html</url>
    <content type="text"><![CDATA[Nodeå…¨å±€å¯¹è±¡ï¼šglobalã€processå’ŒBufferglobalå¯¹è±¡ï¼Œä¹Ÿæ˜¯Nodeçš„å…¨å±€å‘½åç©ºé—´ï¼› processå¯¹è±¡ï¼Œå®ƒæä¾›äº†ä¸€äº›å…³é”®åŠŸèƒ½ï¼Œä¾‹å¦‚å¯¹ä¸‰ç§æ ‡å‡†I/Oæµçš„å°è£…ï¼Œä»¥åŠå°†åŒæ­¥å‡½æ•°è½¬æ¢ä¸ºå¼‚æ­¥å›žè°ƒçš„åŠŸèƒ½ï¼› Bufferç±»ï¼Œå®ƒæä¾›äº†å­˜å‚¨å’Œæ“ä½œåŽŸå§‹æ•°æ®çš„åŠŸèƒ½ï¼ŒåŒæ ·å®ƒä¹Ÿæ˜¯å…¨å±€å¯è§çš„ globalglobalä¸Žæµè§ˆå™¨ä¸­çš„windowå¯¹è±¡æ˜¯ç›¸ä¼¼çš„ï¼Œå®ƒä»¬çš„å…³å¥ä¸åŒç‚¹æ˜¯ï¼š æµè§ˆå™¨ä¸­çš„windowå¯¹è±¡æ˜¯ä¸€ä¸ªçœŸæ­£å…¨å±€çš„å¯¹è±¡ã€‚å¦‚æžœåœ¨å®¢æˆ·ç«¯ JavaScriptä¸­å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒå°†èƒ½å¤Ÿè¢«Webé¡µé¢ä»¥åŠæ¯ä¸€ä¸ªç‹¬ç«‹çš„åº“è®¿é—®åˆ°ã€‚ è€ŒNodeæ¨¡å—ä¸­åˆ›å»ºä¸€ä¸ªé¡¶å±‚å˜é‡ï¼ˆå‡½æ•°ä¹‹å¤–çš„å˜é‡ï¼‰ï¼Œå®ƒä»…ä»…åœ¨è¯¥æ¨¡å—ä¸­æ˜¯å…¨å±€çš„ï¼Œè€Œåœ¨å…¶ä»–æ¨¡å—ä¸­æ˜¯ä¸å¯è§çš„ã€‚åªæœ‰é‚£äº›è¢«æ¨¡å—æ˜¾å¼å¯¼å‡ºçš„éƒ¨åˆ†æ‰èƒ½è¢«å¼•ç”¨è¯¥æ¨¡å—çš„åº”ç”¨ç¨‹åºæ‰€ä½¿ç”¨ã€‚ è¿™æ„å‘³ç€ï¼Œç”±äºŽä¸å°å¿ƒä½¿ç”¨äº†é‡å¤çš„å…¨å±€å˜é‡åç§°è€Œå¼•èµ·çš„æ•°æ®å†²çªé—®é¢˜å°†ä¼šå¤§å¤§å‡å°‘ã€‚ processæ¯ä¸ªNodeåº”ç”¨ç¨‹åºéƒ½æ˜¯ä¸€ä¸ªprocesså¯¹è±¡å®žä¾‹ï¼Œæ‰€ä»¥ï¼Œåº”ç”¨ç¨‹åºè‡ªç„¶èƒ½ç›´æŽ¥ä½¿ç”¨æŸäº›å†…å»ºäºŽ process å¯¹è±¡çš„åŠŸèƒ½ã€‚ process.execPath æ–¹æ³•å¯ä»¥è¿”å›žå½“å‰ Node åº”ç”¨ç¨‹åºçš„æ‰§è¡Œè·¯å¾„ process.version æä¾›äº† Node ç‰ˆæœ¬ä¿¡æ¯ process.platform æä¾›æœåŠ¡å™¨å¹³å°ä¿¡æ¯ process.memoryUsage æ–¹æ³•å¯ä»¥æŸ¥è¯¢å½“å‰Node åº”ç”¨ç¨‹åºçš„å†…å­˜ä½¿ç”¨é‡ process.nextTick æ–¹æ³• è¿™ä¸ªæ–¹æ³•å¯ä»¥å°†ä¸€ä¸ªå›žè°ƒå‡½æ•°æŒ‚è½½åˆ°Nodeç¨‹åºçš„äº‹ä»¶å¾ªçŽ¯æœºåˆ¶ä¸­ï¼Œå¹¶åœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªçŽ¯å‘ç”Ÿæ—¶è°ƒç”¨è¯¥å‡½æ•°ã€‚ ä¾‹ï¼š function asynchFunction = function (data, cb) { process.nextTick(function () { cb(val) }) } è™½ç„¶ä½¿ç”¨ setTimout æ–¹æ³•å¹¶ä¼ å…¥ä¸€ä¸ª0æ¯«ç§’çš„å»¶è¿Ÿå¯ä»¥è¿‡åˆ°åŒæ ·çš„ç›®çš„ setTimout(function () { cb(val) }, 0) ä½†æ˜¯ï¼ŒsetTimoutå¹¶ä¸åƒ process.nextTické‚£æ ·é«˜æ•ˆï¼Œprocess.nextTickçš„è°ƒç”¨é€Ÿåº¦è¿œè¿œå¿«äºŽsetTimoutæ–¹æ³• é¦–å…ˆä½ éœ€è¦å°†è€—æ—¶çš„å¤„ç†è¿‡å’Œæ‰“æ•£å¹¶åˆ†è§£æˆå¤šä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†åˆ†åˆ«é€šè¿‡ process.nextTickè°ƒç”¨ï¼Œæœ€ç»ˆä½¿å¾—åº”ç”¨ç¨‹åºå¯ä»¥å¯¹å…¶ä»–è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œè€Œæ— éœ€ç­‰å¾…è€—æ—¶è®¡ç®—è¿‡ç¨‹å®Œæˆã€‚ BufferBuffer æ˜¯ç”¨äºŽå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ä¸€ç§æ–¹å¼ã€‚ æµå¤„ç†å¾€å¾€é‡‡ç”¨çš„æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œéžå­—ç¬¦ä¸² Buffer æ”¯æŒçš„ç¼–ç æ–¹å¼åŒ…æ‹¬ï¼š ascii ä¸ƒä½ ASCII utf8 å¤šå­—èŠ‚ç¼–ç çš„ Unicode å­—ç¬¦ usc2 ä¸¤å­—èŠ‚ï¼Œlittle endian æ–¹å¼ç¼–ç çš„ Unicode å­—ç¬¦ base64 Base64 ç¼–ç  hex æ¯ä¸ªå­—èŠ‚ç¼–ç ä¸ºä¸¤ä¸ªåå…­è¿›åˆ¶å­—ç¬¦]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeä¸ŽREPL]]></title>
    <url>%2F2016%2F04%2F13%2FREPL-of-node.html</url>
    <content type="text"><![CDATA[è¿™å‡ ä¸ªæœˆï¼ŒæœèŠ½å‰ç«¯å›¢é˜Ÿæžäº†Reactjs+Reduxé¡¹ç›®ï¼Œåœ¨å¾ˆå¤šæ—¶å€™ï¼Œæ¯”å¦‚éƒ¨ç½²ï¼Œéƒ½éœ€è¦ä½¿ç”¨Nodeï¼Œè‹¦äºŽæˆ‘çš„è‚¤æµ…ï¼ŒäºŽæ˜¯å†³å®šè¡¥ä¸€ä¸‹åŠŸè¯¾ã€‚æœ€è¿‘éƒ½ä¼šè®°å½•ä¸€äº› Nodeç›¸å…³çš„ç¬”è®°ã€‚ Node çš„ä¼˜åŠ¿ åº”ç”¨ç¨‹åºå¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰©å±•ï¼Œå› ä¸ºæ‰§è¡Œä¸€ä¸ªå•çº¿ç¨‹å¹¶ä¸ä¼šæœ‰éžå¸¸å¤§çš„å¼€é”€ æ— éœ€è¯‰æ±‚äºŽå¤šçº¿ç¨‹å¼€å‘ï¼Œå´è¾¾åˆ°äº†èŠ‚çº¦åˆèƒ½é«˜æ•ˆä½¿ç”¨èµ„æºçš„ç›®çš„ã€‚æ¢å¥è¯è¯´ï¼Œä½ ä¸å¿…åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„åº”ç”¨ç¨‹åºã€‚ å…¨å±€å˜é‡åœ¨ Node ä¸­æ˜¯éžå¸¸å±é™©çš„ï¼Œç‰¹åˆ«æ˜¯ä½ å¿˜è®° varå…³é”®å­—çš„æ—¶å€™ã€‚ REPLREPL(read-eval-print-loop) æ˜¯Nodeçš„ä¸€ä¸ªäº¤äº’å¼ç»„ä»¶ã€‚åœ¨ REPLçŽ¯å¢ƒä¸‹è¾“å…¥çš„ä»»ä½•å†…å®¹éƒ½ç”±åº•å±‚çš„ V8 Javascriptå¼•æ“Žè¿›è¡Œå¤„ç†ã€‚ ä¸€äº›æ“ä½œæŠ€å·§ _(ä¸‹åˆ’çº¿) å¯ä»¥è°ƒç”¨ä¸Šä¸€ä¸ªè¡¨è¾¾å¼ ä¸Šä¸‹é”®ä»ç„¶å¯ä»¥å¿«æ·è¾“å…¥åŽ†å²å‘½ä»¤, Tab é”®è‡ªåŠ¨è¡¥å…¨ å¯ä»¥ä½¿ç”¨é‡å¤çš„ .(ç‚¹) æ¥å¤„ç†å¤šè¡Œè¡¨è¾¾å¼ï¼Œå¦‚ï¼š>var test = function() { ...return val = x * y ...}; undefined é€€å‡º REPLçŽ¯å¢ƒçš„æ–¹å¼æœ‰ï¼š Ctrl + Cä¸¤æ¬¡ Ctrl + D .exit REPL å‘½ä»¤ .break å¦‚æžœå¤šè¡Œè¾“å…¥å‘ç”Ÿæ··ä¹±ä¸çŸ¥é“å½“å‰ä½ç½®æ—¶ï¼Œä½¿ç”¨ .breakä¼šé‡æ–°å¼€å§‹ã€‚ä¸è¿‡ä¼šä¸¢å¤±ä¹‹å‰è¾“å…¥çš„å¤šè¡Œå†…å®¹ã€‚ .clear é‡ç½®è¯­å¢ƒå¹¶æ¸…ç©ºæ‰€æœ‰è¡¨è¾¾å¼ã€‚è¯¥å‘½ä»¤å¯ä»¥ä½¿ä½ é‡å¤´å†æ¥ã€‚ .exit é€€å‡º REPL .help æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„REPLå‘½ä»¤ã€‚ .save å°†å½“å‰REPLä¼šè¯ä¿å­˜è‡³æ–‡ä»¶ .load å°†æ–‡ä»¶åŠ è½½åˆ°å½“å‰ä¼šè¯ å®šåˆ¶ REPLé¦–å…ˆéœ€è¦å¼•å…¥ REPL æ¨¡å—ï¼š var repl = require('repl'); é€šè¿‡åœ¨replå¯¹è±¡ä¸Šè°ƒç”¨ startæ–¹æ³•åˆ›å»ºæ–°çš„ REPLï¼š repl.start([prompt], [stream], [eval], [useGlobal], [ignoreUndefinded]); æ‰€æœ‰å‚æ•°éƒ½å¯é€‰ã€‚ prompt Default is > é»˜è®¤å€¼ä¸º > stream é»˜è®¤å€¼ä¸ºprocess.stdin eval evalçš„é»˜è®¤å€¼æ˜¯ async useGlobal é»˜è®¤å€¼ä¸º false, æ–°å»ºä¸€ä¸ªè¯­å¢ƒè€Œä¸æ˜¯ä½¿ç”¨å…¨å±€å¯¹è±¡ã€‚ ignoreUndefinded é»˜è®¤å€¼ä¸º falseã€‚ ä¸è¦å¿½ç•¥undefinedçš„è¿”å›žå€¼ã€‚ æ‰€ä»¥è®©REPLåœ¨è¡¨è¾¾å¼æ— è¿”å›žå€¼æ—¶ä¸è¾“å‡ºundefinedå¯ä»¥è¿™æ ·å®žçŽ°ï¼š repl = require('repl'); // è®¾ç½® `ignoreUndefinded` ä¸º `true` , å¯åŠ¨ `REPL` repl.start('>', null, null, null, true);]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[postCSS å¸¸ç”¨æ’ä»¶]]></title>
    <url>%2F2016%2F04%2F10%2FpostCSS-plugins.html</url>
    <content type="text"><![CDATA[postCSSå¸¸ç”¨æ’ä»¶PostCSSæ‹¥æœ‰éžå¸¸å¤šçš„æ’ä»¶ï¼Œè¯¸å¦‚è‡ªåŠ¨ä¸ºCSSæ·»åŠ æµè§ˆå™¨å‰ç¼€çš„æ’ä»¶autoprefixerã€å½“å‰ç§»åŠ¨ç«¯æœ€å¸¸ç”¨çš„pxè½¬remæ’ä»¶px2remï¼Œè¿˜æœ‰æ”¯æŒå°šæœªæˆä¸ºCSSæ ‡å‡†ä½†ç‰¹å®šå¯ç”¨çš„æ’ä»¶cssnextï¼Œè¿˜æœ‰å¾ˆå¤šå¾ˆå¤šã€‚å°±è¿žè‘—åçš„Bootstrapåœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬Bootstrap 5ä¹Ÿå°†ä½¿ç”¨PostCSSä½œä¸ºæ ·å¼çš„åŸºç¡€ã€‚ ä¸€å¥è¯æ¥æ¦‚æ‹¬PostCSSï¼šCSSç¼–è¯‘å™¨èƒ½å¤Ÿåšåˆ°çš„äº‹æƒ…ï¼Œå®ƒä¹Ÿå¯ä»¥åšåˆ°ï¼Œè€Œä¸”èƒ½å¤Ÿåšå¾—æ›´å¥½ PostCSSæ€§èƒ½åœ¨PostCSSå®˜æ–¹æŽ¨ç‰¹ä¸Šçœ‹åˆ°ï¼Œç”±JavaScriptç¼–å†™çš„PostCSSæ¯”C++ç¼–å†™çš„libsassè¿˜è¦å¿«3å€. å¦‚æžœä½ å¯¹ä¸Šé¢çš„æ€§èƒ½æˆªå›¾æœ‰ç–‘é—®ï¼Œå¯ä»¥äº²è‡ªæ¥è¿™é‡Œæµ‹è¯•çœ‹çœ‹ã€‚ å¸¸ç”¨çš„æ’ä»¶autoprefixeré¦–å…ˆæ˜¯æœ€ç«çš„å®˜æ–¹æ’ä»¶ autoprefixer ã€‚autoprefixer æ˜¯ä¸ºæˆ‘ä»¬çš„ css æ·»åŠ å‰ç¼€çš„æ’ä»¶ï¼Œå®ƒçš„æ•°æ®æ¥æºäºŽ Can I useã€‚ç›®çš„æ˜¯è®©æˆ‘ä»¬å†™çº¯ç²¹çš„ cssã€‚ä¾‹ï¼š a { display: flex; } ä¼šç¼–è¯‘æˆï¼š a { display: -webkit-box; display: -webkit-flex; display: -ms-flexbox; display: flex } Optionsé€šè¿‡ autoprefixer(options) é…ç½®ï¼š var plugin = autoprefixer({ browsers: ['> 1%', 'IE 7'], cascade: false }); browsers (array): æŒ‡å®šä½ éœ€è¦æ”¯æŒçš„æµè§ˆå™¨åˆ—è¡¨ã€‚å¯ä»¥ç›´æŽ¥æŒ‡å®šæµè§ˆå™¨ç‰ˆæœ¬ï¼ˆå¦‚ IE 7ï¼‰,ä¹Ÿå¯ä»¥ä½¿ç”¨é€‰é¡¹ï¼ˆå¦‚ï¼š last 2 version æˆ– > 5%ï¼‰,å…·ä½“é€‰é¡¹å¯ä»¥æŸ¥çœ‹ Browserslist cascade (boolean): should Autoprefixer use Visual Cascade, if CSS is uncompressed. Default: true add (boolean): æ˜¯å¦æ·»åŠ æµè§ˆå™¨å…¼å®¹å‰ç¼€. é»˜è®¤å€¼æ˜¯true. remove (boolean): æ˜¯å¦åŽ»é™¤æ— ç”¨çš„æµè§ˆå™¨å…¼å®¹å‰ç¼€. é»˜è®¤å€¼æ˜¯true. supports (boolean): should Autoprefixer add prefixes for @supports parameters. Default is true. flexbox (boolean|string): should Autoprefixer add prefixes for flexbox properties. With â€œno-2009â€ value Autoprefixer will add prefixes only for final and IE versions of specification. Default is true. grid (boolean): should Autoprefixer add IE prefixes for Grid Layout properties. Default is true. stats (object): custom usage statistics for > 10% in my stats browsers query. è°ƒè¯•info() æ–¹æ³•å¯ç”¨äºŽæŸ¥çœ‹è°ƒè¯•ä¿¡æ¯.å¯ä»¥åƒä¸‹é¢è¿™æ ·æŸ¥çœ‹å“ªäº›æµè§ˆå™¨è¢«é€‰ä¸­ä»¥åŠå“ªäº›å±žæ€§è¢«æ·»åŠ å…¼å®¹å‰ç¼€ï¼š var info = autoprefixer({ browsers: ['last 1 version'] }).info(); console.log(info); postcss-safe-parserpostcss-safe-parser å¯ä»¥å¸®ä½ æŸ¥æ‰¾å¹¶ä¿®è¡¥CSSè¯­æ³•é”™è¯¯ã€‚ cssnanocssnano æ˜¯æ¨¡å—åŒ–çš„CSSåŽ‹ç¼©å™¨ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æž„å»º</tag>
        <tag>loader</tag>
        <tag>postCSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[postCSS-loaderé…ç½®,è®©csséšå¿ƒæ‰€æ¬²]]></title>
    <url>%2F2016%2F04%2F09%2FpostCSS-loader-configs.html</url>
    <content type="text"><![CDATA[postCSS-loaderé…ç½®,è®©csséšå¿ƒæ‰€æ¬²ç»„ä»¶å¿…ä¸å¯å°‘çš„ä¸€éƒ¨åˆ†å°±æ˜¯ cssï¼Œè¿™é‡Œçœ‹ä¸‹å…³äºŽ cssçš„ä¸€äº› loadersã€‚ PostCSSPostCSS å®˜ç½‘æ˜¯è¿™ä¹ˆä»‹ç»è‡ªå·±çš„ï¼š PostCSS is a tool for transforming styles with JS plugins. These plugins can lint your CSS, support variables and mixins, transpile future CSS syntax, inline images, and more. ä»–æ˜¯ä¸€æ¬¾é€šè¿‡ JS æ’ä»¶è½¬æ¢ styles æ ·å¼çš„å·¥å…·ã€‚ åœ¨ webpack é‡Œé¢å¯ä»¥é€šè¿‡ postCSS-loader æ¥ä½¿ç”¨ PostCSSã€‚ ä½¿ç”¨é¦–å…ˆæ˜¯å®‰è£… postCSS-loader npm install postcss-loader --save-dev ä¸‹é¢æ˜¯ä¸€ä¸ª webpack config çš„ä¾‹å­ï¼š var precss = require('precss'); // å®žçŽ°ç±»Sassçš„åŠŸèƒ½ï¼Œå˜é‡ï¼ŒåµŒå¥—ï¼Œmixins var autoprefixer = require('autoprefixer'); // è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ module.exports = { module: { loaders: [ { test: /\.css$/, loader: "style-loader!css-loader!postcss-loader" //åœ¨ä½¿ç”¨ css-loader,style-loaderä¹‹å‰å¤„ç† } ] }, postcss: function () { // postcss æ’ä»¶ return [precss, autoprefixer]; } } ä¸Šé¢çš„ä¾‹å­ä½¿ç”¨äº†ä¸¤ä¸ª postcss æ’ä»¶ï¼Œåº”è¯¥é¢„å…ˆå®‰è£…ï¼š npm install precss --save-dev npm install autoprefixer --save-dev åœ¨æ–‡ä»¶ä¸­å¼•å…¥çš„csså°†é€šè¿‡ PostCSS æ’ä»¶çš„å¤„ç†: var css = require('./file.css'); or import './file.css' // => CSS after Autoprefixer and CSSWring æ’ä»¶ç»„å¦‚æžœä½ æƒ³å¯¹ä¸åŒç›®å½•æˆ–ç±»åž‹çš„ cssä½¿ç”¨ä¸åŒçš„ PostCSS æ’ä»¶é…ç½®è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨ ?pack=name å‚æ•° module.exports = { module: { loaders: [ { test: /\.docs\.css$/, loader: "style-loader!css-loader!postcss-loader?pack=cleaner" // å¯¹docsç›®å½•ä¸‹çš„cssä½¿ç”¨ cleaner çš„é…ç½® }, { test: /\.css$/, loader: "style-loader!css-loader!postcss-loader" // å¯¹å…¶ä»–ç›®å½•ä¸‹çš„cssä½¿ç”¨ defaults çš„é…ç½® } ] }, postcss: function () { return { defaults: [precss, autoprefixer], cleaner: [autoprefixer({ browsers: [] })] }; } } å†™åœ¨ js ä¸­çš„æ ·å¼å¯ä»¥é€šè¿‡ postcss-js æ’ä»¶å¤„ç†å†™åœ¨ js ä¸­çš„æ ·å¼ { test: /\.style.js$/, loader: "style-loader!css-loader!postcss-loader?parser=postcss-js" } ä¹Ÿå¯ä»¥é€šè¿‡ babel ç»“åˆ postcss-js å¤„ç† es6 è¯­æ³•ä¸­çš„æ ·å¼ { test: /\.style.js$/, loader: "style-loader!css-loader!postcss-loader?parser=postcss-js!babel" } ä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·å†™æ ·å¼ import colors from '../config/colors'; export default { '.menu': { color: colors.main, height: 25, '&amp;_link': { color: 'white' } } }]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>å‰ç«¯æž„å»º</tag>
        <tag>loaders</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[babel-loaderé…ç½®]]></title>
    <url>%2F2016%2F04%2F08%2Fbabel-loader-configure.html</url>
    <content type="text"><![CDATA[babel-loaderé…ç½®å®‰è£…npm install babel-loader babel-core babel-preset-es2015 --save-dev npm ä»Ž npm@3 ä¹‹åŽä¸èµžæˆè‡ªåŠ¨å®‰è£…peerDependenciesï¼Œæ‰€æœ‰å¿…é¡»åœ¨package.jsoné‡Œæ˜Žç¡®æŒ‡å®š babel-core è¿™æ ·çš„å®¿ä¸»ä¾èµ–ã€‚ peerDependencieså­—æ®µï¼Œä¸»è¦ç”¨æ¥ä¾›æ’ä»¶æŒ‡å®šå…¶æ‰€éœ€è¦çš„ä¸»è½¯ä»¶çš„ç‰ˆæœ¬ã€‚æ›´å¤šå¯ä»¥è§è¿™é‡Œ å¦‚æžœæ˜¯ä»Žbabel 5å‡çº§åˆ° babel 6ï¼Œå¯ä»¥çœ‹è¿™ä»½æŒ‡å¯¼ ä½¿ç”¨åœ¨webpack.config.jsé‡Œé…ç½®æ˜¯æ¯”è¾ƒæŽ¨èçš„æ–¹å¼ï¼š module: { loaders: [ { test: /\.jsx?$/, // åŒ¹é…'js' or 'jsx' åŽç¼€çš„æ–‡ä»¶ç±»åž‹ exclude: /(node_modules|bower_components)/, // æŽ’é™¤æŸäº›æ–‡ä»¶ loader: 'babel', // ä½¿ç”¨'babel-loader'ä¹Ÿæ˜¯ä¸€æ ·çš„ query: { // å‚æ•° presets: ['es2015'] } } ] } é€‰é¡¹é€‰é¡¹çš„å†™æ³•æœ‰ä¸¤ç§ ä¸€ç§æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²çš„æ–¹å¼ï¼š module: { loaders: [ { test: /\.jsx?$/, exclude: /(node_modules|bower_components)/, loader: 'babel?presets[]=es2015' } ] } å¦ä¸€ç§æ˜¯æŒ‡å®š queryå±žæ€§ module: { loaders: [ { test: /\.jsx?$/, exclude: /(node_modules|bower_components)/, loader: 'babel', query: { presets: ['es2015'] } } ] } babel-loader è¿˜æ”¯æŒä»¥ä¸‹é€‰é¡¹ï¼š cacheDirectory: é»˜è®¤å€¼æ˜¯ falseã€‚å¦‚æžœè®¾ç½®äº†è¿™ä¸ªå‚æ•°ï¼Œè¢«è½¬æ¢çš„ç»“æžœå°†ä¼šè¢«ç¼“å­˜èµ·æ¥ã€‚å½“webpack å†æ¬¡ç¼–è¯‘æ—¶ï¼Œå°†ä¼šé¦–å…ˆå°è¯•ä»Žç¼“å­˜ä¸­è¯»å–è½¬æ¢ç»“æžœï¼Œä»¥æ­¤é¿å…èµ„æºæµªè´¹ã€‚å¦‚æžœè¯¥å€¼ä¸ºç©º(loader: â€˜babel-loader?cacheDirectoryâ€™)ï¼Œloaderä¼šä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„ä¸´æ—¶æ–‡ä»¶ç›®å½•ã€‚ é—®é¢˜åŠä¼˜åŒ–æ€§èƒ½é—®é¢˜ ç¡®ä¿åªè½¬æ¢å°½å¯èƒ½å°‘çš„æ–‡ä»¶ï¼Œä½ å¯èƒ½åŒ¹é…äº†è¿‡å¤šçš„æ–‡ä»¶ç±»åž‹ï¼Œæˆ–è€…åŒ¹é…äº†æ‰€æœ‰çš„â€™.jsâ€™æ–‡ä»¶ï¼Œä½ éœ€è¦ä½¿ç”¨ exclude: /(node_modules|bower_components)/ æŽ’é™¤éƒ¨åˆ†ç›®å½• è®¾ç½® cacheDirectory å‚æ•°ä¹Ÿå¯ä»¥è®©ä½ çš„ loader æ€§èƒ½æå‡2å€ï¼ babel ç»™æ¯ä¸ªéœ€è¦çš„æ–‡ä»¶æ³¨å…¥helperæ‰©å±•æ‚¨å¯ä»¥æ”¹ä¸ºè¦æ±‚babelä½œä¸ºä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„æ¨¡å—ï¼Œä»¥é¿å…é‡å¤ã€‚ ä¸‹é¢çš„é…ç½®é€šè¿‡babel-plugin-transform-runtimeæ’ä»¶å¯ä»¥ç¦ç”¨babelå‘æ¯ä¸ªæ–‡ä»¶æ³¨å…¥helper éœ€è¦å…ˆå®‰è£…æ’ä»¶ npm install babel-plugin-transform-runtime --save loaders: [ // the 'transform-runtime' plugin tells babel to require the runtime // instead of inlining it. { test: /\.jsx?$/, exclude: /(node_modules|bower_components)/, loader: 'babel', query: { presets: ['es2015'], plugins: ['transform-runtime'] } } ]]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>loader</tag>
        <tag>babel-loader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack-config]]></title>
    <url>%2F2016%2F04%2F07%2FWebpack-config.html</url>
    <content type="text"><![CDATA[ä¸å¾—ä¸è¯´ï¼Œwebpack é…ç½®ç¡®å®žçƒ¦çäº†ä¸€äº›ï¼Œå¾ˆå¤šäººéƒ½ä½¿ç”¨gulpçš„æ’ä»¶gulp-webpackæ¥åšå…¶ä»–äº‹æƒ…ã€‚ é…ç½®webpackwebpackçš„æž„å»ºè¿‡ç¨‹éœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¸€ä¸ªå…¸åž‹çš„é…ç½®æ–‡ä»¶webpack.config.jså¤§æ¦‚å°±æ˜¯è¿™æ · var webpack = require('webpack'); module.exports = { // é…ç½®é¡¹ }; åŸºæœ¬é…ç½®é¡¹entrymodule.exports = { entry:'./example1.1', output:{ filename:'bundle1.1.js' } }; æˆ‘ä»¬ä¹Ÿä¼šç¢°åˆ°æ”¯æŒå¤šä¸ªå…¥å£æ–‡ä»¶ï¼ˆentryï¼‰çš„æƒ…å†µï¼Œæ¯ä¸€ä¸ªå…¥å£éƒ½éœ€è¦æœ‰è‡ªå·±çš„åå­—ï¼Œå…·ä½“å¯¹åº”entryçš„å†™æ³•è€Œè¨€ï¼Œæœ‰å¦‚ä¸‹å‡ ç§æƒ…å†µï¼š entry:'./example2.1' // æˆ–è€… entry:['./example2.1','./example2.2'] //æˆ–è€… entry:{ 'example2.1':'example2.1.js', 'example2.2':'example2.2.js' } ç¬¬ä¸‰ç§æ˜¯æ¯”è¾ƒæŽ¨èçš„å†™æ³•ï¼Œè¿™ç§å†™æ³•ä¸­ï¼Œåå­—å’Œæ¨¡å—æ–‡ä»¶åä¸€ä¸€å¯¹åº”ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰ç‹¬ç«‹çš„åå­—ã€‚ä¹Ÿå°±æ˜¯output.filenameä¸­çš„[name] outputoutput.filenameoutput.filenameé™¤äº†å¯ä»¥æŒ‡å®šå…·ä½“çš„æ–‡ä»¶åä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸€äº›å ä½ç¬¦ï¼ŒåŒ…æ‹¬ï¼š name æ¨¡å—åç§° hash æ¨¡å—ç¼–è¯‘åŽçš„ï¼ˆæ•´ä½“ï¼‰Hashå€¼ chunkhash åˆ†ç‰‡çš„Hashå€¼ [name] åœ¨ä¸Šé¢çš„entryä¸­ï¼Œå‰ä¸¤ç§å†™æ³•ï¼Œæ¨¡å—æ˜¯æ²¡æœ‰åå­—çš„ï¼Œwebpackä¼šä½¿ç”¨mainä½œä¸ºæ¨¡å—åå­—ï¼Œå› æ­¤ç”¨æ•°ç»„æ¥æŒ‡å®šå…¥å£çš„æƒ…å†µï¼Œæ¨¡å—åä¼šé‡å¤ï¼Œè€Œæ­¤æ—¶webpackä¼šå°†å®ƒä»¬çš„ä»£ç åˆå¹¶æ‰“åŒ…ï¼è€Œç¬¬ä¸‰ç§å†™æ³•ï¼Œè¿™é‡Œçš„[name]å¯ä»¥ç†è§£æˆæ¨¡å—åå­—ã€‚ [hash]ä¸Ž[chunkhash] äº‹å®žä¸Šï¼Œåœ¨webpackçš„æ–‡æ¡£ä¸­ï¼Œè¿™ä¸ªnameæ˜¯æŒ‡â€œchunk nameâ€ï¼Œå³åˆ†ç‰‡çš„åå­—ï¼Œè¿™é‡Œéœ€è¦å…ˆå‰§é€ä¸€ä¸‹åŽé¢è¦è¯´çš„â€œåˆ†ç‰‡â€çš„æ¦‚å¿µã€‚æ‰€è°“åˆ†ç‰‡å°±æ˜¯æŒ‡ä¸€ä¸ªå…¥å£æ¨¡å—çš„ä»£ç æœ‰å¯èƒ½ä¼šè¢«åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€äº›æ–‡ä»¶å¯èƒ½æ˜¯æ¥è‡ªæ¨¡å—çš„å…¬å…±ä»£ç ï¼Œè€Œä¸æ˜¯å…¥å£æ¨¡å—ã€‚å› æ­¤è¿™é‡Œçš„[name]å¹¶éžä¸¥æ ¼ä¸Žå…¥å£æ¨¡å—ä¸€ä¸€å¯¹åº”ã€‚ äº†è§£äº†è¿™äº›æƒ…å†µä¹‹åŽï¼Œ[hash]å’Œ[chunkhash]å°±è‡ªç„¶å¥½ç†è§£äº†ï¼Œä¸€ä¸ªæ˜¯æŒ‡æœ¬æ¬¡æ‰“åŒ…ç›¸å…³çš„æ•´ä½“çš„hashï¼Œä¸€ä¸ªæ˜¯æŒ‡åˆ†ç‰‡çš„hashã€‚ module.exports = { entry:{ 'example3.1':'./example3.1', 'example3.2':'./example3.2' }, output:{ //è¿™é‡Œåˆ†åˆ«ç”¨hashå’Œchunkhashï¼Œç»“æžœä¸ä¸€æ · filename:'[name]-[hash].js' //filename:'[name]-[chunkhash].js' } }; output.pathoutput.pathæ¥æŒ‡å®šè¾“å‡ºè·¯å¾„ output.pathä¹Ÿå¯ä»¥ä½¿ç”¨å ä½ç¬¦ã€‚ å¦‚æžœæƒ³ä¿æŒæ‰“åŒ…å‰æºæ–‡ä»¶çš„ç›®å½•ç»“æž„ï¼Œéœ€è¦æŠŠç›®å½•å†™åˆ°æ¨¡å—åä¸Šï¼Œå¦‚ï¼š entry:{ 'example4.1':'./src/example4.1', 'hello/example4.2':'./src/hello/example4.2' }, output:{ filename:'[name].js', path:'./dist' } æ³¨æ„è¿™é‡Œçš„filenameä¸€å®šè¦åŒ…å«[name]æ‰è¡Œï¼Œå› ä¸ºè·¯å¾„ä¿¡æ¯æ˜¯å¸¦åœ¨æ¨¡å—åä¸Šçš„ã€‚ CommonChunksæ’ä»¶Common Chunks æ’ä»¶çš„ä½œç”¨å°±æ˜¯æå–ä»£ç ä¸­çš„å…¬å…±æ¨¡å—ï¼Œç„¶åŽå°†å…¬å…±æ¨¡å—æ‰“åŒ…åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ä¸­åŽ»ï¼Œä»¥ä¾¿åœ¨å…¶å®ƒçš„å…¥å£å’Œæ¨¡å—ä¸­ä½¿ç”¨ã€‚ var webpack = require('webpack'); module.exports = { entry:{ main1:'./main', main2:'./main.2' }, output:{ filename:'bundle.[name].js' }, plugins: [ new webpack.optimize.CommonsChunkPlugin('common.js', ['main1', 'main2']) ] }; å‚æ•°common.jsè¡¨ç¤ºå…¬å…±æ¨¡å—çš„æ–‡ä»¶åï¼ŒåŽé¢çš„æ•°ç»„å…ƒç´ ä¸Žentryä¸€ä¸€å¯¹åº”ï¼Œè¡¨ç¤ºè¦æå–è¿™äº›æ¨¡å—ä¸­çš„å…¬å…±æ¨¡å—ã€‚ ä½†æ˜¯ï¼Œè¦è®°å¾—åœ¨HTMLä¸­åŠ å…¥å…¬å…±éƒ¨åˆ†common.js ä½†æ¨¡å—åŒ–ä¸åº”è¯¥æœ‰å¤šä¸ªå…¥å£æ–‡ä»¶ï¼Œå…¥å£æ–‡ä»¶ä¸åº”æ—¶æ—¶æ”¹å˜ï¼Œåº”åœ¨å†…éƒ¨å¤„ç† ä½¿ç”¨loaderloaderæ˜¯webpackä¸­ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œå®ƒæ˜¯æŒ‡ç”¨æ¥å°†ä¸€æ®µä»£ç è½¬æ¢æˆå¦ä¸€æ®µä»£ç çš„webpackæ’ä»¶ è™½ç„¶æœ¬è´¨ä¸Šè¯´ï¼Œloaderä¹Ÿæ˜¯æ’ä»¶ï¼Œä½†å› ä¸ºwebpackçš„ä½“ç³»ä¸­è¿˜æœ‰ä¸€ä¸ªä¸“é—¨çš„åè¯å°±å«æ’ä»¶ï¼ˆplguinï¼‰ï¼Œä¸ºé¿å…æ··æ·†ï¼ŒåŽé¢ä¸å†å°†loaderä¸Žæ’ä»¶æ··æ·†è¯´ï¼ŒåŽæ–‡ä¸­è¿™å°†æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„æ¦‚å¿µã€‚ loaderçš„ä½¿ç”¨æœ‰ä¸‰ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ï¼š åœ¨requireä¸­æ˜¾å¼æŒ‡å®š åœ¨é…ç½®é¡¹ï¼ˆwebpack.config.jsï¼‰ä¸­æŒ‡å®š åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®š ç¬¬äºŒç§ï¼Œåœ¨é…ç½®é¡¹ä¸­æŒ‡å®šæ˜¯æœ€çµæ´»çš„æ–¹å¼ï¼Œå®ƒçš„æŒ‡å®šæ–¹å¼æ˜¯è¿™æ ·ï¼š module: { // loadersæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½ç”¨æ¥æŒ‡å®šloader loaders: [{ test: /\.jade$/, //testå€¼ä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œå½“æ–‡ä»¶è·¯å¾„åŒ¹é…æ—¶å¯ç”¨ loader: 'jade', //æŒ‡å®šä½¿ç”¨ä»€ä¹ˆloaderï¼Œå¯ä»¥ç”¨å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ç”¨æ•°ç»„ exclude: /node_modules/, //å¯ä»¥ä½¿ç”¨excludeæ¥æŽ’é™¤ä¸€éƒ¨åˆ†æ–‡ä»¶ // exclude: /regexp/ include: 'dist', // ç”¨æ¥æŒ‡å®šåŒ…å«çš„æ–‡ä»¶ //å¯ä»¥ä½¿ç”¨queryæ¥æŒ‡å®šå‚æ•°ï¼Œä¹Ÿå¯ä»¥åœ¨loaderä¸­ç”¨å’Œrequireä¸€æ ·çš„ç”¨æ³•æŒ‡å®šå‚æ•°ï¼Œå¦‚`jade?p1=1` query: { p1:'1' } }, { test: /\.css$/, loader: 'style!css' //loaderå¯ä»¥å’Œrequireç”¨æ³•ä¸€æ ·ä¸²è” }, { test: /\.css$/, loaders: ['style', 'css'] //ä¹Ÿå¯ä»¥ç”¨æ•°ç»„æŒ‡å®šloader }] } ä¸²è”loaderæ˜¯å¯ä»¥ä¸²è”ä½¿ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªæ–‡ä»¶å¯ä»¥å…ˆç»è¿‡A-loaderå†ç»è¿‡B-loaderæœ€åŽå†ç»è¿‡C-loaderå¤„ç†ã€‚ require('style!css!./style.css'); å‚æ•°loaderè¿˜å¯ä»¥æŽ¥å—å‚æ•°ï¼Œä¸åŒçš„å‚æ•°å¯ä»¥è®©loaderæœ‰ä¸åŒçš„è¡Œä¸ºï¼ˆå‰ææ˜¯loaderç¡®å®žæ”¯æŒä¸åŒçš„è¡Œä¸ºï¼‰ï¼Œå…·ä½“æ¯ä¸ªloaderæ”¯æŒä»€ä¹ˆæ ·çš„å‚æ•°å¯ä»¥å‚è€ƒloaderçš„æ–‡æ¡£ã€‚ å‚æ•°çš„æŒ‡å®šæ–¹å¼å’Œurlå¾ˆåƒï¼Œè¦é€šè¿‡?æ¥æŒ‡å®šï¼Œä¾‹å¦‚æŒ‡å®šliterateå‚æ•°éœ€è¦è¿™æ ·å†™ï¼š require('coffee?literate=1!./a.coffee'); å…·ä½“çš„å¯ä»¥å¯¹ç…§å®˜æ–¹çš„loaderåˆ—è¡¨ä¸€ä¸€æŸ¥çœ‹ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>å‰ç«¯æž„å»º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é‡‡ç”¨éžç›´è¿›å¼åˆå¹¶ï¼ˆgit-merge-no-ffï¼‰]]></title>
    <url>%2F2016%2F04%2F02%2Fmake-fast-forwarding-be-off-by-default-in-git.html</url>
    <content type="text"><![CDATA[é‡‡ç”¨éžç›´è¿›å¼åˆå¹¶ï¼ˆgit-merge-no-ffï¼‰ä½¿ç”¨Gitå½“åˆå¹¶ä¸€ä¸ªåˆ†æ”¯æ˜¯ä¸€ä¸ªç›¸å½“å¸¸è§çš„æ“ä½œã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒGitä¼šé»˜è®¤å°†å°è¯•åœ¨å¿«è¿›æ¨¡å¼åˆå¹¶ä¸€ä¸ªåˆ†æ”¯ã€‚å¦‚æžœä¸ä½¿ç”¨å¿«è¿›åˆå¹¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ å‡è®¾æˆ‘ä»Žmasteråˆ›å»ºä¸€ä¸ªåä¸ºspeedupåˆ†æ”¯ã€‚åœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šå·¥ä½œä¸€æ®µæ—¶é—´ï¼ˆä¸‰ä¸ªæäº¤ï¼Œé‚£äº›ç™½è‰²çš„åœ†åœˆï¼‰åŽï¼Œå½“æˆ‘å®Œæˆå·¥ä½œæ—¶ï¼Œæˆ‘æŠŠå®ƒgit pushæŽ¨åˆ°æˆ‘è‡ªå·±çš„è¿œç¨‹åˆ†æ”¯ã€‚åŒæ—¶ï¼Œä¸»åˆ†æ”¯masterä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿï¼Œä½†ä»å¤„äºŽç›¸åŒçš„çŠ¶æ€ä¹‹å‰ï¼Œæˆ‘åˆ†å‡ºã€‚è¿™ç§æƒ…å†µåœ¨ä¸‹é¢çš„å›¾ä¸­æè¿°ã€‚ ä¸€æ—¦è¯¥é¡¹ç›®çš„ç»´æŠ¤è€…å¾—åˆ°é€šçŸ¥ï¼Œæˆ‘çš„åˆ†æ”¯å·²ç»å‡†å¤‡å¥½åˆå¹¶è¿›masterï¼Œå¥¹å¯èƒ½ä½¿ç”¨gitçš„å¸¸è§„æ­¥éª¤git fetchæ“ä½œåŽæ‰§è¡Œgit mergeæ¥åˆå¹¶ã€‚å› ä¸ºä¸»åˆ†æ”¯å¹¶æ²¡æœ‰æ–°çš„æäº¤ï¼ˆç°è‰²åœ†åœˆï¼‰ï¼ŒGitä¼šç”¨å¿«è¿›æ‰§è¡Œåˆå¹¶ã€‚æ•´ä¸ªç³»åˆ—çš„æäº¤å°†æ˜¯çº¿æ€§çš„ã€‚åŽ†å²ä¼šåƒä¸‹å›¾ï¼ˆå·¦ä¾§ï¼‰ã€‚ åˆå¹¶çš„å¦ä¸€ä¸ªå˜åž‹æ˜¯ä½¿ç”¨ -no-ff é€‰é¡¹ï¼ˆå®ƒä»£è¡¨ä¸å¿«è¿›ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ†æ”¯åŽ†å²çœ‹ä¸ŠåŽ»ç¨æœ‰ä¸åŒï¼ˆå³ä¾§ï¼‰ï¼Œæœ‰ä¸€ä¸ªé™„åŠ çš„æäº¤ï¼ˆè™šçº¿åœ†ï¼‰å¼ºè°ƒåˆå¹¶ã€‚è¿™ä¸ªæäº¤å‘Šè¯‰æˆ‘ä»¬æœ‰å…³åˆå¹¶åˆ†æ”¯çš„å¤‡æ³¨ä¿¡æ¯ã€‚ Gitçš„é»˜è®¤è¡Œä¸ºæ˜¯å°½å¯èƒ½ä½¿ç”¨å¿«è¿›ã€‚è¿™å¯ä»¥æ”¹å˜çš„ï¼Œéžå¿«è¿›æ¨¡å¼å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¾å®šä¸ºé»˜è®¤åˆå¹¶æ¨¡å¼ã€‚ è®¾ç½®éžå¿«è¿›æ¨¡å¼åˆå¹¶ä¸ºé»˜è®¤åˆå¹¶æ–¹å¼ git config branch.master.mergeoptions â€œâ€“no-ffâ€ æ€»ä¹‹ï¼Œéžå¿«è¿›åˆå¹¶ä¿æŒæ˜Žç¡®åˆ†æ”¯çš„æ¦‚å¿µã€‚å®ƒå¯åœ¨ä¿ç•™åˆ†æ”¯å¤æ‚çš„éžçº¿æ€§æäº¤åŽ†å²ã€‚åœ¨å¦ä¸€æ–¹é¢ï¼Œå¿«è¿›åˆå¹¶ä¿æŒçº¿æ€§åŽ†å²ä¸Šçš„å˜æ›´ï¼Œä½¿å…¶æ›´å®¹æ˜“ä½¿ç”¨å…¶ä»–å·¥å…·ï¼ˆlog, blame, bisectï¼‰ã€‚æ¯ä¸ªåˆ†æ”¯çš„æ¥æºå°†å˜å¾—å¾ˆä¸æ˜Žæ˜¾ï¼Œä½†å¦‚æžœè¯¥é¡¹ç›®å¼ºåˆ¶è¦æ±‚æäº¤ä¿¡æ¯å’Œé—®é¢˜è·Ÿè¸ªå™¨ä¹‹é—´çš„ä¸¥æ ¼çš„äº¤å‰å¼•ç”¨ï¼Œè¿™ä¹Ÿä¸æ˜¯ä»€ä¹ˆå¤§ä¸äº†çš„äº‹ã€‚ ä½ å–œæ¬¢å“ªä¸€ç§å‘¢ï¼Œå¿«è¿›å¼æˆ–éžå¿«è¿›å¼ï¼Ÿ ç¿»è¯‘è‡ªï¼š Fast-Forward Git Merge]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¿«é€Ÿä¸Šæ‰‹ Flow é™æ€ç±»åž‹æ£€æŸ¥å™¨]]></title>
    <url>%2F2016%2F03%2F16%2FFlow-the-type-checker.html</url>
    <content type="text"><![CDATA[å¿«é€Ÿä¸Šæ‰‹ Flow é™æ€ç±»åž‹æ£€æŸ¥å™¨why Flowjavascriptæ˜¯ä¸€ä¸ªå¼±ç±»åž‹è¯­è¨€ï¼Œå˜é‡ç±»åž‹ä¸éœ€è¦å£°æ˜Žï¼Œè¿ç®—è¿‡ç¨‹ä¸­ä¼šæ ¹æ®éœ€è¦è‡ªåŠ¨è½¬æ¢ç±»åž‹ï¼Œè¿™ä¸ªæ˜¯jsçš„ä¼˜ç‚¹ï¼Œå¤Ÿçµæ´»ï¼Œç¼–ç ç®€å•ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿæ˜¯è½¯è‚‹ã€‚æœ‰æ—¶å€™ï¼Œæœ‰äº›ç±»åž‹è½¬æ¢çš„bugæ— ä»ŽæŸ¥èµ·ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤æ‚çš„åº”ç”¨ä¸­ã€‚ Flowä¸ºJavascriptæ·»åŠ äº†é™æ€ç±»åž‹æ£€æŸ¥ï¼Œä»¥æé«˜å¼€å‘æ•ˆçŽ‡å’Œä»£ç è´¨é‡ã€‚æ›´æ˜Žç¡®çš„è¯´ï¼Œé™æ€ç±»åž‹æ£€æŸ¥æä¾›çš„å¥½å¤„åƒæ—©æœŸé”™è¯¯æ£€æŸ¥ï¼Œå¸®åŠ©ä½ å‘çŽ°ä¸€äº›åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½å‘çŽ°çš„é”™è¯¯ã€‚ å®‰è£…ç”±äºŽflowæ˜¯ç”¨OCamlè¯­è¨€å†™çš„ï¼Œnpmä¸Šåªæœ‰å¯¹åº”çš„äºŒè¿›åˆ¶åŒ…ã€‚ npm install flow-bin å¯è€…ä½¿ç”¨ Homebrew å®‰è£… brew install flow å¿«é€Ÿä¸Šæ‰‹åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œ flow initï¼Œä¼šç”Ÿæˆä¸€ä¸ª .flowconfig æ–‡ä»¶ åªéœ€è¦åœ¨å¾…æ£€æŸ¥çš„jsæ–‡ä»¶å¤´éƒ¨æ·»åŠ ä¸€è¡Œæ³¨é‡Š /* @flow */ ç„¶åŽåœ¨åŒä¸€ç›®å½•ä¸‹è¿è¡Œflow checkå³å¯ã€‚ flow serverflow serveræ˜¯ä¸ºäº†æé«˜æ£€æµ‹æ•ˆçŽ‡çš„åŽå°ç¨‹åºï¼Œæ”¯æŒåœ¨åŽå°è¿è¡Œï¼Œå¹¶ä¸”åªç›‘æµ‹æœ‰ä¿®æ”¹çš„æ–‡ä»¶ã€‚ æ–¹æ³•å¾ˆç®€å•ï¼Œä¸€æ¡ flow å‘½ä»¤å°±èƒ½å®Œæˆ Flow æœåŠ¡å™¨å¯åŠ¨ï¼Œæ–‡ä»¶æ£€æµ‹ï¼Œè¢«æ›´æ”¹æ–‡ä»¶çš„æ£€æµ‹ï¼Œå³ç¬¬ä¸€æ¬¡ä½¿ç”¨ flow å‘½ä»¤ä¼šå¯åŠ¨ Flow æœåŠ¡å™¨å¹¶ä¸”é¦–æ¬¡æ£€æµ‹æ–‡ä»¶ï¼Œå†æ¬¡ä½¿ç”¨ flow å‘½ä»¤ä¼šè¿žæŽ¥ Flow æœåŠ¡å™¨å¹¶ä¸”æ£€æµ‹æ–‡ä»¶ï¼Œä¹‹åŽä½¿ç”¨ flow å‘½ä»¤æ—¶å°†ä¼šè¿žæŽ¥ Flow æœåŠ¡å™¨å¹¶ä¸”å¯¹ä¿®æ”¹è¿‡çš„æ–‡ä»¶è¿›è¡Œæ£€æµ‹ã€‚ flow check:æ£€æµ‹æ‰€æœ‰å£°æ˜Žäº† @flow çš„æ–‡ä»¶ flow check â€“all:å¯ä»¥è®©Flowæ£€æµ‹æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬æ²¡æœ‰å£°æ˜Ž @flow çš„æ–‡ä»¶ flow stop:é¡¹ç›®å¼€å‘å®Œæˆåœæ­¢æœåŠ¡ flowconfig [ignore]å¿½ç•¥çš„æ–‡ä»¶ï¼Œè·¯å¾„çš„åŒ¹é…è§„åˆ™æ˜¯æ­£åˆ™è¡¨è¾¾å¼ [include]éœ€è¦æ£€æµ‹çš„å…¶ä»–ç›®å½•çš„æ–‡ä»¶ [libs]å½“æ–‡ä»¶ä¸­æœ‰ç¬¬ä¸‰æ–¹åº“å¼•ç”¨æˆ–è€…requireå…¨å±€çš„moduleæ—¶ï¼Œéœ€è¦åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶é‡Œdeclareè¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªçš„å€¼æ˜¯æ‰€æœ‰declareè·¯å¾„çš„é›†åˆ [options]åŒ…å«è‹¥å¹²key-valueçš„é…ç½® flowçš„ä¸¤ç§æ¨¡å¼/* @flow */ åªè¦å¸¦æœ‰è¿™ä¸ªæ³¨é‡Šï¼Œéƒ½ä¼šè¿›è¡Œç±»åž‹æ£€æµ‹ /* @flow weak */ åªå¯¹æœ‰åŠ ç±»åž‹å£°æ˜Žçš„å˜é‡è¿›è¡Œç±»åž‹æ£€æµ‹ ç±»åž‹å£°æ˜Ž/æ ‡æ³¨ ä¸å£°æ˜Žå˜é‡ç±»åž‹çš„æ—¶å€™ï¼ŒFlow ä¹Ÿä¼šè‡ªåŠ¨æ£€æŸ¥éšæ€§å­˜åœ¨çš„ç±»åž‹è½¬æ¢ã€‚ä½†æ›´ä¸ºä¸¥è°¨çš„æ–¹å¼æ˜¯æ˜¾å¼å£°æ˜Žå˜é‡çš„ç±»åž‹ã€‚ å¯ä»¥åœ¨ä»£ç é‡Œå†™ä¸Šç±»åž‹: /* @flow */ // Changing the return type to number fixes the error function foo(x: string, y: number): number { return x.length * y; } foo('Hello', 42); ä¹Ÿå¯ä»¥è¿™æ ·ï¼š /* @flow */ type T = number; var x: T = 0; ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´è¯¦ç»†çš„ä¾‹å­ï¼š class People { name: string; constructor(name:string){ this.name = name } getAge():number{ return 18; } } function getLength(param?:string):number { /*param?:stringä¼ å‚ç±»åž‹ä»€ä¹ˆï¼Œ?è¡¨ç¤ºæ­¤å¤„å¯ä¸ä¼ å€¼ï¼›*/ /*\:numberä¸ºå‡½æ•°è¿”å›žå€¼ç±»åž‹,å¦‚æžœæ²¡æœ‰returnå¯ä¸å†™æˆ–å†™void*/ var s:string = 'string';/*å­—ç¬¦*/ var ss:String = new String('string');/*å­—ç¬¦å¯¹è±¡*/ /* s = ss*///ç±»åž‹ä¸åŒï¼Œflowä¼šæŠ¥é”™ var n:number = 12;/*æ•°å­—*/ var nn:Number = new Number(12);/*æ•°å­—å¯¹è±¡*/ var b:boolean = true;/*boolå€¼ï¼Œä»…èƒ½ä¸ºtrue/false*/ var bb:Boolean = new Boolean(true);/*boolå€¼å¯¹è±¡*/ var o:{prop1:number,prop2:string} = { /*å¯¹è±¡ç†Ÿæ‚‰å£°æ˜Ž*/ prop1: 12, prop2: '21123' } var v:void = undefined;/*undefined*/ var a:any = 'aa';/*ä»»æ„ç±»åž‹ï¼Œé™¤undefined*/ var m:mixed = '1';/*ä»»æ„ç±»åž‹+undefined*/ var mm:mixed = undefined;/*ä»»æ„ç±»åž‹+undefined*/ var aa:Array = [1,2,3,4];/*æ•°ç»„å†…å€¼ç±»åž‹å£°æ˜Ž*/ var P:Class = People;/*è‡ªå®šä¹‰ç±»åž‹å£°æ˜Ž*/ var p:People = new People('pt');/*è‡ªå®šä¹‰Peopleç±»åž‹*/ if (param) { return param.length; } else { return 0; } } å…¼å®¹æ€§Flowè‡´åŠ›äºŽæ”¯æŒæœ€æ–°çš„JavaScriptæ ‡å‡†ã€‚ç›®å‰å·²ç»æ”¯æŒå„ç§ES6ç‰¹æ€§å¦‚destructuring, classes, extended objects, optional function parametersï¼Œä»¥åŠæ ¸å¿ƒAPIæ‰©å±•ï¼ˆæ¯”å¦‚Map, Set, Promise, å’Œ new methods on Object, Array, å’Œ Math)ã€‚å…¶å®ƒç‰¹æ€§ï¼ˆå°¤å…¶æ˜¯æ¨¡å—ï¼‰æ­£åœ¨å¼€å‘ä¸­ã€‚Flowæ”¯æŒCommonJS / Node.js è§„èŒƒçš„æ¨¡å—ã€‚ Flow ä¹Ÿå·²ç»æ”¯æŒ Reactã€‚ ä»£ç ç¼–è¯‘åœ¨æž„å»ºå·¥å…·ä¸­æ·»åŠ flowæ£€æŸ¥çš„æ­¥éª¤ã€‚webpackå’Œgulpéƒ½æœ‰å¯¹åº”çš„flowæ’ä»¶ã€‚ æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ç”¨åˆ°çš„æ’ä»¶ï¼š eslint-plugin-flow-vars å‚è€ƒFlowå®˜ç½‘æœ€è¿‘è®¿é—®ä¸äº†ï¼Œå¯ä»¥çœ‹è¿™é‡Œï¼šhttps://github.com/facebook/flow/tree/master/website/docs flowâ€”â€”A static type checker for javascript #32 flowâ€“facebookå‡ºå“çš„javascripté™æ€ç±»åž‹æ£€æŸ¥å™¨]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Flow</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactåº”ç”¨æ€§èƒ½ä¼˜åŒ–ä¹‹IMMUTABLE.JS]]></title>
    <url>%2F2016%2F03%2F14%2FReact-optimize-with-Immutable-js.html</url>
    <content type="text"><![CDATA[Reactåº”ç”¨æ€§èƒ½ä¼˜åŒ–ä¹‹IMMUTABLE.JSå‰ä¸€ç¯‡æ–‡ç« è®°å½•äº†Reactåº”ç”¨çš„æ€§èƒ½ä¼˜åŒ–ç‚¹ï¼Œä»Šå¤©è¿˜æœ‰ä¸ªæ›´é—ªè€€çš„ Immutable.jsã€‚ Immutable.jsImmutable.js æœ¬èº«å’Œ React.js æ²¡æœ‰å¿…ç„¶çš„è”ç³»ã€‚å®ƒçš„æ„ä¹‰åœ¨äºŽå®ƒå¼¥è¡¥äº†Javascriptæ²¡æœ‰ä¸å¯å˜æ•°æ®ç»“æž„çš„é—®é¢˜ã€‚ Javascriptä¸­å¯¹è±¡éƒ½æ˜¯å‚è€ƒç±»åž‹ï¼Œä¹Ÿå°±æ˜¯a={a:1}; b=a; b.a=10;ä½ å‘çŽ°a.aä¹Ÿå˜æˆ10äº†ã€‚å¯å˜çš„å¥½å¤„æ˜¯èŠ‚çœå†…å­˜æˆ–æ˜¯åˆ©ç”¨å¯å˜æ€§åšä¸€äº›äº‹æƒ…ï¼Œä½†æ˜¯ï¼Œåœ¨å¤æ‚çš„å¼€å‘ä¸­å®ƒçš„å‰¯ä½œç”¨è¿œæ¯”å¥½å¤„å¤§çš„å¤šã€‚äºŽæ˜¯æ‰æœ‰äº†æµ…copyå’Œæ·±copyï¼Œå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¸¾ä¸ªå¸¸è§ä¾‹å­ï¼š var defaultConfig = { /* é»˜è®¤å€¼ */}; var config = $.extend({}, defaultConfig, initConfig); // jQueryç”¨æ³•ã€‚initConfigæ˜¯è‡ªå®šä¹‰å€¼ var config = $.extend(true, {}, defaultConfig, initConfig); // å¦‚æžœå¯¹è±¡æ˜¯å¤šå±‚çš„ï¼Œå°±ç”¨åˆ°deep-copyäº† ES6å‡ºçŽ°åŽŸç”Ÿçš„assignæ–¹æ³•ï¼Œä½†å®ƒç›¸å½“äºŽæ˜¯æµ…copyã€‚å¦‚æžœæœ‰äº†ä¸å¯å˜çš„æ•°æ®ç»“æž„å°±çœå¿ƒäº†ï¼ŒES5.1ä¸­å¯¹è±¡æœ‰äº†freezeæ–¹æ³•ï¼Œä¹Ÿæ˜¯æµ…copyï¼Œa=Object.freeze({a:1}); b=a; b.a=10; a.aè¿˜æ˜¯1ã€‚åœ¨å®žé™…å¼€å‘ä¸­æµ…copyé€šå¸¸ä¸å¤Ÿã€‚å¦‚æžœç”¨immutableJS: var defaultConfig = Immutable.fromJS({ /* é»˜è®¤å€¼ */}); var config = defaultConfig.merge(initConfig); // defaultConfigä¸ä¼šæ”¹å˜ï¼Œè¿”å›žæ–°å€¼ç»™config var config = defaultConfig.mergeDeep(initConfig); // æ·±å±‚merge ä¸Šè¿°ç”¨deep-copyä¹Ÿå¯ä»¥åšåˆ°ï¼Œå·®åˆ«åœ¨äºŽæ€§èƒ½ã€‚æ¯æ¬¡deep-copyéƒ½è¦æŠŠæ•´ä¸ªå¯¹è±¡é€’å½’çš„å¤åˆ¶ä¸€ä»½ã€‚è€ŒImmutableçš„å®žçŽ°æœ‰äº›åƒé“¾è¡¨ï¼Œæ·»åŠ ä¸€ä¸ªæ–°ç»“ç‚¹æŠŠæ—§ç»“ç‚¹çš„çˆ¶å­å…³ç³»è½¬ç§»åˆ°æ–°ç»“ç‚¹ä¸Šï¼Œæ€§èƒ½æå‡å¾ˆå¤šã€‚ImmutableJSç»™çš„è¿œä¸æ­¢è¿™äº›ï¼Œå®ƒæä¾›äº†7ç§ä¸å¯å˜çš„æ•°æ®ç»“æž„ï¼šList, Stack, Map, OrderedMap, Set, OrderedSet, Record ï¼ˆè¯¦è§æ–‡æ¡£Immutable.jsï¼Œæ–‡æ¡£å¾ˆgeekï¼Œæ‰“å¼€consoleè¯•å§ï¼‰ã€‚immutableJS ï¼‹ åŽŸç”ŸJavascriptç­‰äºŽçœŸæ­£çš„å‡½æ•°å¼ç¼–ç¨‹ã€‚ Immutable ä¼˜ç‚¹1. Immutable é™ä½Žäº† Mutable å¸¦æ¥çš„å¤æ‚åº¦å¯å˜ï¼ˆMutableï¼‰æ•°æ®è€¦åˆäº† Time å’Œ Value çš„æ¦‚å¿µï¼Œé€ æˆäº†æ•°æ®å¾ˆéš¾è¢«å›žæº¯ã€‚ æ¯”å¦‚ä¸‹é¢ä¸€æ®µä»£ç ï¼š function touchAndLog(touchFn) { let data = { key: 'value' }; touchFn(data); console.log(data.key); // çŒœçŒœä¼šæ‰“å°ä»€ä¹ˆï¼Ÿ } åœ¨ä¸æŸ¥çœ‹ touchFn çš„ä»£ç çš„æƒ…å†µä¸‹ï¼Œå› ä¸ºä¸ç¡®å®šå®ƒå¯¹ data åšäº†ä»€ä¹ˆï¼Œä½ æ˜¯ä¸å¯èƒ½çŸ¥é“ä¼šæ‰“å°ä»€ä¹ˆï¼ˆè¿™ä¸æ˜¯åºŸè¯å—ï¼‰ã€‚ä½†å¦‚æžœ data æ˜¯ Immutable çš„å‘¢ï¼Œä½ å¯ä»¥å¾ˆè‚¯å®šçš„çŸ¥é“æ‰“å°çš„æ˜¯ valueã€‚ 2. èŠ‚çœå†…å­˜Immutable.js ä½¿ç”¨äº† Structure Sharing ä¼šå°½é‡å¤ç”¨å†…å­˜ï¼Œç”šè‡³ä»¥å‰ä½¿ç”¨çš„å¯¹è±¡ä¹Ÿå¯ä»¥å†æ¬¡è¢«å¤ç”¨ã€‚æ²¡æœ‰è¢«å¼•ç”¨çš„å¯¹è±¡ä¼šè¢«åžƒåœ¾å›žæ”¶ã€‚ import { Map} from 'immutable'; let a = Map({ select: 'users', filter: Map({ name: 'Cam' }) }) let b = a.set('select', 'people'); a === b; // false a.get('filter') === b.get('filter'); // true ä¸Šé¢ a å’Œ b å…±äº«äº†æ²¡æœ‰å˜åŒ–çš„ filter èŠ‚ç‚¹ã€‚ 3. Undo/Redoï¼ŒCopy/Pasteï¼Œç”šè‡³æ—¶é—´æ—…è¡Œè¿™äº›åŠŸèƒ½åšèµ·æ¥å°èœä¸€ç¢Ÿå› ä¸ºæ¯æ¬¡æ•°æ®éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œåªè¦æŠŠè¿™äº›æ•°æ®æ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œå‚¨å­˜èµ·æ¥ï¼Œæƒ³å›žé€€åˆ°å“ªé‡Œå°±æ‹¿å‡ºå¯¹åº”æ•°æ®å³å¯ï¼Œå¾ˆå®¹æ˜“å¼€å‘å‡ºæ’¤é”€é‡åšè¿™ç§åŠŸèƒ½ã€‚ ä¸ºä»€ä¹ˆåœ¨React.jsä¸­ä½¿ç”¨Immutable.jsç†Ÿæ‚‰React.jsçš„éƒ½åº”è¯¥çŸ¥é“ï¼ŒReact.jsæ˜¯ä¸€ä¸ªUI = f(states)çš„æ¡†æž¶ï¼Œä¸ºäº†è§£å†³æ›´æ–°çš„é—®é¢˜ï¼ŒReact.jsä½¿ç”¨äº†virtual domï¼Œvirtual domé€šè¿‡diffä¿®æ”¹domï¼Œæ¥å®žçŽ°é«˜æ•ˆçš„domæ›´æ–°ã€‚ å¬èµ·æ¥å¾ˆå®Œç¾Žå§ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ã€‚å½“stateæ›´æ–°æ—¶ï¼Œå¦‚æžœæ•°æ®æ²¡å˜ï¼Œä½ ä¹Ÿä¼šåŽ»åšvirtual domçš„diffï¼Œè¿™å°±äº§ç”Ÿäº†æµªè´¹ã€‚è¿™ç§æƒ…å†µå…¶å®žå¾ˆå¸¸è§ï¼Œå¦‚ï¼š ç†Ÿæ‚‰ React ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„è¯éƒ½çŸ¥é“ï¼šè°ƒç”¨ setState æ–¹æ³•æ€»æ˜¯ä¼šè§¦å‘ render æ–¹æ³•ä»Žè€Œè¿›è¡Œ vdom re-render ç›¸å…³é€»è¾‘ï¼Œå“ªæ€•å®žé™…ä¸Šä½ æ²¡æœ‰æ›´æ”¹åˆ° Component.state ã€‚ this.state = {count: 0} this.setState({count: 0});// ç»„ä»¶ state å¹¶æœªè¢«æ”¹å˜ï¼Œä½†ä»ä¼šè§¦å‘ render æ–¹æ³• ä¸ºäº†é¿å…è¿™ç§æ€§èƒ½ä¸Šçš„æµªè´¹ï¼ŒReact æä¾›äº†ä¸€ä¸ª shouldComponentUpdate æ¥æŽ§åˆ¶è§¦å‘ vdom re-render é€»è¾‘çš„æ¡ä»¶ã€‚äºŽæ˜¯ PureRenderMixin ä½œä¸ºä¸€ç§ä¼˜åŒ–æŠ€å·§è¢«ä½¿ç”¨ã€‚ä½†PureRenderMixinåªæ˜¯ç®€å•çš„æµ…æ¯”è¾ƒï¼Œä¸ä½¿ç”¨äºŽå¤šå±‚æ¯”è¾ƒã€‚é‚£æ€Žä¹ˆåŠžï¼Ÿï¼Ÿè‡ªå·±åŽ»åšå¤æ‚æ¯”è¾ƒçš„è¯ï¼Œæ€§èƒ½åˆä¼šéžå¸¸å·®ã€‚ è¿™æ—¶å€™ immutableJS å°±æ´¾å¾—ä¸Šç”¨åœºäº†ï¼š var map1 = Immutable.fromJS({a:1, b:1, c:{b:{c:{d:{e:7}}}}}); var map2 = Immutable.fromJS({a:1, b:1, c:{b:{c:{d:{e:7}}}}}); Immutable.is(map1, map2); // true æ¯ä¸€æ¬¡stateæ›´æ–°åªè¦æœ‰æ•°æ®æ”¹å˜ï¼Œé‚£ä¹ˆPureRenderMixinå¯ä»¥ç«‹åˆ»åˆ¤æ–­å‡ºæ•°æ®æ”¹å˜ï¼Œå¯ä»¥å¤§å¤§æå‡æ€§èƒ½ã€‚ å®žè·µä¸Ž React æ­é…ä½¿ç”¨ï¼ŒPure Renderå¯ä»¥ä½¿ç”¨ react-immutable-render-mixin é€šè¿‡es6çš„ä¿®é¥°å™¨ @decorator æ¥ä½¿ç”¨ import React from 'react'; import { immutableRenderDecorator } from 'react-immutable-render-mixin'; @immutableRenderDecorator class Test extends React.Component { render() { return &lt;div>&lt;/div>; } } æˆ–è€…ç›´æŽ¥ import immutableRenderMixin from 'react-immutable-render-mixin'; React.createClass({ mixins: [immutableRenderMixin], render: function() { return &lt;div className={this.props.className}>foo&lt;/div>; } }); ä¸Ž Redux æ­é…ä½¿ç”¨Redux æ˜¯ç›®å‰æµè¡Œçš„ Flux è¡ç”Ÿåº“ã€‚å®ƒç®€åŒ–äº† Flux ä¸­å¤šä¸ª Store çš„æ¦‚å¿µï¼Œåªæœ‰ä¸€ä¸ª Storeï¼Œæ•°æ®æ“ä½œé€šè¿‡ Reducer ä¸­å®žçŽ°ï¼›åŒæ—¶å®ƒæä¾›æ›´ç®€æ´å’Œæ¸…æ™°çš„å•å‘æ•°æ®æµï¼ˆView -> Action -> Middleware -> Reducerï¼‰ï¼Œä¹Ÿæ›´æ˜“äºŽå¼€å‘åŒæž„åº”ç”¨ã€‚ç›®å‰å·²ç»åœ¨æˆ‘ä»¬é¡¹ç›®ä¸­å¤§è§„æ¨¡ä½¿ç”¨ã€‚ ç”±äºŽ Redux ä¸­å†…ç½®çš„ combineReducers å’Œ reducer ä¸­çš„ initialState éƒ½ä¸ºåŽŸç”Ÿçš„ Object å¯¹è±¡ï¼Œæ‰€ä»¥ä¸èƒ½å’Œ Immutable åŽŸç”Ÿæ­é…ä½¿ç”¨ã€‚ å¹¸è¿çš„æ˜¯ï¼ŒRedux å¹¶ä¸æŽ’æ–¥ä½¿ç”¨ Immutableï¼Œå¯ä»¥è‡ªå·±é‡å†™ combineReducers æˆ–ä½¿ç”¨ redux-immutablejs æ¥æä¾›æ”¯æŒã€‚ æœ¬æ–‡åŽŸæ–‡é“¾æŽ¥ï¼š facebook immutable.js æ„ä¹‰ä½•åœ¨ï¼Œä½¿ç”¨åœºæ™¯ï¼Ÿ Immutable è¯¦è§£åŠ React ä¸­å®žè·µåŸºæœ¬æ²¡æœ‰æ”¹åŠ¨ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>Immutable</tag>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactåº”ç”¨æ€§èƒ½ä¼˜åŒ–ä¹‹shouldComponentUpdateä¸Žkey]]></title>
    <url>%2F2016%2F03%2F10%2FReact-optimize-with-shouldComponentUpdate-and-key.html</url>
    <content type="text"><![CDATA[Reactåº”ç”¨æ€§èƒ½ä¼˜åŒ–ä¹‹shouldComponentUpdateä¸Žkeyè™½ç„¶React çš„ vDom diffç®—æ³•èƒ½ä¿è¯æœ€å°ç¨‹åº¦çš„ DOM æ”¹å˜ï¼Œä½†å½“ç»„ä»¶æ ‘åµŒå¥—å¾—éžå¸¸æ·±æ—¶ï¼Œå°±ä¸å¾—ä¸éœ€è¦æ¸²æŸ“ä¸€ä¸ªæ–°çš„è™šæ‹Ÿ DOM æ¥è®©åº”ç”¨è¿è¡Œå¾—æ›´åŠ é«˜æ•ˆã€‚ ä¸‹é¢çœ‹çœ‹åŠ é€Ÿåº”ç”¨ç¨‹åºçš„ä¸¤ç§ç®€å•çš„é…ç½®æ–¹æ³•ï¼š shouldComponentUpdateè®¾ç½®æ–° propsï¼Œè°ƒç”¨ setState æ–¹æ³•æˆ– forceUpdate æ–¹æ³•æ—¶ï¼ŒReact éƒ½ä¼šè°ƒç”¨è¯¥ç»„ä»¶æ‰€æœ‰å­ç»„ä»¶çš„ render æ–¹æ³•ã€‚ä½†æ˜¯åœ¨ç»„ä»¶æ ‘æ·±åº¦åµŒå¥—æˆ– render æ–¹æ³•ååˆ†å¤æ‚çš„æ—¶ä¾¯ï¼Œé¡µé¢å°±ä¼šæœ‰å»¶è¿Ÿã€‚ ä½†æ­¤æ—¶ï¼ŒæŸäº›å­ç»„ä»¶å¹¶æ²¡æœ‰å¿…è¦æ›´æ–°ï¼Œæˆ–è€…æ°¸è¿œéƒ½ä¸éœ€è¦æ›´æ–°ï¼Œè¿™æ—¶è¿›è¡Œçš„è®¡ç®—è¿‡ç¨‹æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚ è€Œ shouldComponentUpdate æ–¹æ³•æ­£æ˜¯ç”¨æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨æŒ‡å®šç»„ä»¶çš„ render æ–¹æ³•ã€‚ shouldComponentUpdate æ–¹æ³•è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ã€‚false è¡¨ç¤ºä¸è¦è°ƒç”¨ render æ–¹æ³•ï¼›true è¡¨ç¤ºéœ€è¦è°ƒç”¨ render æ–¹æ³•è®¡ç®—å‡ºæ–°çš„è™šæ‹Ÿ DOMã€‚ æ­¤æ–¹æ³•çš„é»˜è®¤å€¼æ˜¯ trueã€‚ å¹¶ä¸”ï¼Œç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶ï¼ŒshouldComponentUpdate æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ shouldComponentUpdate æ–¹æ³•æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œæ–°çš„ props å’Œæ–°çš„ stateï¼š React.creatClass({ shouldComponentUpdate: function (nextProps, nextState) { return nextProps.id !== this.props.id } }) å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ  React.addons.PureRenderMixin æ’ä»¶æ¥å¤„ç† shouldComponentUpdateã€‚ è¿™ä¸ªæ’ä»¶ä¼šé‡å†™ shouldComponentUpdate æ–¹æ³•ï¼Œå¹¶åœ¨è¯¥æ–¹æ³•å†…å¯¹æ–°è€ props åŠ state è¿›è¡Œå¯¹æ¯”ï¼Œ å¦‚æžœå‘çŽ°å®ƒä»¬å®Œå…¨ä¸€è‡´åˆ™è¿”å›ž false, å°±åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·ã€‚å®˜æ–¹æ–‡æ¡£é‡Œä¹Ÿæœ‰ä»‹ç»ï¼š PureRenderMixin import PureRenderMixin from 'react-addons-pure-render-mixin'; class FooComponent extends React.Component { constructor(props) { super(props); this.shouldComponentUpdate = PureRenderMixin.shouldComponentUpdate.bind(this); } render() { return foo; } } key(é”®)åœ¨éåŽ†åˆ—è¡¨çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»„ä»¶æ·»åŠ  key å€¼ä¼šæœ‰ warnning äº§ç”Ÿã€‚é‚£å®ƒæ˜¯ç”¨æ¥å¹²å˜›çš„å‘¢ï¼Ÿ å‡è®¾æœ‰ä¸€ä¸ª div ç»„ä»¶ï¼Œå®ƒçš„ key å±žæ€§ä¸º â€˜fooâ€™ï¼Œä¹‹åŽåˆæ”¹ä¸º â€˜barâ€™ï¼Œ é‚£ React å°±ä¼šè·³è¿‡ DOM diffï¼Œ åŒæ—¶å®Œä¼šå¼ƒç½® div æ‰€æœ‰çš„å­å…ƒç´ ï¼Œå¹¶é‡æ–°æ¸²æŸ“ã€‚é™¤äº†å‘Šè¯‰ React ä»€ä¹ˆæ—¶å€™è¦æŠ›å¼ƒä¸€ä¸ªèŠ‚ç‚¹ä¹‹å¤–ï¼Œkey è¿˜å¯ä»¥åœ¨å…ƒç´ é¡ºåºæ”¹å˜æ—¶ä½¿ç”¨ã€‚ render: function(){ return items.map(function(item){ return item.name }) } å¦‚æžœåƒä¸Šé¢è¿™æ ·ï¼ŒReact åœ¨li åˆ—è¡¨é¡ºåºæ”¹å˜çš„æ—¶å€™å°±ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œè€Œæ˜¯é‡‡ç”¨ insertBefore æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯æœ€é«˜æ•ˆçš„æ–¹æ³•ã€‚ ä½†æ˜¯è¦æ³¨æ„ï¼Œkey å€¼å¿…é¡»æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œæœ€å¥½ä¸è¦æ˜¯æ•°å­—ï¼Œç»å¯¹ä¸èƒ½æ˜¯éåŽ†ä¸­çš„indexã€‚è¿™æ ·å¯ä»¥ä¿è¯ä»Žä¸€ä¸ªçˆ¶ç»„ä»¶ç§»åŠ¨åˆ°å¦ä¸€ä¸ªçˆ¶ç»„ä»¶çš„æƒ…å†µæ˜¯ä¸ä¼šè¢«å¤„ç†çš„ã€‚ key å€¼ä¹Ÿæ˜¯æ— æ³•è¯»å–çš„ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>shouldComponentUpdate</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœç´¢å‘½ä»¤ä¹‹locateã€whereisã€whichã€findã€grep]]></title>
    <url>%2F2016%2F03%2F07%2Fsearch-command-locate-whereis-which-find-grep.html</url>
    <content type="text"><![CDATA[æœç´¢å‘½ä»¤ä¹‹locateã€whereisã€whichã€findã€grepwhereisæœç´¢å‘½ä»¤æ‰€åœ¨è·¯å¾„åŠå¸®åŠ©æ–‡æ¡£æ‰€åœ¨ä½ç½® é€‰é¡¹ï¼š -b åªæŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ -m åªæŸ¥æ‰¾å¸®åŠ©æ–‡ä»¶ ä¹Ÿå¯ä»¥é€šè¿‡ whereis å‘½ä»¤æ¥åˆ¤æ–­æ˜¯å¦æ˜¯shellå†…éƒ¨å‘½ä»¤ whichæœç´¢å‘½ä»¤æ‰€åœ¨è·¯ä¹ˆåŠåˆ«å ä¸Žwhereisçš„åŒºåˆ«åœ¨äºŽ which ä¸ä»…å¯ä»¥æŸ¥çœ‹å‘½ä»¤æ‰€åœ¨è·¯å¾„ï¼Œè¿˜å¯ä»¥æŸ¥çœ‹åˆ°å‘½ä»¤çš„åˆ«å locateæœç´¢æ–‡ä»¶åæœ€å¿«çš„æ–¹å¼ï¼Œæ ¹æ®åŽå°æ•°æ®åº“/var/lib/mlocateæœç´¢ updatedb å‘½ä»¤æ‰‹åŠ¨æ›´æ–°æ•°æ®åº“ï¼Œæ•°æ®åº“æ›´æ–°ä¸æ˜¯å³æ—¶çš„ï¼Œä¸€èˆ¬éœ€è¦ä¸€å¤© /etc/updatedb.conf é…ç½®æ–‡ä»¶ï¼Œç”¨äºŽé…ç½®æœç´¢é™åˆ¶ findæœ€å¼ºå¤§çš„æœç´¢å‘½ä»¤ï¼Œä½†åŒæ—¶å¸¦æ¥æ€§èƒ½é—®é¢˜ find [æœç´¢èŒƒå›´] [æœç´¢æ¡ä»¶] -name æŒ‰æ–‡ä»¶åæœç´¢ -iname ä¸åŒºåˆ†å¤§å°å†™æœç´¢ -user æŒ‰ç…§æ‰€æœ‰è€…æœç´¢ -nouser æŸ¥æ‰¾æ²¡æœ‰æ‰€æœ‰è€…çš„æ–‡ä»¶ -mtime æŒ‰ä¿®æ”¹æ–‡ä»¶çš„æ—¥æœŸæœç´¢ï¼Œå¦‚ï¼š+10 æŸ¥æ‰¾10å¤©å‰ä¿®æ”¹çš„æ–‡ä»¶ï¼Œ -10 æŸ¥æ‰¾10å†…ä¿®æ”¹çš„æ–‡ä»¶ï¼Œ 10 æŸ¥æ‰¾10å¤©å½“å¤©ä¿®æ”¹çš„æ–‡ä»¶ -atime æ–‡ä»¶è®¿é—®æ—¶é—´ -ctime æ”¹å˜æ–‡ä»¶å±žæ€§æ—¶é—´ -size æŒ‰ç…§æ–‡ä»¶å¤§å°æŒ‰ç´¢ï¼Œå¦‚ï¼š find . -size 25kï¼Œæ³¨æ„ k æ˜¯å°å†™ï¼Œ Mæ˜¯å¤§å†™ -inum æŒ‰ç…§ièŠ‚ç‚¹æŸ¥æ‰¾æ–‡ä»¶ -a é€»è¾‘ä¸Ž and,ä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼Œå¦‚ï¼š find /root -size +20k -a -size -1M æŸ¥æ‰¾å¤§äºŽ20kä¸”å°äºŽ1Mçš„æ–‡ä»¶ -o é€»è¾‘æˆ– or,ä¸¤ä¸ªæ¡ä»¶æ»¡è¶³ä¸€ä¸ªå³å¯ -exec å‘½ä»¤ {} \; å¯¹æœç´¢ç»“æžœæ‰§è¡Œæ“ä½œï¼Œå¦‚ï¼š find /root -size 25k -exec rm -rf {} \; æŸ¥æ‰¾/rootç›®å½•ä¸‹25kå¤§å°çš„æ–‡ä»¶ä¹‹åŽåˆ é™¤ grepåœ¨æ–‡ä»¶ä¸­æœç´¢ç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸² é€‰é¡¹ï¼š -i å¿½ç•¥å¤§å°å†™ -v æŽ’é™¤æŒ‡å®šå­—ç¬¦ä¸² grep æ˜¯åŒ…å«åŒ¹é…ï¼Œåªè¦å«æœ‰åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œä¸€æ•´è¡Œéƒ½ä¼šè¾“å‡ºï¼›find æ˜¯å®Œå…¨åŒ¹é…ï¼Œåªè¾“å‡ºæ–‡ä»¶åå®Œå…¨ä¸€æ ·çš„æ–‡ä»¶]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fetch POST æŽ¥æ”¶ä¸åˆ°æ•°æ®ï¼Œæ³¨æ„ content-type çš„è®¾ç½®]]></title>
    <url>%2F2016%2F03%2F05%2Fresolve-fetch-post-no-response.html</url>
    <content type="text"><![CDATA[Fetch POST æŽ¥æ”¶ä¸åˆ°æ•°æ®ï¼Œæ³¨æ„ content-type çš„è®¾ç½®æœ€è¿‘æˆ‘ä»¬å‰ç«¯ç»„åœ¨åšä¸€ä¸ªç®€æ˜“çš„æ–‡æ¡£ç³»ç»Ÿï¼Œä½¿ç”¨redux+mongodbã€‚å…¶ä¸­æŠ›å¼ƒäº†Ajaxï¼Œèµ·ç”¨äº†Fetchã€‚ XMLHttpRequest æ˜¯ä¸€ä¸ªè®¾è®¡ç²—ç³™çš„ APIï¼Œä¸ç¬¦åˆå…³æ³¨åˆ†ç¦»ï¼ˆSeparation of Concernsï¼‰çš„åŽŸåˆ™ï¼Œé…ç½®å’Œè°ƒç”¨æ–¹å¼éžå¸¸æ··ä¹±ï¼Œè€Œä¸”åŸºäºŽäº‹ä»¶çš„å¼‚æ­¥æ¨¡åž‹å†™èµ·æ¥ä¹Ÿæ²¡æœ‰çŽ°ä»£çš„ Promiseï¼Œgenerator/yieldï¼Œasync/await å‹å¥½ã€‚ Fetch çš„å‡ºçŽ°å°±æ˜¯ä¸ºäº†è§£å†³ XHR çš„é—®é¢˜ï¼ŒFetch API æ˜¯åŸºäºŽ Promise è®¾è®¡ã€‚ åˆšå¼€å§‹ç”¨çš„æ—¶å€™å‘çŽ°ä¸ªé—®é¢˜ï¼ŒPOSTæ•°æ®å‘çŽ°åŽç«¯èŽ·å–ä¸åˆ°ï¼ŒGETæ–¹å¼æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚å¦‚ï¼š fetch('/group/update', { method: 'post', body: JSON.stringify(params) }) .then((response) => response.json()) .then((json) => dispatch(fetchUpdateGroupName(json, index))) .catch((err) => (console.log('err:', err))) ä»¥å‰ä¸€ç›´ç”¨Jquery Ajaxï¼Œå¾ˆå°‘æƒ…å†µéœ€è¦è®¾ç½®Content-Typeï¼Œè€Œä¸”çœ‹åˆ°æœ‰äº›åšæ–‡ä»‹ç»Fetchçš„æ—¶å€™è¯´ï¼ŒFetch()å¦‚æžœæ²¡æœ‰è®¾ç½®Content-Typeï¼Œä¼šè‡ªåŠ¨èŽ·å–ã€‚ åŽæ¥è¿˜æ˜¯è¢«å®¶ä¼˜æé†’ï¼Œä»¥ä¸‹ä»£ç æ‰æ˜¯æ­£ç¡®çš„è®¾ç½®ï¼š fetch('/group/update', { method: 'post', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(params) }) .then((response) => response.json()) .then((json) => dispatch(fetchUpdateGroupName(json, index))) .catch((err) => (console.log('err:', err))) æ³¨æ„ï¼š Fetch æ”¯æŒå‡ ç§æ•°æ®ç±»åž‹çš„ä¼ è¾“ï¼Œå…¶ä¸­åŒ…å«Blob, BLOB (binary large object)ï¼Œè¡¨ç¤ºäºŒè¿›åˆ¶å¤§å¯¹è±¡ã€‚å…¶ä¸­æœ‰ä¸ªåªè¯»å±žæ€§ï¼ŒBlob.type(),æ­¤æ—¶çš„ Content-Type åº”è®¾ç½®ä¸ºæ­¤å€¼ã€‚ è¿™é‡Œé¡ºä¾¿è®°å½•ä¸‹POSTå¸¸è§çš„Content-Type: application/x-www-form-urlencodedæµè§ˆå™¨çš„åŽŸç”Ÿ form è¡¨å•ï¼Œå¦‚æžœä¸è®¾ç½® enctype å±žæ€§ï¼Œé‚£ä¹ˆæœ€ç»ˆå°±ä¼šä»¥ application/x-www-form-urlencoded æ–¹å¼æäº¤æ•°æ®ã€‚æäº¤çš„æ•°æ®æŒ‰ç…§ key1=val1&key2=val2 çš„æ–¹å¼è¿›è¡Œç¼–ç ï¼Œkey å’Œ val éƒ½è¿›è¡Œäº† URL è½¬ç ã€‚ POST http://www.123.com HTTP/1.1 Content-Type: application/x-www-form-urlencoded;charset=utf-8 title=test&sub%5B%5D=1&sub%5B%5D=2&sub%5B%5D=3 multipart/form-dataä½¿ç”¨è¡¨å•ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå¿…é¡»è®© form çš„ enctyped ç­‰äºŽè¿™ä¸ªå€¼, ä¸Šä¼ å›¾ç‰‡æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°ä¸‹é¢è¿™æ · POST http://www.example.com HTTP/1.1 Content-Type:multipart/form-data; boundary=----WebKitFormBoundaryrGKCBY7qhFd3TrwA ------WebKitFormBoundaryrGKCBY7qhFd3TrwA Content-Disposition: form-data; name="text" title ------WebKitFormBoundaryrGKCBY7qhFd3TrwA Content-Disposition: form-data; name="file"; filename="chrome.png" Content-Type: image/png PNG ... content of chrome.png ... ------WebKitFormBoundaryrGKCBY7qhFd3TrwA-- å¦‚æžœæˆ‘ä»¬ä½¿ç”¨ new FormData()ä½œä¸ºæ•°æ®ä¸»ä½“æäº¤ï¼Œä¹Ÿéœ€è¦è®¾ç½®è¿™ç§ç±»åž‹ã€‚ application/jsonæŠŠå®ƒä½œä¸ºè¯·æ±‚å¤´ï¼Œç”¨æ¥å‘Šè¯‰æœåŠ¡ç«¯æ¶ˆæ¯ä¸»ä½“æ˜¯åºåˆ—åŒ–åŽçš„ JSON å­—ç¬¦ä¸²ã€‚ä½†ä¹Ÿæœ‰äº›æœåŠ¡ç«¯è¯­è¨€è¿˜æ²¡æœ‰æ”¯æŒè¿™ç§æ–¹å¼ï¼Œä¾‹å¦‚ php å°±æ— æ³•é€šè¿‡ $_POST å¯¹è±¡ä»Žä¸Šé¢çš„è¯·æ±‚ä¸­èŽ·å¾—å†…å®¹ã€‚è¿™æ—¶å€™ï¼Œéœ€è¦è‡ªå·±åŠ¨æ‰‹å¤„ç†ä¸‹ï¼šåœ¨è¯·æ±‚å¤´ä¸­ Content-Type ä¸º application/json æ—¶ï¼Œä»Ž php://input é‡ŒèŽ·å¾—åŽŸå§‹è¾“å…¥æµï¼Œå† json_decode æˆå¯¹è±¡ã€‚ å‚è€ƒï¼š å››ç§å¸¸è§çš„ POST æäº¤æ•°æ®æ–¹å¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>fetch</tag>
        <tag>content-type</tag>
        <tag>POST</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•å°‘åŸ‹å‘-è‰¾ç¥žåˆ†äº«ä¼š]]></title>
    <url>%2F2016%2F03%2F04%2Fshare-from-mr.ai.html</url>
    <content type="text"><![CDATA[åˆå¾ˆä¹…æ²¡æœ‰è®°å½•ä¸œè¥¿äº†ï¼ŒçœŸæ˜¯ä¸ªä¸è‡ªå¾‹çš„äºº- -ï¼ åŽ»å¹´åæœˆè¿›å…¥æœèŠ½ï¼Œæ„Ÿè§‰æœèŠ½æ˜¯ä¸€ä¸ªå…±åŒæˆé•¿çš„å…¬å¸ï¼Œæœ‰ä¸€ç§äº²åˆ‡æ„Ÿã€‚è¿™ç®—æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è¿›ä¸€ä¸ªå‰ç«¯å›¢é˜Ÿæ¯”è¾ƒå¤§çš„å…¬å¸ï¼Œå¾ˆå¤šæƒ³æ³•åœ¨åˆ†äº«ä¸Žè®¨è®ºä¸­è¿¸å‘ã€‚ æœ€è¿‘äº§å“åœ¨é¢„çƒ­ä¸­ï¼Œç›¸å¯¹æœ‰ç©ºï¼Œæˆ‘ä»¬å‰ç«¯ä¹Ÿåœ¨å°è¯•ä¸€äº›æ–°æŠ€æœ¯çš„åº”ç”¨,ç”¨react-reduxåšä¸€ä¸ªç®€æ˜“çš„æ–‡æ¡£ç³»ç»Ÿã€‚é™¤äº†å®¶ä¼˜å¯¹æŠ€æœ¯æž¶æž„æ¯”è¾ƒç†Ÿï¼Œæˆ‘ä»¬å‡ ä¸ªéƒ½æ¯”è¾ƒç”Ÿç–ã€‚ä½†æ˜¯æœ€é‡è¦æ˜¯ä¸è¦å¿ƒæµ®æ°”ç‡¥ï¼Œè™½ç„¶æœ€è¿‘å¿ƒæƒ…ä¸æ˜¯å¾ˆå¥½ï¼Œä½†æˆ‘è¿˜æ˜¯å°½é‡é™ä¸‹å¿ƒæ¥ç ”è¯»æ–‡æ¡£ï¼Œåœ¨å¼€å‘ä¸­ä¸€æ­¥ä¸€å‘åœ°èµ°ä¸‹åŽ»ã€‚ ç ”å‘éƒ¨ä¹Ÿåœ¨ç»„ç»‡åˆ†äº«ä¼šï¼Œä»Šå¤©æ˜¯ç¬¬ä¸€æ¬¡åˆ†äº«ä¼šï¼Œè‰¾ç¥žå®šçš„ä¸»é¢˜æ˜¯httpåè®®ï¼Œä¸»è¦å’Œå¤§å®¶åˆ†äº«ä¸€ä¸ªhttpè¯·æ±‚ä»Žå®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯å¤„ç†è¿”å›žçš„æ•´ä¸ªè¿‡ç¨‹ã€‚ è¯´åˆ°è‰¾ç¥žï¼Œå½“åˆè§åˆ°ä»–çš„ç¬¬ä¸€å°è±¡å°±æ˜¯æ²¡ä»€ä¹ˆå°è±¡ï¼Œè€å®žã€æ™®é€šï¼Œæ‰€ä»¥å½“æ—¶ä¸æ˜¯å¾ˆæ˜Žç™½ä¸ºä»€ä¹ˆå¤§å®¶å«ä»–è‰¾ç¥žã€‚ä¸è¿‡åŽæ¥å‘çŽ°ï¼Œè‰¾ç¥žç¡®å®žæ˜¯ä¸€ä¸ªå¾ˆè¸å®žçš„äººï¼Œä»–æ˜¯å†™javaçš„ï¼ŒåŠŸåŠ›å¾ˆæ·±ï¼Œé€»è¾‘å¾ˆä¸¥è°¨ã€‚å’Œä»–ä¸€èµ·åƒé¥­çš„æ—¶å€™ï¼Œå¾ˆå–œæ¬¢å’Œæˆ‘ä»¬â€˜è®²è¯¾â€™ã€‚ å½“ç„¶ï¼Œåˆ†äº«ä¼šå…¶ä»–è®²httpåè®®ä¸æ˜¯ä»–çš„çœŸæ­£ç›®çš„ï¼Œä»–å»¶ä¼¸å‡ºæ¥çš„ç›¸å…³æ¡ˆä¾‹æ‰æ˜¯é‡ç‚¹ã€‚è‰¾ç¥žè®²åè®®ï¼Œæ˜¯æƒ³è®©æˆ‘ä»¬è¦æ³¨æ„åˆ†æ¸…ä»€ä¹ˆæ˜¯æ ‡å‡†ï¼Œä»€ä¹ˆæ˜¯æŠ•æœºã€‚å·¥ä½œä¸­è¦çŸ¥é“é”™çš„ä¸ºä»€ä¹ˆé”™ï¼Œä¹Ÿè¦çŸ¥é“å¯¹çš„ä¸ºä»€ä¹ˆå¯¹ï¼Œè¦æŠŠç¨‹åºçš„è¿è¡ŒæŠŠæŽ§åœ¨è‡ªå·±æ‰‹ä¸­ï¼Œä¸èƒ½å­˜åœ¨ä¸ç¡®å®šæ€§ã€‚å¦åˆ™åŸ‹äº†å‘ï¼Œä¸€æ—¦å‡ºçŽ°é—®é¢˜ï¼Œå°±è¦èŠ±æ›´å¤šçš„æ—¶é—´åŽ»æŽ’æŸ¥ã€‚ æˆ‘ä¹Ÿæ˜¯è§è¿‡å¤ªå¤šç¨‹åºå‘˜ï¼Œå¯¹ä¸€äº›é—®é¢˜ååˆ†é©¬è™Žï¼Œé”™äº†å°±ä¸æ–­æŽ¨è„±ï¼Œæœ‰æ—¶å€™bugè¡¥ä¸Šäº†å´ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ®Šä¸çŸ¥å¯èƒ½åŸ‹äº†æ›´å¤§çš„å‘ã€‚ è‰¾ç¥žæ˜¯ä¸ªå¾ˆé è°±çš„ç¨‹åºå‘˜]]></content>
      <categories>
        <category>workflow</category>
      </categories>
      <tags>
        <tag>review</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascript èŽ·å–æœ¬å‘¨å’Œæœ¬æœˆæˆ–ä»»æ„æœˆçš„æ—¶é—´æ®µ]]></title>
    <url>%2F2015%2F10%2F30%2Fjavascript-get-the-time-period-of-the-week-and-this-month-or-any-month.html</url>
    <content type="text"><![CDATA[javascript èŽ·å–æœ¬å‘¨å’Œæœ¬æœˆæˆ–ä»»æ„æœˆçš„æ—¶é—´æ®µæœ€è¿‘æœ‰åŠŸèƒ½ä»Žä¸¤ä¸ªæ—¶é—´æ®µå˜æˆå•ä¸ªselecté€‰æ‹©äº†ï¼Œä½†åŽç«¯ä¸æƒ³æ”¹æŽ¥å£ã€‚åªå¥½é€‚é…ä¸€ä¸‹ï¼ŒæŠŠä»Šå¤©ã€æœ¬å‘¨ã€æœ¬æœˆåŠè¿‡åŽ»çš„æœˆä»½è½¬æ¢ä¸€ä¸‹ã€‚ é¦–å…ˆï¼Œæ›´æ”¹ä¸€ä¸‹selectèœå•ï¼ŒåŠ¨æ€å–å‡ºè¿‡åŽ»çš„æœˆä»½ï¼Œæ·»åŠ optionsã€‚ var SearchTimer = ['å…¨éƒ¨', 'ä»Šå¤©', 'æœ¬å‘¨', 'æœ¬æœˆ']; (function(){ var Month = new Date().getMonth(); for(; Month > 0; Month--){ SearchTimer.push(Month + 'æœˆä»½'); } })(); æŽ¥ä¸‹æ¥å°±æ˜¯è¦æŠŠå„ä¸ªoptionsåœ¨é€‰æ‹©çš„æ—¶å€™è½¬æ¢æˆstartTimeå’ŒendTime. switch(timer){ case 'å…¨éƒ¨': break; case 'ä»Šå¤©': break; case 'æœ¬å‘¨': break; case 'æœ¬æœˆ': break; default: } ç„¶åŽæ˜¯æ—¶é—´çš„å¤„ç†ï¼Œå…ˆéœ€è¦æ ¼å¼åŒ–æ—¶é—´ï¼Œæ³¨æ„è¡¥é›¶ï¼Œæ ¼å¼ä¸ºyyyy-MM-dd HH:mm:ssã€‚ function formatDate(date) { var myyear = date.getFullYear(); var mymonth = date.getMonth()+1; var myweekday = date.getDate(); var myhours = date.getHours(); var myminutes = date.getMinutes(); var myseconds = date.getSeconds(); if(mymonth &lt; 10){mymonth = "0" + mymonth; } if(myweekday &lt; 10){myweekday = "0" + myweekday; } if(myhours &lt; 10){myhours = "0" + myhours; } if(myminutes &lt; 10){myminutes = "0" + myminutes; } if(myseconds &lt; 10){myseconds = "0" + myseconds; } return (myyear+"-"+mymonth + "-" + myweekday+" "+myhours+":"+myminutes+":"+myseconds); } ä»Šå¤©çš„æ—¶é—´å¾ˆå¥½èŽ·å–ï¼Œç„¶åŽæ˜¯æœ¬å‘¨æ—¶é—´ï¼š var now = new Date(); //å½“å‰æ—¥æœŸ var nowDayOfWeek = now.getDay(); //ä»Šå¤©æœ¬å‘¨çš„ç¬¬å‡ å¤© var nowDay = now.getDate(); //å½“å‰æ—¥ var nowMonth = now.getMonth(); //å½“å‰æœˆ var nowYear = now.getFullYear(); //å½“å‰å¹´ function getWeekStartDate() { //èŽ·å¾—æœ¬å‘¨çš„å¼€ç«¯æ—¥æœŸ var weekStartDate = new Date(nowYear, nowMonth, nowDay - nowDayOfWeek); return formatDate(weekStartDate); //è°ƒç”¨ä¸Šé¢çš„æ—¶é—´æ ¼å¼åŒ– } function getWeekEndDate() { //èŽ·å¾—æœ¬å‘¨çš„åœæ­¢æ—¥æœŸ var weekEndDate = new Date(nowYear, nowMonth, nowDay + (6 - nowDayOfWeek)); return formatDate(weekEndDate); } ç„¶åŽæ˜¯æœ¬æœˆæ—¶é—´ï¼Œä½†é¦–å…ˆéœ€è¦çŸ¥é“æœ¬æœˆæœ‰å¤šå°‘å¤©ï¼š function getMonthDays(myMonth){ //èŽ·å¾—æŸæœˆçš„å¤©æ•° myMonth = parseInt(myMonth); //è¿™ä¸€æ­¥å¾ˆé‡è¦ï¼Œæœ‰æ—¶å€™ä¼ è¿›æ¥çš„å¯èƒ½æ˜¯å­—ç¬¦ä¸²ï¼ŒåŽé¢+1çš„æ—¶å€™ä¼šå˜æˆå­—ç¬¦ä¸²ç›¸è¿ž var monthStartDate = new Date(nowYear, myMonth, 1); //å½“æœˆ1å·çš„æ—¶é—´æˆ³ var monthEndDate = new Date(nowYear, myMonth + 1, 1);//ä¸‹æœˆ1å·çš„æ—¶é—´æˆ³ var days = (monthEndDate - monthStartDate)/(1000 * 60 * 60 * 24);//æ±‚å·®å³å¯å–å¾—æŸæœˆå¤©æ•° return days; } function getMonthStartDate(){ //èŽ·å¾—æœ¬æœˆçš„å¼€ç«¯æ—¥æœŸ var monthStartDate = new Date(nowYear, nowMonth, 1); return formatDate(monthStartDate); } function getMonthEndDate(){ //èŽ·å¾—æœ¬æœˆçš„åœæ­¢æ—¥æœŸ var monthEndDate = new Date(nowYear, nowMonth, getMonthDays(nowMonth)); return formatDate(monthEndDate); } ç„¶åŽæ˜¯è¿‡åŽ»ä»»æ„æœˆä»½çš„1å·å’Œæœ€åŽä¸€å¤©ï¼š var theMon = timer.replace(/(æœˆä»½)$/, '')-1; //å…ˆåŒ¹é…å‡ºselectçš„æœˆä»½ï¼Œå¦‚ï¼šâ€˜9æœˆä»½â€™ï¼Œä½†getMonth()æ˜¯ä»Ž0å¤©å§‹çš„ï¼Œæ‰€ä»¥éœ€è¦å‡1ï¼Œä¹Ÿæ­£å¥½å¯ä»¥è½¬æ¢æˆæ•´åž‹ startTime = formatDate(new Date(nowYear, theMon, 1)); endTime = formatDate(new Date(nowYear, theMon, getMonthDays(theMon)));//æŸæœˆæœ‰å‡ å¤©ï¼Œæœ€åŽä¸€å¤©å°±æ˜¯å‡ å¤©ã€‚ æ‰€ä»¥æœ€åŽè¿”å›žæ—¶é—´æ®µï¼š var startTime, endTime; endTime = formatDate(new Date()); switch(timer){ case 'å…¨éƒ¨': startTime = undefined; endTime = undefined; break; case 'ä»Šå¤©': startTime = formatDate(new Date(nowYear, nowMonth, nowDay)); break; case 'æœ¬å‘¨': startTime = getWeekStartDate(); break; case 'æœ¬æœˆ': startTime = getMonthStartDate(); break; default: var theMon = timer.replace(/(æœˆä»½)$/, '')-1; startTime = formatDate(new Date(nowYear, theMon, 1)); endTime = formatDate(new Date(nowYear, theMon, getMonthDays(theMon))); break; } return { startTime: startTime, endTime: endTime } è‡³æ­¤å°±è½¬æ¢å®Œæ¯•ã€‚ å½“ç„¶ï¼Œå¦‚æžœæœ‰éœ€è¦ï¼Œè¿˜å¯èƒ½èŽ·å–å­£åº¦ã€‚ function getQuarterStartMonth(){ //èŽ·å¾—æœ¬å­£åº¦çš„å¼€ç«¯æœˆä»½ var quarterStartMonth = 0; if(nowMonth&lt;3){quarterStartMonth = 0; }//åˆ¤æ–­å±žäºŽç¬¬ä¸€å­£åº¦ if(2&lt;nowMonth &amp;&amp; nowMonth&lt;6){quarterStartMonth = 3; } if(5&lt;nowMonth &amp;&amp; nowMonth&lt;9){quarterStartMonth = 6; } if(nowMonth>8){quarterStartMonth = 9; } return quarterStartMonth; } åªè¦åˆ¤æ–­å±žäºŽå“ªä¸€å­£åº¦ï¼Œå³å¯çŸ¥é“å¼€ç«¯æœˆä»½å’Œç»“æŸæœˆä»½ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[angularJSè‡ªå®šä¹‰æŒ‡ä»¤]]></title>
    <url>%2F2015%2F10%2F17%2Fangular-comorized-directive.html</url>
    <content type="text"><![CDATA[angularJSè‡ªå®šä¹‰æŒ‡ä»¤æŒ‡ä»¤å¯ä»¥ç®€å•ç†è§£æˆç‰¹å®šDOMå…ƒç´ ä¸Šæ‰§è¡Œçš„å‡½æ•°ï¼Œå®ƒå¯ä»¥æ‹“å±•å…ƒç´ çš„åŠŸèƒ½ã€‚ ä¸€ä¸ªå®šä¹‰æŒ‡ä»¤çš„åŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼š angular.module('myApp', []) .directive('myDirective', function(){ return { //æŒ‡ä»¤çš„é…ç½®é¡¹ } }); directive() æ–¹æ³•å¯ä»¥æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼š nameæŒ‡ä»¤çš„åå­—ï¼Œå¦‚ï¼š myDirectiveã€‚åœ¨DOMä¸­å¯ä»¥è¿™æ ·ä½¿ç”¨: ``;æˆ–è€… ``; å®šä¹‰æŒ‡ä»¤æ—¶çš„åç§°ç”¨é©¼å³°å‘½åï¼Œä½¿ç”¨æ—¶ç”¨ä¸­åˆ’çº¿æ–¹å¼ã€‚ functionè¿™ä¸ªå‡½æ•°å¯ä»¥è¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚ä¸Šé¢ï¼›æˆ–è€…ç›´æŽ¥è¿”å›žä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä¼šè¢«æŽ¥æ”¶æˆ postLink å‡½æ•°ã€‚ æŒ‡ä»¤çš„è¿”å›žå‡½æ•°çš„æ‰€æœ‰é…ç½®é¡¹å…ˆçœ‹çœ‹æŒ‡ä»¤çš„æ‰€æœ‰å‚æ•°é…ç½®ï¼š angular.module('myApp', []) .directive('myDirective', function(){ return { restrict: string,//æŒ‡ä»¤åœ¨DOMä¸­çš„å£°æ˜Žå½¢å¼å­—ç¬¦ä¸²ï¼Œé»˜è®¤å€¼æ˜¯â€˜Aâ€™ proiority: number,//ä¼˜å…ˆçº§ï¼Œé»˜è®¤å€¼0 terminal: boolean,//æ˜¯å¦åœæ­¢è¿è¡Œå½“å‰å…ƒç´ æ¯”æœ¬æŒ‡ä»¤ä¼˜å…ˆçº§ä½Žçš„æŒ‡ä»¤ template: string or function,//æ¨¡æ¿ æˆ– è¿”å›žæ¨¡æ¿çš„å‡½æ•° templateUrl: string,//æ¨¡æ¿æ–‡ä»¶çš„é“¾æŽ¥ replace: boolean or string,//trueä¸ºæ›¿æ¢ï¼Œé»˜è®¤å€¼falseä¸ºæ’å…¥åˆ°æŒ‡ä»¤å…ƒç´ å†…éƒ¨ scope: boolean or object,//æŒ‡ä»¤ä½œç”¨åŸŸ transclude: boolean,//åµŒå…¥ controller: string or function(scope, element, attrs, transcluude, otherInjectables){}, require: string, link: function(scope, iElement, iAttrs){}, compile: function(tElement, tAttrs, transclude){ return { pre: function(scope, iElement, iAttrs, controller){}, post: function(scope, iElement, iAttrs, controller){} } return function postLink(){} } } }); 1. restrictå¯é€‰å€¼ï¼š E(å…ƒç´ ï¼Œç”¨äºŽç‹¬ç«‹çš„æŒ‡ä»¤å•å…ƒï¼Œæ„å›¾è¡¨è¾¾æ›´æ˜Žç¡®) A(å±žæ€§ï¼Œé»˜è®¤å€¼, æœ€å¸¸ç”¨ï¼Œå…¼å®¹æ€§æœ€å¥½) C(ç±»å) M(æ³¨é‡Šï¼Œå°½é‡é¿å…ä½¿ç”¨) 2. priorityé»˜è®¤å€¼æ˜¯0ï¼›ä¼˜å…ˆçº§é«˜çš„æŒ‡ä»¤æ€»æ˜¯ä¼˜å…ˆæ‰§è¡Œã€‚ä¼˜å…ˆçº§ç›¸åŒçš„æŒ‡ä»¤ï¼Œå…ˆå£°æ˜Žçš„å…ˆæ‰§è¡Œã€‚ 3. terminalè®¾ç½®ä¸ºtrue,åˆ™åœæ­¢è¿è¡Œå½“å‰å…ƒç´ ä¸Šæ¯”æœ¬æŒ‡ä»¤ä¼˜å…ˆçº§ä½Žçš„æŒ‡ä»¤ï¼Œä½†ä¼˜å…ˆçº§ç›¸åŒçš„ä»ç„¶ä¼šæ‰§è¡Œã€‚ 4. templateå€¼å¯ä»¥æ˜¯ä»¥ä¸‹ç±»åž‹ï¼š a. æ¨¡æ¿å­—ç¬¦ä¸² b. ä¸€ä¸ªå¯ä»¥æŽ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¹¶è¿”å›žä¸€ä¸ªä»£è¡¨æ¨¡æ¿çš„å­—ç¬¦ä¸² 5. templateUrlå€¼å¯ä»¥æ˜¯ä»¥ä¸‹ç±»åž‹ï¼š a. å¤–éƒ¨htmlæ–‡ä»¶è·¯å¾„çš„å­—ç¬¦ä¸² b. ä¸€ä¸ªå¯ä»¥æŽ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¹¶è¿”å›žä¸€ä¸ªå¤–éƒ¨HTMLæ–‡ä»¶è·¯å¾„çš„å­—ç¬¦ä¸² 6. replaceé»˜è®¤å€¼false. å€¼ä¸º true æ—¶ï¼Œæ¨¡æ¿ä¼šè¢«å½“ä½œå­å…ƒç´ æ’å…¥åˆ°è°ƒç”¨æ­¤æŒ‡ä»¤çš„å…ƒç´ å†…éƒ¨ 7. scopeå¯é€‰å€¼ï¼š false: é»˜è®¤å€¼ï¼Œç›´æŽ¥è°ƒç”¨ç›¸åŒçš„ä½œç”¨åŸŸå¯¹è±¡ï¼› true: ä»Žå½“å‰ä½œç”¨åŸŸå¯¹è±¡ç»§æ‰¿ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸå¯¹è±¡ï¼› {}[object]: åˆ›å»ºä¸€ä¸ªåŒå½“å‰ä½œç”¨åŸŸç›¸éš”ç¦»çš„ä½œç”¨åŸŸå¯¹è±¡ã€‚ éš”ç¦»ä½œç”¨åŸŸå…·æœ‰éš”ç¦»ä½œç”¨åŸŸçš„æŒ‡ä»¤æœ€ä¸»è¦çš„ä½¿ç”¨åœºæ™¯æ˜¯åˆ›å»ºå¯å¤ç”¨çš„ç»„ä»¶ï¼Œç»„ä»¶å¯ä»¥åœ¨æœªçŸ¥ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”å¯ä»¥é¿å…æ±¡æŸ“æ‰€å¤„çš„å¤–éƒ¨ä½œç”¨åŸŸæˆ–ä¸ç»æ„åœ°æ±¡æŸ“å†…éƒ¨ä½œç”¨åŸŸã€‚ ç»‘å®šç­–ç•¥ä½¿ç”¨äº†éš”ç¦»ä½œç”¨åŸŸåŽï¼ŒæŒ‡ä»¤çš„æ¨¡æ¿å°±æ— æ³•è®¿é—®å¤–éƒ¨ä½œç”¨åŸŸäº†ã€‚ä½†ä½¿ç”¨æ— æ•°æ®çš„éš”ç¦»ä½œç”¨åŸŸå¹¶ä¸å¸¸è§ã€‚AngularJS æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥å°†æŒ‡ä»¤å†…éƒ¨çš„éš”ç¦»ä½œç”¨åŸŸåŒå¤–éƒ¨ä½œç”¨åŸŸè¿›è¡Œæ•°æ®ç»‘å®šã€‚ æœ¬åœ°ä½œç”¨åŸŸå±žæ€§ï¼š@ (or @attr) ä½¿ç”¨@ç¬¦å·å°†æœ¬åœ°ä½œç”¨åŸŸåŒDOMå±žæ€§çš„å€¼è¿›è¡Œç»‘å®šã€‚æŒ‡ä»¤å†…éƒ¨ä½œç”¨åŸŸå¯ä»¥ä½¿ç”¨å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡ã€‚ js myApp.controller('myController', ['$scope', function($scope){ $scope.btnText = 'æŒ‰é’®'; $scope.validate= '1234'; $scope.submit = function(err){ console.log(err); } }]); myApp.directive('my-btn', function(){ return { restrict: 'EA', scope: { text: '@btnText'//keyæ˜¯åœ¨templateé‡Œä½¿ç”¨çš„å˜é‡ï¼Œvalæ˜¯åœ¨ä½¿ç”¨æŒ‡ä»¤æ—¶æ‰€ç»‘å®šçš„attrã€‚è‹¥@ç¬¦å·åŽä¸æŒ‡å®šåç§°ï¼Œåˆ™é»˜è®¤ç»‘å®šä¸ºé”®å'text' }, replace: true, template: '{{text}}'//è¿™é‡Œçš„{{text}}æ­£æ˜¯scopeçš„text. } }); html //è¿™é‡Œçš„å±žæ€§â€˜btn-textâ€™æ­£æ˜¯æŒ‡ä»¤çš„â€˜@btnTextâ€™,å±žæ€§å€¼â€˜btnTextâ€™æ­£æ˜¯çˆ¶çº§ä½œç”¨åŸŸçš„â€˜$scope.btnTextâ€™ åŒå‘ç»‘å®šï¼š = (or =attr) å¯ä»¥å°†æœ¬åœ°ä½œç”¨åŸŸä¸Šçš„å±žæ€§åŒçˆ¶çº§ä½œç”¨åŸŸä¸Šçš„å±žæ€§è¿›è¡ŒåŒå‘çš„æ•°æ®ç»‘å®šã€‚ ä¾‹ï¼š js,controlleråŒä¸Šä¸€ä¾‹å­,å¦‚æžœç†è§£ä¸Šé¢çš„ä¾‹å­ï¼Œè¿™é‡Œä¹Ÿæ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œåªæ˜¯ç»‘å®šçš„ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯åŒå‘æ•°æ®ç»‘å®šã€‚ myApp.directive('myInput', function(){ return { restrict: 'A', scope:{ val: '=value'//keyä¸ºtemplateé‡Œçš„æ•°æ®æ¨¡åž‹ï¼Œ'value'æ˜¯htmlé‡Œçš„attr. }, template: '' } }); html //æœ¬åœ°ä½œç”¨åŸŸçš„å±žæ€§valä¸Žçˆ¶çº§ä½œç”¨åŸŸçš„å±žæ€§validateè¿›è¡ŒåŒå‘æ•°æ®ç»‘å®š çˆ¶çº§ä½œç”¨åŸŸç»‘å®šï¼š & (or &attr) å¯ä»¥å¯¹çˆ¶çº§ä½œç”¨åŸŸè¿›è¡Œç»‘å®šï¼Œå¯ä»¥è°ƒç”¨çˆ¶æ–¹æ³•ã€‚æ„å‘³ç€å¯¹è¿™ä¸ªå€¼è¿›è¡Œè®¾ç½®æ—¶ä¼šç”Ÿæˆä¸€ä¸ªæŒ‡å‘çˆ¶çº§ä½œç”¨åŸŸçš„åŒ…è£…å‡½æ•°ã€‚ js myApp.directive('myError', function(){ return { restrict: 'A', scope: { validate: '&check' }, template: ''+ ''//ä¼ é€’å‚æ•°éœ€è¦ä¼ é€’ä¸€ä¸ªå¯¹è±¡ï¼Œnameæ˜¯å‚æ•°åï¼Œtextæ˜¯å‚æ•°å€¼ã€‚ } }); html //å› ä¸ºæ˜¯éš”ç¦»ä½œç”¨åŸŸï¼Œä»–ä»¬ä¹‹é—´çš„å€¼æ˜¯ä¸ä¼šäº’ç›¸å½±å“çš„ï¼Œåªæ˜¯å…±ç”¨çˆ¶æ–¹æ³•ã€‚ è¦è°ƒç”¨ä¸€ä¸ªå¸¦æœ‰å‚æ•°çš„çˆ¶æ–¹æ³•ï¼Œéœ€è¦ä¼ é€’ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„keyæ˜¯å‚æ•°åç§°ï¼Œvalæ˜¯è¦ä¼ é€’ç»™å‚æ•°çš„å†…å®¹ 8. transcludetranscludeæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯false, å½“å€¼ä¸ºtrueæ—¶ï¼ŒangularJSä¼šå°†ä»ŽDOMå…ƒç´ ä¸­èŽ·å–çš„å†…å®¹æ”¾åˆ°å®ƒå‘çŽ°ng-transcludeæŒ‡ä»¤çš„åœ°æ–¹ï¼Œå¦‚ï¼š first second angular.module('myApp', []) .directive('sidebox', function(){ return { scope: { title: '@' }, transclude: true, template: ''+ '' } }); åªæœ‰å¸Œæœ›åˆ›å»ºä¸€ä¸ªå¯ä»¥åŒ…å«ä»»æ„å†…å®¹çš„æŒ‡ä»¤æ—¶ï¼Œæ‰ä½¿ç”¨transclude: trueã€‚ï¼Œå…¸åž‹çš„ä¾‹å­æ˜¯æ¨¡æ€æ¡†æˆ–å¯¼èˆªæ ã€‚ 9. controllerå€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå‡½æ•°ã€‚ string: å½“è®¾ç½®ä¸ºå­—ç¬¦ä¸­æ—¶ï¼ŒæŒ‡ä»¤ä¼šæŸ¥æ‰¾æ³¨å†Œåœ¨åº”ç”¨ä¸­çš„åŒåæŽ§åˆ¶å™¨ã€‚ function: ç›´æŽ¥é€šè¿‡åŒ¿åæž„é€ å‡½æ•°çš„æ–¹å¼æ¥å®šä¹‰ä¸€ä¸ªå†…è”çš„æŽ§åˆ¶å™¨ã€‚ æŽ§åˆ¶å™¨ä¸»è¦æ˜¯ç”¨æ¥æä¾›å¯ä»¥æŒ‡ä»¤é—´å¤ç”¨çš„è¡Œä¸ºã€‚å¯ä»¥çš„å°†å½“å‰æŒ‡ä»¤çš„APIæš´éœ²ç»™å…¶ä»–çš„æŒ‡ä»¤ä½¿ç”¨ã€‚å¦‚ï¼š angular.modue('myApp', []) .directive('inputForm', function(){ return { restrict: 'EA', controller: function($scope){ $scope.input = 'æ‰‹æœºå·'; this.submit = function(){//é€šè¿‡thisæš´éœ²æŽ¥å£ //do something... } } } }); ä»»æ„çš„æœåŠ¡åŒæ ·å¯ä»¥è¢«ä¼ é€’ç»™controllerã€‚å…¶ä¸­æœ‰ä¸€äº›ç‰¹æ®Šçš„æœåŠ¡ï¼š $scope ä¸ŽæŒ‡ä»¤å…ƒç´ ç›¸å…³è”çš„å½“å‰ä½œç”¨åŸŸ $element å½“å‰æŒ‡ä»¤å¯¹åº”çš„å…ƒç´  $attrs å½“å‰å…ƒç´ çš„å±žæ€§ç»„æˆçš„å¯¹è±¡ $transclude transcludeé“¾æŽ¥å‡½æ•°æ˜¯å®žé™…è¢«æ‰§è¡Œç”¨æ¥å…‹éš†å…ƒç´ å’Œæ“ä½œDOMçš„å‡½æ•° 10. controllerAscontrollerAsç”¨æ¥è®¾ç½®æŽ§åˆ¶å™¨åˆ«åï¼Œä»¥æ­¤ä¸ºåå‘å¸ƒæŽ§åˆ¶å™¨ï¼Œå¹¶ä¸”ä½œç”¨åŸŸå¯ä»¥è®¿é—®controllerAsã€‚è¿™æ ·å¯ä»¥åœ¨è§†å›¾ä¸­å¼•ç”¨æŽ§åˆ¶å™¨ï¼Œç”šè‡³æ— éœ€æ³¨å…¥$scopeã€‚ä¾‹ï¼š angular.module('myApp', []) .directive('myDirective', function(){ return { restrict: 'A', template: '{{myController.msg}}',//å¯ä»¥åœ¨tplä¸­ç›´æŽ¥è®¿é—®controller controllerAs: 'myController', contrller: function(){ this.msg = 'Hello'; } } }); åˆä¾‹ï¼š angular.module('myApp', []) .controller('myController', function(){ this.msg = 'robin'; }); {{main.robin}} 11. requireå…¶å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ•°ç»„ï¼Œå­—ç¬¦ä¸²æˆ–æ•°ç»„å…ƒç´ ä»£è¡¨å¦ä¸ªä¸€ä¸ªæŒ‡ä»¤çš„åå­—ã€‚require ä¼šå°†æŒ‡ä»¤æŽ§åˆ¶å™¨æ³¨å…¥åˆ°å½“å‰çš„æŒ‡ä»¤ä¸­ï¼Œå¹¶ä½œä¸ºå½“å‰æŒ‡ä»¤çš„é“¾æŽ¥å‡½æ•°çš„ç¬¬å››ä¸ªå‚æ•°ã€‚ ç»“åˆ9.controllerçš„ä¾‹å­ï¼Œå¯ä»¥è¿™æ ·ä½¿ç”¨ angular.module('myApp', []) .directive('otherForm', function(){ return { restrict: 'A', require: '^?inputForm', link: function(scope, element, attrs, ctrl){ ctrl.submit(); } } }); å¦‚æžœæ˜¯æ•°ç»„ï¼š angular.module('myApp', []) .directive('otherForm', function(){ return { restrict: 'A', require: [?^inputForm, inputForm2], link: function(scope, element, attrs, ctrl){ ctrl[0].submit(); ctrl[1].api(); } } }); requireå‰ç¼€ï¼š â€˜?â€™ å¦‚æžœåœ¨å½“å‰æŒ‡ä»¤ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€é¢è¦çš„æŽ§åˆ¶å™¨ï¼Œä¼šå°†nullä½œä¸ºlinkçš„ç¬¬å››ä¸ªå‚æ•°ï¼› â€˜^â€™ æŒ‡ä»¤ä¼šåœ¨ä¸Šæ¸¸çš„æŒ‡ä»¤é“¾ä¸­æŸ¥æ‰¾requireå‚æ•°æ‰€æŒ‡å®šçš„æŽ§åˆ¶å™¨ï¼› â€˜?^â€™ å‰ä¸¤ä¸ªé€‰é¡¹çš„ç»„åˆï¼› æ²¡æœ‰å‰ç¼€ æŒ‡ä»¤å°†åœ¨åŒçº§ä½œç”¨åŸŸæŸ¥æ‰¾æ‰€éœ€æŽ§åˆ¶å™¨ï¼Œå¦‚æžœæ²¡æœ‰æ‰¾åˆ°ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ 12. compilecompileé€‰é¡¹å¯ä»¥è¿”å›žä¸€ä¸ªå¯¹è±¡æˆ–å‡½æ•°ã€‚ compileå‡½æ•°å¯ä»¥ç”¨æ¥åœ¨æŒ‡ä»¤å’Œå®žæ—¶æ•°æ®è¢«æ”¾åˆ°DOMä¸­ä¹‹å‰è¿›è¡ŒDOMæ“ä½œï¼Œåœ¨è¿™é‡Œè¿›è¡Œæ·»åŠ å’Œåˆ é™¤èŠ‚ç‚¹ç­‰DOMæ“ä½œæ˜¯å®‰å…¨çš„ã€‚ compileä¸Žlinkå‡½æ•°æ˜¯äº’æ–¥çš„ã€‚å¦‚æžœåŒæ—¶è®¾ç½®ï¼Œcompileçš„è¿”å›žå‡½æ•°ä¼šè¢«å½“ä½œé“¾æŽ¥å‡½æ•°ï¼Œlinkå‡½æ•°ä¼šè¢«å¿½ç•¥ã€‚ compile: function(tEle, tAttrs, transcludeFn){ //...tEleä»£è¡¨æœªç»‘å®šäº‹ä»¶çš„DOMå…ƒç´  } 13. linklinkå‡½æ•°ä¼šç»å¸¸è¢«ä½¿ç”¨ã€‚è´Ÿè´£è®¾ç½®äº‹ä»¶ç›‘å¬å™¨ã€ç›‘å¬æ•°æ®å˜åŒ–å’Œå®žæ—¶çš„æ“ä½œDOMã€‚ å¦‚æžœæŒ‡ä»¤å¾ˆç®€å•ï¼Œå¯ä»¥ç›´æŽ¥ä»Žå·¥åŽ‚å‡½æ•°è¿”å›žä¸€ä¸ªå‡½æ•°æ¥ä»£æ›¿ã€‚å¦‚ï¼š angular.module('myApp', []) .directive('myDirective', function(){ return { pre: function(tElement, tAttrs, transclude){}, post: function(scope, iElement, iAttrs, controller){} } }); angular.module('myApp', []) .directive('myDirective', function(){ return { link: function(scope, ele, attrs){ return { pre: function(tElement, tAttrs, transclude){}, post: function(scope, iElement, iAttrs, controller){} } } } });]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>angularJS</tag>
        <tag>directive</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git åˆ†æ”¯]]></title>
    <url>%2F2015%2F10%2F10%2Fgit-branch.html</url>
    <content type="text"><![CDATA[gitåˆ†æ”¯å¯¹äºŽæˆ‘ä»¬å¹³å¸¸å¼€å‘æ–°åŠŸèƒ½ï¼Œä¿®å¤bugç­‰æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚ä¸‹é¢æ˜¯gitåˆ†æ”¯çš„å¸¸ç”¨å‘½ä»¤ï¼š åˆ†æ”¯çš„æ–°å»ºä¸Žåˆ‡æ¢ $ git checkout -b version2.0 è¿™ç›¸å½“äºŽæ‰§è¡Œä¸‹é¢è¿™ä¸¤æ¡å‘½ä»¤ï¼š $ git branch version2.0 $ git checkout version2.0 åˆ†æ”¯çš„åˆå¹¶ $ git checkout master $ git merge version2.0 åˆ‡æ¢åˆ°ä¸»åˆ†æ”¯ï¼ŒæŠŠåˆ†åŽ»version2.0åˆå¹¶åˆ°ä¸»åˆ†æ”¯ åˆ†æ”¯çš„åˆ é™¤ $ git branch -d verdion2.0 å¦‚æžœåˆ†æ”¯åŠŸèƒ½å·²ç»åˆå¹¶åˆ°ä¸»åˆ†æ”¯ï¼Œåˆ†æ”¯å°±æ²¡æœ‰ç”¨äº†ï¼Œå¯ä»¥åˆ é™¤ã€‚ åˆå¹¶åˆ†æ”¯çš„å†²çª åˆå¹¶å¹¶ä¸æ€»æ˜¯é¡ºåˆ©çš„ï¼Œç‰¹åˆ«æ˜¯å¤šäººåˆä½œçš„æ—¶å€™ï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿå†²çªã€‚ < HEAD > version2.0 â€˜=======â€™æŠŠä¸¤ä¸ªç‰ˆæœ¬å†²çªçš„å†…å®¹åˆ†éš”å¼€æ¥ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›æ ‡è®°éƒ½åˆ æŽ‰ï¼Œå¹¶ç•™ä¸‹åˆå¹¶åŽçš„ä»£ç ã€‚ åˆå¹¶GUIå·¥å…· å¦‚æžœå®‰è£…äº†å¯è§†åŒ–çš„åˆå¹¶å·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨$ git mergetoolå‘½ä»¤æ¥è°ƒç”¨ã€‚ æŽ¨èçš„GUIåˆå¹¶å·¥å…·æœ‰å¦‚ï¼šmeld, kdiff3 å¯ä»¥è¿™æ ·è°ƒç”¨æŒ‡å®šçš„å·¥å…·ï¼š$ git mergetool -t meld ä¹Ÿå¯ä»¥é…ç½®é»˜è®¤å·¥å…·ï¼š $ git config --global merge.tool kdiff3]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gulp 4.0çš„å˜åŒ–]]></title>
    <url>%2F2015%2F10%2F09%2Fgulp-4.0.html</url>
    <content type="text"><![CDATA[å‡çº§æ—¥å¿—å…ˆæ¥çœ‹çœ‹æ–°ç‰ˆæœ‰ä»€ä¹ˆä¸åŒï¼ˆå®˜æ–¹å‡çº§æ—¥å¿—ï¼‰ï¼š æ–°çš„ä»»åŠ¡ç³»ç»Ÿï¼ˆåŸºäºŽ bachï¼Œæ›¿æ¢æŽ‰äº†åŽŸå…ˆåŸºäºŽ orchestrator çš„ä»»åŠ¡ç³»ç»Ÿï¼‰ ç§»é™¤ gulp.reset gulp.task ä¸å†æ”¯æŒä¸‰ä¸ªå‚æ•°çš„ç”¨æ³• gulp.task ç”¨å­—ç¬¦ä¸²æ³¨å†Œçš„ä»»åŠ¡å¿…é¡»æ˜¯ç›´æŽ¥åœ¨å‘½ä»¤è¡Œä¸­è°ƒç”¨çš„ä»»åŠ¡ gulp.task å¯ä»¥æŽ¥å—å•å‚æ•°è¯­æ³•ï¼Œè¿™ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå‘½åå‡½æ•°ï¼Œå‡½æ•°åä¼šè¢«ä½œä¸ºä»»åŠ¡å æ·»åŠ äº† gulp.series å’Œ gulp.parallel æ–¹æ³•ç”¨äºŽç»„åˆä»»åŠ¡ æ·»åŠ äº† gulp.tree æ–¹æ³•ç”¨äºŽèŽ·å–ä»»åŠ¡æ ‘ï¼Œä¼ å…¥ { deep: true } å‚æ•°å¯ä»¥å¾—åˆ°ä¸€ä¸ª archy å…¼å®¹çš„èŠ‚ç‚¹åˆ—è¡¨ æ·»åŠ äº† gulp.registry æ–¹æ³•ä»¥å®šåˆ¶æ³¨å†Œè¡¨ã€‚ æ·»åŠ äº† gulp.symlink æ–¹æ³•ï¼ŒåŠŸèƒ½å’Œ gulp.dest ä¸€è‡´ï¼Œä¸è¿‡æ˜¯ä»¥è½¯é“¾æŽ¥çš„æ–¹å¼ gulp.dest å’Œ gulp.symlink æ–¹æ³•æ·»åŠ äº† dirMode å‚æ•°å…è®¸å¯¹ç›®æ ‡ç›®å½•æ›´å¥½åœ°æŽ§åˆ¶ gulp.src æŽ¥æ”¶çš„æ–‡ä»¶åŒ¹é…å­—ç¬¦ä¸²ä¼šé¡ºåºè§£é‡Šï¼Œæ‰€ä»¥ä½ å¯ä»¥å†™æˆè¿™æ · gulp.src([â€˜.jsâ€™, â€˜!b.jsâ€™, â€˜bad.jsâ€™])ï¼ˆæŽ’é™¤æ‰€æœ‰ä»¥ b å¼€å¤´çš„ JS æ–‡ä»¶ä½†æ˜¯é™¤äº† bad.jsï¼‰ gulp.src æ–¹æ³•æ·»åŠ äº† since é€‰é¡¹ï¼Œç­›é€‰åœ¨ç‰¹å®šæ—¶é—´ç‚¹ä¹‹åŽä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼ˆç”¨äºŽå¢žé‡ç¼–è¯‘ï¼‰ å°†å‘½ä»¤è¡Œåˆ†ç¦»å‡ºæ¥æˆä¸ºä¸€ä¸ªç‹¬ç«‹æ¨¡å—ï¼Œä»¥ä¾¿èŠ‚çº¦å¸¦å®½/ç©ºé—´ã€‚ç”¨ npm install gulp -g æˆ– npm install gulp-cli -g éƒ½å¯ä»¥å®‰è£…å‘½ä»¤è¡Œï¼Œåªæ˜¯ gulp-cli ä¸åŒ…å«æ¨¡å—ä»£ç æ‰€ä»¥æ¯”è¾ƒå° å‘½ä»¤è¡Œæ·»åŠ äº† â€“tasks-json å‚æ•°ï¼Œå¯ä»¥å¯¼å‡ºæ•´ä¸ªä»»åŠ¡æ ‘ä»¥ä¾›ä»–ç”¨ å‘½ä»¤è¡Œæ·»åŠ äº† â€“verify å‚æ•°ç”¨ä»¥æ£€æŸ¥ package.json ä¸­æ˜¯å¦åŒ…å«é»‘åå•æ’ä»¶ï¼ˆè¿èƒŒå‡†åˆ™è€Œè¢«ç¦å…¥å®˜æ–¹æ’ä»¶åˆ—è¡¨çš„å¯æ€œå¨ƒä»¬ï¼‰ã€‚ å®‰è£…gulp 4.0# å¦‚æžœå®‰è£…è¿‡å…¨å±€çš„ gulp çš„è¯å…ˆå¸è½½ä¹‹ $ npm uninstall gulp -g # å®‰è£…å…¨å±€çš„ gulp 4.0 $ npm install "gulpjs/gulp#4.0" -g # åˆ°é¡¹ç›®ç›®å½•é‡Œåˆ æŽ‰æœ¬åœ°çš„ gulp $ npm rm gulp --save-dev # å®‰è£…æœ¬åœ°çš„ gulp 4.0 $ npm install "gulpjs/gulp#4.0" --save-dev gulp.task1ã€ç§»é™¤äº†gulp.taskä¼ é€’ä¸‰å‚æ•°çš„ç”¨æ³• å³è¿™ç§ç”¨æ³•å°†æŠ¥é”™ gulp.task('watch', ['default'], function() { // TODO // watch file }); åœ¨gulp4.0ä¹‹å‰ï¼Œè¿™ç§ç”¨æ³•å°†ä¼šä¿è¯defaultä»»åŠ¡å…ˆæ‰§è¡Œå®Œå†æ‰§è¡Œwatchä»»åŠ¡ï¼Œgulpçš„ä»»åŠ¡æµç¨‹æŽ§åˆ¶å°±æ˜¯è¿™ä¹ˆå®žçŽ°çš„ï¼Œæµç¨‹æŽ§åˆ¶å¦å¤–å¢žåŠ apiå®žçŽ°ï¼Œè¯¦çœ‹åŽé¢ã€‚ 2ã€gulp.taskåˆå¢žåŠ äº†ä¸€ç§ç”¨æ³•ï¼Œå³ä¼ é€’ä¸€ä¸ªå…·åå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå°†è‡ªåŠ¨æ³¨å†Œä»¥è¯¥å‡½æ•°åå‘½åçš„ä»»åŠ¡ function clean(){} function compile() { // do something... } gulp.task(clean); gulp.task(compile); ç­‰åŒäºŽ gulp.task('clean', function() { // do something... }); gulp.task('compile', function() { // do something... }); ä»»åŠ¡æµç¨‹æŽ§åˆ¶å¢žåŠ äº†gulp.series ä¸²è¡Œä»»åŠ¡å’Œgulp.parallel å¹¶è¡Œä»»åŠ¡ï¼Œ æ¯”åŽŸæ¥çš„ä¸‰å‚æ•°å†™æ³•è¦æ›´åŠ æ¸…æ™°ã€‚ function clean(){} function copy(){} function compile() { // do something... } gulp.task(clean); gulp.task(copy); gulp.task(compile); gulp.task('clean-build', gulp.series('clean', 'copy', 'compile')); //ä»»åŠ¡å°†æŒ‰é¡ºåºæ‰§è¡Œ gulp.task('build', gulp.parallel('copy', 'compile')); //ä»»åŠ¡å°†å¹¶å‘æ‰§è¡Œ åªè¦åœ¨gulpfile.jsä¸­æ²¡æœ‰ä½¿ç”¨gulp.taskä¼ ä¸‰ä¸ªå‚æ•°çš„ç”¨æ³•ï¼Œgulp 4.0ä¹Ÿæ˜¯å…¼å®¹è€ç‰ˆæœ¬çš„gulpfile.jsçš„ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æž„å»º</tag>
        <tag>gulp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯æ‰¹é‡åŽ‹ç¼©å›¾ç‰‡]]></title>
    <url>%2F2015%2F10%2F08%2Foptimize-images-with-font-end.html</url>
    <content type="text"><![CDATA[å‰ç«¯æ‰¹é‡åŽ‹ç¼©å›¾ç‰‡å‰ç«¯åˆ‡å›¾çš„æ—¶å€™ï¼Œpng å›¾ç‰‡éƒ½æ¯”è¾ƒå¤§ï¼Œä¸€ç›´ä½¿ç”¨çš„æ˜¯ Tinypng æ¥åŽ‹ç¼© png å›¾ç‰‡ï¼Œå°å›¾æ ‡spriteä¹‹åŽï¼Œå›¾ç‰‡æ•°é‡è¿˜æ˜¯è‡³å°‘åœ¨ 20 ä»¥ä¸Šï¼Œæ“ä½œç”šæ˜¯éº»çƒ¦ã€‚åŽæ¥åœ¨ä½¿ç”¨ gulp çš„æ—¶å€™ï¼Œå‘çŽ°äº†ä¸€ä¸ªæ‰¹é‡åŽ‹ç¼©å›¾ç‰‡çš„ç¥žå™¨ â€”â€” pngquant ã€‚ å…ˆæ¥çœ‹çœ‹ä¸€ä¸ª gulp æ’ä»¶ gulp-imagemin Install $ npm install --save-dev gulp-imagemin Usage var gulp = require('gulp'); var imagemin = require('gulp-imagemin'); var pngquant = require('imagemin-pngquant'); gulp.task('default', function () { return gulp.src('src/images/*') .pipe(imagemin({ progressive: true, svgoPlugins: [{removeViewBox: false}], use: [pngquant()] //ä½¿ç”¨äº† pngquant åŽ‹ç¼©pngå›¾ç‰‡ })) .pipe(gulp.dest('dist/images')); }); gulp-imagemin å¯ä»¥åŽ‹ç¼©å‡ ä¹Žæ‰€æœ‰å›¾ç‰‡æ ¼å¼ PNG, JPEG, GIF and SVGï¼Œå…¶ä¸­pngåŽ‹ç¼©æ˜¯ä½¿ç”¨äº† pngquant ,éœ€è¦å…ˆå¦å¤–å®‰è£…ï¼š $ npm install --save imagemin-pngquant ä½†æ˜¯ï¼Œå›¾ç‰‡å…¶å®žå¹¶ä¸éœ€è¦æ¯æ¬¡æž„å»ºéƒ½åŽ‹ç¼©ï¼Œä¸€èˆ¬åªéœ€è¦åœ¨å‘å¸ƒæˆ–æµ‹è¯•çš„æ—¶å€™ä¸€æ¬¡æ€§åŽ‹ç¼©å°±å¯ä»¥äº†ã€‚ æ‰€ä»¥ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ gulp å·¥å…·è¿›è¡Œå›¾ç‰‡åŽ‹ç¼©ï¼Œç›´æŽ¥ä½¿ç”¨ pngquantã€‚ pngquant ä½¿ç”¨èµ·æ¥ä¹Ÿæ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œä¸‹è½½å¯¹åº”ç‰ˆæœ¬ï¼Œwindowsä¸‹æ·»åŠ æ–‡ä»¶ç›®å½•åˆ°ç³»ç»ŸçŽ¯å¢ƒå˜é‡ï¼Œè¿›å…¥åˆ°ç›¸åº”ç›®å½•ï¼Œç›´æŽ¥ä½¿ç”¨å‘½ä»¤è¡Œ pngquant *.png å³å¯å®ŒæˆåŽ‹ç¼©ï¼Œå¯ä»¥çœ‹åˆ°ç›®å½•ä¸‹ç”ŸæˆåŽç¼€åä¸º -fs8.png æˆ– -or8.pngçš„å›¾ç‰‡ã€‚ æŸ¥çœ‹ Readme.md é…ç½®ç›¸åº”å‚æ•° pngquantå¸¸ç”¨çš„ä¸»è¦å‚æ•°--quality min-max ç±»ä¼¼JPEGçš„è´¨é‡ï¼Œè®¾ç½®0 ~ 100 çš„å›¾ç‰‡åŽ‹ç¼©è´¨é‡ã€‚ pngquant --quality=65-80 *.png --ext new.png è®¾ç½®è¾“å‡ºåŽ‹ç¼©å›¾ç‰‡çš„æ–‡ä»¶åã€‚å¦‚æžœä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤åŽç¼€ä¸º -fs8.png æˆ– -or8.pngã€‚å¦‚æžœä½¿ç”¨ --ext=.png --forceï¼Œå°†ä¼šä½¿ç”¨åŽŸæ–‡ä»¶åè¾“å‡ºå¹¶è¦†ç›–åŽŸæ–‡ä»¶ã€‚ -o out.png or --output out.png è®¾ç½®å›¾ç‰‡è¾“å‡ºè·¯å¾„ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æž„å»º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git ssh-key åŠå¤šå¸æˆ·è®¾ç½®]]></title>
    <url>%2F2015%2F09%2F30%2Fgit-ssh-key-and-multiple-accounts-configs.html</url>
    <content type="text"><![CDATA[git ssh-key åŠå¤šå¸æˆ·è®¾ç½®åœ¨ä½¿ç”¨gitçš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ç®¡ç†è¿œç¨‹åˆ†æ”¯ä¹‹å‰éœ€è¦åœ¨æœ¬æœºä¸Šåˆ›å»ºssh-keyå¯†é’¥å¯¹ï¼Œå¹¶æŠŠå…¶ä¸­çš„å…¬é’¥æ·»åŠ åˆ°githubä¸­ã€‚ é¦–ä¸ªå¸æˆ·å¦‚æžœä½ åªä¼šåœ¨ä½ çš„è®¡ç®—æœºä½¿ç”¨ä¸€ä¸ªè¿œç¨‹çš„GitæœåŠ¡å™¨ï¼Œå¹¶ä¸”è´¦å·æ˜¯ä¸€ä¸ªï¼Œæ¯”è¾ƒç®€å•ï¼Œç”Ÿæˆkeyçš„æ—¶å€™ä¹Ÿæ²¡æœ‰å¤ªå¤§æ³¨æ„çš„åœ°æ–¹ï¼Œç›´æŽ¥è¿è¡Œå¦‚ä¸‹çš„ç¬¬ä¸€æ­¥ç„¶åŽæŒ‰å›žè½¦å°±å¯ä»¥äº† åœ¨ gitbashä¸Šè¿è¡Œ ssh-keygen -t rsa -C "Githubè´¦æˆ·é‚®ç®±" æŽ¥ä¸‹æ¥ä¼šæç¤ºè¾“å…¥keyçš„åå­— é»˜è®¤åå­—ä¸ºid_rsa ,é»˜è®¤ä¸æ”¹ç›´æŽ¥å›žè½¦å°±è¡Œäº† ç„¶åŽä¼šæç¤ºè¾“å…¥å£ä»¤ï¼Œè¿™é‡Œå£ä»¤ä¸ŽGithubä¸­çš„å¯†ç æ— å…³ï¼Œéšä¾¿è¾“å…¥å¯ä»¥ä¸ºç©ºï¼Œä¸ºç©ºç›´æŽ¥å›žè½¦ã€‚ å¦‚æžœåœ¨ç¬¬äºŒæ­¥ä¸­çš„æ²¡æœ‰é‡æ–°å‘½åçš„è¯ï¼Œåˆ™å¿½ç•¥æ­¤æ­¥éª¤ï¼Œssh agenté»˜è®¤åªè¯»å–id_rsaï¼Œä¸ºäº†è®©SSHè¯†åˆ«æ–°çš„ç§é’¥ï¼Œéœ€å°†å…¶æ·»åŠ åˆ°SSH agentä¸­,å¦‚ç¬¬äºŒæ­¥æ”¹çš„åå­—ä¸ºrobin, åˆ™æ‰§è¡Œï¼šssh-add id_rsaå¦‚æžœå‡ºçŽ°Could not open a connection to your authentication agentçš„é”™è¯¯ï¼Œå°±è¯•ç€å…ˆç”¨ä»¥ä¸‹å‘½ä»¤ï¼š ssh-agent bash ssh-add robin æ·»åŠ å®Œä¹‹åŽ ç™»é™†Github,ç‚¹å‡»ç½‘é¡µå³ä¸Šä¾§çš„ Settings æŒ‰é’® - é€‰æ‹© ssh-keys ç‚¹å‡»Add SSH Key ï¼Œåœ¨titleä¸­è¾“å…¥åå­—ï¼Œç„¶åŽå°†å…¬é’¥å³id_rsa.pubæ·»åŠ åˆ°ssh-keyå¤„ã€‚ æ‰§è¡Œ ssh -T git@github.com å¦‚æžœèƒ½æ­£å¸¸è®¿é—®å³å¯ $ ssh -T git@github.com Hi robin! You've successfully authenticated, but GitHub does not provide shell access. ç¬¬äºŒä¸ªå¸æˆ· æ–°å»ºuser2çš„SSH Key $ cd ~/.ssh #åˆ‡æ¢åˆ°C:\Users\Administrator\.ssh ssh-keygen -t rsa -C "user2çš„Githubè´¦æˆ·é‚®ç®±" //æ–°å»ºå·¥ä½œçš„SSH key Enter file in which to save the key (/c/Users/Administrator/.ssh/id_rsa): user2 //è®¾ç½®åç§°ä¸ºuser2(åŽæ–‡çš„user2å¯ä»¥ç»Ÿä¸€æ›¿æ¢ä»»ä½•åˆ«å) æ–°å¯†é’¥æ·»åŠ åˆ°SSH agentä¸­ å› ä¸ºé»˜è®¤åªè¯»å–id_rsaï¼Œä¸ºäº†è®©SSHè¯†åˆ«æ–°çš„ç§é’¥ï¼Œéœ€å°†å…¶æ·»åŠ åˆ°SSH agentä¸­ï¼š ssh-add ~/.ssh/user2 //æ³¨æ„è·¯å¾„ï¼Œå¦‚æžœä¸åœ¨.sshç›®å½•ä¸‹åˆ™ä¸èƒ½çœç•¥ '~/.ssh/' åŒæ ·ï¼Œå¦‚æžœå‡ºçŽ°Could not open a connection to your authentication agentçš„é”™è¯¯ï¼Œå°±è¯•ç€ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š ssh-agent bash ssh-add ~/.ssh/user2 æ·»åŠ user2çš„å…¬é’¥ æ‰“å¼€æ–°ç”Ÿæˆçš„ ~/.ssh/uesr2.pubæ–‡ä»¶ï¼Œå°†é‡Œé¢çš„å†…å®¹æ·»åŠ åˆ°user2çš„githubå¸å·ä¸‹çš„SSH Keyä¸­ã€‚ ä¿®æ”¹configæ–‡ä»¶ (é‡è¦çš„ä¸€æ­¥) å°†è´¦æˆ·ä»¥åŠgitæœåŠ¡å™¨ä¸Žå¯¹åº”çš„å¯†é’¥å…³è”ã€‚åœ¨~/.sshç›®å½•ä¸‹æ‰¾åˆ°configæ–‡ä»¶ï¼Œå¦‚æžœæ²¡æœ‰å°±åˆ›å»ºï¼š touch config ç„¶åŽä¿®æ”¹å¦‚ä¸‹ï¼š æˆ‘çš„configé…ç½®å¦‚ä¸‹ï¼š # è¯¥æ–‡ä»¶ç”¨äºŽé…ç½®ç§é’¥å¯¹åº”çš„æœåŠ¡å™¨ # Default github user1 Host github.com HostName github.com User git IdentityFile ~/.ssh/id_rsa # second user2 # å»ºä¸€ä¸ªgithubåˆ«åï¼Œæ–°å»ºçš„å¸å·ä½¿ç”¨è¿™ä¸ªåˆ«ååšå…‹éš†å’Œæ›´æ–° Host user2 HostName github.com User git IdentityFile ~/.ssh/user2 å¸å·å…³è” å¦‚æžœä½ åªæ˜¯æ–‡ç« ä¸­æ‰€è¿°é…ç½®äº†Hostï¼Œé‚£ä¹ˆä½ å¤šä¸ªè´¦å·ä¸‹é¢çš„æäº¤ç”¨æˆ·ä¼šæ˜¯ä¸€ä¸ªäººï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡å‘½ä»¤ git config --global --unset user.email åˆ é™¤å…¨å±€ç”¨æˆ·è´¦æˆ·è®¾ç½®ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸åˆ é™¤ï¼Œå¦‚æžœæ¯ä¸ªgité¡¹ç›®ä¸‹æ²¡æœ‰å•ç‹¬è®¾ç½®ç”¨æˆ·å¸æˆ·ä¿¡æ¯çš„è¯ï¼Œä¼šé»˜è®¤ä½¿ç”¨å…¨å±€è®¾ç½® åœ¨æ¯ä¸€ä¸ªgité¡¹ç›®ä¸‹é¢ä½¿ç”¨å‘½ä»¤ git config --local user.name 'è¯¥é¡¹ç›®çš„githubç”¨æˆ·å' git config --local user.email 'è¯¥é¡¹ç›®çš„githubé‚®ç®±@mail.com' å•ç‹¬è®¾ç½®ç”¨æˆ·è´¦æˆ·ä¿¡æ¯ï¼Œæ¯ä¸ªä¸åŒäºŽå…¨å±€ç”¨æˆ·å¸æˆ·çš„git é¡¹ç›®éƒ½éœ€è¦è®¾ç½®ã€‚ å…³äºŽ clone ä½¿ç”¨ git clone user2:user2/test.git è€Œä¸æ˜¯ git clone git@github.com:user2/test.git å¦åˆ™æ— æ³•åˆ†è¾¨ä½¿ç”¨çš„æ˜¯å“ªä¸€ä¸ªå¸æˆ·ã€‚ å…³äºŽ remote å¦‚æžœclone é¡¹ç›®æ—¶ä½¿ç”¨çš„æ˜¯ git clone user2:user2/test.git åˆ™remote urlçš„Host å°±æ˜¯user2ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€æ­¥ï¼Œå¦åˆ™éœ€è¦æ›´æ”¹ä¸€ä¸‹å…³è”ï¼ˆåŒ…æ‹¬git initæ–°å»ºï¼‰ï¼ŒæŸ¥çœ‹ remote git remote -v å¦‚æžœuser2çš„é¡¹ç›®`remote.origin.url=git@github.com:user2/test.git `åˆ™éœ€è¦è¿›è¡Œä¿®æ”¹ git remote rm origin git remote add origin user2:user2/test.git æµ‹è¯•ï¼š $ ssh -T git@github.com Hi user1! You've successfully authenticated, but GitHub does not provide shell access. $ ssh -T user2 Hi user2! You've successfully authenticated, but GitHub does not provide shell access.]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
</search>
